var c6=Object.create;var{getPrototypeOf:$6,defineProperty:p,getOwnPropertyNames:fj,getOwnPropertyDescriptor:F6}=Object,ij=Object.prototype.hasOwnProperty;var XA=(A,j,n)=>{n=A!=null?c6($6(A)):{};let t=j||!A||!A.__esModule?p(n,"default",{value:A,enumerable:!0}):n;for(let r of fj(A))if(!ij.call(t,r))p(t,r,{get:()=>A[r],enumerable:!0});return t},Ej=new WeakMap,B6=(A)=>{var j=Ej.get(A),n;if(j)return j;if(j=p({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")fj(A).map((t)=>!ij.call(j,t)&&p(j,t,{get:()=>A[t],enumerable:!(n=F6(A,t))||n.enumerable}));return Ej.set(A,j),j},W=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var L6=(A,j)=>{for(var n in j)p(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(t)=>j[n]=()=>t})};var eA=W((Jn,Y)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",q=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},P6=q,jA={},N;for(N in q)if(q.hasOwnProperty(N))jA[N]=q[N];var nA=[],cj="./this.program",CA=function(A,j){throw j},RA=!1,D=!1,hA=!1,$j=!1;RA=typeof window==="object";D=typeof importScripts==="function";hA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";$j=!RA&&!hA&&!D;var G="";function U6(A){if(q.locateFile)return q.locateFile(A,G);return G+A}var GA,ZA,tA,O6,zA,oA;if(hA){if(D)G=require("path").dirname(G)+"/";else G=__dirname+"/";if(GA=function A(j,n){if(!zA)zA=require("fs");if(!oA)oA=require("path");return j=oA.normalize(j),zA.readFileSync(j,n?null:"utf8")},tA=function A(j){var n=GA(j,!0);if(!n.buffer)n=new Uint8Array(n);return vj(n.buffer),n},process.argv.length>1)cj=process.argv[1].replace(/\\/g,"/");if(nA=process.argv.slice(2),typeof Y!=="undefined")Y.exports=q;process.on("uncaughtException",function(A){if(!(A instanceof d6))throw A}),process.on("unhandledRejection",EA),CA=function(A){process.exit(A)},q.inspect=function(){return"[Emscripten Module object]"}}else if($j){if(typeof read!="undefined")GA=function A(j){return read(j)};if(tA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),vj(typeof n==="object"),n},typeof scriptArgs!="undefined")nA=scriptArgs;else if(typeof arguments!="undefined")nA=arguments;if(typeof quit==="function")CA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(RA||D){if(D)G=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)G=document.currentScript.src;if(G.indexOf("blob:")!==0)G=G.substr(0,G.lastIndexOf("/")+1);else G="";{if(GA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},D)tA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};ZA=function(A,j,n){var t=new XMLHttpRequest;t.open("GET",A,!0),t.responseType="arraybuffer",t.onload=function(){if(t.status==200||t.status==0&&t.response){j(t.response);return}n()},t.onerror=n,t.send(null)}}O6=function(A){document.title=A}}var Wn=q.print||console.log.bind(console),AA=q.printErr||console.warn.bind(console);for(N in jA)if(jA.hasOwnProperty(N))q[N]=jA[N];jA=null;if(q.arguments)nA=q.arguments;if(q.thisProgram)cj=q.thisProgram;if(q.quit)CA=q.quit;var qA;if(q.wasmBinary)qA=q.wasmBinary;var Dn=q.noExitRuntime||!0;if(typeof WebAssembly!=="object")EA("no native wasm support detected");var kA,Fj=!1,G6;function vj(A,j){if(!A)EA("Assertion failed: "+j)}var K6=0,u6=1;function R6(A,j){var n;if(j==u6)n=Nj(A.length);else n=Tj(A.length);if(A.subarray||A.slice)J.set(A,n);else J.set(new Uint8Array(A),n);return n}var _j=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function w6(A,j,n){var t=j+n,r=j;while(A[r]&&!(r>=t))++r;if(r-j>16&&A.subarray&&_j)return _j.decode(A.subarray(j,r));else{var k="";while(j<r){var E=A[j++];if(!(E&128)){k+=String.fromCharCode(E);continue}var i=A[j++]&63;if((E&224)==192){k+=String.fromCharCode((E&31)<<6|i);continue}var v=A[j++]&63;if((E&240)==224)E=(E&15)<<12|i<<6|v;else E=(E&7)<<18|i<<12|v<<6|A[j++]&63;if(E<65536)k+=String.fromCharCode(E);else{var c=E-65536;k+=String.fromCharCode(55296|c>>10,56320|c&1023)}}}return k}function y6(A,j){return A?w6(J,A,j):""}function H6(A,j){if(A%j>0)A+=j-A%j;return A}var MA,Bj,J,Lj,Pj,Uj,Oj,Gj,Kj;function uj(A){MA=A,q.HEAP8=Bj=new Int8Array(A),q.HEAP16=Lj=new Int16Array(A),q.HEAP32=Uj=new Int32Array(A),q.HEAPU8=J=new Uint8Array(A),q.HEAPU16=Pj=new Uint16Array(A),q.HEAPU32=Oj=new Uint32Array(A),q.HEAPF32=Gj=new Float32Array(A),q.HEAPF64=Kj=new Float64Array(A)}var Xn=q.INITIAL_MEMORY||16777216,KA,Rj=[],wj=[],yj=[],x6=!1;function T6(){if(q.preRun){if(typeof q.preRun=="function")q.preRun=[q.preRun];while(q.preRun.length)V6(q.preRun.shift())}mA(Rj)}function N6(){x6=!0,mA(wj)}function S6(){if(q.postRun){if(typeof q.postRun=="function")q.postRun=[q.postRun];while(q.postRun.length)D6(q.postRun.shift())}mA(yj)}function V6(A){Rj.unshift(A)}function W6(A){wj.unshift(A)}function D6(A){yj.unshift(A)}var X=0,QA=null,rA=null;function X6(A){if(X++,q.monitorRunDependencies)q.monitorRunDependencies(X)}function J6(A){if(X--,q.monitorRunDependencies)q.monitorRunDependencies(X);if(X==0){if(QA!==null)clearInterval(QA),QA=null;if(rA){var j=rA;rA=null,j()}}}q.preloadedImages={};q.preloadedAudios={};function EA(A){if(q.onAbort)q.onAbort(A);A+="",AA(A),Fj=!0,G6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var Y6="data:application/octet-stream;base64,";function Hj(A){return A.startsWith(Y6)}function xj(A){return A.startsWith("file://")}var U="argon2.wasm";if(!Hj(U))U=U6(U);function Ij(A){try{if(A==U&&qA)return new Uint8Array(qA);if(tA)return tA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){EA(j)}}function z6(){if(!qA&&(RA||D)){if(typeof fetch==="function"&&!xj(U))return fetch(U,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+U+"'";return A.arrayBuffer()}).catch(function(){return Ij(U)});else if(ZA)return new Promise(function(A,j){ZA(U,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return Ij(U)})}function o6(){var A={a:h6};function j(E,i){var v=E.exports;q.asm=v,kA=q.asm.c,uj(kA.buffer),KA=q.asm.k,W6(q.asm.d),J6("wasm-instantiate")}X6("wasm-instantiate");function n(E){j(E.instance)}function t(E){return z6().then(function(i){var v=WebAssembly.instantiate(i,A);return v}).then(E,function(i){AA("failed to asynchronously prepare wasm: "+i),EA(i)})}function r(){if(!qA&&typeof WebAssembly.instantiateStreaming==="function"&&!Hj(U)&&!xj(U)&&typeof fetch==="function")return fetch(U,{credentials:"same-origin"}).then(function(E){var i=WebAssembly.instantiateStreaming(E,A);return i.then(n,function(v){return AA("wasm streaming compile failed: "+v),AA("falling back to ArrayBuffer instantiation"),t(n)})});else return t(n)}if(q.instantiateWasm)try{var k=q.instantiateWasm(A,j);return k}catch(E){return AA("Module.instantiateWasm callback failed with error: "+E),!1}return r(),{}}function mA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(q);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)KA.get(n)();else KA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function Q6(A,j,n){J.copyWithin(A,j,j+n)}function C6(A){try{return kA.grow(A-MA.byteLength+65535>>>16),uj(kA.buffer),1}catch(j){}}function Z6(A){var j=J.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var t=1;t<=4;t*=2){var r=j*(1+0.2/t);r=Math.min(r,A+100663296);var k=Math.min(n,H6(Math.max(A,r),65536)),E=C6(k);if(E)return!0}return!1}var h6={a:Q6,b:Z6},M6=o6(),m6=q.___wasm_call_ctors=function(){return(m6=q.___wasm_call_ctors=q.asm.d).apply(null,arguments)},g6=q._argon2_hash=function(){return(g6=q._argon2_hash=q.asm.e).apply(null,arguments)},Tj=q._malloc=function(){return(Tj=q._malloc=q.asm.f).apply(null,arguments)},e6=q._free=function(){return(e6=q._free=q.asm.g).apply(null,arguments)},b6=q._argon2_verify=function(){return(b6=q._argon2_verify=q.asm.h).apply(null,arguments)},l6=q._argon2_error_message=function(){return(l6=q._argon2_error_message=q.asm.i).apply(null,arguments)},s6=q._argon2_encodedlen=function(){return(s6=q._argon2_encodedlen=q.asm.j).apply(null,arguments)},a6=q._argon2_hash_ext=function(){return(a6=q._argon2_hash_ext=q.asm.l).apply(null,arguments)},p6=q._argon2_verify_ext=function(){return(p6=q._argon2_verify_ext=q.asm.m).apply(null,arguments)},Nj=q.stackAlloc=function(){return(Nj=q.stackAlloc=q.asm.n).apply(null,arguments)};q.allocate=R6;q.UTF8ToString=y6;q.ALLOC_NORMAL=K6;var uA;function d6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}rA=function A(){if(!uA)gA();if(!uA)rA=A};function gA(A){if(A=A||nA,X>0)return;if(T6(),X>0)return;function j(){if(uA)return;if(uA=!0,q.calledRun=!0,Fj)return;if(N6(),q.onRuntimeInitialized)q.onRuntimeInitialized();S6()}if(q.setStatus)q.setStatus("Running..."),setTimeout(function(){setTimeout(function(){q.setStatus("")},1),j()},1);else j()}q.run=gA;if(q.preInit){if(typeof q.preInit=="function")q.preInit=[q.preInit];while(q.preInit.length>0)q.preInit.pop()()}gA();if(typeof Y!=="undefined")Y.exports=q;q.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(q=P6=kA=KA=M6=MA=Bj=J=Lj=Pj=Uj=Oj=Gj=Kj=void 0,typeof Y!=="undefined")delete Y.exports}});var Sj=W((Yn,An)=>{An.exports="./cryptit.index.wasm"});var Wj=W((Vj,wA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof wA==="object"&&wA.exports)wA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:Vj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(f){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=r().then((_)=>new Promise((F)=>{_.postRun=()=>F(_)}));else I=k().then((_)=>{let F=f?i(f):void 0;return t(_,F)});return n._promise=I,I.then((_)=>{return n._module=_,delete n._promise,_})}function t(f,I){return new Promise((_)=>{return A.Module={wasmBinary:f,wasmMemory:I,postRun(){_(Module)}},r()})}function r(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(eA())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(Sj()).then((I)=>{return E(I)})}function E(f){let I=atob(f),_=new Uint8Array(new ArrayBuffer(I.length));for(let F=0;F<I.length;F++)_[F]=I.charCodeAt(F);return _}function i(f){let C=Math.min(Math.max(Math.ceil(f*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:C,maximum:32767})}function v(f,I){return f.allocate(I,"i8",f.ALLOC_NORMAL)}function c(f,I){let _=new Uint8Array([...I,0]);return v(f,_)}function B(f){if(typeof f!=="string")return f;if(typeof TextEncoder==="function")return new TextEncoder().encode(f);else if(typeof Buffer==="function")return Buffer.from(f);else throw new Error("Don't know how to encode UTF8")}function L(f){let I=f.mem||1024;return n(I).then((_)=>{let F=f.time||1,b=f.parallelism||1,l=B(f.pass),C=c(_,l),WA=l.length,cA=B(f.salt),$A=c(_,cA),s=cA.length,Z=f.type||j.Argon2d,u=_.allocate(new Array(f.hashLen||24),"i8",_.ALLOC_NORMAL),H=f.secret?v(_,f.secret):0,a=f.secret?f.secret.byteLength:0,O=f.ad?v(_,f.ad):0,_6=f.ad?f.ad.byteLength:0,FA=f.hashLen||24,rj=_._argon2_encodedlen(F,I,b,s,FA,Z),DA=_.allocate(new Array(rj+1),"i8",_.ALLOC_NORMAL),yn=19,h,BA;try{BA=_._argon2_hash_ext(F,I,b,C,WA,$A,s,u,FA,DA,rj,Z,H,a,O,_6,19)}catch(M){h=M}let LA;if(BA===0&&!h){let M="",qj=new Uint8Array(FA);for(let PA=0;PA<FA;PA++){let kj=_.HEAP8[u+PA];qj[PA]=kj,M+=("0"+(255&kj).toString(16)).slice(-2)}let I6=_.UTF8ToString(DA);LA={hash:qj,hashHex:M,encoded:I6}}else{try{if(!h)h=_.UTF8ToString(_._argon2_error_message(BA))}catch(M){}LA={message:h,code:BA}}try{if(_._free(C),_._free($A),_._free(u),_._free(DA),O)_._free(O);if(H)_._free(H)}catch(M){}if(h)throw LA;else return LA})}function $(f){return n().then((I)=>{let _=B(f.pass),F=c(I,_),b=_.length,l=f.secret?v(I,f.secret):0,C=f.secret?f.secret.byteLength:0,WA=f.ad?v(I,f.ad):0,cA=f.ad?f.ad.byteLength:0,$A=B(f.encoded),s=c(I,$A),Z=f.type;if(Z===void 0){let O=f.encoded.split("$")[1];if(O)O=O.replace("a","A"),Z=j[O]||j.Argon2d}let u,H;try{H=I._argon2_verify_ext(s,F,b,l,C,WA,cA,Z)}catch(O){u=O}let a;if(H||u){try{if(!u)u=I.UTF8ToString(I._argon2_error_message(H))}catch(O){}a={message:u,code:H}}try{I._free(F),I._free(s)}catch(O){}if(u)throw a;else return a})}function V(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:L,verify:$,unloadRuntime:V}})});var Yj=W((zn,Jj)=>{var yA=/^[a-z0-9-]{1,32}$/,HA=/^[a-z0-9-]{1,32}$/,xA=/^[a-zA-Z0-9/+.-]+$/,Dj=/^([a-zA-Z0-9/+.-]+|)$/,jn=/^((-)?[1-9]\d*|0)$/,bA=/^v=(\d+)$/;function nn(A){return fA(A).map((j)=>[j,A[j]].join("=")).join(",")}function tn(A){let j={};return A.split(",").forEach((n)=>{let t=n.split("=");if(t.length<2)throw new TypeError("params must be in the format name=value");j[t.shift()]=t.join("=")}),j}function fA(A){return Object.keys(A)}function Xj(A){if(typeof Object.values==="function")return Object.values(A);return fA(A).map((j)=>A[j])}function rn(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!yA.test(A.id))throw new TypeError(`id must satisfy ${yA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let t=fA(A.params);if(!t.every((E)=>HA.test(E)))throw new TypeError(`params names must satisfy ${HA}`);t.forEach((E)=>{if(typeof A.params[E]==="number")A.params[E]=A.params[E].toString();else if(Buffer.isBuffer(A.params[E]))A.params[E]=A.params[E].toString("base64").split("=")[0]});let r=Xj(A.params);if(!r.every((E)=>typeof E==="string"))throw new TypeError("params values must be strings");if(!r.every((E)=>xA.test(E)))throw new TypeError(`params values must satisfy ${xA}`);let k=nn(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function qn(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!bA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let t=j.shift();if(!yA.test(t))throw new TypeError(`id must satisfy ${yA}`);let r;if(bA.test(j[0]))r=parseInt(j.shift().match(bA)[1],10);let k,E;if(Dj.test(j[j.length-1]))if(j.length>1&&Dj.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),E=Buffer.from(j.pop(),"base64");else E=Buffer.from(j.pop(),"base64");let i;if(j.length>0){let c=j.pop();if(i=tn(c),!fA(i).every(($)=>HA.test($)))throw new TypeError(`params names must satisfy ${HA}`);if(!Xj(i).every(($)=>xA.test($)))throw new TypeError(`params values must satisfy ${xA}`);fA(i).forEach(($)=>{i[$]=jn.test(i[$])?parseInt(i[$],10):i[$]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let v={id:t};if(r)v.version=r;if(i)v.params=i;if(E)v.salt=E;if(k)v.hash=k;return v}Jj.exports={serialize:rn,deserialize:qn}});var dj=W((on,pj)=>{var Cj=require("fs"),y=require("path"),Zj=require("os"),hj=typeof __webpack_require__==="function"?__non_webpack_require__:require,kn=process.config&&process.config.variables||{},En=!!process.env.PREBUILDS_ONLY,zj=process.versions.modules,lA=_n()?"electron":vn()?"node-webkit":"node",sA=process.env.npm_config_arch||Zj.arch(),aA=process.env.npm_config_platform||Zj.platform(),Mj=process.env.LIBC||(In(aA)?"musl":"glibc"),pA=process.env.ARM_VERSION||(sA==="arm64"?"8":kn.arm_version)||"",mj=(process.versions.uv||"").split(".")[0];pj.exports=R;function R(A){return hj(R.resolve(A))}R.resolve=R.path=function(A){A=y.resolve(A||".");try{var j=hj(y.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(v){}if(!En){var n=oj(y.join(A,"build/Release"),Qj);if(n)return n;var t=oj(y.join(A,"build/Debug"),Qj);if(t)return t}var r=i(A);if(r)return r;var k=i(y.dirname(process.execPath));if(k)return k;var E=["platform="+aA,"arch="+sA,"runtime="+lA,"abi="+zj,"uv="+mj,pA?"armv="+pA:"","libc="+Mj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+E+`
    loaded from: `+A+`
`);function i(v){var c=dA(y.join(v,"prebuilds")).map(gj),B=c.filter(ej(aA,sA)).sort(bj)[0];if(!B)return;var L=y.join(v,"prebuilds",B.name),$=dA(L).map(lj),V=$.filter(sj(lA,zj)),f=V.sort(aj(lA))[0];if(f)return y.join(L,f.file)}};function dA(A){try{return Cj.readdirSync(A)}catch(j){return[]}}function oj(A,j){var n=dA(A).filter(j);return n[0]&&y.join(A,n[0])}function Qj(A){return/\.node$/.test(A)}function gj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],t=j[1].split("+");if(!n)return;if(!t.length)return;if(!t.every(Boolean))return;return{name:A,platform:n,architectures:t}}function ej(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function bj(A,j){return A.architectures.length-j.architectures.length}function lj(A){var j=A.split("."),n=j.pop(),t={file:A,specificity:0};if(n!=="node")return;for(var r=0;r<j.length;r++){var k=j[r];if(k==="node"||k==="electron"||k==="node-webkit")t.runtime=k;else if(k==="napi")t.napi=!0;else if(k.slice(0,3)==="abi")t.abi=k.slice(3);else if(k.slice(0,2)==="uv")t.uv=k.slice(2);else if(k.slice(0,4)==="armv")t.armv=k.slice(4);else if(k==="glibc"||k==="musl")t.libc=k;else continue;t.specificity++}return t}function sj(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!fn(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==mj)return!1;if(n.armv&&n.armv!==pA)return!1;if(n.libc&&n.libc!==Mj)return!1;return!0}}function fn(A){return A.runtime==="node"&&A.napi}function aj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function vn(){return!!(process.versions&&process.versions.nw)}function _n(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function In(A){return A==="linux"&&Cj.existsSync("/etc/alpine-release")}R.parseTags=lj;R.matchTags=sj;R.compareTags=aj;R.parseTuple=gj;R.matchTuple=ej;R.compareTuples=bj});var A6=W((Qn,jj)=>{var Aj=typeof __webpack_require__==="function"?__non_webpack_require__:require;if(typeof Aj.addon==="function")jj.exports=Aj.addon.bind(Aj);else jj.exports=dj()});var r6=W((Zn,z)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",Cn=require("node:assert"),{randomBytes:cn,timingSafeEqual:$n}=require("node:crypto"),{promisify:Fn}=require("node:util"),{deserialize:j6,serialize:Bn}=Yj(),Ln=A6(),{hash:n6}=Ln(__dirname),Pn=Fn(cn);z.exports.argon2d=0;z.exports.argon2i=1;z.exports.argon2id=2;var iA=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),Un=Object.freeze({[iA.argon2d]:"argon2d",[iA.argon2i]:"argon2i",[iA.argon2id]:"argon2id"}),t6={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function On(A,j){let{raw:n,salt:t,...r}={...t6,...j};if(r.hashLength>4294967295)throw new RangeError("Hash length is too large");if(r.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(r.timeCost>4294967295)throw new RangeError("Time cost is too large");if(r.parallelism>16777215)throw new RangeError("Parallelism is too large");t=t??await Pn(16);let{hashLength:k,secret:E=Buffer.alloc(0),type:i,version:v,memoryCost:c,timeCost:B,parallelism:L,associatedData:$=Buffer.alloc(0)}=r,V=await n6({password:Buffer.from(A),salt:t,secret:E,data:$,hashLength:k,m:c,t:B,p:L,version:v,type:i});if(n)return V;return Bn({id:Un[i],version:v,params:{m:c,t:B,p:L,...$.byteLength>0?{data:$}:{}},salt:t,hash:V})}z.exports.hash=On;function Gn(A,j={}){let{memoryCost:n,timeCost:t,parallelism:r,version:k}={...t6,...j},{version:E,params:{m:i,t:v,p:c}}=j6(A);return+E!==+k||+i!==+n||+v!==+t||+c!==+r}z.exports.needsRehash=Gn;async function Kn(A,j,n={}){let{id:t,...r}=j6(A);if(!(t in iA))return!1;let{version:k=16,params:{m:E,t:i,p:v,data:c=""},salt:B,hash:L}=r,{secret:$=Buffer.alloc(0)}=n;return $n(await n6({password:Buffer.from(j),salt:B,secret:$,data:Buffer.from(c,"base64"),hashLength:L.byteLength,m:+E,t:+i,p:+v,version:+k,type:iA[t]}),L)}z.exports.verify=Kn});var wn={};L6(wn,{createCryptit:()=>Rn});module.exports=B6(wn);class w extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class x extends w{}class d extends w{}class JA extends w{}class UA extends w{}class m extends w{}class T extends w{}class OA extends w{}class K extends w{}class P{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new UA(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new UA(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class YA{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),t=new Uint8Array(j.length+n.length);return t.set(j),t.set(n,j.length),t}async decryptChunk(A){let j=A.slice(0,12),n=A.slice(12),t=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);try{let r=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(r)}catch{throw new K("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var TA=XA(Wj());async function q6(A,j,n,t){if(t==="node"){let r=await Promise.resolve().then(() => XA(r6())),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),E=Buffer.from(j),i=await r.hash(k,{salt:E,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:r.argon2id});return{hash:new Uint8Array(i)}}if(t==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>{let r=new URL("argon2.wasm",import.meta.url).href;return fetch(r).then((k)=>{if(!k.ok)throw new Error("Failed to load argon2.wasm");return k.arrayBuffer()}).then((k)=>new Uint8Array(k))};return TA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:TA.ArgonType.Argon2id}).then((r)=>{if(!r||!r.hash)throw new Error("Failed to produce key derivation");return{hash:r.hash}}).catch((r)=>{let k=r instanceof Error?r.message:typeof r==="string"?r:"Unknown error";throw new T(`argon2-browser failure: ${k}`)})}throw new Error(`Unsupported environment: ${t}`)}class nj{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,n,t){let{hash:r}=await q6(A,j,this.presets[n],t.isNode?"node":"browser");return t.subtle.importKey("raw",r,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var k6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},un={id:0,cipher:YA,kdf:new nj(k6),saltLengths:{low:12,high:16},difficulties:k6,defaultChunkSize:524288};P.register(un);var NA=1;function E6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function vA(...A){let j=A.reduce((r,k)=>r+k.byteLength,0),n=new Uint8Array(j),t=0;for(let r of A)n.set(r,t),t+=r.byteLength;return n}function _A(...A){try{let j=vA(...A);if(E6())return Buffer.from(j).toString("base64");let n="";for(let t=0;t<j.length;t++)n+=String.fromCharCode(j[t]);return btoa(n)}catch(j){throw new JA("Base64 Enconding Error")}}function tj(A){try{if(E6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let t=0;t<j.length;t++)n[t]=j.charCodeAt(t);return n}catch(j){throw new d("Base64 Decoding Error")}}function SA(A,j,n,t){let r={low:0,middle:1,high:2}[j]??0,k=A<<5|(n==="high"?1:0)<<2|r;return vA(new Uint8Array([NA,k]),t)}function o(A){if(A[0]!==NA)throw new x("Invalid input format. The input is unknown.");try{let j=A[1],n=j>>5,t=j>>2&1?"high":"low",r=j&3,k=["low","middle","high"][r],E=P.get(n).saltLengths[t],i=A.slice(2,2+E);return{version:n,difficulty:k,saltStrength:t,salt:i,headerLen:2+E}}catch(j){throw new m(j instanceof Error?j.message:String(j))}}class IA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(n.length-t>=this.chunkSize){let r=n.slice(t,t+this.chunkSize);t+=this.chunkSize;let k=await this.engine.encryptChunk(r),E=new Uint8Array(4);new DataView(E.buffer).setUint32(0,k.length,!1);let i=new Uint8Array(4+k.length);i.set(E),i.set(k,E.length),j.enqueue(i)}this.buffer=n.slice(t)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let t=new Uint8Array(4+j.length);t.set(n),t.set(j,4),A.enqueue(t),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class g{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(!0){if(n.length-t<4)break;let r=new DataView(n.buffer,n.byteOffset+t,4).getUint32(0,!1);if(n.length-t-4<r)break;t+=4;let k=n.slice(t,t+r);t+=r;try{let E=await this.engine.decryptChunk(k);j.enqueue(E)}catch(E){throw E instanceof K?E:new K("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(t)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class e{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new IA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(r,k){if(j===0){k.enqueue(r);return}if(r.byteLength<=j){j-=r.byteLength;return}k.enqueue(r.slice(j)),j=0}}),t=new g(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(t)}}async collect(A,j,n=null){let t=A.pipeThrough(j).getReader(),r=[];if(n?.length)r.push(n);while(!0){let{value:v,done:c}=await t.read();if(c)break;r.push(v)}let k=r.reduce((v,c)=>v+c.byteLength,0),E=new Uint8Array(k),i=0;for(let v of r)E.set(v,i),i+=v.byteLength;return E}}function f6(A=0,j=console.info){return{level:A,log(n,t){if(n<=A)j(`${n}| ${t}`)}}}var i6=new Map;class S{static getEngine(A,j){let n=i6.get(j);if(n)return n;let t=P.get(j),r=new t.cipher(A),k=t.kdf,E=t.defaultChunkSize;return n={desc:t,cipher:r,kdf:k,chunkSize:E,provider:A},i6.set(j,n),n}static async deriveKey(A,j,n,t){try{let r=await A.kdf.derive(j,n,t,A.provider);A.cipher.key=r}catch(r){let k=r instanceof Error?r.message:String(r);throw new T(k)}}}class Q{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=P.get(j.version??P.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new e(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=f6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await Q.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await Q.peekHeader(A),n=o(j);return{version:n.version,difficulty:n.difficulty,salt:_A(n.salt),saltLength:n.salt.byteLength}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setVersion(A){this.v=P.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new e(this.cipher,this.chunkSize)}getVersion(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){this.chunkSize=A,this.stream=new e(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){try{this.log.log(1,"Start text encryption"),this.log.log(2,"Deriving key for text encryption");let n=this.genSalt();await this.deriveKey(j,n),this.log.log(3,`Salt generated: ${_A(n)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let t=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.log.log(3,"Encoding header");let r=SA(this.v.id,this.difficulty,this.saltStrength,n);return this.log.log(3,"Encoding text"),_A(r,t)}catch(n){throw new OA(n instanceof Error?n.message:String(n))}}async decryptText(A,j){try{this.log.log(1,"Start text decryption");let n=tj(A);this.log.log(3,"Start header decoding"),await Q.peekHeader(A);let t=o(n);this.log.log(3,"Trying to get engine");let r=S.getEngine(this.provider,t.version);this.log.log(2,"Deriving key via engine for text decryption"),this.log.log(3,`Salt use: ${_A(t.salt)}, KDF difficulty: ${t.difficulty}`),await S.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting text data");let k=await r.cipher.decryptChunk(n.slice(t.headerLen));return this.log.log(3,"Decoding text"),new TextDecoder().decode(k)}catch(n){if(n instanceof K||n instanceof x||n instanceof m||n instanceof d||n instanceof T)throw n;throw new K("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){try{this.log.log(2,"Deriving key for file encryption");let n=this.genSalt();await this.deriveKey(j,n);let t=SA(this.v.id,this.difficulty,this.saltStrength,n),r=await this.stream.collect(A.stream(),new IA(this.cipher,this.chunkSize).toTransformStream(),t);return new Blob([r],{type:"application/octet-stream"})}catch(n){throw new OA(n instanceof Error?n.message:String(n))}}async decryptFile(A,j){try{let n=await Q.peekHeader(A),t=o(n),r=S.getEngine(this.provider,t.version);await S.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting file data");let E=await new e(r.cipher,r.chunkSize).collect(A.slice(t.headerLen).stream(),new g(r.cipher,r.chunkSize).toTransformStream());return new Blob([E],{type:"application/octet-stream"})}catch(n){if(n instanceof K)throw n;throw new K(n instanceof Error?n.message:String(n))}}async createEncryptionStream(A){this.log.log(2,"Deriving key for stream encryption");let j=this.genSalt();await this.deriveKey(A,j);let n=SA(this.v.id,this.difficulty,this.saltStrength,j),t=this.stream.encryptionStream();return{header:n,writable:t.writable,readable:t.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),t=null;async function r(k,E){let i=k.getReader();while(!0){let{value:v,done:c}=await i.read();if(c)break;E.enqueue(v)}}return new TransformStream({async transform(k,E){if(!t){if(n=vA(n,k),n.length<2)return;let v=n.slice(0,30),{salt:c,difficulty:B}=o(v),L=n[1]>>5,$=n[1]>>2&1?"high":"low",f=2+P.get(L).saltLengths[$];if(n.length<f)return;let I=S.getEngine(j.provider,L);await S.deriveKey(I,A,c,B),t=new g(I.cipher,I.chunkSize).toTransformStream(),r(t.readable,E);let _=n.slice(f);if(_.length){let F=t.writable.getWriter();await F.write(_),F.releaseLock()}return}let i=t.writable.getWriter();await i.write(k),i.releaseLock()},async flush(){if(t){let k=t.writable.getWriter();await k.close(),k.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let t=performance.now();try{let r=await this.kdf.derive(A,j,n,this.provider);this.cipher.key=r,this.log.log(3,`Key derivation completed in ${(performance.now()-t).toFixed(1)} ms`)}catch(r){throw new T(r instanceof Error?r.message:String(r))}}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}static async peekHeader(A){if(typeof A==="string")A=tj(A);if(A instanceof Uint8Array){if(A.length<2)throw new x("Input too short");let{headerLen:j}=o(A.length>=16?A:Uint8Array.from(A));if(A.length<j)throw new x("Incomplete header");return A.slice(0,j)}if(A instanceof Blob){let j=new Uint8Array(await A.slice(0,2).arrayBuffer());if(j[0]!==1)throw new x("Invalid input format. The input is unknown.");let n=j[1],t=n>>5,r=n>>2&1?"high":"low",k=P.get(t).saltLengths[r],E=new Uint8Array(await A.slice(0,2+k).arrayBuffer());return o(E),E}throw new m("Unsupported input type")}}var VA=require("node:crypto"),v6={subtle:VA.webcrypto.subtle,getRandomValues(A){return VA.randomFillSync(A),A},isNode:!0};function Rn(A){return new Q(v6,A)}

//# debugId=1B04F4C8D7B0025D64756E2164756E21
