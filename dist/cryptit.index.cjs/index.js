var _6=Object.create;var{getPrototypeOf:I6,defineProperty:p,getOwnPropertyNames:Ej,getOwnPropertyDescriptor:c6}=Object,kj=Object.prototype.hasOwnProperty;var WA=(A,j,n)=>{n=A!=null?_6(I6(A)):{};let t=j||!A||!A.__esModule?p(n,"default",{value:A,enumerable:!0}):n;for(let r of Ej(A))if(!kj.call(t,r))p(t,r,{get:()=>A[r],enumerable:!0});return t},qj=new WeakMap,$6=(A)=>{var j=qj.get(A),n;if(j)return j;if(j=p({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")Ej(A).map((t)=>!kj.call(j,t)&&p(j,t,{get:()=>A[t],enumerable:!(n=c6(A,t))||n.enumerable}));return qj.set(A,j),j},D=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var F6=(A,j)=>{for(var n in j)p(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(t)=>j[n]=()=>t})};var gA=D((Wn,o)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",q=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},B6=q,AA={},T;for(T in q)if(q.hasOwnProperty(T))AA[T]=q[T];var jA=[],_j="./this.program",zA=function(A,j){throw j},KA=!1,W=!1,QA=!1,Ij=!1;KA=typeof window==="object";W=typeof importScripts==="function";QA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";Ij=!KA&&!QA&&!W;var G="";function L6(A){if(q.locateFile)return q.locateFile(A,G);return G+A}var OA,CA,nA,P6,JA,oA;if(QA){if(W)G=require("path").dirname(G)+"/";else G=__dirname+"/";if(OA=function A(j,n){if(!JA)JA=require("fs");if(!oA)oA=require("path");return j=oA.normalize(j),JA.readFileSync(j,n?null:"utf8")},nA=function A(j){var n=OA(j,!0);if(!n.buffer)n=new Uint8Array(n);return fj(n.buffer),n},process.argv.length>1)_j=process.argv[1].replace(/\\/g,"/");if(jA=process.argv.slice(2),typeof o!=="undefined")o.exports=q;process.on("uncaughtException",function(A){if(!(A instanceof a6))throw A}),process.on("unhandledRejection",EA),zA=function(A){process.exit(A)},q.inspect=function(){return"[Emscripten Module object]"}}else if(Ij){if(typeof read!="undefined")OA=function A(j){return read(j)};if(nA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),fj(typeof n==="object"),n},typeof scriptArgs!="undefined")jA=scriptArgs;else if(typeof arguments!="undefined")jA=arguments;if(typeof quit==="function")zA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(KA||W){if(W)G=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)G=document.currentScript.src;if(G.indexOf("blob:")!==0)G=G.substr(0,G.lastIndexOf("/")+1);else G="";{if(OA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},W)nA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};CA=function(A,j,n){var t=new XMLHttpRequest;t.open("GET",A,!0),t.responseType="arraybuffer",t.onload=function(){if(t.status==200||t.status==0&&t.response){j(t.response);return}n()},t.onerror=n,t.send(null)}}P6=function(A){document.title=A}}var Sn=q.print||console.log.bind(console),d=q.printErr||console.warn.bind(console);for(T in AA)if(AA.hasOwnProperty(T))q[T]=AA[T];AA=null;if(q.arguments)jA=q.arguments;if(q.thisProgram)_j=q.thisProgram;if(q.quit)zA=q.quit;var rA;if(q.wasmBinary)rA=q.wasmBinary;var Dn=q.noExitRuntime||!0;if(typeof WebAssembly!=="object")EA("no native wasm support detected");var qA,cj=!1,U6;function fj(A,j){if(!A)EA("Assertion failed: "+j)}var O6=0,G6=1;function u6(A,j){var n;if(j==G6)n=xj(A.length);else n=Hj(A.length);if(A.subarray||A.slice)J.set(A,n);else J.set(new Uint8Array(A),n);return n}var ij=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function K6(A,j,n){var t=j+n,r=j;while(A[r]&&!(r>=t))++r;if(r-j>16&&A.subarray&&ij)return ij.decode(A.subarray(j,r));else{var E="";while(j<r){var k=A[j++];if(!(k&128)){E+=String.fromCharCode(k);continue}var i=A[j++]&63;if((k&224)==192){E+=String.fromCharCode((k&31)<<6|i);continue}var v=A[j++]&63;if((k&240)==224)k=(k&15)<<12|i<<6|v;else k=(k&7)<<18|i<<12|v<<6|A[j++]&63;if(k<65536)E+=String.fromCharCode(k);else{var c=k-65536;E+=String.fromCharCode(55296|c>>10,56320|c&1023)}}}return E}function R6(A,j){return A?K6(J,A,j):""}function y6(A,j){if(A%j>0)A+=j-A%j;return A}var ZA,$j,J,Fj,Bj,Lj,Pj,Uj,Oj;function Gj(A){ZA=A,q.HEAP8=$j=new Int8Array(A),q.HEAP16=Fj=new Int16Array(A),q.HEAP32=Lj=new Int32Array(A),q.HEAPU8=J=new Uint8Array(A),q.HEAPU16=Bj=new Uint16Array(A),q.HEAPU32=Pj=new Uint32Array(A),q.HEAPF32=Uj=new Float32Array(A),q.HEAPF64=Oj=new Float64Array(A)}var Vn=q.INITIAL_MEMORY||16777216,GA,uj=[],Kj=[],Rj=[],w6=!1;function H6(){if(q.preRun){if(typeof q.preRun=="function")q.preRun=[q.preRun];while(q.preRun.length)N6(q.preRun.shift())}hA(uj)}function x6(){w6=!0,hA(Kj)}function T6(){if(q.postRun){if(typeof q.postRun=="function")q.postRun=[q.postRun];while(q.postRun.length)D6(q.postRun.shift())}hA(Rj)}function N6(A){uj.unshift(A)}function S6(A){Kj.unshift(A)}function D6(A){Rj.unshift(A)}var X=0,YA=null,tA=null;function V6(A){if(X++,q.monitorRunDependencies)q.monitorRunDependencies(X)}function W6(A){if(X--,q.monitorRunDependencies)q.monitorRunDependencies(X);if(X==0){if(YA!==null)clearInterval(YA),YA=null;if(tA){var j=tA;tA=null,j()}}}q.preloadedImages={};q.preloadedAudios={};function EA(A){if(q.onAbort)q.onAbort(A);A+="",d(A),cj=!0,U6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var X6="data:application/octet-stream;base64,";function yj(A){return A.startsWith(X6)}function wj(A){return A.startsWith("file://")}var U="argon2.wasm";if(!yj(U))U=L6(U);function vj(A){try{if(A==U&&rA)return new Uint8Array(rA);if(nA)return nA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){EA(j)}}function J6(){if(!rA&&(KA||W)){if(typeof fetch==="function"&&!wj(U))return fetch(U,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+U+"'";return A.arrayBuffer()}).catch(function(){return vj(U)});else if(CA)return new Promise(function(A,j){CA(U,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return vj(U)})}function o6(){var A={a:Q6};function j(k,i){var v=k.exports;q.asm=v,qA=q.asm.c,Gj(qA.buffer),GA=q.asm.k,S6(q.asm.d),W6("wasm-instantiate")}V6("wasm-instantiate");function n(k){j(k.instance)}function t(k){return J6().then(function(i){var v=WebAssembly.instantiate(i,A);return v}).then(k,function(i){d("failed to asynchronously prepare wasm: "+i),EA(i)})}function r(){if(!rA&&typeof WebAssembly.instantiateStreaming==="function"&&!yj(U)&&!wj(U)&&typeof fetch==="function")return fetch(U,{credentials:"same-origin"}).then(function(k){var i=WebAssembly.instantiateStreaming(k,A);return i.then(n,function(v){return d("wasm streaming compile failed: "+v),d("falling back to ArrayBuffer instantiation"),t(n)})});else return t(n)}if(q.instantiateWasm)try{var E=q.instantiateWasm(A,j);return E}catch(k){return d("Module.instantiateWasm callback failed with error: "+k),!1}return r(),{}}function hA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(q);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)GA.get(n)();else GA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function Y6(A,j,n){J.copyWithin(A,j,j+n)}function z6(A){try{return qA.grow(A-ZA.byteLength+65535>>>16),Gj(qA.buffer),1}catch(j){}}function C6(A){var j=J.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var t=1;t<=4;t*=2){var r=j*(1+0.2/t);r=Math.min(r,A+100663296);var E=Math.min(n,y6(Math.max(A,r),65536)),k=z6(E);if(k)return!0}return!1}var Q6={a:Y6,b:C6},Z6=o6(),h6=q.___wasm_call_ctors=function(){return(h6=q.___wasm_call_ctors=q.asm.d).apply(null,arguments)},M6=q._argon2_hash=function(){return(M6=q._argon2_hash=q.asm.e).apply(null,arguments)},Hj=q._malloc=function(){return(Hj=q._malloc=q.asm.f).apply(null,arguments)},g6=q._free=function(){return(g6=q._free=q.asm.g).apply(null,arguments)},m6=q._argon2_verify=function(){return(m6=q._argon2_verify=q.asm.h).apply(null,arguments)},e6=q._argon2_error_message=function(){return(e6=q._argon2_error_message=q.asm.i).apply(null,arguments)},b6=q._argon2_encodedlen=function(){return(b6=q._argon2_encodedlen=q.asm.j).apply(null,arguments)},l6=q._argon2_hash_ext=function(){return(l6=q._argon2_hash_ext=q.asm.l).apply(null,arguments)},s6=q._argon2_verify_ext=function(){return(s6=q._argon2_verify_ext=q.asm.m).apply(null,arguments)},xj=q.stackAlloc=function(){return(xj=q.stackAlloc=q.asm.n).apply(null,arguments)};q.allocate=u6;q.UTF8ToString=R6;q.ALLOC_NORMAL=O6;var uA;function a6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}tA=function A(){if(!uA)MA();if(!uA)tA=A};function MA(A){if(A=A||jA,X>0)return;if(H6(),X>0)return;function j(){if(uA)return;if(uA=!0,q.calledRun=!0,cj)return;if(x6(),q.onRuntimeInitialized)q.onRuntimeInitialized();T6()}if(q.setStatus)q.setStatus("Running..."),setTimeout(function(){setTimeout(function(){q.setStatus("")},1),j()},1);else j()}q.run=MA;if(q.preInit){if(typeof q.preInit=="function")q.preInit=[q.preInit];while(q.preInit.length>0)q.preInit.pop()()}MA();if(typeof o!=="undefined")o.exports=q;q.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(q=B6=qA=GA=Z6=ZA=$j=J=Fj=Bj=Lj=Pj=Uj=Oj=void 0,typeof o!=="undefined")delete o.exports}});var Tj=D((Xn,p6)=>{p6.exports="./cryptit.index.wasm"});var Sj=D((Nj,RA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof RA==="object"&&RA.exports)RA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:Nj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(f){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=r().then((_)=>new Promise((F)=>{_.postRun=()=>F(_)}));else I=E().then((_)=>{let F=f?i(f):void 0;return t(_,F)});return n._promise=I,I.then((_)=>{return n._module=_,delete n._promise,_})}function t(f,I){return new Promise((_)=>{return A.Module={wasmBinary:f,wasmMemory:I,postRun(){_(Module)}},r()})}function r(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(gA())}function E(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(Tj()).then((I)=>{return k(I)})}function k(f){let I=atob(f),_=new Uint8Array(new ArrayBuffer(I.length));for(let F=0;F<I.length;F++)_[F]=I.charCodeAt(F);return _}function i(f){let C=Math.min(Math.max(Math.ceil(f*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:C,maximum:32767})}function v(f,I){return f.allocate(I,"i8",f.ALLOC_NORMAL)}function c(f,I){let _=new Uint8Array([...I,0]);return v(f,_)}function B(f){if(typeof f!=="string")return f;if(typeof TextEncoder==="function")return new TextEncoder().encode(f);else if(typeof Buffer==="function")return Buffer.from(f);else throw new Error("Don't know how to encode UTF8")}function L(f){let I=f.mem||1024;return n(I).then((_)=>{let F=f.time||1,b=f.parallelism||1,l=B(f.pass),C=c(_,l),DA=l.length,IA=B(f.salt),cA=c(_,IA),s=IA.length,Q=f.type||j.Argon2d,K=_.allocate(new Array(f.hashLen||24),"i8",_.ALLOC_NORMAL),w=f.secret?v(_,f.secret):0,a=f.secret?f.secret.byteLength:0,O=f.ad?v(_,f.ad):0,i6=f.ad?f.ad.byteLength:0,$A=f.hashLen||24,nj=_._argon2_encodedlen(F,I,b,s,$A,Q),VA=_.allocate(new Array(nj+1),"i8",_.ALLOC_NORMAL),Rn=19,Z,FA;try{FA=_._argon2_hash_ext(F,I,b,C,DA,cA,s,K,$A,VA,nj,Q,w,a,O,i6,19)}catch(h){Z=h}let BA;if(FA===0&&!Z){let h="",tj=new Uint8Array($A);for(let LA=0;LA<$A;LA++){let rj=_.HEAP8[K+LA];tj[LA]=rj,h+=("0"+(255&rj).toString(16)).slice(-2)}let v6=_.UTF8ToString(VA);BA={hash:tj,hashHex:h,encoded:v6}}else{try{if(!Z)Z=_.UTF8ToString(_._argon2_error_message(FA))}catch(h){}BA={message:Z,code:FA}}try{if(_._free(C),_._free(cA),_._free(K),_._free(VA),O)_._free(O);if(w)_._free(w)}catch(h){}if(Z)throw BA;else return BA})}function $(f){return n().then((I)=>{let _=B(f.pass),F=c(I,_),b=_.length,l=f.secret?v(I,f.secret):0,C=f.secret?f.secret.byteLength:0,DA=f.ad?v(I,f.ad):0,IA=f.ad?f.ad.byteLength:0,cA=B(f.encoded),s=c(I,cA),Q=f.type;if(Q===void 0){let O=f.encoded.split("$")[1];if(O)O=O.replace("a","A"),Q=j[O]||j.Argon2d}let K,w;try{w=I._argon2_verify_ext(s,F,b,l,C,DA,IA,Q)}catch(O){K=O}let a;if(w||K){try{if(!K)K=I.UTF8ToString(I._argon2_error_message(w))}catch(O){}a={message:K,code:w}}try{I._free(F),I._free(s)}catch(O){}if(K)throw a;else return a})}function S(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:L,verify:$,unloadRuntime:S}})});var Xj=D((Jn,Wj)=>{var yA=/^[a-z0-9-]{1,32}$/,wA=/^[a-z0-9-]{1,32}$/,HA=/^[a-zA-Z0-9/+.-]+$/,Dj=/^([a-zA-Z0-9/+.-]+|)$/,d6=/^((-)?[1-9]\d*|0)$/,mA=/^v=(\d+)$/;function An(A){return kA(A).map((j)=>[j,A[j]].join("=")).join(",")}function jn(A){let j={};return A.split(",").forEach((n)=>{let t=n.split("=");if(t.length<2)throw new TypeError("params must be in the format name=value");j[t.shift()]=t.join("=")}),j}function kA(A){return Object.keys(A)}function Vj(A){if(typeof Object.values==="function")return Object.values(A);return kA(A).map((j)=>A[j])}function nn(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!yA.test(A.id))throw new TypeError(`id must satisfy ${yA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let t=kA(A.params);if(!t.every((k)=>wA.test(k)))throw new TypeError(`params names must satisfy ${wA}`);t.forEach((k)=>{if(typeof A.params[k]==="number")A.params[k]=A.params[k].toString();else if(Buffer.isBuffer(A.params[k]))A.params[k]=A.params[k].toString("base64").split("=")[0]});let r=Vj(A.params);if(!r.every((k)=>typeof k==="string"))throw new TypeError("params values must be strings");if(!r.every((k)=>HA.test(k)))throw new TypeError(`params values must satisfy ${HA}`);let E=An(A.params);j.push(E)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function tn(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!mA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let t=j.shift();if(!yA.test(t))throw new TypeError(`id must satisfy ${yA}`);let r;if(mA.test(j[0]))r=parseInt(j.shift().match(mA)[1],10);let E,k;if(Dj.test(j[j.length-1]))if(j.length>1&&Dj.test(j[j.length-2]))E=Buffer.from(j.pop(),"base64"),k=Buffer.from(j.pop(),"base64");else k=Buffer.from(j.pop(),"base64");let i;if(j.length>0){let c=j.pop();if(i=jn(c),!kA(i).every(($)=>wA.test($)))throw new TypeError(`params names must satisfy ${wA}`);if(!Vj(i).every(($)=>HA.test($)))throw new TypeError(`params values must satisfy ${HA}`);kA(i).forEach(($)=>{i[$]=d6.test(i[$])?parseInt(i[$],10):i[$]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let v={id:t};if(r)v.version=r;if(i)v.params=i;if(k)v.salt=k;if(E)v.hash=E;return v}Wj.exports={serialize:nn,deserialize:tn}});var aj=D((on,sj)=>{var zj=require("fs"),y=require("path"),Cj=require("os"),Qj=typeof __webpack_require__==="function"?__non_webpack_require__:require,rn=process.config&&process.config.variables||{},qn=!!process.env.PREBUILDS_ONLY,Jj=process.versions.modules,eA=fn()?"electron":kn()?"node-webkit":"node",bA=process.env.npm_config_arch||Cj.arch(),lA=process.env.npm_config_platform||Cj.platform(),Zj=process.env.LIBC||(vn(lA)?"musl":"glibc"),sA=process.env.ARM_VERSION||(bA==="arm64"?"8":rn.arm_version)||"",hj=(process.versions.uv||"").split(".")[0];sj.exports=R;function R(A){return Qj(R.resolve(A))}R.resolve=R.path=function(A){A=y.resolve(A||".");try{var j=Qj(y.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(v){}if(!qn){var n=oj(y.join(A,"build/Release"),Yj);if(n)return n;var t=oj(y.join(A,"build/Debug"),Yj);if(t)return t}var r=i(A);if(r)return r;var E=i(y.dirname(process.execPath));if(E)return E;var k=["platform="+lA,"arch="+bA,"runtime="+eA,"abi="+Jj,"uv="+hj,sA?"armv="+sA:"","libc="+Zj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+k+`
    loaded from: `+A+`
`);function i(v){var c=aA(y.join(v,"prebuilds")).map(Mj),B=c.filter(gj(lA,bA)).sort(mj)[0];if(!B)return;var L=y.join(v,"prebuilds",B.name),$=aA(L).map(ej),S=$.filter(bj(eA,Jj)),f=S.sort(lj(eA))[0];if(f)return y.join(L,f.file)}};function aA(A){try{return zj.readdirSync(A)}catch(j){return[]}}function oj(A,j){var n=aA(A).filter(j);return n[0]&&y.join(A,n[0])}function Yj(A){return/\.node$/.test(A)}function Mj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],t=j[1].split("+");if(!n)return;if(!t.length)return;if(!t.every(Boolean))return;return{name:A,platform:n,architectures:t}}function gj(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function mj(A,j){return A.architectures.length-j.architectures.length}function ej(A){var j=A.split("."),n=j.pop(),t={file:A,specificity:0};if(n!=="node")return;for(var r=0;r<j.length;r++){var E=j[r];if(E==="node"||E==="electron"||E==="node-webkit")t.runtime=E;else if(E==="napi")t.napi=!0;else if(E.slice(0,3)==="abi")t.abi=E.slice(3);else if(E.slice(0,2)==="uv")t.uv=E.slice(2);else if(E.slice(0,4)==="armv")t.armv=E.slice(4);else if(E==="glibc"||E==="musl")t.libc=E;else continue;t.specificity++}return t}function bj(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!En(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==hj)return!1;if(n.armv&&n.armv!==sA)return!1;if(n.libc&&n.libc!==Zj)return!1;return!0}}function En(A){return A.runtime==="node"&&A.napi}function lj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function kn(){return!!(process.versions&&process.versions.nw)}function fn(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function vn(A){return A==="linux"&&zj.existsSync("/etc/alpine-release")}R.parseTags=ej;R.matchTags=bj;R.compareTags=lj;R.parseTuple=Mj;R.matchTuple=gj;R.compareTuples=mj});var pj=D((Yn,dA)=>{var pA=typeof __webpack_require__==="function"?__non_webpack_require__:require;if(typeof pA.addon==="function")dA.exports=pA.addon.bind(pA);else dA.exports=aj()});var n6=D((Cn,Y)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",zn=require("node:assert"),{randomBytes:_n,timingSafeEqual:In}=require("node:crypto"),{promisify:cn}=require("node:util"),{deserialize:dj,serialize:$n}=Xj(),Fn=pj(),{hash:A6}=Fn(__dirname),Bn=cn(_n);Y.exports.argon2d=0;Y.exports.argon2i=1;Y.exports.argon2id=2;var fA=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),Ln=Object.freeze({[fA.argon2d]:"argon2d",[fA.argon2i]:"argon2i",[fA.argon2id]:"argon2id"}),j6={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function Pn(A,j){let{raw:n,salt:t,...r}={...j6,...j};if(r.hashLength>4294967295)throw new RangeError("Hash length is too large");if(r.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(r.timeCost>4294967295)throw new RangeError("Time cost is too large");if(r.parallelism>16777215)throw new RangeError("Parallelism is too large");t=t??await Bn(16);let{hashLength:E,secret:k=Buffer.alloc(0),type:i,version:v,memoryCost:c,timeCost:B,parallelism:L,associatedData:$=Buffer.alloc(0)}=r,S=await A6({password:Buffer.from(A),salt:t,secret:k,data:$,hashLength:E,m:c,t:B,p:L,version:v,type:i});if(n)return S;return $n({id:Ln[i],version:v,params:{m:c,t:B,p:L,...$.byteLength>0?{data:$}:{}},salt:t,hash:S})}Y.exports.hash=Pn;function Un(A,j={}){let{memoryCost:n,timeCost:t,parallelism:r,version:E}={...j6,...j},{version:k,params:{m:i,t:v,p:c}}=dj(A);return+k!==+E||+i!==+n||+v!==+t||+c!==+r}Y.exports.needsRehash=Un;async function On(A,j,n={}){let{id:t,...r}=dj(A);if(!(t in fA))return!1;let{version:E=16,params:{m:k,t:i,p:v,data:c=""},salt:B,hash:L}=r,{secret:$=Buffer.alloc(0)}=n;return In(await A6({password:Buffer.from(j),salt:B,secret:$,data:Buffer.from(c,"base64"),hashLength:L.byteLength,m:+k,t:+i,p:+v,version:+E,type:fA[t]}),L)}Y.exports.verify=On});var Kn={};F6(Kn,{createCryptit:()=>un});module.exports=$6(Kn);class V extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class H extends V{}class PA extends V{}class M extends V{}class x extends V{}class UA extends V{}class u extends V{}class P{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new PA(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new PA(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class XA{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),t=new Uint8Array(j.length+n.length);return t.set(j),t.set(n,j.length),t}async decryptChunk(A){let j=A.slice(0,12),n=A.slice(12),t=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);try{let r=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(r)}catch{throw new u("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var xA=WA(Sj());async function t6(A,j,n,t){if(t==="node"){let r=await Promise.resolve().then(() => WA(n6())),E=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),k=Buffer.from(j),i=await r.hash(E,{salt:k,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:r.argon2id});return{hash:new Uint8Array(i)}}if(t==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>{let r=new URL("argon2.wasm",import.meta.url).href;return fetch(r).then((E)=>{if(!E.ok)throw new Error("Failed to load argon2.wasm");return E.arrayBuffer()}).then((E)=>new Uint8Array(E))};return xA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:xA.ArgonType.Argon2id}).then((r)=>{if(!r||!r.hash)throw new Error("Failed to produce key derivation");return{hash:r.hash}}).catch((r)=>{let E=r instanceof Error?r.message:typeof r==="string"?r:"Unknown error";throw new x(`argon2-browser failure: ${E}`)})}throw new Error(`Unsupported environment: ${t}`)}class Aj{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,n,t){let{hash:r}=await t6(A,j,this.presets[n],t.isNode?"node":"browser");return t.subtle.importKey("raw",r,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var r6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},Gn={id:0,cipher:XA,kdf:new Aj(r6),saltLengths:{low:12,high:16},difficulties:r6,defaultChunkSize:524288};P.register(Gn);var TA=1;function q6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function iA(...A){let j=A.reduce((r,E)=>r+E.byteLength,0),n=new Uint8Array(j),t=0;for(let r of A)n.set(r,t),t+=r.byteLength;return n}function vA(...A){let j=iA(...A);if(q6())return Buffer.from(j).toString("base64");let n="";for(let t=0;t<j.length;t++)n+=String.fromCharCode(j[t]);return btoa(n)}function jj(A){if(q6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let t=0;t<j.length;t++)n[t]=j.charCodeAt(t);return n}function NA(A,j,n,t){let r={low:0,middle:1,high:2}[j]??0,E=A<<5|(n==="high"?1:0)<<2|r;return iA(new Uint8Array([TA,E]),t)}function z(A){if(A[0]!==TA)throw new H("Invalid input format. The input is unknown.");try{let j=A[1],n=j>>5,t=j>>2&1?"high":"low",r=j&3,E=["low","middle","high"][r],k=P.get(n).saltLengths[t],i=A.slice(2,2+k);return{version:n,difficulty:E,saltStrength:t,salt:i,headerLen:2+k}}catch(j){throw new M(j instanceof Error?j.message:String(j))}}class _A{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(n.length-t>=this.chunkSize){let r=n.slice(t,t+this.chunkSize);t+=this.chunkSize;let E=await this.engine.encryptChunk(r),k=new Uint8Array(4);new DataView(k.buffer).setUint32(0,E.length,!1);let i=new Uint8Array(4+E.length);i.set(k),i.set(E,k.length),j.enqueue(i)}this.buffer=n.slice(t)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let t=new Uint8Array(4+j.length);t.set(n),t.set(j,4),A.enqueue(t),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class g{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(!0){if(n.length-t<4)break;let r=new DataView(n.buffer,n.byteOffset+t,4).getUint32(0,!1);if(n.length-t-4<r)break;t+=4;let E=n.slice(t,t+r);t+=r;try{let k=await this.engine.decryptChunk(E);j.enqueue(k)}catch(k){throw k instanceof u?k:new u("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(t)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class m{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new _A(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(r,E){if(j===0){E.enqueue(r);return}if(r.byteLength<=j){j-=r.byteLength;return}E.enqueue(r.slice(j)),j=0}}),t=new g(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(t)}}async collect(A,j,n=null){let t=A.pipeThrough(j).getReader(),r=[];if(n?.length)r.push(n);while(!0){let{value:v,done:c}=await t.read();if(c)break;r.push(v)}let E=r.reduce((v,c)=>v+c.byteLength,0),k=new Uint8Array(E),i=0;for(let v of r)k.set(v,i),i+=v.byteLength;return k}}function E6(A=0,j=console.info){return{level:A,log(n,t){if(n<=A)j(`${n}| ${t}`)}}}var k6=new Map;class N{static getEngine(A,j){let n=k6.get(j);if(n)return n;let t=P.get(j),r=new t.cipher(A),E=t.kdf,k=t.defaultChunkSize;return n={desc:t,cipher:r,kdf:E,chunkSize:k,provider:A},k6.set(j,n),n}static async deriveKey(A,j,n,t){try{let r=await A.kdf.derive(j,n,t,A.provider);A.cipher.key=r}catch(r){let E=r instanceof Error?r.message:String(r);throw new x(E)}}}class e{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=P.get(j.version??P.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new m(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=E6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await e.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await e.peekHeader(A),n=z(j);return{version:n.version,difficulty:n.difficulty,salt:vA(n.salt),saltLength:n.salt.byteLength}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setVersion(A){this.v=P.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new m(this.cipher,this.chunkSize)}getVersion(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){this.chunkSize=A,this.stream=new m(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){try{this.log.log(1,"Start text encryption"),this.log.log(2,"Deriving key for text encryption");let n=this.genSalt();await this.deriveKey(j,n),this.log.log(3,`Salt generated: ${vA(n)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let t=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.log.log(3,"Encoding header");let r=NA(this.v.id,this.difficulty,this.saltStrength,n);return this.log.log(3,"Encoding text"),vA(r,t)}catch(n){throw new UA(n instanceof Error?n.message:String(n))}}async decryptText(A,j){try{this.log.log(1,"Start text decryption");let n=jj(A);this.log.log(3,"Start header decoding");let t=z(n);this.log.log(3,"Trying to get engine");let r=N.getEngine(this.provider,t.version);this.log.log(2,"Deriving key via engine for text decryption"),this.log.log(3,`Salt use: ${vA(t.salt)}, KDF difficulty: ${t.difficulty}`),await N.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting text data");let E=await r.cipher.decryptChunk(n.slice(t.headerLen));return this.log.log(3,"Decoding text"),new TextDecoder().decode(E)}catch(n){if(n instanceof u||n instanceof H||n instanceof M||n instanceof x)throw n;throw new u("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){try{this.log.log(2,"Deriving key for file encryption");let n=this.genSalt();await this.deriveKey(j,n);let t=NA(this.v.id,this.difficulty,this.saltStrength,n),r=await this.stream.collect(A.stream(),new _A(this.cipher,this.chunkSize).toTransformStream(),t);return new Blob([r],{type:"application/octet-stream"})}catch(n){throw new UA(n instanceof Error?n.message:String(n))}}async decryptFile(A,j){try{let n=await e.peekHeader(A),t=z(n),r=N.getEngine(this.provider,t.version);await N.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting file data");let k=await new m(r.cipher,r.chunkSize).collect(A.slice(t.headerLen).stream(),new g(r.cipher,r.chunkSize).toTransformStream());return new Blob([k],{type:"application/octet-stream"})}catch(n){if(n instanceof u)throw n;throw new u(n instanceof Error?n.message:String(n))}}async createEncryptionStream(A){this.log.log(2,"Deriving key for stream encryption");let j=this.genSalt();await this.deriveKey(A,j);let n=NA(this.v.id,this.difficulty,this.saltStrength,j),t=this.stream.encryptionStream();return{header:n,writable:t.writable,readable:t.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),t=null;async function r(E,k){let i=E.getReader();while(!0){let{value:v,done:c}=await i.read();if(c)break;k.enqueue(v)}}return new TransformStream({async transform(E,k){if(!t){if(n=iA(n,E),n.length<2)return;let v=n.slice(0,30),{salt:c,difficulty:B}=z(v),L=n[1]>>5,$=n[1]>>2&1?"high":"low",f=2+P.get(L).saltLengths[$];if(n.length<f)return;let I=N.getEngine(j.provider,L);await N.deriveKey(I,A,c,B),t=new g(I.cipher,I.chunkSize).toTransformStream(),r(t.readable,k);let _=n.slice(f);if(_.length){let F=t.writable.getWriter();await F.write(_),F.releaseLock()}return}let i=t.writable.getWriter();await i.write(E),i.releaseLock()},async flush(){if(t){let E=t.writable.getWriter();await E.close(),E.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let t=performance.now();try{let r=await this.kdf.derive(A,j,n,this.provider);this.cipher.key=r,this.log.log(3,`Key derivation completed in ${(performance.now()-t).toFixed(1)} ms`)}catch(r){throw new x(r instanceof Error?r.message:String(r))}}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}static async peekHeader(A){if(typeof A==="string")return jj(A);if(A instanceof Uint8Array){if(A.length<2)throw new H("Input too short");let{headerLen:j}=z(A.length>=16?A:Uint8Array.from(A));if(A.length<j)throw new H("Incomplete header");return A.slice(0,j)}if(A instanceof Blob){let j=new Uint8Array(await A.slice(0,2).arrayBuffer());if(j[0]!==1)throw new H("Bad magic byte");let n=j[1],t=n>>5,r=n>>2&1?"high":"low",E=P.get(t).saltLengths[r],k=new Uint8Array(await A.slice(0,2+E).arrayBuffer());return z(k),k}throw new M("Unsupported input type")}}var SA=require("node:crypto"),f6={subtle:SA.webcrypto.subtle,getRandomValues(A){return SA.randomFillSync(A),A},isNode:!0};function un(A){return new e(f6,A)}

//# debugId=33C7747D31206AA764756E2164756E21
