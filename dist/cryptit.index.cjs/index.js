var pj=Object.create;var{getPrototypeOf:sj,defineProperty:o,getOwnPropertyNames:eA,getOwnPropertyDescriptor:dj}=Object,lA=Object.prototype.hasOwnProperty;var KA=(A,j,n)=>{n=A!=null?pj(sj(A)):{};let E=j||!A||!A.__esModule?o(n,"default",{value:A,enumerable:!0}):n;for(let q of eA(A))if(!lA.call(E,q))o(E,q,{get:()=>A[q],enumerable:!0});return E},bA=new WeakMap,aj=(A)=>{var j=bA.get(A),n;if(j)return j;if(j=o({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")eA(A).map((E)=>!lA.call(j,E)&&o(j,E,{get:()=>A[E],enumerable:!(n=dj(A,E))||n.enumerable}));return bA.set(A,j),j},x=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var A6=(A,j)=>{for(var n in j)o(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(E)=>j[n]=()=>E})};var cA=x(($n,c)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",t=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},j6=t,h={},D;for(D in t)if(t.hasOwnProperty(D))h[D]=t[D];var m=[],aA="./this.program",SA=function(A,j){throw j},vA=!1,T=!1,xA=!1,Aj=!1;vA=typeof window==="object";T=typeof importScripts==="function";xA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";Aj=!vA&&!xA&&!T;var G="";function n6(A){if(t.locateFile)return t.locateFile(A,G);return G+A}var kA,DA,b,E6,PA,NA;if(xA){if(T)G=require("path").dirname(G)+"/";else G=__dirname+"/";if(kA=function A(j,n){if(!PA)PA=require("fs");if(!NA)NA=require("path");return j=NA.normalize(j),PA.readFileSync(j,n?null:"utf8")},b=function A(j){var n=kA(j,!0);if(!n.buffer)n=new Uint8Array(n);return pA(n.buffer),n},process.argv.length>1)aA=process.argv[1].replace(/\\/g,"/");if(m=process.argv.slice(2),typeof c!=="undefined")c.exports=t;process.on("uncaughtException",function(A){if(!(A instanceof J6))throw A}),process.on("unhandledRejection",s),SA=function(A){process.exit(A)},t.inspect=function(){return"[Emscripten Module object]"}}else if(Aj){if(typeof read!="undefined")kA=function A(j){return read(j)};if(b=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),pA(typeof n==="object"),n},typeof scriptArgs!="undefined")m=scriptArgs;else if(typeof arguments!="undefined")m=arguments;if(typeof quit==="function")SA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(vA||T){if(T)G=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)G=document.currentScript.src;if(G.indexOf("blob:")!==0)G=G.substr(0,G.lastIndexOf("/")+1);else G="";{if(kA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},T)b=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};DA=function(A,j,n){var E=new XMLHttpRequest;E.open("GET",A,!0),E.responseType="arraybuffer",E.onload=function(){if(E.status==200||E.status==0&&E.response){j(E.response);return}n()},E.onerror=n,E.send(null)}}E6=function(A){document.title=A}}var vn=t.print||console.log.bind(console),g=t.printErr||console.warn.bind(console);for(D in h)if(h.hasOwnProperty(D))t[D]=h[D];h=null;if(t.arguments)m=t.arguments;if(t.thisProgram)aA=t.thisProgram;if(t.quit)SA=t.quit;var l;if(t.wasmBinary)l=t.wasmBinary;var _n=t.noExitRuntime||!0;if(typeof WebAssembly!=="object")s("no native wasm support detected");var p,jj=!1,t6;function pA(A,j){if(!A)s("Assertion failed: "+j)}var q6=0,r6=1;function k6(A,j){var n;if(j==r6)n=Lj(A.length);else n=Bj(A.length);if(A.subarray||A.slice)y.set(A,n);else y.set(new Uint8Array(A),n);return n}var sA=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function i6(A,j,n){var E=j+n,q=j;while(A[q]&&!(q>=E))++q;if(q-j>16&&A.subarray&&sA)return sA.decode(A.subarray(j,q));else{var k="";while(j<q){var r=A[j++];if(!(r&128)){k+=String.fromCharCode(r);continue}var f=A[j++]&63;if((r&224)==192){k+=String.fromCharCode((r&31)<<6|f);continue}var v=A[j++]&63;if((r&240)==224)r=(r&15)<<12|f<<6|v;else r=(r&7)<<18|f<<12|v<<6|A[j++]&63;if(r<65536)k+=String.fromCharCode(r);else{var $=r-65536;k+=String.fromCharCode(55296|$>>10,56320|$&1023)}}}return k}function f6(A,j){return A?i6(y,A,j):""}function v6(A,j){if(A%j>0)A+=j-A%j;return A}var TA,nj,y,Ej,tj,qj,rj,kj,ij;function fj(A){TA=A,t.HEAP8=nj=new Int8Array(A),t.HEAP16=Ej=new Int16Array(A),t.HEAP32=qj=new Int32Array(A),t.HEAPU8=y=new Uint8Array(A),t.HEAPU16=tj=new Uint16Array(A),t.HEAPU32=rj=new Uint32Array(A),t.HEAPF32=kj=new Float32Array(A),t.HEAPF64=ij=new Float64Array(A)}var In=t.INITIAL_MEMORY||16777216,iA,vj=[],_j=[],Ij=[],_6=!1;function I6(){if(t.preRun){if(typeof t.preRun=="function")t.preRun=[t.preRun];while(t.preRun.length)B6(t.preRun.shift())}wA(vj)}function $6(){_6=!0,wA(_j)}function F6(){if(t.postRun){if(typeof t.postRun=="function")t.postRun=[t.postRun];while(t.postRun.length)R6(t.postRun.shift())}wA(Ij)}function B6(A){vj.unshift(A)}function L6(A){_j.unshift(A)}function R6(A){Ij.unshift(A)}var w=0,UA=null,e=null;function u6(A){if(w++,t.monitorRunDependencies)t.monitorRunDependencies(w)}function O6(A){if(w--,t.monitorRunDependencies)t.monitorRunDependencies(w);if(w==0){if(UA!==null)clearInterval(UA),UA=null;if(e){var j=e;e=null,j()}}}t.preloadedImages={};t.preloadedAudios={};function s(A){if(t.onAbort)t.onAbort(A);A+="",g(A),jj=!0,t6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var G6="data:application/octet-stream;base64,";function $j(A){return A.startsWith(G6)}function Fj(A){return A.startsWith("file://")}var u="argon2.wasm";if(!$j(u))u=n6(u);function dA(A){try{if(A==u&&l)return new Uint8Array(l);if(b)return b(A);else throw"both async and sync fetching of the wasm failed"}catch(j){s(j)}}function H6(){if(!l&&(vA||T)){if(typeof fetch==="function"&&!Fj(u))return fetch(u,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+u+"'";return A.arrayBuffer()}).catch(function(){return dA(u)});else if(DA)return new Promise(function(A,j){DA(u,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return dA(u)})}function K6(){var A={a:S6};function j(r,f){var v=r.exports;t.asm=v,p=t.asm.c,fj(p.buffer),iA=t.asm.k,L6(t.asm.d),O6("wasm-instantiate")}u6("wasm-instantiate");function n(r){j(r.instance)}function E(r){return H6().then(function(f){var v=WebAssembly.instantiate(f,A);return v}).then(r,function(f){g("failed to asynchronously prepare wasm: "+f),s(f)})}function q(){if(!l&&typeof WebAssembly.instantiateStreaming==="function"&&!$j(u)&&!Fj(u)&&typeof fetch==="function")return fetch(u,{credentials:"same-origin"}).then(function(r){var f=WebAssembly.instantiateStreaming(r,A);return f.then(n,function(v){return g("wasm streaming compile failed: "+v),g("falling back to ArrayBuffer instantiation"),E(n)})});else return E(n)}if(t.instantiateWasm)try{var k=t.instantiateWasm(A,j);return k}catch(r){return g("Module.instantiateWasm callback failed with error: "+r),!1}return q(),{}}function wA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(t);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)iA.get(n)();else iA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function P6(A,j,n){y.copyWithin(A,j,j+n)}function N6(A){try{return p.grow(A-TA.byteLength+65535>>>16),fj(p.buffer),1}catch(j){}}function U6(A){var j=y.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var E=1;E<=4;E*=2){var q=j*(1+0.2/E);q=Math.min(q,A+100663296);var k=Math.min(n,v6(Math.max(A,q),65536)),r=N6(k);if(r)return!0}return!1}var S6={a:P6,b:U6},D6=K6(),x6=t.___wasm_call_ctors=function(){return(x6=t.___wasm_call_ctors=t.asm.d).apply(null,arguments)},T6=t._argon2_hash=function(){return(T6=t._argon2_hash=t.asm.e).apply(null,arguments)},Bj=t._malloc=function(){return(Bj=t._malloc=t.asm.f).apply(null,arguments)},w6=t._free=function(){return(w6=t._free=t.asm.g).apply(null,arguments)},y6=t._argon2_verify=function(){return(y6=t._argon2_verify=t.asm.h).apply(null,arguments)},c6=t._argon2_error_message=function(){return(c6=t._argon2_error_message=t.asm.i).apply(null,arguments)},C6=t._argon2_encodedlen=function(){return(C6=t._argon2_encodedlen=t.asm.j).apply(null,arguments)},W6=t._argon2_hash_ext=function(){return(W6=t._argon2_hash_ext=t.asm.l).apply(null,arguments)},X6=t._argon2_verify_ext=function(){return(X6=t._argon2_verify_ext=t.asm.m).apply(null,arguments)},Lj=t.stackAlloc=function(){return(Lj=t.stackAlloc=t.asm.n).apply(null,arguments)};t.allocate=k6;t.UTF8ToString=f6;t.ALLOC_NORMAL=q6;var fA;function J6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}e=function A(){if(!fA)yA();if(!fA)e=A};function yA(A){if(A=A||m,w>0)return;if(I6(),w>0)return;function j(){if(fA)return;if(fA=!0,t.calledRun=!0,jj)return;if($6(),t.onRuntimeInitialized)t.onRuntimeInitialized();F6()}if(t.setStatus)t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),j()},1);else j()}t.run=yA;if(t.preInit){if(typeof t.preInit=="function")t.preInit=[t.preInit];while(t.preInit.length>0)t.preInit.pop()()}yA();if(typeof c!=="undefined")c.exports=t;t.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(t=j6=p=iA=D6=TA=nj=y=Ej=tj=qj=rj=kj=ij=void 0,typeof c!=="undefined")delete c.exports}});var Rj=x((Fn,V6)=>{V6.exports="./cryptit.index.wasm"});var Oj=x((uj,_A)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof _A==="object"&&_A.exports)_A.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:uj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(i){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=q().then((_)=>new Promise((L)=>{_.postRun=()=>L(_)}));else I=k().then((_)=>{let L=i?f(i):void 0;return E(_,L)});return n._promise=I,I.then((_)=>{return n._module=_,delete n._promise,_})}function E(i,I){return new Promise((_)=>{return A.Module={wasmBinary:i,wasmMemory:I,postRun(){_(Module)}},q()})}function q(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(cA())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(Rj()).then((I)=>{return r(I)})}function r(i){let I=atob(i),_=new Uint8Array(new ArrayBuffer(I.length));for(let L=0;L<I.length;L++)_[L]=I.charCodeAt(L);return _}function f(i){let W=Math.min(Math.max(Math.ceil(i*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:W,maximum:32767})}function v(i,I){return i.allocate(I,"i8",i.ALLOC_NORMAL)}function $(i,I){let _=new Uint8Array([...I,0]);return v(i,_)}function B(i){if(typeof i!=="string")return i;if(typeof TextEncoder==="function")return new TextEncoder().encode(i);else if(typeof Buffer==="function")return Buffer.from(i);else throw new Error("Don't know how to encode UTF8")}function R(i){let I=i.mem||1024;return n(I).then((_)=>{let L=i.time||1,Q=i.parallelism||1,z=B(i.pass),W=$(_,z),GA=z.length,jA=B(i.salt),nA=$(_,jA),Z=jA.length,X=i.type||j.Argon2d,H=_.allocate(new Array(i.hashLen||24),"i8",_.ALLOC_NORMAL),S=i.secret?v(_,i.secret):0,M=i.secret?i.secret.byteLength:0,O=i.ad?v(_,i.ad):0,ej=i.ad?i.ad.byteLength:0,EA=i.hashLen||24,gA=_._argon2_encodedlen(L,I,Q,Z,EA,X),HA=_.allocate(new Array(gA+1),"i8",_.ALLOC_NORMAL),kn=19,J,tA;try{tA=_._argon2_hash_ext(L,I,Q,W,GA,nA,Z,H,EA,HA,gA,X,S,M,O,ej,19)}catch(V){J=V}let qA;if(tA===0&&!J){let V="",hA=new Uint8Array(EA);for(let rA=0;rA<EA;rA++){let mA=_.HEAP8[H+rA];hA[rA]=mA,V+=("0"+(255&mA).toString(16)).slice(-2)}let lj=_.UTF8ToString(HA);qA={hash:hA,hashHex:V,encoded:lj}}else{try{if(!J)J=_.UTF8ToString(_._argon2_error_message(tA))}catch(V){}qA={message:J,code:tA}}try{if(_._free(W),_._free(nA),_._free(H),_._free(HA),O)_._free(O);if(S)_._free(S)}catch(V){}if(J)throw qA;else return qA})}function F(i){return n().then((I)=>{let _=B(i.pass),L=$(I,_),Q=_.length,z=i.secret?v(I,i.secret):0,W=i.secret?i.secret.byteLength:0,GA=i.ad?v(I,i.ad):0,jA=i.ad?i.ad.byteLength:0,nA=B(i.encoded),Z=$(I,nA),X=i.type;if(X===void 0){let O=i.encoded.split("$")[1];if(O)O=O.replace("a","A"),X=j[O]||j.Argon2d}let H,S;try{S=I._argon2_verify_ext(Z,L,Q,z,W,GA,jA,X)}catch(O){H=O}let M;if(S||H){try{if(!H)H=I.UTF8ToString(I._argon2_error_message(S))}catch(O){}M={message:H,code:S}}try{I._free(L),I._free(Z)}catch(O){}if(H)throw M;else return M})}function U(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:R,verify:F,unloadRuntime:U}})});var Pj=x((Bn,Kj)=>{var IA=/^[a-z0-9-]{1,32}$/,$A=/^[a-z0-9-]{1,32}$/,FA=/^[a-zA-Z0-9/+.-]+$/,Gj=/^([a-zA-Z0-9/+.-]+|)$/,Y6=/^((-)?[1-9]\d*|0)$/,CA=/^v=(\d+)$/;function Q6(A){return d(A).map((j)=>[j,A[j]].join("=")).join(",")}function z6(A){let j={};return A.split(",").forEach((n)=>{let E=n.split("=");if(E.length<2)throw new TypeError("params must be in the format name=value");j[E.shift()]=E.join("=")}),j}function d(A){return Object.keys(A)}function Hj(A){if(typeof Object.values==="function")return Object.values(A);return d(A).map((j)=>A[j])}function Z6(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!IA.test(A.id))throw new TypeError(`id must satisfy ${IA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let E=d(A.params);if(!E.every((r)=>$A.test(r)))throw new TypeError(`params names must satisfy ${$A}`);E.forEach((r)=>{if(typeof A.params[r]==="number")A.params[r]=A.params[r].toString();else if(Buffer.isBuffer(A.params[r]))A.params[r]=A.params[r].toString("base64").split("=")[0]});let q=Hj(A.params);if(!q.every((r)=>typeof r==="string"))throw new TypeError("params values must be strings");if(!q.every((r)=>FA.test(r)))throw new TypeError(`params values must satisfy ${FA}`);let k=Q6(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function M6(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!CA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let E=j.shift();if(!IA.test(E))throw new TypeError(`id must satisfy ${IA}`);let q;if(CA.test(j[0]))q=parseInt(j.shift().match(CA)[1],10);let k,r;if(Gj.test(j[j.length-1]))if(j.length>1&&Gj.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),r=Buffer.from(j.pop(),"base64");else r=Buffer.from(j.pop(),"base64");let f;if(j.length>0){let $=j.pop();if(f=z6($),!d(f).every((F)=>$A.test(F)))throw new TypeError(`params names must satisfy ${$A}`);if(!Hj(f).every((F)=>FA.test(F)))throw new TypeError(`params values must satisfy ${FA}`);d(f).forEach((F)=>{f[F]=Y6.test(f[F])?parseInt(f[F],10):f[F]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let v={id:E};if(q)v.version=q;if(f)v.params=f;if(r)v.salt=r;if(k)v.hash=k;return v}Kj.exports={serialize:Z6,deserialize:M6}});var Qj=x((Ln,Yj)=>{var Dj=require("fs"),P=require("path"),xj=require("os"),Tj=typeof __webpack_require__==="function"?__non_webpack_require__:require,o6=process.config&&process.config.variables||{},g6=!!process.env.PREBUILDS_ONLY,Nj=process.versions.modules,WA=b6()?"electron":m6()?"node-webkit":"node",XA=process.env.npm_config_arch||xj.arch(),JA=process.env.npm_config_platform||xj.platform(),wj=process.env.LIBC||(e6(JA)?"musl":"glibc"),VA=process.env.ARM_VERSION||(XA==="arm64"?"8":o6.arm_version)||"",yj=(process.versions.uv||"").split(".")[0];Yj.exports=K;function K(A){return Tj(K.resolve(A))}K.resolve=K.path=function(A){A=P.resolve(A||".");try{var j=Tj(P.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(v){}if(!g6){var n=Uj(P.join(A,"build/Release"),Sj);if(n)return n;var E=Uj(P.join(A,"build/Debug"),Sj);if(E)return E}var q=f(A);if(q)return q;var k=f(P.dirname(process.execPath));if(k)return k;var r=["platform="+JA,"arch="+XA,"runtime="+WA,"abi="+Nj,"uv="+yj,VA?"armv="+VA:"","libc="+wj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+r+`
    loaded from: `+A+`
`);function f(v){var $=YA(P.join(v,"prebuilds")).map(cj),B=$.filter(Cj(JA,XA)).sort(Wj)[0];if(!B)return;var R=P.join(v,"prebuilds",B.name),F=YA(R).map(Xj),U=F.filter(Jj(WA,Nj)),i=U.sort(Vj(WA))[0];if(i)return P.join(R,i.file)}};function YA(A){try{return Dj.readdirSync(A)}catch(j){return[]}}function Uj(A,j){var n=YA(A).filter(j);return n[0]&&P.join(A,n[0])}function Sj(A){return/\.node$/.test(A)}function cj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],E=j[1].split("+");if(!n)return;if(!E.length)return;if(!E.every(Boolean))return;return{name:A,platform:n,architectures:E}}function Cj(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function Wj(A,j){return A.architectures.length-j.architectures.length}function Xj(A){var j=A.split("."),n=j.pop(),E={file:A,specificity:0};if(n!=="node")return;for(var q=0;q<j.length;q++){var k=j[q];if(k==="node"||k==="electron"||k==="node-webkit")E.runtime=k;else if(k==="napi")E.napi=!0;else if(k.slice(0,3)==="abi")E.abi=k.slice(3);else if(k.slice(0,2)==="uv")E.uv=k.slice(2);else if(k.slice(0,4)==="armv")E.armv=k.slice(4);else if(k==="glibc"||k==="musl")E.libc=k;else continue;E.specificity++}return E}function Jj(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!h6(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==yj)return!1;if(n.armv&&n.armv!==VA)return!1;if(n.libc&&n.libc!==wj)return!1;return!0}}function h6(A){return A.runtime==="node"&&A.napi}function Vj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function m6(){return!!(process.versions&&process.versions.nw)}function b6(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function e6(A){return A==="linux"&&Dj.existsSync("/etc/alpine-release")}K.parseTags=Xj;K.matchTags=Jj;K.compareTags=Vj;K.parseTuple=cj;K.matchTuple=Cj;K.compareTuples=Wj});var zj=x((Rn,zA)=>{var QA=typeof __webpack_require__==="function"?__non_webpack_require__:require;if(typeof QA.addon==="function")zA.exports=QA.addon.bind(QA);else zA.exports=Qj()});var gj=x((On,C)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",un=require("node:assert"),{randomBytes:l6,timingSafeEqual:p6}=require("node:crypto"),{promisify:s6}=require("node:util"),{deserialize:Zj,serialize:d6}=Pj(),a6=zj(),{hash:Mj}=a6(__dirname),An=s6(l6);C.exports.argon2d=0;C.exports.argon2i=1;C.exports.argon2id=2;var a=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),jn=Object.freeze({[a.argon2d]:"argon2d",[a.argon2i]:"argon2i",[a.argon2id]:"argon2id"}),oj={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function nn(A,j){let{raw:n,salt:E,...q}={...oj,...j};if(q.hashLength>4294967295)throw new RangeError("Hash length is too large");if(q.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(q.timeCost>4294967295)throw new RangeError("Time cost is too large");if(q.parallelism>16777215)throw new RangeError("Parallelism is too large");E=E??await An(16);let{hashLength:k,secret:r=Buffer.alloc(0),type:f,version:v,memoryCost:$,timeCost:B,parallelism:R,associatedData:F=Buffer.alloc(0)}=q,U=await Mj({password:Buffer.from(A),salt:E,secret:r,data:F,hashLength:k,m:$,t:B,p:R,version:v,type:f});if(n)return U;return d6({id:jn[f],version:v,params:{m:$,t:B,p:R,...F.byteLength>0?{data:F}:{}},salt:E,hash:U})}C.exports.hash=nn;function En(A,j={}){let{memoryCost:n,timeCost:E,parallelism:q,version:k}={...oj,...j},{version:r,params:{m:f,t:v,p:$}}=Zj(A);return+r!==+k||+f!==+n||+v!==+E||+$!==+q}C.exports.needsRehash=En;async function tn(A,j,n={}){let{id:E,...q}=Zj(A);if(!(E in a))return!1;let{version:k=16,params:{m:r,t:f,p:v,data:$=""},salt:B,hash:R}=q,{secret:F=Buffer.alloc(0)}=n;return p6(await Mj({password:Buffer.from(j),salt:B,secret:F,data:Buffer.from($,"base64"),hashLength:R.byteLength,m:+r,t:+f,p:+v,version:+k,type:a[E]}),R)}C.exports.verify=tn});var rn={};A6(rn,{createCryptit:()=>qn});module.exports=aj(rn);var BA=KA(Oj());async function hj(A,j,n,E){if(E==="node"){let q=await Promise.resolve().then(() => KA(gj())),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),r=Buffer.from(j),f=await q.hash(k,{salt:r,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:q.argon2id});return{hash:new Uint8Array(f)}}if(E==="browser"){let{hash:q}=await BA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:BA.ArgonType.Argon2id});return{hash:q}}throw new Error(`Unsupported environment: ${E}`)}var N={saltLengths:{low:12,high:16},argon:{low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},chunkSize:524288};class ZA{provider;key=null;constructor(A){this.provider=A}async deriveKey(A,j,n){let E=this.provider.isNode?"node":"browser",{hash:q}=await hj(A,j,N.argon[n],E);this.key=await this.provider.subtle.importKey("raw",q,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async encryptChunk(A){if(!this.key)throw new Error("KEY_NOT_DERIVED");let j=this.provider.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.provider.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),E=new Uint8Array(j.length+n.length);return E.set(j),E.set(n,j.length),E}async decryptChunk(A){if(!this.key)throw new Error("KEY_NOT_DERIVED");let j=A.slice(0,12),n=A.slice(12),E=await this.provider.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(E)}}var LA=1,mj=0;function RA(A,j,n){let E=mj<<5|(j==="high"?1:0)<<2|{low:0,middle:1,high:2}[A];return new Uint8Array([LA,E,...n])}function uA(A){if(A[0]!==LA)throw new Error("INVALID_HEADER");let j=A[1],n=j>>5,E=j>>2&1?"high":"low",q=j&3,k=["low","middle","high"][q],r=N.saltLengths[E],f=A.slice(2,2+r);return{version:n,difficulty:k,saltStrength:E,salt:f,headerLen:2+r}}class AA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let E=0;while(n.length-E>=this.chunkSize){let q=n.slice(E,E+this.chunkSize);E+=this.chunkSize;let k=await this.engine.encryptChunk(q),r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,k.length,!1);let f=new Uint8Array(r.length+k.length);f.set(r),f.set(k,r.length),j.enqueue(f)}this.buffer=n.slice(E)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let E=new Uint8Array(4+j.length);E.set(n),E.set(j,4),A.enqueue(E),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class Y{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let E=0;while(!0){if(n.length-E<4)break;let q=new DataView(n.buffer,n.byteOffset+E,4).getUint32(0,!1);if(n.length-E-4<q)break;E+=4;let k=n.slice(E,E+q);E+=q;let r=await this.engine.decryptChunk(k);j.enqueue(r)}this.buffer=n.slice(E)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class MA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new AA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A;console.log(j);let n=new TransformStream({transform(q,k){if(j===0){k.enqueue(q);return}if(q.byteLength<=j){j-=q.byteLength;return}k.enqueue(q.slice(j)),j=0}}),E=new Y(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(E)}}async collect(A,j,n=null){let E=A.pipeThrough(j).getReader(),q=[];if(n?.length)q.push(n);while(!0){let{value:v,done:$}=await E.read();if($)break;q.push(v)}let k=q.reduce((v,$)=>v+$.byteLength,0),r=new Uint8Array(k),f=0;for(let v of q)r.set(v,f),f+=v.byteLength;return r}}class oA{provider;algo;difficulty;saltStrength;chunkSize;streamer;constructor(A,j={}){this.provider=A;this.algo=new ZA(A),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.chunkSize=j.chunkSize??N.chunkSize,this.streamer=new MA(this.algo,this.chunkSize)}async encryptText(A,j){let n=this.genSalt();await this.algo.deriveKey(j,n,this.difficulty);let E=await this.algo.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A),q=RA(this.difficulty,this.saltStrength,n);return Buffer.from([...q,...E]).toString("base64")}async decryptText(A,j){let n=Uint8Array.from(Buffer.from(A,"base64")),{difficulty:E,salt:q,headerLen:k}=uA(n);await this.algo.deriveKey(j,q,E);let r=await this.algo.decryptChunk(n.slice(k));return new TextDecoder().decode(r)}async encryptFile(A,j){let n=this.genSalt();await this.algo.deriveKey(j,n,this.difficulty);let E=RA(this.difficulty,this.saltStrength,n),q=await this.streamer.collect(A.stream(),new AA(this.algo,this.chunkSize).toTransformStream(),E);return new Blob([q],{type:"application/octet-stream"})}async decryptFile(A,j){let E=new Uint8Array(await A.slice(0,2).arrayBuffer())[1]>>2&1?"high":"low",q=2+N.saltLengths[E],k=new Uint8Array(await A.slice(0,q).arrayBuffer()),r=uA(k);await this.algo.deriveKey(j,r.salt,r.difficulty);let f=await this.streamer.collect(A.slice(q).stream(),new Y(this.algo,this.chunkSize).toTransformStream());return new Blob([f],{type:"application/octet-stream"})}async createEncryptionStream(A){let j=this.genSalt();await this.algo.deriveKey(A,j,this.difficulty);let n=RA(this.difficulty,this.saltStrength,j),E=this.streamer.encryptionStream();return{header:n,writable:E.writable,readable:E.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),E=!1,q;async function k(r,f){let v=r.getReader();while(!0){let{value:$,done:B}=await v.read();if(B)break;f.enqueue($)}}return new TransformStream({async transform(r,f){if(!E){if(n=j.concat(n,r),n.length<2)return;let $=n[1]>>2&1?"high":"low",B=2+N.saltLengths[$];if(n.length<B)return;let R=n.slice(0,B),{salt:F,difficulty:U}=uA(R);await j.algo.deriveKey(A,F,U),q=new Y(j.algo,j.chunkSize).toTransformStream(),k(q.readable,f);let i=n.slice(B);if(i.length){let I=q.writable.getWriter();await I.write(i),I.releaseLock()}E=!0;return}let v=q.writable.getWriter();await v.write(r),v.releaseLock()},async flush(){if(E){let r=q.writable.getWriter();await r.close(),r.releaseLock()}}})}concat(A,j){let n=new Uint8Array(A.length+j.length);return n.set(A,0),n.set(j,A.length),n}genSalt(){let A=N.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}}var OA=require("node:crypto"),bj={subtle:OA.webcrypto.subtle,getRandomValues(A){return OA.randomFillSync(A),A},isNode:!0};function qn(A){return new oA(bj,A)}

//# debugId=A41D2C5FF2DB466964756E2164756E21
