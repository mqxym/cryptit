var A6=Object.create;var{getPrototypeOf:j6,defineProperty:h,getOwnPropertyNames:aA,getOwnPropertyDescriptor:n6}=Object,sA=Object.prototype.hasOwnProperty;var OA=(A,j,n)=>{n=A!=null?A6(j6(A)):{};let r=j||!A||!A.__esModule?h(n,"default",{value:A,enumerable:!0}):n;for(let t of aA(A))if(!sA.call(r,t))h(r,t,{get:()=>A[t],enumerable:!0});return r},lA=new WeakMap,r6=(A)=>{var j=lA.get(A),n;if(j)return j;if(j=h({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")aA(A).map((r)=>!sA.call(j,r)&&h(j,r,{get:()=>A[r],enumerable:!(n=n6(A,r))||n.enumerable}));return lA.set(A,j),j},w=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var E6=(A,j)=>{for(var n in j)h(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(r)=>j[n]=()=>r})};var xA=w((Hn,x)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",E=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},t6=E,o={},S;for(S in E)if(E.hasOwnProperty(S))o[S]=E[S];var m=[],jj="./this.program",cA=function(A,j){throw j},_A=!1,y=!1,wA=!1,nj=!1;_A=typeof window==="object";y=typeof importScripts==="function";wA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";nj=!_A&&!wA&&!y;var P="";function q6(A){if(E.locateFile)return E.locateFile(A,P);return P+A}var kA,SA,b,k6,RA,NA;if(wA){if(y)P=require("path").dirname(P)+"/";else P=__dirname+"/";if(kA=function A(j,n){if(!RA)RA=require("fs");if(!NA)NA=require("path");return j=NA.normalize(j),RA.readFileSync(j,n?null:"utf8")},b=function A(j){var n=kA(j,!0);if(!n.buffer)n=new Uint8Array(n);return pA(n.buffer),n},process.argv.length>1)jj=process.argv[1].replace(/\\/g,"/");if(m=process.argv.slice(2),typeof x!=="undefined")x.exports=E;process.on("uncaughtException",function(A){if(!(A instanceof Z6))throw A}),process.on("unhandledRejection",s),cA=function(A){process.exit(A)},E.inspect=function(){return"[Emscripten Module object]"}}else if(nj){if(typeof read!="undefined")kA=function A(j){return read(j)};if(b=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),pA(typeof n==="object"),n},typeof scriptArgs!="undefined")m=scriptArgs;else if(typeof arguments!="undefined")m=arguments;if(typeof quit==="function")cA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(_A||y){if(y)P=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)P=document.currentScript.src;if(P.indexOf("blob:")!==0)P=P.substr(0,P.lastIndexOf("/")+1);else P="";{if(kA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},y)b=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};SA=function(A,j,n){var r=new XMLHttpRequest;r.open("GET",A,!0),r.responseType="arraybuffer",r.onload=function(){if(r.status==200||r.status==0&&r.response){j(r.response);return}n()},r.onerror=n,r.send(null)}}k6=function(A){document.title=A}}var Ln=E.print||console.log.bind(console),g=E.printErr||console.warn.bind(console);for(S in o)if(o.hasOwnProperty(S))E[S]=o[S];o=null;if(E.arguments)m=E.arguments;if(E.thisProgram)jj=E.thisProgram;if(E.quit)cA=E.quit;var l;if(E.wasmBinary)l=E.wasmBinary;var Un=E.noExitRuntime||!0;if(typeof WebAssembly!=="object")s("no native wasm support detected");var a,rj=!1,f6;function pA(A,j){if(!A)s("Assertion failed: "+j)}var i6=0,_6=1;function v6(A,j){var n;if(j==_6)n=Uj(A.length);else n=Lj(A.length);if(A.subarray||A.slice)W.set(A,n);else W.set(new Uint8Array(A),n);return n}var dA=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function I6(A,j,n){var r=j+n,t=j;while(A[t]&&!(t>=r))++t;if(t-j>16&&A.subarray&&dA)return dA.decode(A.subarray(j,t));else{var k="";while(j<t){var q=A[j++];if(!(q&128)){k+=String.fromCharCode(q);continue}var f=A[j++]&63;if((q&224)==192){k+=String.fromCharCode((q&31)<<6|f);continue}var _=A[j++]&63;if((q&240)==224)q=(q&15)<<12|f<<6|_;else q=(q&7)<<18|f<<12|_<<6|A[j++]&63;if(q<65536)k+=String.fromCharCode(q);else{var $=q-65536;k+=String.fromCharCode(55296|$>>10,56320|$&1023)}}}return k}function $6(A,j){return A?I6(W,A,j):""}function F6(A,j){if(A%j>0)A+=j-A%j;return A}var yA,Ej,W,tj,qj,kj,fj,ij,_j;function vj(A){yA=A,E.HEAP8=Ej=new Int8Array(A),E.HEAP16=tj=new Int16Array(A),E.HEAP32=kj=new Int32Array(A),E.HEAPU8=W=new Uint8Array(A),E.HEAPU16=qj=new Uint16Array(A),E.HEAPU32=fj=new Uint32Array(A),E.HEAPF32=ij=new Float32Array(A),E.HEAPF64=_j=new Float64Array(A)}var Gn=E.INITIAL_MEMORY||16777216,fA,Ij=[],$j=[],Fj=[],B6=!1;function u6(){if(E.preRun){if(typeof E.preRun=="function")E.preRun=[E.preRun];while(E.preRun.length)G6(E.preRun.shift())}DA(Ij)}function L6(){B6=!0,DA($j)}function U6(){if(E.postRun){if(typeof E.postRun=="function")E.postRun=[E.postRun];while(E.postRun.length)P6(E.postRun.shift())}DA(Fj)}function G6(A){Ij.unshift(A)}function H6(A){$j.unshift(A)}function P6(A){Fj.unshift(A)}var D=0,TA=null,e=null;function O6(A){if(D++,E.monitorRunDependencies)E.monitorRunDependencies(D)}function K6(A){if(D--,E.monitorRunDependencies)E.monitorRunDependencies(D);if(D==0){if(TA!==null)clearInterval(TA),TA=null;if(e){var j=e;e=null,j()}}}E.preloadedImages={};E.preloadedAudios={};function s(A){if(E.onAbort)E.onAbort(A);A+="",g(A),rj=!0,f6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var R6="data:application/octet-stream;base64,";function Bj(A){return A.startsWith(R6)}function uj(A){return A.startsWith("file://")}var G="argon2.wasm";if(!Bj(G))G=q6(G);function Aj(A){try{if(A==G&&l)return new Uint8Array(l);if(b)return b(A);else throw"both async and sync fetching of the wasm failed"}catch(j){s(j)}}function N6(){if(!l&&(_A||y)){if(typeof fetch==="function"&&!uj(G))return fetch(G,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+G+"'";return A.arrayBuffer()}).catch(function(){return Aj(G)});else if(SA)return new Promise(function(A,j){SA(G,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return Aj(G)})}function T6(){var A={a:y6};function j(q,f){var _=q.exports;E.asm=_,a=E.asm.c,vj(a.buffer),fA=E.asm.k,H6(E.asm.d),K6("wasm-instantiate")}O6("wasm-instantiate");function n(q){j(q.instance)}function r(q){return N6().then(function(f){var _=WebAssembly.instantiate(f,A);return _}).then(q,function(f){g("failed to asynchronously prepare wasm: "+f),s(f)})}function t(){if(!l&&typeof WebAssembly.instantiateStreaming==="function"&&!Bj(G)&&!uj(G)&&typeof fetch==="function")return fetch(G,{credentials:"same-origin"}).then(function(q){var f=WebAssembly.instantiateStreaming(q,A);return f.then(n,function(_){return g("wasm streaming compile failed: "+_),g("falling back to ArrayBuffer instantiation"),r(n)})});else return r(n)}if(E.instantiateWasm)try{var k=E.instantiateWasm(A,j);return k}catch(q){return g("Module.instantiateWasm callback failed with error: "+q),!1}return t(),{}}function DA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(E);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)fA.get(n)();else fA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function c6(A,j,n){W.copyWithin(A,j,j+n)}function S6(A){try{return a.grow(A-yA.byteLength+65535>>>16),vj(a.buffer),1}catch(j){}}function w6(A){var j=W.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var r=1;r<=4;r*=2){var t=j*(1+0.2/r);t=Math.min(t,A+100663296);var k=Math.min(n,F6(Math.max(A,t),65536)),q=S6(k);if(q)return!0}return!1}var y6={a:c6,b:w6},D6=T6(),W6=E.___wasm_call_ctors=function(){return(W6=E.___wasm_call_ctors=E.asm.d).apply(null,arguments)},x6=E._argon2_hash=function(){return(x6=E._argon2_hash=E.asm.e).apply(null,arguments)},Lj=E._malloc=function(){return(Lj=E._malloc=E.asm.f).apply(null,arguments)},X6=E._free=function(){return(X6=E._free=E.asm.g).apply(null,arguments)},J6=E._argon2_verify=function(){return(J6=E._argon2_verify=E.asm.h).apply(null,arguments)},Y6=E._argon2_error_message=function(){return(Y6=E._argon2_error_message=E.asm.i).apply(null,arguments)},Q6=E._argon2_encodedlen=function(){return(Q6=E._argon2_encodedlen=E.asm.j).apply(null,arguments)},z6=E._argon2_hash_ext=function(){return(z6=E._argon2_hash_ext=E.asm.l).apply(null,arguments)},C6=E._argon2_verify_ext=function(){return(C6=E._argon2_verify_ext=E.asm.m).apply(null,arguments)},Uj=E.stackAlloc=function(){return(Uj=E.stackAlloc=E.asm.n).apply(null,arguments)};E.allocate=v6;E.UTF8ToString=$6;E.ALLOC_NORMAL=i6;var iA;function Z6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}e=function A(){if(!iA)WA();if(!iA)e=A};function WA(A){if(A=A||m,D>0)return;if(u6(),D>0)return;function j(){if(iA)return;if(iA=!0,E.calledRun=!0,rj)return;if(L6(),E.onRuntimeInitialized)E.onRuntimeInitialized();U6()}if(E.setStatus)E.setStatus("Running..."),setTimeout(function(){setTimeout(function(){E.setStatus("")},1),j()},1);else j()}E.run=WA;if(E.preInit){if(typeof E.preInit=="function")E.preInit=[E.preInit];while(E.preInit.length>0)E.preInit.pop()()}WA();if(typeof x!=="undefined")x.exports=E;E.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(E=t6=a=fA=D6=yA=Ej=W=tj=qj=kj=fj=ij=_j=void 0,typeof x!=="undefined")delete x.exports}});var Gj=w((Pn,V6)=>{V6.exports="./cryptit.index.wasm"});var Pj=w((Hj,vA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof vA==="object"&&vA.exports)vA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:Hj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(i){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=t().then((v)=>new Promise((u)=>{v.postRun=()=>u(v)}));else I=k().then((v)=>{let u=i?f(i):void 0;return r(v,u)});return n._promise=I,I.then((v)=>{return n._module=v,delete n._promise,v})}function r(i,I){return new Promise((v)=>{return A.Module={wasmBinary:i,wasmMemory:I,postRun(){v(Module)}},t()})}function t(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(xA())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(Gj()).then((I)=>{return q(I)})}function q(i){let I=atob(i),v=new Uint8Array(new ArrayBuffer(I.length));for(let u=0;u<I.length;u++)v[u]=I.charCodeAt(u);return v}function f(i){let J=Math.min(Math.max(Math.ceil(i*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:J,maximum:32767})}function _(i,I){return i.allocate(I,"i8",i.ALLOC_NORMAL)}function $(i,I){let v=new Uint8Array([...I,0]);return _(i,v)}function F(i){if(typeof i!=="string")return i;if(typeof TextEncoder==="function")return new TextEncoder().encode(i);else if(typeof Buffer==="function")return Buffer.from(i);else throw new Error("Don't know how to encode UTF8")}function L(i){let I=i.mem||1024;return n(I).then((v)=>{let u=i.time||1,T=i.parallelism||1,Z=F(i.pass),J=$(v,Z),HA=Z.length,jA=F(i.salt),nA=$(v,jA),V=jA.length,Y=i.type||j.Argon2d,K=v.allocate(new Array(i.hashLen||24),"i8",v.ALLOC_NORMAL),c=i.secret?_(v,i.secret):0,M=i.secret?i.secret.byteLength:0,H=i.ad?_(v,i.ad):0,pj=i.ad?i.ad.byteLength:0,rA=i.hashLen||24,mA=v._argon2_encodedlen(u,I,T,V,rA,Y),PA=v.allocate(new Array(mA+1),"i8",v.ALLOC_NORMAL),$n=19,Q,EA;try{EA=v._argon2_hash_ext(u,I,T,J,HA,nA,V,K,rA,PA,mA,Y,c,M,H,pj,19)}catch(z){Q=z}let tA;if(EA===0&&!Q){let z="",bA=new Uint8Array(rA);for(let qA=0;qA<rA;qA++){let eA=v.HEAP8[K+qA];bA[qA]=eA,z+=("0"+(255&eA).toString(16)).slice(-2)}let dj=v.UTF8ToString(PA);tA={hash:bA,hashHex:z,encoded:dj}}else{try{if(!Q)Q=v.UTF8ToString(v._argon2_error_message(EA))}catch(z){}tA={message:Q,code:EA}}try{if(v._free(J),v._free(nA),v._free(K),v._free(PA),H)v._free(H);if(c)v._free(c)}catch(z){}if(Q)throw tA;else return tA})}function B(i){return n().then((I)=>{let v=F(i.pass),u=$(I,v),T=v.length,Z=i.secret?_(I,i.secret):0,J=i.secret?i.secret.byteLength:0,HA=i.ad?_(I,i.ad):0,jA=i.ad?i.ad.byteLength:0,nA=F(i.encoded),V=$(I,nA),Y=i.type;if(Y===void 0){let H=i.encoded.split("$")[1];if(H)H=H.replace("a","A"),Y=j[H]||j.Argon2d}let K,c;try{c=I._argon2_verify_ext(V,u,T,Z,J,HA,jA,Y)}catch(H){K=H}let M;if(c||K){try{if(!K)K=I.UTF8ToString(I._argon2_error_message(c))}catch(H){}M={message:K,code:c}}try{I._free(u),I._free(V)}catch(H){}if(K)throw M;else return M})}function O(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:L,verify:B,unloadRuntime:O}})});var Nj=w((On,Rj)=>{var IA=/^[a-z0-9-]{1,32}$/,$A=/^[a-z0-9-]{1,32}$/,FA=/^[a-zA-Z0-9/+.-]+$/,Oj=/^([a-zA-Z0-9/+.-]+|)$/,M6=/^((-)?[1-9]\d*|0)$/,XA=/^v=(\d+)$/;function h6(A){return p(A).map((j)=>[j,A[j]].join("=")).join(",")}function g6(A){let j={};return A.split(",").forEach((n)=>{let r=n.split("=");if(r.length<2)throw new TypeError("params must be in the format name=value");j[r.shift()]=r.join("=")}),j}function p(A){return Object.keys(A)}function Kj(A){if(typeof Object.values==="function")return Object.values(A);return p(A).map((j)=>A[j])}function o6(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!IA.test(A.id))throw new TypeError(`id must satisfy ${IA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let r=p(A.params);if(!r.every((q)=>$A.test(q)))throw new TypeError(`params names must satisfy ${$A}`);r.forEach((q)=>{if(typeof A.params[q]==="number")A.params[q]=A.params[q].toString();else if(Buffer.isBuffer(A.params[q]))A.params[q]=A.params[q].toString("base64").split("=")[0]});let t=Kj(A.params);if(!t.every((q)=>typeof q==="string"))throw new TypeError("params values must be strings");if(!t.every((q)=>FA.test(q)))throw new TypeError(`params values must satisfy ${FA}`);let k=h6(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function m6(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!XA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let r=j.shift();if(!IA.test(r))throw new TypeError(`id must satisfy ${IA}`);let t;if(XA.test(j[0]))t=parseInt(j.shift().match(XA)[1],10);let k,q;if(Oj.test(j[j.length-1]))if(j.length>1&&Oj.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),q=Buffer.from(j.pop(),"base64");else q=Buffer.from(j.pop(),"base64");let f;if(j.length>0){let $=j.pop();if(f=g6($),!p(f).every((B)=>$A.test(B)))throw new TypeError(`params names must satisfy ${$A}`);if(!Kj(f).every((B)=>FA.test(B)))throw new TypeError(`params values must satisfy ${FA}`);p(f).forEach((B)=>{f[B]=M6.test(f[B])?parseInt(f[B],10):f[B]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let _={id:r};if(t)_.version=t;if(f)_.params=f;if(q)_.salt=q;if(k)_.hash=k;return _}Rj.exports={serialize:o6,deserialize:m6}});var Vj=w((Kn,Zj)=>{var wj=require("fs"),N=require("path"),yj=require("os"),Dj=typeof __webpack_require__==="function"?__non_webpack_require__:require,b6=process.config&&process.config.variables||{},e6=!!process.env.PREBUILDS_ONLY,Tj=process.versions.modules,JA=s6()?"electron":a6()?"node-webkit":"node",YA=process.env.npm_config_arch||yj.arch(),QA=process.env.npm_config_platform||yj.platform(),Wj=process.env.LIBC||(p6(QA)?"musl":"glibc"),zA=process.env.ARM_VERSION||(YA==="arm64"?"8":b6.arm_version)||"",xj=(process.versions.uv||"").split(".")[0];Zj.exports=R;function R(A){return Dj(R.resolve(A))}R.resolve=R.path=function(A){A=N.resolve(A||".");try{var j=Dj(N.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(_){}if(!e6){var n=cj(N.join(A,"build/Release"),Sj);if(n)return n;var r=cj(N.join(A,"build/Debug"),Sj);if(r)return r}var t=f(A);if(t)return t;var k=f(N.dirname(process.execPath));if(k)return k;var q=["platform="+QA,"arch="+YA,"runtime="+JA,"abi="+Tj,"uv="+xj,zA?"armv="+zA:"","libc="+Wj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+q+`
    loaded from: `+A+`
`);function f(_){var $=CA(N.join(_,"prebuilds")).map(Xj),F=$.filter(Jj(QA,YA)).sort(Yj)[0];if(!F)return;var L=N.join(_,"prebuilds",F.name),B=CA(L).map(Qj),O=B.filter(zj(JA,Tj)),i=O.sort(Cj(JA))[0];if(i)return N.join(L,i.file)}};function CA(A){try{return wj.readdirSync(A)}catch(j){return[]}}function cj(A,j){var n=CA(A).filter(j);return n[0]&&N.join(A,n[0])}function Sj(A){return/\.node$/.test(A)}function Xj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],r=j[1].split("+");if(!n)return;if(!r.length)return;if(!r.every(Boolean))return;return{name:A,platform:n,architectures:r}}function Jj(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function Yj(A,j){return A.architectures.length-j.architectures.length}function Qj(A){var j=A.split("."),n=j.pop(),r={file:A,specificity:0};if(n!=="node")return;for(var t=0;t<j.length;t++){var k=j[t];if(k==="node"||k==="electron"||k==="node-webkit")r.runtime=k;else if(k==="napi")r.napi=!0;else if(k.slice(0,3)==="abi")r.abi=k.slice(3);else if(k.slice(0,2)==="uv")r.uv=k.slice(2);else if(k.slice(0,4)==="armv")r.armv=k.slice(4);else if(k==="glibc"||k==="musl")r.libc=k;else continue;r.specificity++}return r}function zj(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!l6(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==xj)return!1;if(n.armv&&n.armv!==zA)return!1;if(n.libc&&n.libc!==Wj)return!1;return!0}}function l6(A){return A.runtime==="node"&&A.napi}function Cj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function a6(){return!!(process.versions&&process.versions.nw)}function s6(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function p6(A){return A==="linux"&&wj.existsSync("/etc/alpine-release")}R.parseTags=Qj;R.matchTags=zj;R.compareTags=Cj;R.parseTuple=Xj;R.matchTuple=Jj;R.compareTuples=Yj});var Mj=w((Rn,VA)=>{var ZA=typeof __webpack_require__==="function"?__non_webpack_require__:require;if(typeof ZA.addon==="function")VA.exports=ZA.addon.bind(ZA);else VA.exports=Vj()});var mj=w((Tn,X)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",Nn=require("node:assert"),{randomBytes:d6,timingSafeEqual:An}=require("node:crypto"),{promisify:jn}=require("node:util"),{deserialize:hj,serialize:nn}=Nj(),rn=Mj(),{hash:gj}=rn(__dirname),En=jn(d6);X.exports.argon2d=0;X.exports.argon2i=1;X.exports.argon2id=2;var d=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),tn=Object.freeze({[d.argon2d]:"argon2d",[d.argon2i]:"argon2i",[d.argon2id]:"argon2id"}),oj={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function qn(A,j){let{raw:n,salt:r,...t}={...oj,...j};if(t.hashLength>4294967295)throw new RangeError("Hash length is too large");if(t.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(t.timeCost>4294967295)throw new RangeError("Time cost is too large");if(t.parallelism>16777215)throw new RangeError("Parallelism is too large");r=r??await En(16);let{hashLength:k,secret:q=Buffer.alloc(0),type:f,version:_,memoryCost:$,timeCost:F,parallelism:L,associatedData:B=Buffer.alloc(0)}=t,O=await gj({password:Buffer.from(A),salt:r,secret:q,data:B,hashLength:k,m:$,t:F,p:L,version:_,type:f});if(n)return O;return nn({id:tn[f],version:_,params:{m:$,t:F,p:L,...B.byteLength>0?{data:B}:{}},salt:r,hash:O})}X.exports.hash=qn;function kn(A,j={}){let{memoryCost:n,timeCost:r,parallelism:t,version:k}={...oj,...j},{version:q,params:{m:f,t:_,p:$}}=hj(A);return+q!==+k||+f!==+n||+_!==+r||+$!==+t}X.exports.needsRehash=kn;async function fn(A,j,n={}){let{id:r,...t}=hj(A);if(!(r in d))return!1;let{version:k=16,params:{m:q,t:f,p:_,data:$=""},salt:F,hash:L}=t,{secret:B=Buffer.alloc(0)}=n;return An(await gj({password:Buffer.from(j),salt:F,secret:B,data:Buffer.from($,"base64"),hashLength:L.byteLength,m:+q,t:+f,p:+_,version:+k,type:d[r]}),L)}X.exports.verify=fn});var In={};E6(In,{createCryptit:()=>vn});module.exports=r6(In);class U{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new Error(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new Error(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class KA{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),r=new Uint8Array(j.length+n.length);return r.set(j),r.set(n,j.length),r}async decryptChunk(A){let j=A.slice(0,12),n=A.slice(12),r=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(r)}}var BA=OA(Pj());async function bj(A,j,n,r){if(r==="node"){let t=await Promise.resolve().then(() => OA(mj())),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),q=Buffer.from(j),f=await t.hash(k,{salt:q,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:t.argon2id});return{hash:new Uint8Array(f)}}if(r==="browser"){let{hash:t}=await BA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:BA.ArgonType.Argon2id});return{hash:t}}throw new Error(`Unsupported environment: ${r}`)}class MA{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,n,r){let{hash:t}=await bj(A,j,this.presets[n],r.isNode?"node":"browser");return r.subtle.importKey("raw",t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var ej={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},_n={id:0,cipher:KA,kdf:new MA(ej),saltLengths:{low:12,high:16},difficulties:ej,defaultChunkSize:524288};U.register(_n);var uA=1;function hA(...A){let j=A.reduce((t,k)=>t+k.byteLength,0),n=new Uint8Array(j),r=0;for(let t of A)n.set(t,r),r+=t.byteLength;return n}function lj(...A){return Buffer.from(hA(...A)).toString("base64")}function aj(A){return Uint8Array.from(Buffer.from(A,"base64"))}function LA(A,j,n,r){let t={low:0,middle:1,high:2}[j]??0,k=A<<5|(n==="high"?1:0)<<2|t;return hA(new Uint8Array([uA,k]),r)}function UA(A){if(A[0]!==uA)throw new Error("INVALID_HEADER");let j=A[1],n=j>>5,r=j>>2&1?"high":"low",t=j&3,k=["low","middle","high"][t],q=U.get(n).saltLengths[r],f=A.slice(2,2+q);return{version:n,difficulty:k,saltStrength:r,salt:f,headerLen:2+q}}class AA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let r=0;while(n.length-r>=this.chunkSize){let t=n.slice(r,r+this.chunkSize);r+=this.chunkSize;let k=await this.engine.encryptChunk(t),q=new Uint8Array(4);new DataView(q.buffer).setUint32(0,k.length,!1);let f=new Uint8Array(4+k.length);f.set(q),f.set(k,q.length),j.enqueue(f)}this.buffer=n.slice(r)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let r=new Uint8Array(4+j.length);r.set(n),r.set(j,4),A.enqueue(r),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class C{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let r=0;while(!0){if(n.length-r<4)break;let t=new DataView(n.buffer,n.byteOffset+r,4).getUint32(0,!1);if(n.length-r-4<t)break;r+=4;let k=n.slice(r,r+t);r+=t;let q=await this.engine.decryptChunk(k);j.enqueue(q)}this.buffer=n.slice(r)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class gA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new AA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(t,k){if(j===0){k.enqueue(t);return}if(t.byteLength<=j){j-=t.byteLength;return}k.enqueue(t.slice(j)),j=0}}),r=new C(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(r)}}async collect(A,j,n=null){let r=A.pipeThrough(j).getReader(),t=[];if(n?.length)t.push(n);while(!0){let{value:_,done:$}=await r.read();if($)break;t.push(_)}let k=t.reduce((_,$)=>_+$.byteLength,0),q=new Uint8Array(k),f=0;for(let _ of t)q.set(_,f),f+=_.byteLength;return q}}class oA{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;constructor(A,j={}){this.provider=A;this.v=U.get(j.version??U.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new gA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high"}async encryptText(A,j){let n=this.genSalt();await this.deriveKey(j,n);let r=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A),t=LA(this.v.id,this.difficulty,this.saltStrength,n);return lj(t,r)}async decryptText(A,j){let n=aj(A),r=UA(n),t=U.get(r.version);this.ensureSameVersion(t),await this.deriveKey(j,r.salt,r.difficulty);let k=await this.cipher.decryptChunk(n.slice(r.headerLen));return new TextDecoder().decode(k)}async encryptFile(A,j){let n=this.genSalt();await this.deriveKey(j,n);let r=LA(this.v.id,this.difficulty,this.saltStrength,n),t=await this.stream.collect(A.stream(),new AA(this.cipher,this.chunkSize).toTransformStream(),r);return new Blob([t],{type:"application/octet-stream"})}async decryptFile(A,j){let n=new Uint8Array(await A.slice(0,2).arrayBuffer()),r=n[1]>>5,t=n[1]>>2&1?"high":"low",q=2+U.get(r).saltLengths[t],f=new Uint8Array(await A.slice(0,q).arrayBuffer()),_=UA(f);await this.deriveKey(j,_.salt,_.difficulty);let $=await this.stream.collect(A.slice(q).stream(),new C(this.cipher,this.chunkSize).toTransformStream());return new Blob([$],{type:"application/octet-stream"})}async createEncryptionStream(A){let j=this.genSalt();await this.deriveKey(A,j);let n=LA(this.v.id,this.difficulty,this.saltStrength,j),r=this.stream.encryptionStream();return{header:n,writable:r.writable,readable:r.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),r=!1,t;function k(f,_){let $=new Uint8Array(f.length+_.length);return $.set(f),$.set(_,f.length),$}async function q(f,_){let $=f.getReader();while(!0){let{value:F,done:L}=await $.read();if(L)break;_.enqueue(F)}}return new TransformStream({async transform(f,_){if(!r){if(n=k(n,f),n.length<2)return;let F=n[1]>>5,L=n[1]>>2&1?"high":"low",O=2+U.get(F).saltLengths[L];if(n.length<O)return;let i=n.slice(0,O),{salt:I,difficulty:v}=UA(i);if(F!==j.v.id)throw new Error(`Ciphertext v${F} but Cryptit instance is v${j.v.id}`);await j.deriveKey(A,I,v),t=new C(j.cipher,j.chunkSize).toTransformStream(),q(t.readable,_);let u=n.slice(O);if(u.length){let T=t.writable.getWriter();await T.write(u),T.releaseLock()}r=!0;return}let $=t.writable.getWriter();await $.write(f),$.releaseLock()},async flush(){if(r){let f=t.writable.getWriter();await f.close(),f.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let r=await this.kdf.derive(A,j,n,this.provider);this.cipher.key=r}concat(A,j){let n=new Uint8Array(A.length+j.length);return n.set(A,0),n.set(j,A.length),n}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}ensureSameVersion(A){if(A.id!==this.v.id)throw new Error(`This Cryptit instance was created for v${this.v.id} but ciphertext is v${A.id}`)}}var GA=require("node:crypto"),sj={subtle:GA.webcrypto.subtle,getRandomValues(A){return GA.randomFillSync(A),A},isNode:!0};function vn(A){return new oA(sj,A)}

//# debugId=3BAD3DAA76E1B3AE64756E2164756E21
