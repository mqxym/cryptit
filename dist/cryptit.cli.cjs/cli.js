#!/usr/bin/env node
var O0=Object.create;var{getPrototypeOf:x0,defineProperty:y8,getOwnPropertyNames:f0}=Object;var v0=Object.prototype.hasOwnProperty;var X8=(U,Y,_)=>{_=U!=null?O0(x0(U)):{};let $=Y||!U||!U.__esModule?y8(_,"default",{value:U,enumerable:!0}):_;for(let z of f0(U))if(!v0.call($,z))y8($,z,{get:()=>U[z],enumerable:!0});return $};var H=(U,Y)=>()=>(Y||U((Y={exports:{}}).exports,Y),Y.exports);var g=H((G8)=>{class Z8 extends Error{constructor(U,Y,_){super(_);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=Y,this.exitCode=U,this.nestedError=void 0}}class k8 extends Z8{constructor(U){super(1,"commander.invalidArgument",U);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}G8.CommanderError=Z8;G8.InvalidArgumentError=k8});var s=H((q8)=>{var{InvalidArgumentError:b0}=g();class C8{constructor(U,Y){switch(this.description=Y||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,U[0]){case"<":this.required=!0,this._name=U.slice(1,-1);break;case"[":this.required=!1,this._name=U.slice(1,-1);break;default:this.required=!0,this._name=U;break}if(this._name.length>3&&this._name.slice(-3)==="...")this.variadic=!0,this._name=this._name.slice(0,-3)}name(){return this._name}_concatValue(U,Y){if(Y===this.defaultValue||!Array.isArray(Y))return[U];return Y.concat(U)}default(U,Y){return this.defaultValue=U,this.defaultValueDescription=Y,this}argParser(U){return this.parseArg=U,this}choices(U){return this.argChoices=U.slice(),this.parseArg=(Y,_)=>{if(!this.argChoices.includes(Y))throw new b0(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(Y,_);return Y},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}}function h0(U){let Y=U.name()+(U.variadic===!0?"...":"");return U.required?"<"+Y+">":"["+Y+"]"}q8.Argument=C8;q8.humanReadableArgName=h0});var T8=H((x8)=>{var{humanReadableArgName:u0}=s();class O8{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands(U){let Y=U.commands.filter((_)=>!_._hidden);if(U._hasImplicitHelpCommand()){let[,_,$]=U._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),z=U.createCommand(_).helpOption(!1);if(z.description(U._helpCommandDescription),$)z.arguments($);Y.push(z)}if(this.sortSubcommands)Y.sort((_,$)=>{return _.name().localeCompare($.name())});return Y}compareOptions(U,Y){let _=($)=>{return $.short?$.short.replace(/^-/,""):$.long.replace(/^--/,"")};return _(U).localeCompare(_(Y))}visibleOptions(U){let Y=U.options.filter((z)=>!z.hidden),_=U._hasHelpOption&&U._helpShortFlag&&!U._findOption(U._helpShortFlag),$=U._hasHelpOption&&!U._findOption(U._helpLongFlag);if(_||$){let z;if(!_)z=U.createOption(U._helpLongFlag,U._helpDescription);else if(!$)z=U.createOption(U._helpShortFlag,U._helpDescription);else z=U.createOption(U._helpFlags,U._helpDescription);Y.push(z)}if(this.sortOptions)Y.sort(this.compareOptions);return Y}visibleGlobalOptions(U){if(!this.showGlobalOptions)return[];let Y=[];for(let _=U.parent;_;_=_.parent){let $=_.options.filter((z)=>!z.hidden);Y.push(...$)}if(this.sortOptions)Y.sort(this.compareOptions);return Y}visibleArguments(U){if(U._argsDescription)U.registeredArguments.forEach((Y)=>{Y.description=Y.description||U._argsDescription[Y.name()]||""});if(U.registeredArguments.find((Y)=>Y.description))return U.registeredArguments;return[]}subcommandTerm(U){let Y=U.registeredArguments.map((_)=>u0(_)).join(" ");return U._name+(U._aliases[0]?"|"+U._aliases[0]:"")+(U.options.length?" [options]":"")+(Y?" "+Y:"")}optionTerm(U){return U.flags}argumentTerm(U){return U.name()}longestSubcommandTermLength(U,Y){return Y.visibleCommands(U).reduce((_,$)=>{return Math.max(_,Y.subcommandTerm($).length)},0)}longestOptionTermLength(U,Y){return Y.visibleOptions(U).reduce((_,$)=>{return Math.max(_,Y.optionTerm($).length)},0)}longestGlobalOptionTermLength(U,Y){return Y.visibleGlobalOptions(U).reduce((_,$)=>{return Math.max(_,Y.optionTerm($).length)},0)}longestArgumentTermLength(U,Y){return Y.visibleArguments(U).reduce((_,$)=>{return Math.max(_,Y.argumentTerm($).length)},0)}commandUsage(U){let Y=U._name;if(U._aliases[0])Y=Y+"|"+U._aliases[0];let _="";for(let $=U.parent;$;$=$.parent)_=$.name()+" "+_;return _+Y+" "+U.usage()}commandDescription(U){return U.description()}subcommandDescription(U){return U.summary()||U.description()}optionDescription(U){let Y=[];if(U.argChoices)Y.push(`choices: ${U.argChoices.map((_)=>JSON.stringify(_)).join(", ")}`);if(U.defaultValue!==void 0){if(U.required||U.optional||U.isBoolean()&&typeof U.defaultValue==="boolean")Y.push(`default: ${U.defaultValueDescription||JSON.stringify(U.defaultValue)}`)}if(U.presetArg!==void 0&&U.optional)Y.push(`preset: ${JSON.stringify(U.presetArg)}`);if(U.envVar!==void 0)Y.push(`env: ${U.envVar}`);if(Y.length>0)return`${U.description} (${Y.join(", ")})`;return U.description}argumentDescription(U){let Y=[];if(U.argChoices)Y.push(`choices: ${U.argChoices.map((_)=>JSON.stringify(_)).join(", ")}`);if(U.defaultValue!==void 0)Y.push(`default: ${U.defaultValueDescription||JSON.stringify(U.defaultValue)}`);if(Y.length>0){let _=`(${Y.join(", ")})`;if(U.description)return`${U.description} ${_}`;return _}return U.description}formatHelp(U,Y){let _=Y.padWidth(U,Y),$=Y.helpWidth||80,z=2,J=2;function X(B,K){if(K){let D=`${B.padEnd(_+2)}${K}`;return Y.wrap(D,$-2,_+2)}return B}function Q(B){return B.join(`
`).replace(/^/gm," ".repeat(2))}let Z=[`Usage: ${Y.commandUsage(U)}`,""],G=Y.commandDescription(U);if(G.length>0)Z=Z.concat([Y.wrap(G,$,0),""]);let T=Y.visibleArguments(U).map((B)=>{return X(Y.argumentTerm(B),Y.argumentDescription(B))});if(T.length>0)Z=Z.concat(["Arguments:",Q(T),""]);let M=Y.visibleOptions(U).map((B)=>{return X(Y.optionTerm(B),Y.optionDescription(B))});if(M.length>0)Z=Z.concat(["Options:",Q(M),""]);if(this.showGlobalOptions){let B=Y.visibleGlobalOptions(U).map((K)=>{return X(Y.optionTerm(K),Y.optionDescription(K))});if(B.length>0)Z=Z.concat(["Global Options:",Q(B),""])}let W=Y.visibleCommands(U).map((B)=>{return X(Y.subcommandTerm(B),Y.subcommandDescription(B))});if(W.length>0)Z=Z.concat(["Commands:",Q(W),""]);return Z.join(`
`)}padWidth(U,Y){return Math.max(Y.longestOptionTermLength(U,Y),Y.longestGlobalOptionTermLength(U,Y),Y.longestSubcommandTermLength(U,Y),Y.longestArgumentTermLength(U,Y))}wrap(U,Y,_,$=40){let J=new RegExp(`[\\n][${" \\f\\t\\v   -   　\uFEFF"}]+`);if(U.match(J))return U;let X=Y-_;if(X<$)return U;let Q=U.slice(0,_),Z=U.slice(_).replace(`\r
`,`
`),G=" ".repeat(_),M=`\\s${"​"}`,W=new RegExp(`
|.{1,${X-1}}([${M}]|$)|[^${M}]+?([${M}]|$)`,"g"),B=Z.match(W)||[];return Q+B.map((K,D)=>{if(K===`
`)return"";return(D>0?G:"")+K.trimEnd()}).join(`
`)}}x8.Help=O8});var M8=H((r)=>{var{InvalidArgumentError:g0}=g();class f8{constructor(U,Y){this.flags=U,this.description=Y||"",this.required=U.includes("<"),this.optional=U.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(U),this.mandatory=!1;let _=b8(U);if(this.short=_.shortFlag,this.long=_.longFlag,this.negate=!1,this.long)this.negate=this.long.startsWith("--no-");this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default(U,Y){return this.defaultValue=U,this.defaultValueDescription=Y,this}preset(U){return this.presetArg=U,this}conflicts(U){return this.conflictsWith=this.conflictsWith.concat(U),this}implies(U){let Y=U;if(typeof U==="string")Y={[U]:!0};return this.implied=Object.assign(this.implied||{},Y),this}env(U){return this.envVar=U,this}argParser(U){return this.parseArg=U,this}makeOptionMandatory(U=!0){return this.mandatory=!!U,this}hideHelp(U=!0){return this.hidden=!!U,this}_concatValue(U,Y){if(Y===this.defaultValue||!Array.isArray(Y))return[U];return Y.concat(U)}choices(U){return this.argChoices=U.slice(),this.parseArg=(Y,_)=>{if(!this.argChoices.includes(Y))throw new g0(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(Y,_);return Y},this}name(){if(this.long)return this.long.replace(/^--/,"");return this.short.replace(/^-/,"")}attributeName(){return c0(this.name().replace(/^no-/,""))}is(U){return this.short===U||this.long===U}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class v8{constructor(U){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,U.forEach((Y)=>{if(Y.negate)this.negativeOptions.set(Y.attributeName(),Y);else this.positiveOptions.set(Y.attributeName(),Y)}),this.negativeOptions.forEach((Y,_)=>{if(this.positiveOptions.has(_))this.dualOptions.add(_)})}valueFromOption(U,Y){let _=Y.attributeName();if(!this.dualOptions.has(_))return!0;let $=this.negativeOptions.get(_).presetArg,z=$!==void 0?$:!1;return Y.negate===(z===U)}}function c0(U){return U.split("-").reduce((Y,_)=>{return Y+_[0].toUpperCase()+_.slice(1)})}function b8(U){let Y,_,$=U.split(/[ |,]+/);if($.length>1&&!/^[[<]/.test($[1]))Y=$.shift();if(_=$.shift(),!Y&&/^-[^-]$/.test(_))Y=_,_=void 0;return{shortFlag:Y,longFlag:_}}r.Option=f8;r.splitOptionFlags=b8;r.DualOptions=v8});var u8=H((h8)=>{function l0(U,Y){if(Math.abs(U.length-Y.length)>3)return Math.max(U.length,Y.length);let _=[];for(let $=0;$<=U.length;$++)_[$]=[$];for(let $=0;$<=Y.length;$++)_[0][$]=$;for(let $=1;$<=Y.length;$++)for(let z=1;z<=U.length;z++){let J=1;if(U[z-1]===Y[$-1])J=0;else J=1;if(_[z][$]=Math.min(_[z-1][$]+1,_[z][$-1]+1,_[z-1][$-1]+J),z>1&&$>1&&U[z-1]===Y[$-2]&&U[z-2]===Y[$-1])_[z][$]=Math.min(_[z][$],_[z-2][$-2]+1)}return _[U.length][Y.length]}function m0(U,Y){if(!Y||Y.length===0)return"";Y=Array.from(new Set(Y));let _=U.startsWith("--");if(_)U=U.slice(2),Y=Y.map((X)=>X.slice(2));let $=[],z=3,J=0.4;if(Y.forEach((X)=>{if(X.length<=1)return;let Q=l0(U,X),Z=Math.max(U.length,X.length);if((Z-Q)/Z>J){if(Q<z)z=Q,$=[X];else if(Q===z)$.push(X)}}),$.sort((X,Q)=>X.localeCompare(Q)),_)$=$.map((X)=>`--${X}`);if($.length>1)return`
(Did you mean one of ${$.join(", ")}?)`;if($.length===1)return`
(Did you mean ${$[0]}?)`;return""}h8.suggestSimilar=m0});var p8=H((d8)=>{var d0=require("events").EventEmitter,W8=require("child_process"),F=require("path"),B8=require("fs"),L=require("process"),{Argument:p0,humanReadableArgName:i0}=s(),{CommanderError:L8}=g(),{Help:n0}=T8(),{Option:g8,splitOptionFlags:s0,DualOptions:r0}=M8(),{suggestSimilar:c8}=u8();class K8 extends d0{constructor(U){super();this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=U||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:(Y)=>L.stdout.write(Y),writeErr:(Y)=>L.stderr.write(Y),getOutHelpWidth:()=>L.stdout.isTTY?L.stdout.columns:void 0,getErrHelpWidth:()=>L.stderr.isTTY?L.stderr.columns:void 0,outputError:(Y,_)=>_(Y)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings(U){return this._outputConfiguration=U._outputConfiguration,this._hasHelpOption=U._hasHelpOption,this._helpFlags=U._helpFlags,this._helpDescription=U._helpDescription,this._helpShortFlag=U._helpShortFlag,this._helpLongFlag=U._helpLongFlag,this._helpCommandName=U._helpCommandName,this._helpCommandnameAndArgs=U._helpCommandnameAndArgs,this._helpCommandDescription=U._helpCommandDescription,this._helpConfiguration=U._helpConfiguration,this._exitCallback=U._exitCallback,this._storeOptionsAsProperties=U._storeOptionsAsProperties,this._combineFlagAndOptionalValue=U._combineFlagAndOptionalValue,this._allowExcessArguments=U._allowExcessArguments,this._enablePositionalOptions=U._enablePositionalOptions,this._showHelpAfterError=U._showHelpAfterError,this._showSuggestionAfterError=U._showSuggestionAfterError,this}_getCommandAndAncestors(){let U=[];for(let Y=this;Y;Y=Y.parent)U.push(Y);return U}command(U,Y,_){let $=Y,z=_;if(typeof $==="object"&&$!==null)z=$,$=null;z=z||{};let[,J,X]=U.match(/([^ ]+) *(.*)/),Q=this.createCommand(J);if($)Q.description($),Q._executableHandler=!0;if(z.isDefault)this._defaultCommandName=Q._name;if(Q._hidden=!!(z.noHelp||z.hidden),Q._executableFile=z.executableFile||null,X)Q.arguments(X);if(this.commands.push(Q),Q.parent=this,Q.copyInheritedSettings(this),$)return this;return Q}createCommand(U){return new K8(U)}createHelp(){return Object.assign(new n0,this.configureHelp())}configureHelp(U){if(U===void 0)return this._helpConfiguration;return this._helpConfiguration=U,this}configureOutput(U){if(U===void 0)return this._outputConfiguration;return Object.assign(this._outputConfiguration,U),this}showHelpAfterError(U=!0){if(typeof U!=="string")U=!!U;return this._showHelpAfterError=U,this}showSuggestionAfterError(U=!0){return this._showSuggestionAfterError=!!U,this}addCommand(U,Y){if(!U._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);if(Y=Y||{},Y.isDefault)this._defaultCommandName=U._name;if(Y.noHelp||Y.hidden)U._hidden=!0;return this.commands.push(U),U.parent=this,this}createArgument(U,Y){return new p0(U,Y)}argument(U,Y,_,$){let z=this.createArgument(U,Y);if(typeof _==="function")z.default($).argParser(_);else z.default(_);return this.addArgument(z),this}arguments(U){return U.trim().split(/ +/).forEach((Y)=>{this.argument(Y)}),this}addArgument(U){let Y=this.registeredArguments.slice(-1)[0];if(Y&&Y.variadic)throw new Error(`only the last argument can be variadic '${Y.name()}'`);if(U.required&&U.defaultValue!==void 0&&U.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${U.name()}'`);return this.registeredArguments.push(U),this}addHelpCommand(U,Y){if(U===!1)this._addImplicitHelpCommand=!1;else{if(this._addImplicitHelpCommand=!0,typeof U==="string")this._helpCommandName=U.split(" ")[0],this._helpCommandnameAndArgs=U;this._helpCommandDescription=Y||this._helpCommandDescription}return this}_hasImplicitHelpCommand(){if(this._addImplicitHelpCommand===void 0)return this.commands.length&&!this._actionHandler&&!this._findCommand("help");return this._addImplicitHelpCommand}hook(U,Y){let _=["preSubcommand","preAction","postAction"];if(!_.includes(U))throw new Error(`Unexpected value for event passed to hook : '${U}'.
Expecting one of '${_.join("', '")}'`);if(this._lifeCycleHooks[U])this._lifeCycleHooks[U].push(Y);else this._lifeCycleHooks[U]=[Y];return this}exitOverride(U){if(U)this._exitCallback=U;else this._exitCallback=(Y)=>{if(Y.code!=="commander.executeSubCommandAsync")throw Y};return this}_exit(U,Y,_){if(this._exitCallback)this._exitCallback(new L8(U,Y,_));L.exit(U)}action(U){let Y=(_)=>{let $=this.registeredArguments.length,z=_.slice(0,$);if(this._storeOptionsAsProperties)z[$]=this;else z[$]=this.opts();return z.push(this),U.apply(this,z)};return this._actionHandler=Y,this}createOption(U,Y){return new g8(U,Y)}_callParseArg(U,Y,_,$){try{return U.parseArg(Y,_)}catch(z){if(z.code==="commander.invalidArgument"){let J=`${$} ${z.message}`;this.error(J,{exitCode:z.exitCode,code:z.code})}throw z}}addOption(U){let Y=U.name(),_=U.attributeName();if(U.negate){let z=U.long.replace(/^--no-/,"--");if(!this._findOption(z))this.setOptionValueWithSource(_,U.defaultValue===void 0?!0:U.defaultValue,"default")}else if(U.defaultValue!==void 0)this.setOptionValueWithSource(_,U.defaultValue,"default");this.options.push(U);let $=(z,J,X)=>{if(z==null&&U.presetArg!==void 0)z=U.presetArg;let Q=this.getOptionValue(_);if(z!==null&&U.parseArg)z=this._callParseArg(U,z,Q,J);else if(z!==null&&U.variadic)z=U._concatValue(z,Q);if(z==null)if(U.negate)z=!1;else if(U.isBoolean()||U.optional)z=!0;else z="";this.setOptionValueWithSource(_,z,X)};if(this.on("option:"+Y,(z)=>{let J=`error: option '${U.flags}' argument '${z}' is invalid.`;$(z,J,"cli")}),U.envVar)this.on("optionEnv:"+Y,(z)=>{let J=`error: option '${U.flags}' value '${z}' from env '${U.envVar}' is invalid.`;$(z,J,"env")});return this}_optionEx(U,Y,_,$,z){if(typeof Y==="object"&&Y instanceof g8)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let J=this.createOption(Y,_);if(J.makeOptionMandatory(!!U.mandatory),typeof $==="function")J.default(z).argParser($);else if($ instanceof RegExp){let X=$;$=(Q,Z)=>{let G=X.exec(Q);return G?G[0]:Z},J.default(z).argParser($)}else J.default($);return this.addOption(J)}option(U,Y,_,$){return this._optionEx({},U,Y,_,$)}requiredOption(U,Y,_,$){return this._optionEx({mandatory:!0},U,Y,_,$)}combineFlagAndOptionalValue(U=!0){return this._combineFlagAndOptionalValue=!!U,this}allowUnknownOption(U=!0){return this._allowUnknownOption=!!U,this}allowExcessArguments(U=!0){return this._allowExcessArguments=!!U,this}enablePositionalOptions(U=!0){return this._enablePositionalOptions=!!U,this}passThroughOptions(U=!0){if(this._passThroughOptions=!!U,!!this.parent&&U&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties(U=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this._storeOptionsAsProperties=!!U,this}getOptionValue(U){if(this._storeOptionsAsProperties)return this[U];return this._optionValues[U]}setOptionValue(U,Y){return this.setOptionValueWithSource(U,Y,void 0)}setOptionValueWithSource(U,Y,_){if(this._storeOptionsAsProperties)this[U]=Y;else this._optionValues[U]=Y;return this._optionValueSources[U]=_,this}getOptionValueSource(U){return this._optionValueSources[U]}getOptionValueSourceWithGlobals(U){let Y;return this._getCommandAndAncestors().forEach((_)=>{if(_.getOptionValueSource(U)!==void 0)Y=_.getOptionValueSource(U)}),Y}_prepareUserArgs(U,Y){if(U!==void 0&&!Array.isArray(U))throw new Error("first parameter to parse must be array or undefined");if(Y=Y||{},U===void 0){if(U=L.argv,L.versions&&L.versions.electron)Y.from="electron"}this.rawArgs=U.slice();let _;switch(Y.from){case void 0:case"node":this._scriptPath=U[1],_=U.slice(2);break;case"electron":if(L.defaultApp)this._scriptPath=U[1],_=U.slice(2);else _=U.slice(1);break;case"user":_=U.slice(0);break;default:throw new Error(`unexpected parse option { from: '${Y.from}' }`)}if(!this._name&&this._scriptPath)this.nameFromFilename(this._scriptPath);return this._name=this._name||"program",_}parse(U,Y){let _=this._prepareUserArgs(U,Y);return this._parseCommand([],_),this}async parseAsync(U,Y){let _=this._prepareUserArgs(U,Y);return await this._parseCommand([],_),this}_executeSubCommand(U,Y){Y=Y.slice();let _=!1,$=[".js",".ts",".tsx",".mjs",".cjs"];function z(G,T){let M=F.resolve(G,T);if(B8.existsSync(M))return M;if($.includes(F.extname(T)))return;let W=$.find((B)=>B8.existsSync(`${M}${B}`));if(W)return`${M}${W}`;return}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let J=U._executableFile||`${this._name}-${U._name}`,X=this._executableDir||"";if(this._scriptPath){let G;try{G=B8.realpathSync(this._scriptPath)}catch(T){G=this._scriptPath}X=F.resolve(F.dirname(G),X)}if(X){let G=z(X,J);if(!G&&!U._executableFile&&this._scriptPath){let T=F.basename(this._scriptPath,F.extname(this._scriptPath));if(T!==this._name)G=z(X,`${T}-${U._name}`)}J=G||J}_=$.includes(F.extname(J));let Q;if(L.platform!=="win32")if(_)Y.unshift(J),Y=m8(L.execArgv).concat(Y),Q=W8.spawn(L.argv[0],Y,{stdio:"inherit"});else Q=W8.spawn(J,Y,{stdio:"inherit"});else Y.unshift(J),Y=m8(L.execArgv).concat(Y),Q=W8.spawn(L.execPath,Y,{stdio:"inherit"});if(!Q.killed)["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach((T)=>{L.on(T,()=>{if(Q.killed===!1&&Q.exitCode===null)Q.kill(T)})});let Z=this._exitCallback;if(!Z)Q.on("close",L.exit.bind(L));else Q.on("close",()=>{Z(new L8(L.exitCode||0,"commander.executeSubCommandAsync","(close)"))});Q.on("error",(G)=>{if(G.code==="ENOENT"){let T=X?`searched for local subcommand relative to directory '${X}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",M=`'${J}' does not exist
 - if '${U._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${T}`;throw new Error(M)}else if(G.code==="EACCES")throw new Error(`'${J}' not executable`);if(!Z)L.exit(1);else{let T=new L8(1,"commander.executeSubCommandAsync","(error)");T.nestedError=G,Z(T)}}),this.runningCommand=Q}_dispatchSubcommand(U,Y,_){let $=this._findCommand(U);if(!$)this.help({error:!0});let z;return z=this._chainOrCallSubCommandHook(z,$,"preSubcommand"),z=this._chainOrCall(z,()=>{if($._executableHandler)this._executeSubCommand($,Y.concat(_));else return $._parseCommand(Y,_)}),z}_dispatchHelpCommand(U){if(!U)this.help();let Y=this._findCommand(U);if(Y&&!Y._executableHandler)Y.help();return this._dispatchSubcommand(U,[],[this._helpLongFlag||this._helpShortFlag])}_checkNumberOfArguments(){if(this.registeredArguments.forEach((U,Y)=>{if(U.required&&this.args[Y]==null)this.missingArgument(U.name())}),this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)return;if(this.args.length>this.registeredArguments.length)this._excessArguments(this.args)}_processArguments(){let U=(_,$,z)=>{let J=$;if($!==null&&_.parseArg){let X=`error: command-argument value '${$}' is invalid for argument '${_.name()}'.`;J=this._callParseArg(_,$,z,X)}return J};this._checkNumberOfArguments();let Y=[];this.registeredArguments.forEach((_,$)=>{let z=_.defaultValue;if(_.variadic){if($<this.args.length){if(z=this.args.slice($),_.parseArg)z=z.reduce((J,X)=>{return U(_,X,J)},_.defaultValue)}else if(z===void 0)z=[]}else if($<this.args.length){if(z=this.args[$],_.parseArg)z=U(_,z,_.defaultValue)}Y[$]=z}),this.processedArgs=Y}_chainOrCall(U,Y){if(U&&U.then&&typeof U.then==="function")return U.then(()=>Y());return Y()}_chainOrCallHooks(U,Y){let _=U,$=[];if(this._getCommandAndAncestors().reverse().filter((z)=>z._lifeCycleHooks[Y]!==void 0).forEach((z)=>{z._lifeCycleHooks[Y].forEach((J)=>{$.push({hookedCommand:z,callback:J})})}),Y==="postAction")$.reverse();return $.forEach((z)=>{_=this._chainOrCall(_,()=>{return z.callback(z.hookedCommand,this)})}),_}_chainOrCallSubCommandHook(U,Y,_){let $=U;if(this._lifeCycleHooks[_]!==void 0)this._lifeCycleHooks[_].forEach((z)=>{$=this._chainOrCall($,()=>{return z(this,Y)})});return $}_parseCommand(U,Y){let _=this.parseOptions(Y);if(this._parseOptionsEnv(),this._parseOptionsImplied(),U=U.concat(_.operands),Y=_.unknown,this.args=U.concat(Y),U&&this._findCommand(U[0]))return this._dispatchSubcommand(U[0],U.slice(1),Y);if(this._hasImplicitHelpCommand()&&U[0]===this._helpCommandName)return this._dispatchHelpCommand(U[1]);if(this._defaultCommandName)return l8(this,Y),this._dispatchSubcommand(this._defaultCommandName,U,Y);if(this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName)this.help({error:!0});l8(this,_.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let $=()=>{if(_.unknown.length>0)this.unknownOption(_.unknown[0])},z=`command:${this.name()}`;if(this._actionHandler){$(),this._processArguments();let J;if(J=this._chainOrCallHooks(J,"preAction"),J=this._chainOrCall(J,()=>this._actionHandler(this.processedArgs)),this.parent)J=this._chainOrCall(J,()=>{this.parent.emit(z,U,Y)});return J=this._chainOrCallHooks(J,"postAction"),J}if(this.parent&&this.parent.listenerCount(z))$(),this._processArguments(),this.parent.emit(z,U,Y);else if(U.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",U,Y);if(this.listenerCount("command:*"))this.emit("command:*",U,Y);else if(this.commands.length)this.unknownCommand();else $(),this._processArguments()}else if(this.commands.length)$(),this.help({error:!0});else $(),this._processArguments()}_findCommand(U){if(!U)return;return this.commands.find((Y)=>Y._name===U||Y._aliases.includes(U))}_findOption(U){return this.options.find((Y)=>Y.is(U))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach((U)=>{U.options.forEach((Y)=>{if(Y.mandatory&&U.getOptionValue(Y.attributeName())===void 0)U.missingMandatoryOptionValue(Y)})})}_checkForConflictingLocalOptions(){let U=this.options.filter((_)=>{let $=_.attributeName();if(this.getOptionValue($)===void 0)return!1;return this.getOptionValueSource($)!=="default"});U.filter((_)=>_.conflictsWith.length>0).forEach((_)=>{let $=U.find((z)=>_.conflictsWith.includes(z.attributeName()));if($)this._conflictingOption(_,$)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach((U)=>{U._checkForConflictingLocalOptions()})}parseOptions(U){let Y=[],_=[],$=Y,z=U.slice();function J(Q){return Q.length>1&&Q[0]==="-"}let X=null;while(z.length){let Q=z.shift();if(Q==="--"){if($===_)$.push(Q);$.push(...z);break}if(X&&!J(Q)){this.emit(`option:${X.name()}`,Q);continue}if(X=null,J(Q)){let Z=this._findOption(Q);if(Z){if(Z.required){let G=z.shift();if(G===void 0)this.optionMissingArgument(Z);this.emit(`option:${Z.name()}`,G)}else if(Z.optional){let G=null;if(z.length>0&&!J(z[0]))G=z.shift();this.emit(`option:${Z.name()}`,G)}else this.emit(`option:${Z.name()}`);X=Z.variadic?Z:null;continue}}if(Q.length>2&&Q[0]==="-"&&Q[1]!=="-"){let Z=this._findOption(`-${Q[1]}`);if(Z){if(Z.required||Z.optional&&this._combineFlagAndOptionalValue)this.emit(`option:${Z.name()}`,Q.slice(2));else this.emit(`option:${Z.name()}`),z.unshift(`-${Q.slice(2)}`);continue}}if(/^--[^=]+=/.test(Q)){let Z=Q.indexOf("="),G=this._findOption(Q.slice(0,Z));if(G&&(G.required||G.optional)){this.emit(`option:${G.name()}`,Q.slice(Z+1));continue}}if(J(Q))$=_;if((this._enablePositionalOptions||this._passThroughOptions)&&Y.length===0&&_.length===0){if(this._findCommand(Q)){if(Y.push(Q),z.length>0)_.push(...z);break}else if(Q===this._helpCommandName&&this._hasImplicitHelpCommand()){if(Y.push(Q),z.length>0)Y.push(...z);break}else if(this._defaultCommandName){if(_.push(Q),z.length>0)_.push(...z);break}}if(this._passThroughOptions){if($.push(Q),z.length>0)$.push(...z);break}$.push(Q)}return{operands:Y,unknown:_}}opts(){if(this._storeOptionsAsProperties){let U={},Y=this.options.length;for(let _=0;_<Y;_++){let $=this.options[_].attributeName();U[$]=$===this._versionOptionName?this._version:this[$]}return U}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((U,Y)=>Object.assign(U,Y.opts()),{})}error(U,Y){if(this._outputConfiguration.outputError(`${U}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError==="string")this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`);else if(this._showHelpAfterError)this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0});let _=Y||{},$=_.exitCode||1,z=_.code||"commander.error";this._exit($,z,U)}_parseOptionsEnv(){this.options.forEach((U)=>{if(U.envVar&&U.envVar in L.env){let Y=U.attributeName();if(this.getOptionValue(Y)===void 0||["default","config","env"].includes(this.getOptionValueSource(Y)))if(U.required||U.optional)this.emit(`optionEnv:${U.name()}`,L.env[U.envVar]);else this.emit(`optionEnv:${U.name()}`)}})}_parseOptionsImplied(){let U=new r0(this.options),Y=(_)=>{return this.getOptionValue(_)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(_))};this.options.filter((_)=>_.implied!==void 0&&Y(_.attributeName())&&U.valueFromOption(this.getOptionValue(_.attributeName()),_)).forEach((_)=>{Object.keys(_.implied).filter(($)=>!Y($)).forEach(($)=>{this.setOptionValueWithSource($,_.implied[$],"implied")})})}missingArgument(U){let Y=`error: missing required argument '${U}'`;this.error(Y,{code:"commander.missingArgument"})}optionMissingArgument(U){let Y=`error: option '${U.flags}' argument missing`;this.error(Y,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(U){let Y=`error: required option '${U.flags}' not specified`;this.error(Y,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(U,Y){let _=(J)=>{let X=J.attributeName(),Q=this.getOptionValue(X),Z=this.options.find((T)=>T.negate&&X===T.attributeName()),G=this.options.find((T)=>!T.negate&&X===T.attributeName());if(Z&&(Z.presetArg===void 0&&Q===!1||Z.presetArg!==void 0&&Q===Z.presetArg))return Z;return G||J},$=(J)=>{let X=_(J),Q=X.attributeName();if(this.getOptionValueSource(Q)==="env")return`environment variable '${X.envVar}'`;return`option '${X.flags}'`},z=`error: ${$(U)} cannot be used with ${$(Y)}`;this.error(z,{code:"commander.conflictingOption"})}unknownOption(U){if(this._allowUnknownOption)return;let Y="";if(U.startsWith("--")&&this._showSuggestionAfterError){let $=[],z=this;do{let J=z.createHelp().visibleOptions(z).filter((X)=>X.long).map((X)=>X.long);$=$.concat(J),z=z.parent}while(z&&!z._enablePositionalOptions);Y=c8(U,$)}let _=`error: unknown option '${U}'${Y}`;this.error(_,{code:"commander.unknownOption"})}_excessArguments(U){if(this._allowExcessArguments)return;let Y=this.registeredArguments.length,_=Y===1?"":"s",z=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${Y} argument${_} but got ${U.length}.`;this.error(z,{code:"commander.excessArguments"})}unknownCommand(){let U=this.args[0],Y="";if(this._showSuggestionAfterError){let $=[];this.createHelp().visibleCommands(this).forEach((z)=>{if($.push(z.name()),z.alias())$.push(z.alias())}),Y=c8(U,$)}let _=`error: unknown command '${U}'${Y}`;this.error(_,{code:"commander.unknownCommand"})}version(U,Y,_){if(U===void 0)return this._version;this._version=U,Y=Y||"-V, --version",_=_||"output the version number";let $=this.createOption(Y,_);return this._versionOptionName=$.attributeName(),this.options.push($),this.on("option:"+$.name(),()=>{this._outputConfiguration.writeOut(`${U}
`),this._exit(0,"commander.version",U)}),this}description(U,Y){if(U===void 0&&Y===void 0)return this._description;if(this._description=U,Y)this._argsDescription=Y;return this}summary(U){if(U===void 0)return this._summary;return this._summary=U,this}alias(U){if(U===void 0)return this._aliases[0];let Y=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler)Y=this.commands[this.commands.length-1];if(U===Y._name)throw new Error("Command alias can't be the same as its name");return Y._aliases.push(U),this}aliases(U){if(U===void 0)return this._aliases;return U.forEach((Y)=>this.alias(Y)),this}usage(U){if(U===void 0){if(this._usage)return this._usage;let Y=this.registeredArguments.map((_)=>{return i0(_)});return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?Y:[]).join(" ")}return this._usage=U,this}name(U){if(U===void 0)return this._name;return this._name=U,this}nameFromFilename(U){return this._name=F.basename(U,F.extname(U)),this}executableDir(U){if(U===void 0)return this._executableDir;return this._executableDir=U,this}helpInformation(U){let Y=this.createHelp();if(Y.helpWidth===void 0)Y.helpWidth=U&&U.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth();return Y.formatHelp(this,Y)}_getHelpContext(U){U=U||{};let Y={error:!!U.error},_;if(Y.error)_=($)=>this._outputConfiguration.writeErr($);else _=($)=>this._outputConfiguration.writeOut($);return Y.write=U.write||_,Y.command=this,Y}outputHelp(U){let Y;if(typeof U==="function")Y=U,U=void 0;let _=this._getHelpContext(U);this._getCommandAndAncestors().reverse().forEach((z)=>z.emit("beforeAllHelp",_)),this.emit("beforeHelp",_);let $=this.helpInformation(_);if(Y){if($=Y($),typeof $!=="string"&&!Buffer.isBuffer($))throw new Error("outputHelp callback must return a string or a Buffer")}if(_.write($),this._helpLongFlag)this.emit(this._helpLongFlag);this.emit("afterHelp",_),this._getCommandAndAncestors().forEach((z)=>z.emit("afterAllHelp",_))}helpOption(U,Y){if(typeof U==="boolean")return this._hasHelpOption=U,this;this._helpFlags=U||this._helpFlags,this._helpDescription=Y||this._helpDescription;let _=s0(this._helpFlags);return this._helpShortFlag=_.shortFlag,this._helpLongFlag=_.longFlag,this}help(U){this.outputHelp(U);let Y=L.exitCode||0;if(Y===0&&U&&typeof U!=="function"&&U.error)Y=1;this._exit(Y,"commander.help","(outputHelp)")}addHelpText(U,Y){let _=["beforeAll","before","after","afterAll"];if(!_.includes(U))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${_.join("', '")}'`);let $=`${U}Help`;return this.on($,(z)=>{let J;if(typeof Y==="function")J=Y({error:z.error,command:z.command});else J=Y;if(J)z.write(`${J}
`)}),this}}function l8(U,Y){if(U._hasHelpOption&&Y.find(($)=>$===U._helpLongFlag||$===U._helpShortFlag))U.outputHelp(),U._exit(0,"commander.helpDisplayed","(outputHelp)")}function m8(U){return U.map((Y)=>{if(!Y.startsWith("--inspect"))return Y;let _,$="127.0.0.1",z="9229",J;if((J=Y.match(/^(--inspect(-brk)?)$/))!==null)_=J[1];else if((J=Y.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null)if(_=J[1],/^\d+$/.test(J[3]))z=J[3];else $=J[3];else if((J=Y.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null)_=J[1],$=J[3],z=J[4];if(_&&z!=="0")return`${_}=${$}:${parseInt(z)+1}`;return Y})}d8.Command=K8});var r8=H((S,s8)=>{var{Argument:o0}=s(),{Command:i8}=p8(),{CommanderError:a0,InvalidArgumentError:n8}=g(),{Help:t0}=T8(),{Option:e0}=M8();S=s8.exports=new i8;S.program=S;S.Command=i8;S.Option=e0;S.Argument=o0;S.Help=t0;S.CommanderError=a0;S.InvalidArgumentError=n8;S.InvalidOptionArgumentError=n8});var Y0=H((iU,U0)=>{var t=/^[a-z0-9-]{1,32}$/,e=/^[a-z0-9-]{1,32}$/,U8=/^[a-zA-Z0-9/+.-]+$/,t8=/^([a-zA-Z0-9/+.-]+|)$/,UU=/^((-)?[1-9]\d*|0)$/,H8=/^v=(\d+)$/;function YU(U){return l(U).map((Y)=>[Y,U[Y]].join("=")).join(",")}function _U(U){let Y={};return U.split(",").forEach((_)=>{let $=_.split("=");if($.length<2)throw new TypeError("params must be in the format name=value");Y[$.shift()]=$.join("=")}),Y}function l(U){return Object.keys(U)}function e8(U){if(typeof Object.values==="function")return Object.values(U);return l(U).map((Y)=>U[Y])}function $U(U){let Y=[""];if(typeof U!=="object"||U===null)throw new TypeError("opts must be an object");if(typeof U.id!=="string")throw new TypeError("id must be a string");if(!t.test(U.id))throw new TypeError(`id must satisfy ${t}`);if(Y.push(U.id),typeof U.version!=="undefined"){if(typeof U.version!=="number"||U.version<0||!Number.isInteger(U.version))throw new TypeError("version must be a positive integer number");Y.push(`v=${U.version}`)}if(typeof U.params!=="undefined"){if(typeof U.params!=="object"||U.params===null)throw new TypeError("params must be an object");let $=l(U.params);if(!$.every((X)=>e.test(X)))throw new TypeError(`params names must satisfy ${e}`);$.forEach((X)=>{if(typeof U.params[X]==="number")U.params[X]=U.params[X].toString();else if(Buffer.isBuffer(U.params[X]))U.params[X]=U.params[X].toString("base64").split("=")[0]});let z=e8(U.params);if(!z.every((X)=>typeof X==="string"))throw new TypeError("params values must be strings");if(!z.every((X)=>U8.test(X)))throw new TypeError(`params values must satisfy ${U8}`);let J=YU(U.params);Y.push(J)}if(typeof U.salt!=="undefined"){if(!Buffer.isBuffer(U.salt))throw new TypeError("salt must be a Buffer");if(Y.push(U.salt.toString("base64").split("=")[0]),typeof U.hash!=="undefined"){if(!Buffer.isBuffer(U.hash))throw new TypeError("hash must be a Buffer");Y.push(U.hash.toString("base64").split("=")[0])}}return Y.join("$")}function zU(U){if(typeof U!=="string"||U==="")throw new TypeError("pchstr must be a non-empty string");if(U[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let Y=U.split("$");Y.shift();let _=5;if(!H8.test(Y[1]))_--;if(Y.length>_)throw new TypeError(`pchstr contains too many fileds: ${Y.length}/${_}`);let $=Y.shift();if(!t.test($))throw new TypeError(`id must satisfy ${t}`);let z;if(H8.test(Y[0]))z=parseInt(Y.shift().match(H8)[1],10);let J,X;if(t8.test(Y[Y.length-1]))if(Y.length>1&&t8.test(Y[Y.length-2]))J=Buffer.from(Y.pop(),"base64"),X=Buffer.from(Y.pop(),"base64");else X=Buffer.from(Y.pop(),"base64");let Q;if(Y.length>0){let G=Y.pop();if(Q=_U(G),!l(Q).every((W)=>e.test(W)))throw new TypeError(`params names must satisfy ${e}`);if(!e8(Q).every((W)=>U8.test(W)))throw new TypeError(`params values must satisfy ${U8}`);l(Q).forEach((W)=>{Q[W]=UU.test(Q[W])?parseInt(Q[W],10):Q[W]})}if(Y.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${Y}`);let Z={id:$};if(z)Z.version=z;if(Q)Z.params=Q;if(X)Z.salt=X;if(J)Z.hash=J;return Z}U0.exports={serialize:$U,deserialize:zU}});var P0=H((nU,K0)=>{var J0=require("fs"),A=require("path"),Q0=require("os"),X0=typeof __webpack_require__==="function"?__non_webpack_require__:require,JU=process.config&&process.config.variables||{},QU=!!process.env.PREBUILDS_ONLY,_0=process.versions.modules,S8=GU()?"electron":ZU()?"node-webkit":"node",I8=process.env.npm_config_arch||Q0.arch(),V8=process.env.npm_config_platform||Q0.platform(),Z0=process.env.LIBC||(qU(V8)?"musl":"glibc"),D8=process.env.ARM_VERSION||(I8==="arm64"?"8":JU.arm_version)||"",G0=(process.versions.uv||"").split(".")[0];K0.exports=N;function N(U){return X0(N.resolve(U))}N.resolve=N.path=function(U){U=A.resolve(U||".");try{var Y=X0(A.join(U,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[Y+"_PREBUILD"])U=process.env[Y+"_PREBUILD"]}catch(Z){}if(!QU){var _=$0(A.join(U,"build/Release"),z0);if(_)return _;var $=$0(A.join(U,"build/Debug"),z0);if($)return $}var z=Q(U);if(z)return z;var J=Q(A.dirname(process.execPath));if(J)return J;var X=["platform="+V8,"arch="+I8,"runtime="+S8,"abi="+_0,"uv="+G0,D8?"armv="+D8:"","libc="+Z0,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+X+`
    loaded from: `+U+`
`);function Q(Z){var G=N8(A.join(Z,"prebuilds")).map(q0),T=G.filter(T0(V8,I8)).sort(M0)[0];if(!T)return;var M=A.join(Z,"prebuilds",T.name),W=N8(M).map(W0),B=W.filter(B0(S8,_0)),K=B.sort(L0(S8))[0];if(K)return A.join(M,K.file)}};function N8(U){try{return J0.readdirSync(U)}catch(Y){return[]}}function $0(U,Y){var _=N8(U).filter(Y);return _[0]&&A.join(U,_[0])}function z0(U){return/\.node$/.test(U)}function q0(U){var Y=U.split("-");if(Y.length!==2)return;var _=Y[0],$=Y[1].split("+");if(!_)return;if(!$.length)return;if(!$.every(Boolean))return;return{name:U,platform:_,architectures:$}}function T0(U,Y){return function(_){if(_==null)return!1;if(_.platform!==U)return!1;return _.architectures.includes(Y)}}function M0(U,Y){return U.architectures.length-Y.architectures.length}function W0(U){var Y=U.split("."),_=Y.pop(),$={file:U,specificity:0};if(_!=="node")return;for(var z=0;z<Y.length;z++){var J=Y[z];if(J==="node"||J==="electron"||J==="node-webkit")$.runtime=J;else if(J==="napi")$.napi=!0;else if(J.slice(0,3)==="abi")$.abi=J.slice(3);else if(J.slice(0,2)==="uv")$.uv=J.slice(2);else if(J.slice(0,4)==="armv")$.armv=J.slice(4);else if(J==="glibc"||J==="musl")$.libc=J;else continue;$.specificity++}return $}function B0(U,Y){return function(_){if(_==null)return!1;if(_.runtime&&_.runtime!==U&&!XU(_))return!1;if(_.abi&&_.abi!==Y&&!_.napi)return!1;if(_.uv&&_.uv!==G0)return!1;if(_.armv&&_.armv!==D8)return!1;if(_.libc&&_.libc!==Z0)return!1;return!0}}function XU(U){return U.runtime==="node"&&U.napi}function L0(U){return function(Y,_){if(Y.runtime!==_.runtime)return Y.runtime===U?-1:1;else if(Y.abi!==_.abi)return Y.abi?-1:1;else if(Y.specificity!==_.specificity)return Y.specificity>_.specificity?-1:1;else return 0}}function ZU(){return!!(process.versions&&process.versions.nw)}function GU(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function qU(U){return U==="linux"&&J0.existsSync("/etc/alpine-release")}N.parseTags=W0;N.matchTags=B0;N.compareTags=L0;N.parseTuple=q0;N.matchTuple=T0;N.compareTuples=M0});var R0=H((sU,E8)=>{var F8=typeof __webpack_require__==="function"?__non_webpack_require__:require;if(typeof F8.addon==="function")E8.exports=F8.addon.bind(F8);else E8.exports=P0()});var V0=H((oU,k)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",rU=require("node:assert"),{randomBytes:TU,timingSafeEqual:MU}=require("node:crypto"),{promisify:WU}=require("node:util"),{deserialize:H0,serialize:BU}=Y0(),LU=R0(),{hash:S0}=LU(__dirname),KU=WU(TU);k.exports.argon2d=0;k.exports.argon2i=1;k.exports.argon2id=2;var m=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),PU=Object.freeze({[m.argon2d]:"argon2d",[m.argon2i]:"argon2i",[m.argon2id]:"argon2id"}),I0={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function RU(U,Y){let{raw:_,salt:$,...z}={...I0,...Y};if(z.hashLength>4294967295)throw new RangeError("Hash length is too large");if(z.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(z.timeCost>4294967295)throw new RangeError("Time cost is too large");if(z.parallelism>16777215)throw new RangeError("Parallelism is too large");$=$??await KU(16);let{hashLength:J,secret:X=Buffer.alloc(0),type:Q,version:Z,memoryCost:G,timeCost:T,parallelism:M,associatedData:W=Buffer.alloc(0)}=z,B=await S0({password:Buffer.from(U),salt:$,secret:X,data:W,hashLength:J,m:G,t:T,p:M,version:Z,type:Q});if(_)return B;return BU({id:PU[Q],version:Z,params:{m:G,t:T,p:M,...W.byteLength>0?{data:W}:{}},salt:$,hash:B})}k.exports.hash=RU;function HU(U,Y={}){let{memoryCost:_,timeCost:$,parallelism:z,version:J}={...I0,...Y},{version:X,params:{m:Q,t:Z,p:G}}=H0(U);return+X!==+J||+Q!==+_||+Z!==+$||+G!==+z}k.exports.needsRehash=HU;async function SU(U,Y,_={}){let{id:$,...z}=H0(U);if(!($ in m))return!1;let{version:J=16,params:{m:X,t:Q,p:Z,data:G=""},salt:T,hash:M}=z,{secret:W=Buffer.alloc(0)}=_;return MU(await S0({password:Buffer.from(Y),salt:T,secret:W,data:Buffer.from(G,"base64"),hashLength:M.byteLength,m:+X,t:+Q,p:+Z,version:+J,type:m[$]}),M)}k.exports.verify=SU});var o8=X8(r8()),{program:kU,createCommand:CU,createArgument:OU,createOption:xU,CommanderError:fU,InvalidArgumentError:vU,InvalidOptionArgumentError:bU,Command:a8,Argument:hU,Option:x,Help:uU}=o8.default;var O=require("node:fs"),u=require("node:fs"),q=require("node:process"),J8=require("node:stream"),w0=require("node:fs/promises");class E extends Error{constructor(U){super(U);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class j extends E{}class c extends E{}class P8 extends E{}class o extends E{}class f extends E{}class w extends E{}class a extends E{}class I extends E{}class P{static byId=new Map;static register(U){if(this.byId.has(U.id))throw new o(`Version ${U.id} already registered`);this.byId.set(U.id,U)}static get(U){let Y=this.byId.get(U);if(!Y)throw new o(`Unknown version: ${U}`);return Y}static get current(){return this.get(0)}}class R8{p;key;constructor(U){this.p=U}setKey(U){this.key=U}async encryptChunk(U){let Y=this.p.getRandomValues(new Uint8Array(12)),_=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:Y},this.key,U)),$=new Uint8Array(Y.length+_.length);return $.set(Y),$.set(_,Y.length),$}async decryptChunk(U){let Y=U.slice(0,12),_=U.slice(12),$=await this.p.subtle.decrypt({name:"AES-GCM",iv:Y},this.key,_);try{let z=await this.p.subtle.decrypt({name:"AES-GCM",iv:Y},this.key,_);return new Uint8Array(z)}catch{throw new I("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var Y8=X8(require("argon2-browser"));async function D0(U,Y,_,$){if($==="node"){let z=await Promise.resolve().then(() => X8(V0())),J=typeof U==="string"?Buffer.from(U,"utf8"):Buffer.from(U),X=Buffer.from(Y),Q=await z.hash(J,{salt:X,timeCost:_.time,memoryCost:_.mem,parallelism:_.parallelism,hashLength:32,raw:!0,type:z.argon2id});return{hash:new Uint8Array(Q)}}if($==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>{let z=new URL("argon2.wasm",import.meta.url).href;return fetch(z).then((J)=>{if(!J.ok)throw new Error("Failed to load argon2.wasm");return J.arrayBuffer()}).then((J)=>new Uint8Array(J))};return Y8.hash({pass:U,salt:Y,time:_.time,mem:_.mem,parallelism:_.parallelism,hashLen:32,type:Y8.ArgonType.Argon2id}).then((z)=>{if(!z||!z.hash)throw new Error("Failed to produce key derivation");return{hash:z.hash}}).catch((z)=>{let J=z instanceof Error?z.message:typeof z==="string"?z:"Unknown error";throw new w(`argon2-browser failure: ${J}`)})}throw new Error(`Unsupported environment: ${$}`)}class A8{presets;name="argon2id";constructor(U){this.presets=U}async derive(U,Y,_,$){let{hash:z}=await D0(U,Y,this.presets[_],$.isNode?"node":"browser");return $.subtle.importKey("raw",z,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var N0={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},IU={id:0,cipher:R8,kdf:new A8(N0),saltLengths:{low:12,high:16},difficulties:N0,defaultChunkSize:524288};P.register(IU);var _8=1;function F0(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function d(...U){let Y=U.reduce((z,J)=>z+J.byteLength,0),_=new Uint8Array(Y),$=0;for(let z of U)_.set(z,$),$+=z.byteLength;return _}function p(...U){try{let Y=d(...U);if(F0())return Buffer.from(Y).toString("base64");let _="";for(let $=0;$<Y.length;$++)_+=String.fromCharCode(Y[$]);return btoa(_)}catch(Y){throw new P8("Base64 Enconding Error")}}function j8(U){try{if(!/^[A-Za-z0-9+/]+={0,2}$/.test(U)||U.length%4!==0)throw new Error("invalid base64");if(F0())return new Uint8Array(Buffer.from(U,"base64"));let Y=atob(U),_=new Uint8Array(Y.length);for(let $=0;$<Y.length;$++)_[$]=Y.charCodeAt($);return _}catch(Y){throw new c("Base64 Decoding Error")}}function $8(U,Y,_,$){let z={low:0,middle:1,high:2}[Y]??0,J=U<<5|(_==="high"?1:0)<<2|z;return d(new Uint8Array([_8,J]),$)}function C(U){if(U[0]!==_8)throw new j("Invalid input format. The input is unknown.");try{let Y=U[1],_=Y>>5,$=Y>>2&1?"high":"low",z=Y&3,J=["low","middle","high"][z],X=P.get(_).saltLengths[$],Q=U.slice(2,2+X);return{version:_,difficulty:J,saltStrength:$,salt:Q,headerLen:2+X}}catch(Y){throw new f(Y instanceof Error?Y.message:String(Y))}}class i{engine;chunkSize;buffer=new Uint8Array(0);constructor(U,Y=524288){this.engine=U;this.chunkSize=Y}toTransformStream(){return new TransformStream({transform:async(U,Y)=>{await this.transform(await this.asUint8Array(U),Y)},flush:async(U)=>this.flush(U)})}async transform(U,Y){let _=new Uint8Array(this.buffer.length+U.length);_.set(this.buffer),_.set(U,this.buffer.length);let $=0;while(_.length-$>=this.chunkSize){let z=_.slice($,$+this.chunkSize);$+=this.chunkSize;let J=await this.engine.encryptChunk(z),X=new Uint8Array(4);new DataView(X.buffer).setUint32(0,J.length,!1);let Q=new Uint8Array(4+J.length);Q.set(X),Q.set(J,X.length),Y.enqueue(Q)}this.buffer=_.slice($)}async flush(U){if(!this.buffer.length)return;let Y=await this.engine.encryptChunk(this.buffer),_=new Uint8Array(4);new DataView(_.buffer).setUint32(0,Y.length,!1);let $=new Uint8Array(4+Y.length);$.set(_),$.set(Y,4),U.enqueue($),this.buffer=new Uint8Array(0)}async asUint8Array(U){if(U instanceof Uint8Array)return U;if(U instanceof ArrayBuffer)return new Uint8Array(U);return new Uint8Array(await U.arrayBuffer())}}class v{engine;chunkSize;buffer=new Uint8Array(0);constructor(U,Y=524288){this.engine=U;this.chunkSize=Y}toTransformStream(){return new TransformStream({transform:async(U,Y)=>{await this.transform(await this.asUint8Array(U),Y)},flush:async(U)=>this.flush(U)})}async transform(U,Y){let _=new Uint8Array(this.buffer.length+U.length);_.set(this.buffer),_.set(U,this.buffer.length);let $=0;while(!0){if(_.length-$<4)break;let z=new DataView(_.buffer,_.byteOffset+$,4).getUint32(0,!1);if(_.length-$-4<z)break;$+=4;let J=_.slice($,$+z);$+=z;try{let X=await this.engine.decryptChunk(J);Y.enqueue(X)}catch(X){throw X instanceof I?X:new I("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=_.slice($)}async flush(U){await this.transform(new Uint8Array(0),U),this.buffer=new Uint8Array(0)}async asUint8Array(U){if(U instanceof Uint8Array)return U;if(U instanceof ArrayBuffer)return new Uint8Array(U);return new Uint8Array(await U.arrayBuffer())}}class b{engine;chunkSize;constructor(U,Y=524288){this.engine=U;this.chunkSize=Y}encryptionStream(){let U=new i(this.engine,this.chunkSize).toTransformStream();return{writable:U.writable,readable:U.readable}}decryptionStream(U){let Y=U,_=new TransformStream({transform(z,J){if(Y===0){J.enqueue(z);return}if(z.byteLength<=Y){Y-=z.byteLength;return}J.enqueue(z.slice(Y)),Y=0}}),$=new v(this.engine,this.chunkSize).toTransformStream();return{writable:_.writable,readable:_.readable.pipeThrough($)}}async collect(U,Y,_=null){let $=U.pipeThrough(Y).getReader(),z=[];if(_?.length)z.push(_);while(!0){let{value:Z,done:G}=await $.read();if(G)break;z.push(Z)}let J=z.reduce((Z,G)=>Z+G.byteLength,0),X=new Uint8Array(J),Q=0;for(let Z of z)X.set(Z,Q),Q+=Z.byteLength;return X}}function E0(U=0,Y=console.info){return{level:U,log(_,$){if(_<=U)Y(`${_}| ${$}`)}}}var A0=new Map;class y{static getEngine(U,Y){let _=A0.get(Y);if(_)return _;let $=P.get(Y),z=new $.cipher(U),J=$.kdf,X=$.defaultChunkSize;return _={desc:$,cipher:z,kdf:J,chunkSize:X,provider:U},A0.set(Y,_),_}static async deriveKey(U,Y,_,$){try{let z=await U.kdf.derive(Y,_,$,U.provider);U.cipher.key=z}catch(z){let J=z instanceof Error?z.message:String(z);throw new w(J)}}}class V{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(U,Y={}){this.provider=U;this.v=P.get(Y.version??P.current.id),this.cipher=new this.v.cipher(U),this.kdf=this.v.kdf,this.chunkSize=Y.chunkSize??this.v.defaultChunkSize,this.stream=new b(this.cipher,this.chunkSize),this.difficulty=Y.difficulty??"middle",this.saltStrength=Y.saltStrength??"high",this.log=E0(Y.verbose??0,Y.logger)}static async isEncrypted(U){try{return await V.peekHeader(U),!0}catch{return!1}}static async headerDecode(U){let Y=await V.peekHeader(U),_=C(Y);return{version:_.version,difficulty:_.difficulty,salt:p(_.salt),saltLength:_.salt.byteLength}}setDifficulty(U){this.difficulty=U}getDifficulty(){return this.difficulty}setVersion(U){this.v=P.get(U),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new b(this.cipher,this.chunkSize)}getVersion(){return this.v.id}setSaltDifficulty(U){this.saltStrength=U}getSaltDifficulty(){return this.saltStrength}setChunkSize(U){this.chunkSize=U,this.stream=new b(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(U){this.log.level=U}getVerbose(){return this.log.level}async encryptText(U,Y){try{this.log.log(1,"Start text encryption"),this.log.log(2,"Deriving key for text encryption");let _=this.genSalt();await this.deriveKey(Y,_),this.log.log(3,`Salt generated: ${p(_)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let $=await this.cipher.encryptChunk(typeof U==="string"?new TextEncoder().encode(U):U);this.log.log(3,"Encoding header");let z=$8(this.v.id,this.difficulty,this.saltStrength,_);this.log.log(3,"Encoding text");let J=p(z,$);return this.log.log(1,"Decryption finished"),J}catch(_){throw new a(_ instanceof Error?_.message:String(_))}}async decryptText(U,Y){try{this.log.log(1,"Start text decryption"),this.log.log(3,"Start text decoding");let _=j8(U);this.log.log(3,"Start header decoding"),await V.peekHeader(U);let $=C(_);this.log.log(3,"Trying to get engine");let z=y.getEngine(this.provider,$.version);this.log.log(2,"Deriving key via engine for text decryption"),this.log.log(3,`Salt use: ${p($.salt)}, KDF difficulty: ${$.difficulty}`),await y.deriveKey(z,Y,$.salt,$.difficulty),this.log.log(2,"Decrypting text data");let J=await z.cipher.decryptChunk(_.slice($.headerLen));this.log.log(3,"Decoding text");let X=new TextDecoder().decode(J);return this.log.log(1,"Decryption finished"),X}catch(_){if(_ instanceof I||_ instanceof j||_ instanceof f||_ instanceof c||_ instanceof w)throw _;throw new I("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(U,Y){try{this.log.log(2,"Deriving key for file encryption");let _=this.genSalt();await this.deriveKey(Y,_);let $=$8(this.v.id,this.difficulty,this.saltStrength,_),z=await this.stream.collect(U.stream(),new i(this.cipher,this.chunkSize).toTransformStream(),$);return new Blob([z],{type:"application/octet-stream"})}catch(_){throw new a(_ instanceof Error?_.message:String(_))}}async decryptFile(U,Y){try{let _=await V.peekHeader(U),$=C(_),z=y.getEngine(this.provider,$.version);await y.deriveKey(z,Y,$.salt,$.difficulty),this.log.log(2,"Decrypting file data");let X=await new b(z.cipher,z.chunkSize).collect(U.slice($.headerLen).stream(),new v(z.cipher,z.chunkSize).toTransformStream());return new Blob([X],{type:"application/octet-stream"})}catch(_){if(_ instanceof I)throw _;throw new I(_ instanceof Error?_.message:String(_))}}async createEncryptionStream(U){this.log.log(2,"Deriving key for stream encryption");let Y=this.genSalt();await this.deriveKey(U,Y);let _=$8(this.v.id,this.difficulty,this.saltStrength,Y),$=this.stream.encryptionStream();return{header:_,writable:$.writable,readable:$.readable}}async createDecryptionStream(U){let Y=this,_=new Uint8Array(0),$=null;async function z(J,X){let Q=J.getReader();while(!0){let{value:Z,done:G}=await Q.read();if(G)break;X.enqueue(Z)}}return new TransformStream({async transform(J,X){if(!$){if(_=d(_,J),_.length<2)return;let Z=_.slice(0,30),{salt:G,difficulty:T}=C(Z),M=_[1]>>5,W=_[1]>>2&1?"high":"low",K=2+P.get(M).saltLengths[W];if(_.length<K)return;let D=y.getEngine(Y.provider,M);await y.deriveKey(D,U,G,T),$=new v(D.cipher,D.chunkSize).toTransformStream(),z($.readable,X);let n=_.slice(K);if(n.length){let w8=$.writable.getWriter();await w8.write(n),w8.releaseLock()}return}let Q=$.writable.getWriter();await Q.write(J),Q.releaseLock()},async flush(){if($){let J=$.writable.getWriter();await J.close(),J.releaseLock()}}})}async deriveKey(U,Y,_=this.difficulty){let $=performance.now();try{let z=await this.kdf.derive(U,Y,_,this.provider);this.cipher.key=z,this.log.log(3,`Key derivation completed in ${(performance.now()-$).toFixed(1)} ms`)}catch(z){throw new w(z instanceof Error?z.message:String(z))}}genSalt(){let U=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(U))}static async peekHeader(U){if(typeof U==="string")U=j8(U);if(U instanceof Uint8Array){if(U.length<2)throw new j("Input too short");let{headerLen:Y}=C(U.length>=16?U:Uint8Array.from(U));if(U.length<Y)throw new j("Incomplete header");return U.slice(0,Y)}if(U instanceof Blob){let Y=new Uint8Array(await U.slice(0,2).arrayBuffer());if(Y[0]!==1)throw new j("Invalid input format. The input is unknown.");let _=Y[1],$=_>>5,z=_>>2&1?"high":"low",J=P.get($).saltLengths[z],X=new Uint8Array(await U.slice(0,2+J).arrayBuffer());return C(X),X}throw new f("Unsupported input type")}}var z8=require("node:crypto"),j0={subtle:z8.webcrypto.subtle,getRandomValues(U){return z8.randomFillSync(U),U},isNode:!0};function h(U){return new V(j0,U)}var VU="0.2.4";async function Q8(){if(!q.stdin.isTTY)throw new Error("STDIN not a TTY; use --pass");q.stderr.write("Passphrase: "),q.stdin.setRawMode?.(!0),q.stdin.resume(),q.stdin.setEncoding("utf8");let U="";return new Promise((Y)=>{function _(){q.stdin.setRawMode?.(!1),q.stdin.pause(),q.stderr.write(`
`),q.stdin.off("data",$),Y(U)}function $(z){if(z==="\x03")q.exit(130);if(z==="\r"||z===`
`)return _();if(z==="\b"||z===""){U=U.slice(0,-1);return}U+=z}q.stdin.on("data",$)})}function y0(U){return J8.Readable.toWeb(U)}function k0(U){return J8.Writable.toWeb(U)}async function C0(){let U=[];for await(let Y of q.stdin)U.push(Y);return Buffer.concat(U).toString("utf8")}var R=new a8;R.name("cryptit").version(VU).description("AES-GCM / Argon2 encryption utility").addOption(new x("-p, --pass <passphrase>","passphrase (prompt if omitted)").hideHelp().argParser((U)=>{if(!U.trim())throw new Error("Passphrase cannot be empty");return U})).addOption(new x("-d, --difficulty <level>","argon2 difficulty").choices(["low","middle","high"]).default("middle","middle")).addOption(new x("-s, --salt-strength <variant>","salt length variant").choices(["low","high"]).default("high","high")).addOption(new x("-c, --chunk-size <bytes>","chunk size in bytes").argParser((U)=>{let Y=Number(U);if(!Number.isInteger(Y)||Y<=0)throw new Error("Chunk size must be a positive integer");return Y}).default(524288,"512*1024")).addOption(new x("-v, --verbose","increase verbosity (use multiple times)").default(0).argParser((U,Y)=>{return Y+1}));process.on("uncaughtException",(U)=>{if(U instanceof Error){let Y=U.constructor.name,_=U.message;q.stderr.write(`Error [${Y}]: ${_}
`)}else q.stderr.write(`Error [Unknown]: ${String(U)}
`);q.exit(1)});process.on("unhandledRejection",(U)=>{if(U instanceof Error){let Y=U.constructor.name,_=U.message;q.stderr.write(`Error [${Y}]: ${_}
`)}else q.stderr.write(`Error [Unknown]: ${String(U)}
`);q.exit(1)});async function DU(){let U=[];for await(let Y of q.stdin)U.push(Y);return Buffer.concat(U)}R.command("decode [src]").description("Show Cryptit header information; omit arg or use - to read from STDIN").action(async(U)=>{let{verbose:Y}=R.opts(),$=h({verbose:Y,logger:(G)=>q.stderr.write(G)}),z=!U||U==="-";async function J(G){if(G.length<2)throw new Error("Input too short for header");let T=G[1],M=T>>5,W=T>>2&1?"high":"low",B=P.get(M).saltLengths[W],K=G.slice(0,2+B);return V.headerDecode(K)}if(!z&&U){let G=await w0.open(U,"r"),T=Buffer.alloc(2);await G.read(T,0,2,0);let M=T[1],W=M>>5,B=M>>2&1?"high":"low",K=P.get(W).saltLengths[B],D=Buffer.alloc(2+K);await G.read(D,0,2+K,0),await G.close();let n=await V.headerDecode(new Uint8Array(D));q.stdout.write(JSON.stringify(n,null,2)+`
`);return}let X=z?await DU():Buffer.from(U,"utf8"),Q=X.toString("utf8").trim(),Z=/^[A-Za-z0-9\/+]+={0,2}$/.test(Q)&&Q.length%4===0;try{let G=Z?await V.headerDecode(Q):await J(X);q.stdout.write(JSON.stringify(G,null,2)+`
`)}catch(G){let T=G instanceof Error?G.message:String(G);q.stderr.write(`Error: ${T}
`),q.exit(1)}});R.command("encrypt <src>").description("Encrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async(U,Y)=>{if(U!=="-"&&!O.existsSync(U))q.stderr.write(`Error: input file not found: ${U}
`),q.exit(1);let _=R.opts(),$=h({difficulty:_.difficulty,saltStrength:_.saltStrength,chunkSize:_.chunkSize,verbose:_.verbose}),z=_.pass??(q.stdin.isTTY?await Q8():(()=>{q.stderr.write(`Use --pass when piping via STDIN
`),q.exit(1)})()),J=Y.out;if(J!=="-"&&!O.existsSync(J)&&!O.existsSync(require("path").dirname(J)))q.stderr.write(`Error: output directory does not exist: ${require("path").dirname(J)}
`),q.exit(1);let X=U==="-"?q.stdin:u.createReadStream(U),Q=Y.out==="-"?q.stdout:u.createWriteStream(Y.out),{header:Z,writable:G,readable:T}=await $.createEncryptionStream(z),M=y0(X),W=k0(Q),B=W.getWriter();await B.write(Z),B.releaseLock(),await Promise.all([M.pipeTo(G),T.pipeTo(W)])});R.command("decrypt <src>").description("Decrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async(U,Y)=>{if(U!=="-"&&!O.existsSync(U))q.stderr.write(`Error: input file not found: ${U}
`),q.exit(1);let _=R.opts(),$=h({difficulty:_.difficulty,saltStrength:_.saltStrength,chunkSize:_.chunkSize,verbose:_.verbose}),z=Y.out;if(z!=="-"&&!O.existsSync(z)&&!O.existsSync(require("path").dirname(z)))q.stderr.write(`Error: output directory does not exist: ${require("path").dirname(z)}
`),q.exit(1);let J=_.pass??await Q8(),X=U==="-"?q.stdin:u.createReadStream(U),Q=Y.out==="-"?q.stdout:u.createWriteStream(Y.out),Z=y0(X),G=k0(Q),T=await $.createDecryptionStream(J);await Promise.all([Z.pipeTo(T.writable),T.readable.pipeTo(G)])});R.command("encrypt-text [text]").description("Encrypt plaintext; omit arg to read from STDIN").action(async(U)=>{let Y=R.opts(),_=h({difficulty:Y.difficulty,saltStrength:Y.saltStrength,verbose:Y.verbose}),$=Y.pass??(q.stdin.isTTY?await Q8():(()=>{q.stderr.write(`Use --pass when piping via STDIN
`),q.exit(1)})()),z=U??await C0(),J=await _.encryptText(z,$);q.stdout.write(J+`
`)});R.command("decrypt-text [b64]").description("Decrypt Base64 ciphertext; omit arg to read from STDIN").action(async(U)=>{let Y=R.opts(),_=h({difficulty:Y.difficulty,saltStrength:Y.saltStrength,verbose:Y.verbose}),$=Y.pass??await Q8(),z=U??(await C0()).trim();if(!/^[A-Za-z0-9+/]+={0,2}$/.test(z))q.stderr.write(`Error: ciphertext does not look like Base64
`),q.exit(1);let J=await _.decryptText(z,$);q.stdout.write(J+`
`)});R.parse();

//# debugId=53DBF7F1C4200BE964756E2164756E21
