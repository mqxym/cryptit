#!/usr/bin/env node
var qq=Object.create;var{getPrototypeOf:Eq,defineProperty:Nj,getOwnPropertyNames:_q}=Object;var kq=Object.prototype.hasOwnProperty;var NA=(A,j,q)=>{q=A!=null?qq(Eq(A)):{};let E=j||!A||!A.__esModule?Nj(q,"default",{value:A,enumerable:!0}):q;for(let _ of _q(A))if(!kq.call(E,_))Nj(E,_,{get:()=>A[_],enumerable:!0});return E};var f=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var IA=f((pA)=>{class dA extends Error{constructor(A,j,q){super(q);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=j,this.exitCode=A,this.nestedError=void 0}}class Dj extends dA{constructor(A){super(1,"commander.invalidArgument",A);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}pA.CommanderError=dA;pA.InvalidArgumentError=Dj});var DA=f((sA)=>{var{InvalidArgumentError:$q}=IA();class Vj{constructor(A,j){switch(this.description=j||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,A[0]){case"<":this.required=!0,this._name=A.slice(1,-1);break;case"[":this.required=!1,this._name=A.slice(1,-1);break;default:this.required=!0,this._name=A;break}if(this._name.length>3&&this._name.slice(-3)==="...")this.variadic=!0,this._name=this._name.slice(0,-3)}name(){return this._name}_concatValue(A,j){if(j===this.defaultValue||!Array.isArray(j))return[A];return j.concat(A)}default(A,j){return this.defaultValue=A,this.defaultValueDescription=j,this}argParser(A){return this.parseArg=A,this}choices(A){return this.argChoices=A.slice(),this.parseArg=(j,q)=>{if(!this.argChoices.includes(j))throw new $q(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(j,q);return j},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}}function Iq(A){let j=A.name()+(A.variadic===!0?"...":"");return A.required?"<"+j+">":"["+j+"]"}sA.Argument=Vj;sA.humanReadableArgName=Iq});var oA=f((wj)=>{var{humanReadableArgName:Gq}=DA();class Mj{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands(A){let j=A.commands.filter((q)=>!q._hidden);if(A._hasImplicitHelpCommand()){let[,q,E]=A._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),_=A.createCommand(q).helpOption(!1);if(_.description(A._helpCommandDescription),E)_.arguments(E);j.push(_)}if(this.sortSubcommands)j.sort((q,E)=>{return q.name().localeCompare(E.name())});return j}compareOptions(A,j){let q=(E)=>{return E.short?E.short.replace(/^-/,""):E.long.replace(/^--/,"")};return q(A).localeCompare(q(j))}visibleOptions(A){let j=A.options.filter((_)=>!_.hidden),q=A._hasHelpOption&&A._helpShortFlag&&!A._findOption(A._helpShortFlag),E=A._hasHelpOption&&!A._findOption(A._helpLongFlag);if(q||E){let _;if(!q)_=A.createOption(A._helpLongFlag,A._helpDescription);else if(!E)_=A.createOption(A._helpShortFlag,A._helpDescription);else _=A.createOption(A._helpFlags,A._helpDescription);j.push(_)}if(this.sortOptions)j.sort(this.compareOptions);return j}visibleGlobalOptions(A){if(!this.showGlobalOptions)return[];let j=[];for(let q=A.parent;q;q=q.parent){let E=q.options.filter((_)=>!_.hidden);j.push(...E)}if(this.sortOptions)j.sort(this.compareOptions);return j}visibleArguments(A){if(A._argsDescription)A.registeredArguments.forEach((j)=>{j.description=j.description||A._argsDescription[j.name()]||""});if(A.registeredArguments.find((j)=>j.description))return A.registeredArguments;return[]}subcommandTerm(A){let j=A.registeredArguments.map((q)=>Gq(q)).join(" ");return A._name+(A._aliases[0]?"|"+A._aliases[0]:"")+(A.options.length?" [options]":"")+(j?" "+j:"")}optionTerm(A){return A.flags}argumentTerm(A){return A.name()}longestSubcommandTermLength(A,j){return j.visibleCommands(A).reduce((q,E)=>{return Math.max(q,j.subcommandTerm(E).length)},0)}longestOptionTermLength(A,j){return j.visibleOptions(A).reduce((q,E)=>{return Math.max(q,j.optionTerm(E).length)},0)}longestGlobalOptionTermLength(A,j){return j.visibleGlobalOptions(A).reduce((q,E)=>{return Math.max(q,j.optionTerm(E).length)},0)}longestArgumentTermLength(A,j){return j.visibleArguments(A).reduce((q,E)=>{return Math.max(q,j.argumentTerm(E).length)},0)}commandUsage(A){let j=A._name;if(A._aliases[0])j=j+"|"+A._aliases[0];let q="";for(let E=A.parent;E;E=E.parent)q=E.name()+" "+q;return q+j+" "+A.usage()}commandDescription(A){return A.description()}subcommandDescription(A){return A.summary()||A.description()}optionDescription(A){let j=[];if(A.argChoices)j.push(`choices: ${A.argChoices.map((q)=>JSON.stringify(q)).join(", ")}`);if(A.defaultValue!==void 0){if(A.required||A.optional||A.isBoolean()&&typeof A.defaultValue==="boolean")j.push(`default: ${A.defaultValueDescription||JSON.stringify(A.defaultValue)}`)}if(A.presetArg!==void 0&&A.optional)j.push(`preset: ${JSON.stringify(A.presetArg)}`);if(A.envVar!==void 0)j.push(`env: ${A.envVar}`);if(j.length>0)return`${A.description} (${j.join(", ")})`;return A.description}argumentDescription(A){let j=[];if(A.argChoices)j.push(`choices: ${A.argChoices.map((q)=>JSON.stringify(q)).join(", ")}`);if(A.defaultValue!==void 0)j.push(`default: ${A.defaultValueDescription||JSON.stringify(A.defaultValue)}`);if(j.length>0){let q=`(${j.join(", ")})`;if(A.description)return`${A.description} ${q}`;return q}return A.description}formatHelp(A,j){let q=j.padWidth(A,j),E=j.helpWidth||80,_=2,k=2;function $(X,L){if(L){let T=`${X.padEnd(q+2)}${L}`;return j.wrap(T,E-2,q+2)}return X}function I(X){return X.join(`
`).replace(/^/gm," ".repeat(2))}let B=[`Usage: ${j.commandUsage(A)}`,""],U=j.commandDescription(A);if(U.length>0)B=B.concat([j.wrap(U,E,0),""]);let R=j.visibleArguments(A).map((X)=>{return $(j.argumentTerm(X),j.argumentDescription(X))});if(R.length>0)B=B.concat(["Arguments:",I(R),""]);let P=j.visibleOptions(A).map((X)=>{return $(j.optionTerm(X),j.optionDescription(X))});if(P.length>0)B=B.concat(["Options:",I(P),""]);if(this.showGlobalOptions){let X=j.visibleGlobalOptions(A).map((L)=>{return $(j.optionTerm(L),j.optionDescription(L))});if(X.length>0)B=B.concat(["Global Options:",I(X),""])}let H=j.visibleCommands(A).map((X)=>{return $(j.subcommandTerm(X),j.subcommandDescription(X))});if(H.length>0)B=B.concat(["Commands:",I(H),""]);return B.join(`
`)}padWidth(A,j){return Math.max(j.longestOptionTermLength(A,j),j.longestGlobalOptionTermLength(A,j),j.longestSubcommandTermLength(A,j),j.longestArgumentTermLength(A,j))}wrap(A,j,q,E=40){let k=new RegExp(`[\\n][${" \\f\\t\\v   -   　\uFEFF"}]+`);if(A.match(k))return A;let $=j-q;if($<E)return A;let I=A.slice(0,q),B=A.slice(q).replace(`\r
`,`
`),U=" ".repeat(q),P=`\\s${"​"}`,H=new RegExp(`
|.{1,${$-1}}([${P}]|$)|[^${P}]+?([${P}]|$)`,"g"),X=B.match(H)||[];return I+X.map((L,T)=>{if(L===`
`)return"";return(T>0?U:"")+L.trimEnd()}).join(`
`)}}wj.Help=Mj});var aA=f((VA)=>{var{InvalidArgumentError:Bq}=IA();class yj{constructor(A,j){this.flags=A,this.description=j||"",this.required=A.includes("<"),this.optional=A.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(A),this.mandatory=!1;let q=Oj(A);if(this.short=q.shortFlag,this.long=q.longFlag,this.negate=!1,this.long)this.negate=this.long.startsWith("--no-");this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default(A,j){return this.defaultValue=A,this.defaultValueDescription=j,this}preset(A){return this.presetArg=A,this}conflicts(A){return this.conflictsWith=this.conflictsWith.concat(A),this}implies(A){let j=A;if(typeof A==="string")j={[A]:!0};return this.implied=Object.assign(this.implied||{},j),this}env(A){return this.envVar=A,this}argParser(A){return this.parseArg=A,this}makeOptionMandatory(A=!0){return this.mandatory=!!A,this}hideHelp(A=!0){return this.hidden=!!A,this}_concatValue(A,j){if(j===this.defaultValue||!Array.isArray(j))return[A];return j.concat(A)}choices(A){return this.argChoices=A.slice(),this.parseArg=(j,q)=>{if(!this.argChoices.includes(j))throw new Bq(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(j,q);return j},this}name(){if(this.long)return this.long.replace(/^--/,"");return this.short.replace(/^-/,"")}attributeName(){return Uq(this.name().replace(/^no-/,""))}is(A){return this.short===A||this.long===A}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class vj{constructor(A){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,A.forEach((j)=>{if(j.negate)this.negativeOptions.set(j.attributeName(),j);else this.positiveOptions.set(j.attributeName(),j)}),this.negativeOptions.forEach((j,q)=>{if(this.positiveOptions.has(q))this.dualOptions.add(q)})}valueFromOption(A,j){let q=j.attributeName();if(!this.dualOptions.has(q))return!0;let E=this.negativeOptions.get(q).presetArg,_=E!==void 0?E:!1;return j.negate===(_===A)}}function Uq(A){return A.split("-").reduce((j,q)=>{return j+q[0].toUpperCase()+q.slice(1)})}function Oj(A){let j,q,E=A.split(/[ |,]+/);if(E.length>1&&!/^[[<]/.test(E[1]))j=E.shift();if(q=E.shift(),!j&&/^-[^-]$/.test(q))j=q,q=void 0;return{shortFlag:j,longFlag:q}}VA.Option=yj;VA.splitOptionFlags=Oj;VA.DualOptions=vj});var xj=f((Cj)=>{function Lq(A,j){if(Math.abs(A.length-j.length)>3)return Math.max(A.length,j.length);let q=[];for(let E=0;E<=A.length;E++)q[E]=[E];for(let E=0;E<=j.length;E++)q[0][E]=E;for(let E=1;E<=j.length;E++)for(let _=1;_<=A.length;_++){let k=1;if(A[_-1]===j[E-1])k=0;else k=1;if(q[_][E]=Math.min(q[_-1][E]+1,q[_][E-1]+1,q[_-1][E-1]+k),_>1&&E>1&&A[_-1]===j[E-2]&&A[_-2]===j[E-1])q[_][E]=Math.min(q[_][E],q[_-2][E-2]+1)}return q[A.length][j.length]}function Rq(A,j){if(!j||j.length===0)return"";j=Array.from(new Set(j));let q=A.startsWith("--");if(q)A=A.slice(2),j=j.map(($)=>$.slice(2));let E=[],_=3,k=0.4;if(j.forEach(($)=>{if($.length<=1)return;let I=Lq(A,$),B=Math.max(A.length,$.length);if((B-I)/B>k){if(I<_)_=I,E=[$];else if(I===_)E.push($)}}),E.sort(($,I)=>$.localeCompare(I)),q)E=E.map(($)=>`--${$}`);if(E.length>1)return`
(Did you mean one of ${E.join(", ")}?)`;if(E.length===1)return`
(Did you mean ${E[0]}?)`;return""}Cj.suggestSimilar=Rq});var lj=f((cj)=>{var Kq=require("events").EventEmitter,eA=require("child_process"),y=require("path"),Aj=require("fs"),J=require("process"),{Argument:Tq,humanReadableArgName:Fq}=DA(),{CommanderError:jj}=IA(),{Help:Pq}=oA(),{Option:bj,splitOptionFlags:Hq,DualOptions:Xq}=aA(),{suggestSimilar:hj}=xj();class qj extends Kq{constructor(A){super();this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=A||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:(j)=>J.stdout.write(j),writeErr:(j)=>J.stderr.write(j),getOutHelpWidth:()=>J.stdout.isTTY?J.stdout.columns:void 0,getErrHelpWidth:()=>J.stderr.isTTY?J.stderr.columns:void 0,outputError:(j,q)=>q(j)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings(A){return this._outputConfiguration=A._outputConfiguration,this._hasHelpOption=A._hasHelpOption,this._helpFlags=A._helpFlags,this._helpDescription=A._helpDescription,this._helpShortFlag=A._helpShortFlag,this._helpLongFlag=A._helpLongFlag,this._helpCommandName=A._helpCommandName,this._helpCommandnameAndArgs=A._helpCommandnameAndArgs,this._helpCommandDescription=A._helpCommandDescription,this._helpConfiguration=A._helpConfiguration,this._exitCallback=A._exitCallback,this._storeOptionsAsProperties=A._storeOptionsAsProperties,this._combineFlagAndOptionalValue=A._combineFlagAndOptionalValue,this._allowExcessArguments=A._allowExcessArguments,this._enablePositionalOptions=A._enablePositionalOptions,this._showHelpAfterError=A._showHelpAfterError,this._showSuggestionAfterError=A._showSuggestionAfterError,this}_getCommandAndAncestors(){let A=[];for(let j=this;j;j=j.parent)A.push(j);return A}command(A,j,q){let E=j,_=q;if(typeof E==="object"&&E!==null)_=E,E=null;_=_||{};let[,k,$]=A.match(/([^ ]+) *(.*)/),I=this.createCommand(k);if(E)I.description(E),I._executableHandler=!0;if(_.isDefault)this._defaultCommandName=I._name;if(I._hidden=!!(_.noHelp||_.hidden),I._executableFile=_.executableFile||null,$)I.arguments($);if(this.commands.push(I),I.parent=this,I.copyInheritedSettings(this),E)return this;return I}createCommand(A){return new qj(A)}createHelp(){return Object.assign(new Pq,this.configureHelp())}configureHelp(A){if(A===void 0)return this._helpConfiguration;return this._helpConfiguration=A,this}configureOutput(A){if(A===void 0)return this._outputConfiguration;return Object.assign(this._outputConfiguration,A),this}showHelpAfterError(A=!0){if(typeof A!=="string")A=!!A;return this._showHelpAfterError=A,this}showSuggestionAfterError(A=!0){return this._showSuggestionAfterError=!!A,this}addCommand(A,j){if(!A._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);if(j=j||{},j.isDefault)this._defaultCommandName=A._name;if(j.noHelp||j.hidden)A._hidden=!0;return this.commands.push(A),A.parent=this,this}createArgument(A,j){return new Tq(A,j)}argument(A,j,q,E){let _=this.createArgument(A,j);if(typeof q==="function")_.default(E).argParser(q);else _.default(q);return this.addArgument(_),this}arguments(A){return A.trim().split(/ +/).forEach((j)=>{this.argument(j)}),this}addArgument(A){let j=this.registeredArguments.slice(-1)[0];if(j&&j.variadic)throw new Error(`only the last argument can be variadic '${j.name()}'`);if(A.required&&A.defaultValue!==void 0&&A.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${A.name()}'`);return this.registeredArguments.push(A),this}addHelpCommand(A,j){if(A===!1)this._addImplicitHelpCommand=!1;else{if(this._addImplicitHelpCommand=!0,typeof A==="string")this._helpCommandName=A.split(" ")[0],this._helpCommandnameAndArgs=A;this._helpCommandDescription=j||this._helpCommandDescription}return this}_hasImplicitHelpCommand(){if(this._addImplicitHelpCommand===void 0)return this.commands.length&&!this._actionHandler&&!this._findCommand("help");return this._addImplicitHelpCommand}hook(A,j){let q=["preSubcommand","preAction","postAction"];if(!q.includes(A))throw new Error(`Unexpected value for event passed to hook : '${A}'.
Expecting one of '${q.join("', '")}'`);if(this._lifeCycleHooks[A])this._lifeCycleHooks[A].push(j);else this._lifeCycleHooks[A]=[j];return this}exitOverride(A){if(A)this._exitCallback=A;else this._exitCallback=(j)=>{if(j.code!=="commander.executeSubCommandAsync")throw j};return this}_exit(A,j,q){if(this._exitCallback)this._exitCallback(new jj(A,j,q));J.exit(A)}action(A){let j=(q)=>{let E=this.registeredArguments.length,_=q.slice(0,E);if(this._storeOptionsAsProperties)_[E]=this;else _[E]=this.opts();return _.push(this),A.apply(this,_)};return this._actionHandler=j,this}createOption(A,j){return new bj(A,j)}_callParseArg(A,j,q,E){try{return A.parseArg(j,q)}catch(_){if(_.code==="commander.invalidArgument"){let k=`${E} ${_.message}`;this.error(k,{exitCode:_.exitCode,code:_.code})}throw _}}addOption(A){let j=A.name(),q=A.attributeName();if(A.negate){let _=A.long.replace(/^--no-/,"--");if(!this._findOption(_))this.setOptionValueWithSource(q,A.defaultValue===void 0?!0:A.defaultValue,"default")}else if(A.defaultValue!==void 0)this.setOptionValueWithSource(q,A.defaultValue,"default");this.options.push(A);let E=(_,k,$)=>{if(_==null&&A.presetArg!==void 0)_=A.presetArg;let I=this.getOptionValue(q);if(_!==null&&A.parseArg)_=this._callParseArg(A,_,I,k);else if(_!==null&&A.variadic)_=A._concatValue(_,I);if(_==null)if(A.negate)_=!1;else if(A.isBoolean()||A.optional)_=!0;else _="";this.setOptionValueWithSource(q,_,$)};if(this.on("option:"+j,(_)=>{let k=`error: option '${A.flags}' argument '${_}' is invalid.`;E(_,k,"cli")}),A.envVar)this.on("optionEnv:"+j,(_)=>{let k=`error: option '${A.flags}' value '${_}' from env '${A.envVar}' is invalid.`;E(_,k,"env")});return this}_optionEx(A,j,q,E,_){if(typeof j==="object"&&j instanceof bj)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let k=this.createOption(j,q);if(k.makeOptionMandatory(!!A.mandatory),typeof E==="function")k.default(_).argParser(E);else if(E instanceof RegExp){let $=E;E=(I,B)=>{let U=$.exec(I);return U?U[0]:B},k.default(_).argParser(E)}else k.default(E);return this.addOption(k)}option(A,j,q,E){return this._optionEx({},A,j,q,E)}requiredOption(A,j,q,E){return this._optionEx({mandatory:!0},A,j,q,E)}combineFlagAndOptionalValue(A=!0){return this._combineFlagAndOptionalValue=!!A,this}allowUnknownOption(A=!0){return this._allowUnknownOption=!!A,this}allowExcessArguments(A=!0){return this._allowExcessArguments=!!A,this}enablePositionalOptions(A=!0){return this._enablePositionalOptions=!!A,this}passThroughOptions(A=!0){if(this._passThroughOptions=!!A,!!this.parent&&A&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties(A=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this._storeOptionsAsProperties=!!A,this}getOptionValue(A){if(this._storeOptionsAsProperties)return this[A];return this._optionValues[A]}setOptionValue(A,j){return this.setOptionValueWithSource(A,j,void 0)}setOptionValueWithSource(A,j,q){if(this._storeOptionsAsProperties)this[A]=j;else this._optionValues[A]=j;return this._optionValueSources[A]=q,this}getOptionValueSource(A){return this._optionValueSources[A]}getOptionValueSourceWithGlobals(A){let j;return this._getCommandAndAncestors().forEach((q)=>{if(q.getOptionValueSource(A)!==void 0)j=q.getOptionValueSource(A)}),j}_prepareUserArgs(A,j){if(A!==void 0&&!Array.isArray(A))throw new Error("first parameter to parse must be array or undefined");if(j=j||{},A===void 0){if(A=J.argv,J.versions&&J.versions.electron)j.from="electron"}this.rawArgs=A.slice();let q;switch(j.from){case void 0:case"node":this._scriptPath=A[1],q=A.slice(2);break;case"electron":if(J.defaultApp)this._scriptPath=A[1],q=A.slice(2);else q=A.slice(1);break;case"user":q=A.slice(0);break;default:throw new Error(`unexpected parse option { from: '${j.from}' }`)}if(!this._name&&this._scriptPath)this.nameFromFilename(this._scriptPath);return this._name=this._name||"program",q}parse(A,j){let q=this._prepareUserArgs(A,j);return this._parseCommand([],q),this}async parseAsync(A,j){let q=this._prepareUserArgs(A,j);return await this._parseCommand([],q),this}_executeSubCommand(A,j){j=j.slice();let q=!1,E=[".js",".ts",".tsx",".mjs",".cjs"];function _(U,R){let P=y.resolve(U,R);if(Aj.existsSync(P))return P;if(E.includes(y.extname(R)))return;let H=E.find((X)=>Aj.existsSync(`${P}${X}`));if(H)return`${P}${H}`;return}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let k=A._executableFile||`${this._name}-${A._name}`,$=this._executableDir||"";if(this._scriptPath){let U;try{U=Aj.realpathSync(this._scriptPath)}catch(R){U=this._scriptPath}$=y.resolve(y.dirname(U),$)}if($){let U=_($,k);if(!U&&!A._executableFile&&this._scriptPath){let R=y.basename(this._scriptPath,y.extname(this._scriptPath));if(R!==this._name)U=_($,`${R}-${A._name}`)}k=U||k}q=E.includes(y.extname(k));let I;if(J.platform!=="win32")if(q)j.unshift(k),j=gj(J.execArgv).concat(j),I=eA.spawn(J.argv[0],j,{stdio:"inherit"});else I=eA.spawn(k,j,{stdio:"inherit"});else j.unshift(k),j=gj(J.execArgv).concat(j),I=eA.spawn(J.execPath,j,{stdio:"inherit"});if(!I.killed)["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach((R)=>{J.on(R,()=>{if(I.killed===!1&&I.exitCode===null)I.kill(R)})});let B=this._exitCallback;if(!B)I.on("close",J.exit.bind(J));else I.on("close",()=>{B(new jj(J.exitCode||0,"commander.executeSubCommandAsync","(close)"))});I.on("error",(U)=>{if(U.code==="ENOENT"){let R=$?`searched for local subcommand relative to directory '${$}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",P=`'${k}' does not exist
 - if '${A._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${R}`;throw new Error(P)}else if(U.code==="EACCES")throw new Error(`'${k}' not executable`);if(!B)J.exit(1);else{let R=new jj(1,"commander.executeSubCommandAsync","(error)");R.nestedError=U,B(R)}}),this.runningCommand=I}_dispatchSubcommand(A,j,q){let E=this._findCommand(A);if(!E)this.help({error:!0});let _;return _=this._chainOrCallSubCommandHook(_,E,"preSubcommand"),_=this._chainOrCall(_,()=>{if(E._executableHandler)this._executeSubCommand(E,j.concat(q));else return E._parseCommand(j,q)}),_}_dispatchHelpCommand(A){if(!A)this.help();let j=this._findCommand(A);if(j&&!j._executableHandler)j.help();return this._dispatchSubcommand(A,[],[this._helpLongFlag||this._helpShortFlag])}_checkNumberOfArguments(){if(this.registeredArguments.forEach((A,j)=>{if(A.required&&this.args[j]==null)this.missingArgument(A.name())}),this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)return;if(this.args.length>this.registeredArguments.length)this._excessArguments(this.args)}_processArguments(){let A=(q,E,_)=>{let k=E;if(E!==null&&q.parseArg){let $=`error: command-argument value '${E}' is invalid for argument '${q.name()}'.`;k=this._callParseArg(q,E,_,$)}return k};this._checkNumberOfArguments();let j=[];this.registeredArguments.forEach((q,E)=>{let _=q.defaultValue;if(q.variadic){if(E<this.args.length){if(_=this.args.slice(E),q.parseArg)_=_.reduce((k,$)=>{return A(q,$,k)},q.defaultValue)}else if(_===void 0)_=[]}else if(E<this.args.length){if(_=this.args[E],q.parseArg)_=A(q,_,q.defaultValue)}j[E]=_}),this.processedArgs=j}_chainOrCall(A,j){if(A&&A.then&&typeof A.then==="function")return A.then(()=>j());return j()}_chainOrCallHooks(A,j){let q=A,E=[];if(this._getCommandAndAncestors().reverse().filter((_)=>_._lifeCycleHooks[j]!==void 0).forEach((_)=>{_._lifeCycleHooks[j].forEach((k)=>{E.push({hookedCommand:_,callback:k})})}),j==="postAction")E.reverse();return E.forEach((_)=>{q=this._chainOrCall(q,()=>{return _.callback(_.hookedCommand,this)})}),q}_chainOrCallSubCommandHook(A,j,q){let E=A;if(this._lifeCycleHooks[q]!==void 0)this._lifeCycleHooks[q].forEach((_)=>{E=this._chainOrCall(E,()=>{return _(this,j)})});return E}_parseCommand(A,j){let q=this.parseOptions(j);if(this._parseOptionsEnv(),this._parseOptionsImplied(),A=A.concat(q.operands),j=q.unknown,this.args=A.concat(j),A&&this._findCommand(A[0]))return this._dispatchSubcommand(A[0],A.slice(1),j);if(this._hasImplicitHelpCommand()&&A[0]===this._helpCommandName)return this._dispatchHelpCommand(A[1]);if(this._defaultCommandName)return uj(this,j),this._dispatchSubcommand(this._defaultCommandName,A,j);if(this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName)this.help({error:!0});uj(this,q.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let E=()=>{if(q.unknown.length>0)this.unknownOption(q.unknown[0])},_=`command:${this.name()}`;if(this._actionHandler){E(),this._processArguments();let k;if(k=this._chainOrCallHooks(k,"preAction"),k=this._chainOrCall(k,()=>this._actionHandler(this.processedArgs)),this.parent)k=this._chainOrCall(k,()=>{this.parent.emit(_,A,j)});return k=this._chainOrCallHooks(k,"postAction"),k}if(this.parent&&this.parent.listenerCount(_))E(),this._processArguments(),this.parent.emit(_,A,j);else if(A.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",A,j);if(this.listenerCount("command:*"))this.emit("command:*",A,j);else if(this.commands.length)this.unknownCommand();else E(),this._processArguments()}else if(this.commands.length)E(),this.help({error:!0});else E(),this._processArguments()}_findCommand(A){if(!A)return;return this.commands.find((j)=>j._name===A||j._aliases.includes(A))}_findOption(A){return this.options.find((j)=>j.is(A))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach((A)=>{A.options.forEach((j)=>{if(j.mandatory&&A.getOptionValue(j.attributeName())===void 0)A.missingMandatoryOptionValue(j)})})}_checkForConflictingLocalOptions(){let A=this.options.filter((q)=>{let E=q.attributeName();if(this.getOptionValue(E)===void 0)return!1;return this.getOptionValueSource(E)!=="default"});A.filter((q)=>q.conflictsWith.length>0).forEach((q)=>{let E=A.find((_)=>q.conflictsWith.includes(_.attributeName()));if(E)this._conflictingOption(q,E)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach((A)=>{A._checkForConflictingLocalOptions()})}parseOptions(A){let j=[],q=[],E=j,_=A.slice();function k(I){return I.length>1&&I[0]==="-"}let $=null;while(_.length){let I=_.shift();if(I==="--"){if(E===q)E.push(I);E.push(..._);break}if($&&!k(I)){this.emit(`option:${$.name()}`,I);continue}if($=null,k(I)){let B=this._findOption(I);if(B){if(B.required){let U=_.shift();if(U===void 0)this.optionMissingArgument(B);this.emit(`option:${B.name()}`,U)}else if(B.optional){let U=null;if(_.length>0&&!k(_[0]))U=_.shift();this.emit(`option:${B.name()}`,U)}else this.emit(`option:${B.name()}`);$=B.variadic?B:null;continue}}if(I.length>2&&I[0]==="-"&&I[1]!=="-"){let B=this._findOption(`-${I[1]}`);if(B){if(B.required||B.optional&&this._combineFlagAndOptionalValue)this.emit(`option:${B.name()}`,I.slice(2));else this.emit(`option:${B.name()}`),_.unshift(`-${I.slice(2)}`);continue}}if(/^--[^=]+=/.test(I)){let B=I.indexOf("="),U=this._findOption(I.slice(0,B));if(U&&(U.required||U.optional)){this.emit(`option:${U.name()}`,I.slice(B+1));continue}}if(k(I))E=q;if((this._enablePositionalOptions||this._passThroughOptions)&&j.length===0&&q.length===0){if(this._findCommand(I)){if(j.push(I),_.length>0)q.push(..._);break}else if(I===this._helpCommandName&&this._hasImplicitHelpCommand()){if(j.push(I),_.length>0)j.push(..._);break}else if(this._defaultCommandName){if(q.push(I),_.length>0)q.push(..._);break}}if(this._passThroughOptions){if(E.push(I),_.length>0)E.push(..._);break}E.push(I)}return{operands:j,unknown:q}}opts(){if(this._storeOptionsAsProperties){let A={},j=this.options.length;for(let q=0;q<j;q++){let E=this.options[q].attributeName();A[E]=E===this._versionOptionName?this._version:this[E]}return A}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((A,j)=>Object.assign(A,j.opts()),{})}error(A,j){if(this._outputConfiguration.outputError(`${A}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError==="string")this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`);else if(this._showHelpAfterError)this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0});let q=j||{},E=q.exitCode||1,_=q.code||"commander.error";this._exit(E,_,A)}_parseOptionsEnv(){this.options.forEach((A)=>{if(A.envVar&&A.envVar in J.env){let j=A.attributeName();if(this.getOptionValue(j)===void 0||["default","config","env"].includes(this.getOptionValueSource(j)))if(A.required||A.optional)this.emit(`optionEnv:${A.name()}`,J.env[A.envVar]);else this.emit(`optionEnv:${A.name()}`)}})}_parseOptionsImplied(){let A=new Xq(this.options),j=(q)=>{return this.getOptionValue(q)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(q))};this.options.filter((q)=>q.implied!==void 0&&j(q.attributeName())&&A.valueFromOption(this.getOptionValue(q.attributeName()),q)).forEach((q)=>{Object.keys(q.implied).filter((E)=>!j(E)).forEach((E)=>{this.setOptionValueWithSource(E,q.implied[E],"implied")})})}missingArgument(A){let j=`error: missing required argument '${A}'`;this.error(j,{code:"commander.missingArgument"})}optionMissingArgument(A){let j=`error: option '${A.flags}' argument missing`;this.error(j,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(A){let j=`error: required option '${A.flags}' not specified`;this.error(j,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(A,j){let q=(k)=>{let $=k.attributeName(),I=this.getOptionValue($),B=this.options.find((R)=>R.negate&&$===R.attributeName()),U=this.options.find((R)=>!R.negate&&$===R.attributeName());if(B&&(B.presetArg===void 0&&I===!1||B.presetArg!==void 0&&I===B.presetArg))return B;return U||k},E=(k)=>{let $=q(k),I=$.attributeName();if(this.getOptionValueSource(I)==="env")return`environment variable '${$.envVar}'`;return`option '${$.flags}'`},_=`error: ${E(A)} cannot be used with ${E(j)}`;this.error(_,{code:"commander.conflictingOption"})}unknownOption(A){if(this._allowUnknownOption)return;let j="";if(A.startsWith("--")&&this._showSuggestionAfterError){let E=[],_=this;do{let k=_.createHelp().visibleOptions(_).filter(($)=>$.long).map(($)=>$.long);E=E.concat(k),_=_.parent}while(_&&!_._enablePositionalOptions);j=hj(A,E)}let q=`error: unknown option '${A}'${j}`;this.error(q,{code:"commander.unknownOption"})}_excessArguments(A){if(this._allowExcessArguments)return;let j=this.registeredArguments.length,q=j===1?"":"s",_=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${j} argument${q} but got ${A.length}.`;this.error(_,{code:"commander.excessArguments"})}unknownCommand(){let A=this.args[0],j="";if(this._showSuggestionAfterError){let E=[];this.createHelp().visibleCommands(this).forEach((_)=>{if(E.push(_.name()),_.alias())E.push(_.alias())}),j=hj(A,E)}let q=`error: unknown command '${A}'${j}`;this.error(q,{code:"commander.unknownCommand"})}version(A,j,q){if(A===void 0)return this._version;this._version=A,j=j||"-V, --version",q=q||"output the version number";let E=this.createOption(j,q);return this._versionOptionName=E.attributeName(),this.options.push(E),this.on("option:"+E.name(),()=>{this._outputConfiguration.writeOut(`${A}
`),this._exit(0,"commander.version",A)}),this}description(A,j){if(A===void 0&&j===void 0)return this._description;if(this._description=A,j)this._argsDescription=j;return this}summary(A){if(A===void 0)return this._summary;return this._summary=A,this}alias(A){if(A===void 0)return this._aliases[0];let j=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler)j=this.commands[this.commands.length-1];if(A===j._name)throw new Error("Command alias can't be the same as its name");return j._aliases.push(A),this}aliases(A){if(A===void 0)return this._aliases;return A.forEach((j)=>this.alias(j)),this}usage(A){if(A===void 0){if(this._usage)return this._usage;let j=this.registeredArguments.map((q)=>{return Fq(q)});return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?j:[]).join(" ")}return this._usage=A,this}name(A){if(A===void 0)return this._name;return this._name=A,this}nameFromFilename(A){return this._name=y.basename(A,y.extname(A)),this}executableDir(A){if(A===void 0)return this._executableDir;return this._executableDir=A,this}helpInformation(A){let j=this.createHelp();if(j.helpWidth===void 0)j.helpWidth=A&&A.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth();return j.formatHelp(this,j)}_getHelpContext(A){A=A||{};let j={error:!!A.error},q;if(j.error)q=(E)=>this._outputConfiguration.writeErr(E);else q=(E)=>this._outputConfiguration.writeOut(E);return j.write=A.write||q,j.command=this,j}outputHelp(A){let j;if(typeof A==="function")j=A,A=void 0;let q=this._getHelpContext(A);this._getCommandAndAncestors().reverse().forEach((_)=>_.emit("beforeAllHelp",q)),this.emit("beforeHelp",q);let E=this.helpInformation(q);if(j){if(E=j(E),typeof E!=="string"&&!Buffer.isBuffer(E))throw new Error("outputHelp callback must return a string or a Buffer")}if(q.write(E),this._helpLongFlag)this.emit(this._helpLongFlag);this.emit("afterHelp",q),this._getCommandAndAncestors().forEach((_)=>_.emit("afterAllHelp",q))}helpOption(A,j){if(typeof A==="boolean")return this._hasHelpOption=A,this;this._helpFlags=A||this._helpFlags,this._helpDescription=j||this._helpDescription;let q=Hq(this._helpFlags);return this._helpShortFlag=q.shortFlag,this._helpLongFlag=q.longFlag,this}help(A){this.outputHelp(A);let j=J.exitCode||0;if(j===0&&A&&typeof A!=="function"&&A.error)j=1;this._exit(j,"commander.help","(outputHelp)")}addHelpText(A,j){let q=["beforeAll","before","after","afterAll"];if(!q.includes(A))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${q.join("', '")}'`);let E=`${A}Help`;return this.on(E,(_)=>{let k;if(typeof j==="function")k=j({error:_.error,command:_.command});else k=j;if(k)_.write(`${k}
`)}),this}}function uj(A,j){if(A._hasHelpOption&&j.find((E)=>E===A._helpLongFlag||E===A._helpShortFlag))A.outputHelp(),A._exit(0,"commander.helpDisplayed","(outputHelp)")}function gj(A){return A.map((j)=>{if(!j.startsWith("--inspect"))return j;let q,E="127.0.0.1",_="9229",k;if((k=j.match(/^(--inspect(-brk)?)$/))!==null)q=k[1];else if((k=j.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null)if(q=k[1],/^\d+$/.test(k[3]))_=k[3];else E=k[3];else if((k=j.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null)q=k[1],E=k[3],_=k[4];if(q&&_!=="0")return`${q}=${E}:${parseInt(_)+1}`;return j})}cj.Command=qj});var tj=f((N,ij)=>{var{Argument:Jq}=DA(),{Command:mj}=lj(),{CommanderError:Yq,InvalidArgumentError:nj}=IA(),{Help:zq}=oA(),{Option:fq}=aA();N=ij.exports=new mj;N.program=N;N.Command=mj;N.Option=fq;N.Argument=Jq;N.Help=zq;N.CommanderError=Yq;N.InvalidArgumentError=nj;N.InvalidOptionArgumentError=nj});var Kj=f((q_,m)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",G=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},Qq=G,BA={},b;for(b in G)if(G.hasOwnProperty(b))BA[b]=G[b];var UA=[],aj="./this.program",Ij=function(A,j){throw j},CA=!1,g=!1,Bj=!1,ej=!1;CA=typeof window==="object";g=typeof importScripts==="function";Bj=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";ej=!CA&&!Bj&&!g;var W="";function Zq(A){if(G.locateFile)return G.locateFile(A,W);return W+A}var yA,Gj,LA,Wq,_j,kj;if(Bj){if(g)W=require("path").dirname(W)+"/";else W=__dirname+"/";if(yA=function A(j,q){if(!_j)_j=require("fs");if(!kj)kj=require("path");return j=kj.normalize(j),_j.readFileSync(j,q?null:"utf8")},LA=function A(j){var q=yA(j,!0);if(!q.buffer)q=new Uint8Array(q);return pj(q.buffer),q},process.argv.length>1)aj=process.argv[1].replace(/\\/g,"/");if(UA=process.argv.slice(2),typeof m!=="undefined")m.exports=G;process.on("uncaughtException",function(A){if(!(A instanceof _E))throw A}),process.on("unhandledRejection",FA),Ij=function(A){process.exit(A)},G.inspect=function(){return"[Emscripten Module object]"}}else if(ej){if(typeof read!="undefined")yA=function A(j){return read(j)};if(LA=function A(j){var q;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return q=read(j,"binary"),pj(typeof q==="object"),q},typeof scriptArgs!="undefined")UA=scriptArgs;else if(typeof arguments!="undefined")UA=arguments;if(typeof quit==="function")Ij=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(CA||g){if(g)W=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)W=document.currentScript.src;if(W.indexOf("blob:")!==0)W=W.substr(0,W.lastIndexOf("/")+1);else W="";{if(yA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},g)LA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};Gj=function(A,j,q){var E=new XMLHttpRequest;E.open("GET",A,!0),E.responseType="arraybuffer",E.onload=function(){if(E.status==200||E.status==0&&E.response){j(E.response);return}q()},E.onerror=q,E.send(null)}}Wq=function(A){document.title=A}}var eE=G.print||console.log.bind(console),GA=G.printErr||console.warn.bind(console);for(b in BA)if(BA.hasOwnProperty(b))G[b]=BA[b];BA=null;if(G.arguments)UA=G.arguments;if(G.thisProgram)aj=G.thisProgram;if(G.quit)Ij=G.quit;var KA;if(G.wasmBinary)KA=G.wasmBinary;var A_=G.noExitRuntime||!0;if(typeof WebAssembly!=="object")FA("no native wasm support detected");var TA,A6=!1,Sq;function pj(A,j){if(!A)FA("Assertion failed: "+j)}var Nq=0,Dq=1;function Vq(A,j){var q;if(j==Dq)q=F6(A.length);else q=T6(A.length);if(A.subarray||A.slice)l.set(A,q);else l.set(new Uint8Array(A),q);return q}var sj=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function Mq(A,j,q){var E=j+q,_=j;while(A[_]&&!(_>=E))++_;if(_-j>16&&A.subarray&&sj)return sj.decode(A.subarray(j,_));else{var k="";while(j<_){var $=A[j++];if(!($&128)){k+=String.fromCharCode($);continue}var I=A[j++]&63;if(($&224)==192){k+=String.fromCharCode(($&31)<<6|I);continue}var B=A[j++]&63;if(($&240)==224)$=($&15)<<12|I<<6|B;else $=($&7)<<18|I<<12|B<<6|A[j++]&63;if($<65536)k+=String.fromCharCode($);else{var U=$-65536;k+=String.fromCharCode(55296|U>>10,56320|U&1023)}}}return k}function wq(A,j){return A?Mq(l,A,j):""}function yq(A,j){if(A%j>0)A+=j-A%j;return A}var Uj,j6,l,q6,E6,_6,k6,$6,I6;function G6(A){Uj=A,G.HEAP8=j6=new Int8Array(A),G.HEAP16=q6=new Int16Array(A),G.HEAP32=_6=new Int32Array(A),G.HEAPU8=l=new Uint8Array(A),G.HEAPU16=E6=new Uint16Array(A),G.HEAPU32=k6=new Uint32Array(A),G.HEAPF32=$6=new Float32Array(A),G.HEAPF64=I6=new Float64Array(A)}var j_=G.INITIAL_MEMORY||16777216,vA,B6=[],U6=[],L6=[],vq=!1;function Oq(){if(G.preRun){if(typeof G.preRun=="function")G.preRun=[G.preRun];while(G.preRun.length)bq(G.preRun.shift())}Lj(B6)}function Cq(){vq=!0,Lj(U6)}function xq(){if(G.postRun){if(typeof G.postRun=="function")G.postRun=[G.postRun];while(G.postRun.length)uq(G.postRun.shift())}Lj(L6)}function bq(A){B6.unshift(A)}function hq(A){U6.unshift(A)}function uq(A){L6.unshift(A)}var c=0,$j=null,RA=null;function gq(A){if(c++,G.monitorRunDependencies)G.monitorRunDependencies(c)}function cq(A){if(c--,G.monitorRunDependencies)G.monitorRunDependencies(c);if(c==0){if($j!==null)clearInterval($j),$j=null;if(RA){var j=RA;RA=null,j()}}}G.preloadedImages={};G.preloadedAudios={};function FA(A){if(G.onAbort)G.onAbort(A);A+="",GA(A),A6=!0,Sq=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var lq="data:application/octet-stream;base64,";function R6(A){return A.startsWith(lq)}function K6(A){return A.startsWith("file://")}var Q="argon2.wasm";if(!R6(Q))Q=Zq(Q);function oj(A){try{if(A==Q&&KA)return new Uint8Array(KA);if(LA)return LA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){FA(j)}}function mq(){if(!KA&&(CA||g)){if(typeof fetch==="function"&&!K6(Q))return fetch(Q,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+Q+"'";return A.arrayBuffer()}).catch(function(){return oj(Q)});else if(Gj)return new Promise(function(A,j){Gj(Q,function(q){A(new Uint8Array(q))},j)})}return Promise.resolve().then(function(){return oj(Q)})}function nq(){var A={a:dq};function j($,I){var B=$.exports;G.asm=B,TA=G.asm.c,G6(TA.buffer),vA=G.asm.k,hq(G.asm.d),cq("wasm-instantiate")}gq("wasm-instantiate");function q($){j($.instance)}function E($){return mq().then(function(I){var B=WebAssembly.instantiate(I,A);return B}).then($,function(I){GA("failed to asynchronously prepare wasm: "+I),FA(I)})}function _(){if(!KA&&typeof WebAssembly.instantiateStreaming==="function"&&!R6(Q)&&!K6(Q)&&typeof fetch==="function")return fetch(Q,{credentials:"same-origin"}).then(function($){var I=WebAssembly.instantiateStreaming($,A);return I.then(q,function(B){return GA("wasm streaming compile failed: "+B),GA("falling back to ArrayBuffer instantiation"),E(q)})});else return E(q)}if(G.instantiateWasm)try{var k=G.instantiateWasm(A,j);return k}catch($){return GA("Module.instantiateWasm callback failed with error: "+$),!1}return _(),{}}function Lj(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(G);continue}var q=j.func;if(typeof q==="number")if(j.arg===void 0)vA.get(q)();else vA.get(q)(j.arg);else q(j.arg===void 0?null:j.arg)}}function iq(A,j,q){l.copyWithin(A,j,j+q)}function tq(A){try{return TA.grow(A-Uj.byteLength+65535>>>16),G6(TA.buffer),1}catch(j){}}function rq(A){var j=l.length;A=A>>>0;var q=2147418112;if(A>q)return!1;for(var E=1;E<=4;E*=2){var _=j*(1+0.2/E);_=Math.min(_,A+100663296);var k=Math.min(q,yq(Math.max(A,_),65536)),$=tq(k);if($)return!0}return!1}var dq={a:iq,b:rq},pq=nq(),sq=G.___wasm_call_ctors=function(){return(sq=G.___wasm_call_ctors=G.asm.d).apply(null,arguments)},oq=G._argon2_hash=function(){return(oq=G._argon2_hash=G.asm.e).apply(null,arguments)},T6=G._malloc=function(){return(T6=G._malloc=G.asm.f).apply(null,arguments)},aq=G._free=function(){return(aq=G._free=G.asm.g).apply(null,arguments)},eq=G._argon2_verify=function(){return(eq=G._argon2_verify=G.asm.h).apply(null,arguments)},AE=G._argon2_error_message=function(){return(AE=G._argon2_error_message=G.asm.i).apply(null,arguments)},jE=G._argon2_encodedlen=function(){return(jE=G._argon2_encodedlen=G.asm.j).apply(null,arguments)},qE=G._argon2_hash_ext=function(){return(qE=G._argon2_hash_ext=G.asm.l).apply(null,arguments)},EE=G._argon2_verify_ext=function(){return(EE=G._argon2_verify_ext=G.asm.m).apply(null,arguments)},F6=G.stackAlloc=function(){return(F6=G.stackAlloc=G.asm.n).apply(null,arguments)};G.allocate=Vq;G.UTF8ToString=wq;G.ALLOC_NORMAL=Nq;var OA;function _E(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}RA=function A(){if(!OA)Rj();if(!OA)RA=A};function Rj(A){if(A=A||UA,c>0)return;if(Oq(),c>0)return;function j(){if(OA)return;if(OA=!0,G.calledRun=!0,A6)return;if(Cq(),G.onRuntimeInitialized)G.onRuntimeInitialized();xq()}if(G.setStatus)G.setStatus("Running..."),setTimeout(function(){setTimeout(function(){G.setStatus("")},1),j()},1);else j()}G.run=Rj;if(G.preInit){if(typeof G.preInit=="function")G.preInit=[G.preInit];while(G.preInit.length>0)G.preInit.pop()()}Rj();if(typeof m!=="undefined")m.exports=G;G.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(G=Qq=TA=vA=pq=Uj=j6=l=q6=E6=_6=k6=$6=I6=void 0,typeof m!=="undefined")delete m.exports}});var P6=f((E_,kE)=>{kE.exports="./cryptit.cli.wasm"});var X6=f((H6,xA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof xA==="object"&&xA.exports)xA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:H6,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function q(L){if(q._promise)return q._promise;if(q._module)return Promise.resolve(q._module);let T;if(A.process&&A.process.versions&&A.process.versions.node)T=_().then((F)=>new Promise((Y)=>{F.postRun=()=>Y(F)}));else T=k().then((F)=>{let Y=L?I(L):void 0;return E(F,Y)});return q._promise=T,T.then((F)=>{return q._module=F,delete q._promise,F})}function E(L,T){return new Promise((F)=>{return A.Module={wasmBinary:L,wasmMemory:T,postRun(){F(Module)}},_()})}function _(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(Kj())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(P6()).then((T)=>{return $(T)})}function $(L){let T=atob(L),F=new Uint8Array(new ArrayBuffer(T.length));for(let Y=0;Y<T.length;Y++)F[Y]=T.charCodeAt(Y);return F}function I(L){let r=Math.min(Math.max(Math.ceil(L*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:r,maximum:32767})}function B(L,T){return L.allocate(T,"i8",L.ALLOC_NORMAL)}function U(L,T){let F=new Uint8Array([...T,0]);return B(L,F)}function R(L){if(typeof L!=="string")return L;if(typeof TextEncoder==="function")return new TextEncoder().encode(L);else if(typeof Buffer==="function")return Buffer.from(L);else throw new Error("Don't know how to encode UTF8")}function P(L){let T=L.mem||1024;return q(T).then((F)=>{let Y=L.time||1,EA=L.parallelism||1,_A=R(L.pass),r=U(F,_A),tA=_A.length,zA=R(L.salt),fA=U(F,zA),kA=zA.length,d=L.type||j.Argon2d,M=F.allocate(new Array(L.hashLen||24),"i8",F.ALLOC_NORMAL),O=L.secret?B(F,L.secret):0,$A=L.secret?L.secret.byteLength:0,Z=L.ad?B(F,L.ad):0,Aq=L.ad?L.ad.byteLength:0,QA=L.hashLen||24,Zj=F._argon2_encodedlen(Y,T,EA,kA,QA,d),rA=F.allocate(new Array(Zj+1),"i8",F.ALLOC_NORMAL),ME=19,p,ZA;try{ZA=F._argon2_hash_ext(Y,T,EA,r,tA,fA,kA,M,QA,rA,Zj,d,O,$A,Z,Aq,19)}catch(s){p=s}let WA;if(ZA===0&&!p){let s="",Wj=new Uint8Array(QA);for(let SA=0;SA<QA;SA++){let Sj=F.HEAP8[M+SA];Wj[SA]=Sj,s+=("0"+(255&Sj).toString(16)).slice(-2)}let jq=F.UTF8ToString(rA);WA={hash:Wj,hashHex:s,encoded:jq}}else{try{if(!p)p=F.UTF8ToString(F._argon2_error_message(ZA))}catch(s){}WA={message:p,code:ZA}}try{if(F._free(r),F._free(fA),F._free(M),F._free(rA),Z)F._free(Z);if(O)F._free(O)}catch(s){}if(p)throw WA;else return WA})}function H(L){return q().then((T)=>{let F=R(L.pass),Y=U(T,F),EA=F.length,_A=L.secret?B(T,L.secret):0,r=L.secret?L.secret.byteLength:0,tA=L.ad?B(T,L.ad):0,zA=L.ad?L.ad.byteLength:0,fA=R(L.encoded),kA=U(T,fA),d=L.type;if(d===void 0){let Z=L.encoded.split("$")[1];if(Z)Z=Z.replace("a","A"),d=j[Z]||j.Argon2d}let M,O;try{O=T._argon2_verify_ext(kA,Y,EA,_A,r,tA,zA,d)}catch(Z){M=Z}let $A;if(O||M){try{if(!M)M=T.UTF8ToString(T._argon2_error_message(O))}catch(Z){}$A={message:M,code:O}}try{T._free(Y),T._free(kA)}catch(Z){}if(M)throw $A;else return $A})}function X(){if(q._module)q._module.unloadRuntime(),delete q._promise,delete q._module}return{ArgonType:j,hash:P,verify:H,unloadRuntime:X}})});var f6=f((__,z6)=>{var bA=/^[a-z0-9-]{1,32}$/,hA=/^[a-z0-9-]{1,32}$/,uA=/^[a-zA-Z0-9/+.-]+$/,J6=/^([a-zA-Z0-9/+.-]+|)$/,$E=/^((-)?[1-9]\d*|0)$/,Tj=/^v=(\d+)$/;function IE(A){return PA(A).map((j)=>[j,A[j]].join("=")).join(",")}function GE(A){let j={};return A.split(",").forEach((q)=>{let E=q.split("=");if(E.length<2)throw new TypeError("params must be in the format name=value");j[E.shift()]=E.join("=")}),j}function PA(A){return Object.keys(A)}function Y6(A){if(typeof Object.values==="function")return Object.values(A);return PA(A).map((j)=>A[j])}function BE(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!bA.test(A.id))throw new TypeError(`id must satisfy ${bA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let E=PA(A.params);if(!E.every(($)=>hA.test($)))throw new TypeError(`params names must satisfy ${hA}`);E.forEach(($)=>{if(typeof A.params[$]==="number")A.params[$]=A.params[$].toString();else if(Buffer.isBuffer(A.params[$]))A.params[$]=A.params[$].toString("base64").split("=")[0]});let _=Y6(A.params);if(!_.every(($)=>typeof $==="string"))throw new TypeError("params values must be strings");if(!_.every(($)=>uA.test($)))throw new TypeError(`params values must satisfy ${uA}`);let k=IE(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function UE(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let q=5;if(!Tj.test(j[1]))q--;if(j.length>q)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${q}`);let E=j.shift();if(!bA.test(E))throw new TypeError(`id must satisfy ${bA}`);let _;if(Tj.test(j[0]))_=parseInt(j.shift().match(Tj)[1],10);let k,$;if(J6.test(j[j.length-1]))if(j.length>1&&J6.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),$=Buffer.from(j.pop(),"base64");else $=Buffer.from(j.pop(),"base64");let I;if(j.length>0){let U=j.pop();if(I=GE(U),!PA(I).every((H)=>hA.test(H)))throw new TypeError(`params names must satisfy ${hA}`);if(!Y6(I).every((H)=>uA.test(H)))throw new TypeError(`params values must satisfy ${uA}`);PA(I).forEach((H)=>{I[H]=$E.test(I[H])?parseInt(I[H],10):I[H]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let B={id:E};if(_)B.version=_;if(I)B.params=I;if($)B.salt=$;if(k)B.hash=k;return B}z6.exports={serialize:BE,deserialize:UE}});var h6=f((k_,b6)=>{var S6=require("fs"),v=require("path"),N6=require("os"),D6=typeof __webpack_require__==="function"?__non_webpack_require__:require,LE=process.config&&process.config.variables||{},RE=!!process.env.PREBUILDS_ONLY,Q6=process.versions.modules,Fj=FE()?"electron":TE()?"node-webkit":"node",Pj=process.env.npm_config_arch||N6.arch(),Hj=process.env.npm_config_platform||N6.platform(),V6=process.env.LIBC||(PE(Hj)?"musl":"glibc"),Xj=process.env.ARM_VERSION||(Pj==="arm64"?"8":LE.arm_version)||"",M6=(process.versions.uv||"").split(".")[0];b6.exports=w;function w(A){return D6(w.resolve(A))}w.resolve=w.path=function(A){A=v.resolve(A||".");try{var j=D6(v.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(B){}if(!RE){var q=Z6(v.join(A,"build/Release"),W6);if(q)return q;var E=Z6(v.join(A,"build/Debug"),W6);if(E)return E}var _=I(A);if(_)return _;var k=I(v.dirname(process.execPath));if(k)return k;var $=["platform="+Hj,"arch="+Pj,"runtime="+Fj,"abi="+Q6,"uv="+M6,Xj?"armv="+Xj:"","libc="+V6,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+$+`
    loaded from: `+A+`
`);function I(B){var U=Jj(v.join(B,"prebuilds")).map(w6),R=U.filter(y6(Hj,Pj)).sort(v6)[0];if(!R)return;var P=v.join(B,"prebuilds",R.name),H=Jj(P).map(O6),X=H.filter(C6(Fj,Q6)),L=X.sort(x6(Fj))[0];if(L)return v.join(P,L.file)}};function Jj(A){try{return S6.readdirSync(A)}catch(j){return[]}}function Z6(A,j){var q=Jj(A).filter(j);return q[0]&&v.join(A,q[0])}function W6(A){return/\.node$/.test(A)}function w6(A){var j=A.split("-");if(j.length!==2)return;var q=j[0],E=j[1].split("+");if(!q)return;if(!E.length)return;if(!E.every(Boolean))return;return{name:A,platform:q,architectures:E}}function y6(A,j){return function(q){if(q==null)return!1;if(q.platform!==A)return!1;return q.architectures.includes(j)}}function v6(A,j){return A.architectures.length-j.architectures.length}function O6(A){var j=A.split("."),q=j.pop(),E={file:A,specificity:0};if(q!=="node")return;for(var _=0;_<j.length;_++){var k=j[_];if(k==="node"||k==="electron"||k==="node-webkit")E.runtime=k;else if(k==="napi")E.napi=!0;else if(k.slice(0,3)==="abi")E.abi=k.slice(3);else if(k.slice(0,2)==="uv")E.uv=k.slice(2);else if(k.slice(0,4)==="armv")E.armv=k.slice(4);else if(k==="glibc"||k==="musl")E.libc=k;else continue;E.specificity++}return E}function C6(A,j){return function(q){if(q==null)return!1;if(q.runtime&&q.runtime!==A&&!KE(q))return!1;if(q.abi&&q.abi!==j&&!q.napi)return!1;if(q.uv&&q.uv!==M6)return!1;if(q.armv&&q.armv!==Xj)return!1;if(q.libc&&q.libc!==V6)return!1;return!0}}function KE(A){return A.runtime==="node"&&A.napi}function x6(A){return function(j,q){if(j.runtime!==q.runtime)return j.runtime===A?-1:1;else if(j.abi!==q.abi)return j.abi?-1:1;else if(j.specificity!==q.specificity)return j.specificity>q.specificity?-1:1;else return 0}}function TE(){return!!(process.versions&&process.versions.nw)}function FE(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function PE(A){return A==="linux"&&S6.existsSync("/etc/alpine-release")}w.parseTags=O6;w.matchTags=C6;w.compareTags=x6;w.parseTuple=w6;w.matchTuple=y6;w.compareTuples=v6});var u6=f(($_,zj)=>{var Yj=typeof __webpack_require__==="function"?__non_webpack_require__:require;if(typeof Yj.addon==="function")zj.exports=Yj.addon.bind(Yj);else zj.exports=h6()});var m6=f((G_,n)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",I_=require("node:assert"),{randomBytes:HE,timingSafeEqual:XE}=require("node:crypto"),{promisify:JE}=require("node:util"),{deserialize:g6,serialize:YE}=f6(),zE=u6(),{hash:c6}=zE(__dirname),fE=JE(HE);n.exports.argon2d=0;n.exports.argon2i=1;n.exports.argon2id=2;var HA=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),QE=Object.freeze({[HA.argon2d]:"argon2d",[HA.argon2i]:"argon2i",[HA.argon2id]:"argon2id"}),l6={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function ZE(A,j){let{raw:q,salt:E,..._}={...l6,...j};if(_.hashLength>4294967295)throw new RangeError("Hash length is too large");if(_.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(_.timeCost>4294967295)throw new RangeError("Time cost is too large");if(_.parallelism>16777215)throw new RangeError("Parallelism is too large");E=E??await fE(16);let{hashLength:k,secret:$=Buffer.alloc(0),type:I,version:B,memoryCost:U,timeCost:R,parallelism:P,associatedData:H=Buffer.alloc(0)}=_,X=await c6({password:Buffer.from(A),salt:E,secret:$,data:H,hashLength:k,m:U,t:R,p:P,version:B,type:I});if(q)return X;return YE({id:QE[I],version:B,params:{m:U,t:R,p:P,...H.byteLength>0?{data:H}:{}},salt:E,hash:X})}n.exports.hash=ZE;function WE(A,j={}){let{memoryCost:q,timeCost:E,parallelism:_,version:k}={...l6,...j},{version:$,params:{m:I,t:B,p:U}}=g6(A);return+$!==+k||+I!==+q||+B!==+E||+U!==+_}n.exports.needsRehash=WE;async function SE(A,j,q={}){let{id:E,..._}=g6(A);if(!(E in HA))return!1;let{version:k=16,params:{m:$,t:I,p:B,data:U=""},salt:R,hash:P}=_,{secret:H=Buffer.alloc(0)}=q;return XE(await c6({password:Buffer.from(j),salt:R,secret:H,data:Buffer.from(U,"base64"),hashLength:P.byteLength,m:+$,t:+I,p:+B,version:+k,type:HA[E]}),P)}n.exports.verify=SE});var rj=NA(tj()),{program:hE,createCommand:uE,createArgument:gE,createOption:cE,CommanderError:lE,InvalidArgumentError:mE,InvalidOptionArgumentError:nE,Command:dj,Argument:iE,Option:o,Help:tE}=rj.default;var t=require("node:fs"),qA=require("node:fs"),K=require("node:process"),nA=require("node:stream"),s6=require("node:fs/promises");class u extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class C extends u{}class MA extends u{}class a extends u{}class x extends u{}class wA extends u{}class D extends u{}class z{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new MA(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new MA(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class Ej{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),q=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),E=new Uint8Array(j.length+q.length);return E.set(j),E.set(q,j.length),E}async decryptChunk(A){let j=A.slice(0,12),q=A.slice(12),E=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,q);try{let _=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,q);return new Uint8Array(_)}catch{throw new D("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var gA=NA(X6());async function n6(A,j,q,E){if(E==="node"){let _=await Promise.resolve().then(() => NA(m6())),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),$=Buffer.from(j),I=await _.hash(k,{salt:$,timeCost:q.time,memoryCost:q.mem,parallelism:q.parallelism,hashLength:32,raw:!0,type:_.argon2id});return{hash:new Uint8Array(I)}}if(E==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>{let _=new URL("argon2.wasm",import.meta.url).href;return fetch(_).then((k)=>{if(!k.ok)throw new Error("Failed to load argon2.wasm");return k.arrayBuffer()}).then((k)=>new Uint8Array(k))};return gA.hash({pass:A,salt:j,time:q.time,mem:q.mem,parallelism:q.parallelism,hashLen:32,type:gA.ArgonType.Argon2id}).then((_)=>{if(!_||!_.hash)throw new Error("Failed to produce key derivation");return{hash:_.hash}}).catch((_)=>{let k=_ instanceof Error?_.message:typeof _==="string"?_:"Unknown error";throw new x(`argon2-browser failure: ${k}`)})}throw new Error(`Unsupported environment: ${E}`)}class fj{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,q,E){let{hash:_}=await n6(A,j,this.presets[q],E.isNode?"node":"browser");return E.subtle.importKey("raw",_,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var i6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},NE={id:0,cipher:Ej,kdf:new fj(i6),saltLengths:{low:12,high:16},difficulties:i6,defaultChunkSize:524288};z.register(NE);var cA=1;function t6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function XA(...A){let j=A.reduce((_,k)=>_+k.byteLength,0),q=new Uint8Array(j),E=0;for(let _ of A)q.set(_,E),E+=_.byteLength;return q}function JA(...A){let j=XA(...A);if(t6())return Buffer.from(j).toString("base64");let q="";for(let E=0;E<j.length;E++)q+=String.fromCharCode(j[E]);return btoa(q)}function Qj(A){if(t6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),q=new Uint8Array(j.length);for(let E=0;E<j.length;E++)q[E]=j.charCodeAt(E);return q}function lA(A,j,q,E){let _={low:0,middle:1,high:2}[j]??0,k=A<<5|(q==="high"?1:0)<<2|_;return XA(new Uint8Array([cA,k]),E)}function i(A){if(A[0]!==cA)throw new C("Invalid input format. The input is unknown.");try{let j=A[1],q=j>>5,E=j>>2&1?"high":"low",_=j&3,k=["low","middle","high"][_],$=z.get(q).saltLengths[E],I=A.slice(2,2+$);return{version:q,difficulty:k,saltStrength:E,salt:I,headerLen:2+$}}catch(j){throw new a(j instanceof Error?j.message:String(j))}}class YA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let q=new Uint8Array(this.buffer.length+A.length);q.set(this.buffer),q.set(A,this.buffer.length);let E=0;while(q.length-E>=this.chunkSize){let _=q.slice(E,E+this.chunkSize);E+=this.chunkSize;let k=await this.engine.encryptChunk(_),$=new Uint8Array(4);new DataView($.buffer).setUint32(0,k.length,!1);let I=new Uint8Array(4+k.length);I.set($),I.set(k,$.length),j.enqueue(I)}this.buffer=q.slice(E)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),q=new Uint8Array(4);new DataView(q.buffer).setUint32(0,j.length,!1);let E=new Uint8Array(4+j.length);E.set(q),E.set(j,4),A.enqueue(E),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class e{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let q=new Uint8Array(this.buffer.length+A.length);q.set(this.buffer),q.set(A,this.buffer.length);let E=0;while(!0){if(q.length-E<4)break;let _=new DataView(q.buffer,q.byteOffset+E,4).getUint32(0,!1);if(q.length-E-4<_)break;E+=4;let k=q.slice(E,E+_);E+=_;try{let $=await this.engine.decryptChunk(k);j.enqueue($)}catch($){throw $ instanceof D?$:new D("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=q.slice(E)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class AA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new YA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,q=new TransformStream({transform(_,k){if(j===0){k.enqueue(_);return}if(_.byteLength<=j){j-=_.byteLength;return}k.enqueue(_.slice(j)),j=0}}),E=new e(this.engine,this.chunkSize).toTransformStream();return{writable:q.writable,readable:q.readable.pipeThrough(E)}}async collect(A,j,q=null){let E=A.pipeThrough(j).getReader(),_=[];if(q?.length)_.push(q);while(!0){let{value:B,done:U}=await E.read();if(U)break;_.push(B)}let k=_.reduce((B,U)=>B+U.byteLength,0),$=new Uint8Array(k),I=0;for(let B of _)$.set(B,I),I+=B.byteLength;return $}}function r6(A=0,j=console.info){return{level:A,log(q,E){if(q<=A)j(`${q}| ${E}`)}}}var d6=new Map;class h{static getEngine(A,j){let q=d6.get(j);if(q)return q;let E=z.get(j),_=new E.cipher(A),k=E.kdf,$=E.defaultChunkSize;return q={desc:E,cipher:_,kdf:k,chunkSize:$,provider:A},d6.set(j,q),q}static async deriveKey(A,j,q,E){try{let _=await A.kdf.derive(j,q,E,A.provider);A.cipher.key=_}catch(_){let k=_ instanceof Error?_.message:String(_);throw new x(k)}}}class V{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=z.get(j.version??z.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new AA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=r6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await V.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await V.peekHeader(A),q=i(j);return{version:q.version,difficulty:q.difficulty,salt:JA(q.salt),saltLength:q.salt.byteLength}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setVersion(A){this.v=z.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new AA(this.cipher,this.chunkSize)}getVersion(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){this.chunkSize=A,this.stream=new AA(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){try{this.log.log(1,"Start text encryption"),this.log.log(2,"Deriving key for text encryption");let q=this.genSalt();await this.deriveKey(j,q),this.log.log(3,`Salt generated: ${JA(q)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let E=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.log.log(3,"Encoding header");let _=lA(this.v.id,this.difficulty,this.saltStrength,q);return this.log.log(3,"Encoding text"),JA(_,E)}catch(q){throw new wA(q instanceof Error?q.message:String(q))}}async decryptText(A,j){try{this.log.log(1,"Start text decryption");let q=Qj(A);this.log.log(3,"Start header decoding"),await V.peekHeader(A);let E=i(q);this.log.log(3,"Trying to get engine");let _=h.getEngine(this.provider,E.version);this.log.log(2,"Deriving key via engine for text decryption"),this.log.log(3,`Salt use: ${JA(E.salt)}, KDF difficulty: ${E.difficulty}`),await h.deriveKey(_,j,E.salt,E.difficulty),this.log.log(2,"Decrypting text data");let k=await _.cipher.decryptChunk(q.slice(E.headerLen));return this.log.log(3,"Decoding text"),new TextDecoder().decode(k)}catch(q){if(q instanceof D||q instanceof C||q instanceof a||q instanceof x)throw q;throw new D("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){try{this.log.log(2,"Deriving key for file encryption");let q=this.genSalt();await this.deriveKey(j,q);let E=lA(this.v.id,this.difficulty,this.saltStrength,q),_=await this.stream.collect(A.stream(),new YA(this.cipher,this.chunkSize).toTransformStream(),E);return new Blob([_],{type:"application/octet-stream"})}catch(q){throw new wA(q instanceof Error?q.message:String(q))}}async decryptFile(A,j){try{let q=await V.peekHeader(A),E=i(q),_=h.getEngine(this.provider,E.version);await h.deriveKey(_,j,E.salt,E.difficulty),this.log.log(2,"Decrypting file data");let $=await new AA(_.cipher,_.chunkSize).collect(A.slice(E.headerLen).stream(),new e(_.cipher,_.chunkSize).toTransformStream());return new Blob([$],{type:"application/octet-stream"})}catch(q){if(q instanceof D)throw q;throw new D(q instanceof Error?q.message:String(q))}}async createEncryptionStream(A){this.log.log(2,"Deriving key for stream encryption");let j=this.genSalt();await this.deriveKey(A,j);let q=lA(this.v.id,this.difficulty,this.saltStrength,j),E=this.stream.encryptionStream();return{header:q,writable:E.writable,readable:E.readable}}async createDecryptionStream(A){let j=this,q=new Uint8Array(0),E=null;async function _(k,$){let I=k.getReader();while(!0){let{value:B,done:U}=await I.read();if(U)break;$.enqueue(B)}}return new TransformStream({async transform(k,$){if(!E){if(q=XA(q,k),q.length<2)return;let B=q.slice(0,30),{salt:U,difficulty:R}=i(B),P=q[1]>>5,H=q[1]>>2&1?"high":"low",L=2+z.get(P).saltLengths[H];if(q.length<L)return;let T=h.getEngine(j.provider,P);await h.deriveKey(T,A,U,R),E=new e(T.cipher,T.chunkSize).toTransformStream(),_(E.readable,$);let F=q.slice(L);if(F.length){let Y=E.writable.getWriter();await Y.write(F),Y.releaseLock()}return}let I=E.writable.getWriter();await I.write(k),I.releaseLock()},async flush(){if(E){let k=E.writable.getWriter();await k.close(),k.releaseLock()}}})}async deriveKey(A,j,q=this.difficulty){let E=performance.now();try{let _=await this.kdf.derive(A,j,q,this.provider);this.cipher.key=_,this.log.log(3,`Key derivation completed in ${(performance.now()-E).toFixed(1)} ms`)}catch(_){throw new x(_ instanceof Error?_.message:String(_))}}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}static async peekHeader(A){if(typeof A==="string")A=Qj(A);if(A instanceof Uint8Array){if(A.length<2)throw new C("Input too short");let{headerLen:j}=i(A.length>=16?A:Uint8Array.from(A));if(A.length<j)throw new C("Incomplete header");return A.slice(0,j)}if(A instanceof Blob){let j=new Uint8Array(await A.slice(0,2).arrayBuffer());if(j[0]!==1)throw new C("Invalid input format. The input is unknown.");let q=j[1],E=q>>5,_=q>>2&1?"high":"low",k=z.get(E).saltLengths[_],$=new Uint8Array(await A.slice(0,2+k).arrayBuffer());return i($),$}throw new a("Unsupported input type")}}var mA=require("node:crypto"),p6={subtle:mA.webcrypto.subtle,getRandomValues(A){return mA.randomFillSync(A),A},isNode:!0};function jA(A){return new V(p6,A)}var DE="0.2.3";async function iA(){if(!K.stdin.isTTY)throw new Error("STDIN not a TTY; use --pass");K.stderr.write("Passphrase: "),K.stdin.setRawMode?.(!0),K.stdin.resume(),K.stdin.setEncoding("utf8");let A="";return new Promise((j)=>{function q(){K.stdin.setRawMode?.(!1),K.stdin.pause(),K.stderr.write(`
`),K.stdin.off("data",E),j(A)}function E(_){if(_==="\x03")K.exit(130);if(_==="\r"||_===`
`)return q();if(_==="\b"||_===""){A=A.slice(0,-1);return}A+=_}K.stdin.on("data",E)})}function o6(A){return nA.Readable.toWeb(A)}function a6(A){return nA.Writable.toWeb(A)}async function e6(){let A=[];for await(let j of K.stdin)A.push(j);return Buffer.concat(A).toString("utf8")}var S=new dj;S.name("cryptit").version(DE).description("AES-GCM / Argon2 encryption utility").addOption(new o("-p, --pass <passphrase>","passphrase (prompt if omitted)").hideHelp().argParser((A)=>{if(!A.trim())throw new Error("Passphrase cannot be empty");return A})).addOption(new o("-d, --difficulty <level>","argon2 difficulty").choices(["low","middle","high"]).default("middle","middle")).addOption(new o("-s, --salt-strength <variant>","salt length variant").choices(["low","high"]).default("high","high")).addOption(new o("-c, --chunk-size <bytes>","chunk size in bytes").argParser((A)=>{let j=Number(A);if(!Number.isInteger(j)||j<=0)throw new Error("Chunk size must be a positive integer");return j}).default(524288,"512*1024")).addOption(new o("-v, --verbose","increase verbosity (use multiple times)").default(0).argParser((A,j)=>{return j+1}));process.on("uncaughtException",(A)=>{if(A instanceof Error){let j=A.constructor.name,q=A.message;K.stderr.write(`Error [${j}]: ${q}
`)}else K.stderr.write(`Error [Unknown]: ${String(A)}
`);K.exit(1)});process.on("unhandledRejection",(A)=>{if(A instanceof Error){let j=A.constructor.name,q=A.message;K.stderr.write(`Error [${j}]: ${q}
`)}else K.stderr.write(`Error [Unknown]: ${String(A)}
`);K.exit(1)});async function VE(){let A=[];for await(let j of K.stdin)A.push(j);return Buffer.concat(A)}S.command("decode [src]").description("Show Cryptit header information; omit arg or use - to read from STDIN").action(async(A)=>{let{verbose:j}=S.opts(),E=jA({verbose:j,logger:(U)=>K.stderr.write(U)}),_=!A||A==="-";async function k(U){if(U.length<2)throw new Error("Input too short for header");let R=U[1],P=R>>5,H=R>>2&1?"high":"low",X=z.get(P).saltLengths[H],L=U.slice(0,2+X);return V.headerDecode(L)}if(!_&&A){let U=await s6.open(A,"r"),R=Buffer.alloc(2);await U.read(R,0,2,0);let P=R[1],H=P>>5,X=P>>2&1?"high":"low",L=z.get(H).saltLengths[X],T=Buffer.alloc(2+L);await U.read(T,0,2+L,0),await U.close();let F=await V.headerDecode(new Uint8Array(T));K.stdout.write(JSON.stringify(F,null,2)+`
`);return}let $=_?await VE():Buffer.from(A,"utf8"),I=$.toString("utf8").trim(),B=/^[A-Za-z0-9\/+]+={0,2}$/.test(I)&&I.length%4===0;try{let U=B?await V.headerDecode(I):await k($);K.stdout.write(JSON.stringify(U,null,2)+`
`)}catch(U){let R=U instanceof Error?U.message:String(U);K.stderr.write(`Error: ${R}
`),K.exit(1)}});S.command("encrypt <src>").description("Encrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async(A,j)=>{if(A!=="-"&&!t.existsSync(A))K.stderr.write(`Error: input file not found: ${A}
`),K.exit(1);let q=S.opts(),E=jA({difficulty:q.difficulty,saltStrength:q.saltStrength,chunkSize:q.chunkSize,verbose:q.verbose}),_=q.pass??(K.stdin.isTTY?await iA():(()=>{K.stderr.write(`Use --pass when piping via STDIN
`),K.exit(1)})()),k=j.out;if(k!=="-"&&!t.existsSync(k)&&!t.existsSync(require("path").dirname(k)))K.stderr.write(`Error: output directory does not exist: ${require("path").dirname(k)}
`),K.exit(1);let $=A==="-"?K.stdin:qA.createReadStream(A),I=j.out==="-"?K.stdout:qA.createWriteStream(j.out),{header:B,writable:U,readable:R}=await E.createEncryptionStream(_),P=o6($),H=a6(I),X=H.getWriter();await X.write(B),X.releaseLock(),await Promise.all([P.pipeTo(U),R.pipeTo(H)])});S.command("decrypt <src>").description("Decrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async(A,j)=>{if(A!=="-"&&!t.existsSync(A))K.stderr.write(`Error: input file not found: ${A}
`),K.exit(1);let q=S.opts(),E=jA({difficulty:q.difficulty,saltStrength:q.saltStrength,chunkSize:q.chunkSize,verbose:q.verbose}),_=j.out;if(_!=="-"&&!t.existsSync(_)&&!t.existsSync(require("path").dirname(_)))K.stderr.write(`Error: output directory does not exist: ${require("path").dirname(_)}
`),K.exit(1);let k=q.pass??await iA(),$=A==="-"?K.stdin:qA.createReadStream(A),I=j.out==="-"?K.stdout:qA.createWriteStream(j.out),B=o6($),U=a6(I),R=await E.createDecryptionStream(k);await Promise.all([B.pipeTo(R.writable),R.readable.pipeTo(U)])});S.command("encrypt-text [text]").description("Encrypt plaintext; omit arg to read from STDIN").action(async(A)=>{let j=S.opts(),q=jA({difficulty:j.difficulty,saltStrength:j.saltStrength,verbose:j.verbose}),E=j.pass??(K.stdin.isTTY?await iA():(()=>{K.stderr.write(`Use --pass when piping via STDIN
`),K.exit(1)})()),_=A??await e6(),k=await q.encryptText(_,E);K.stdout.write(k+`
`)});S.command("decrypt-text [b64]").description("Decrypt Base64 ciphertext; omit arg to read from STDIN").action(async(A)=>{let j=S.opts(),q=jA({difficulty:j.difficulty,saltStrength:j.saltStrength,verbose:j.verbose}),E=j.pass??await iA(),_=A??(await e6()).trim();if(!/^[A-Za-z0-9+/]+={0,2}$/.test(_))K.stderr.write(`Error: ciphertext does not look like Base64
`),K.exit(1);let k=await q.decryptText(_,E);K.stdout.write(k+`
`)});S.parse();

//# debugId=3A1EA10366EB647A64756E2164756E21
