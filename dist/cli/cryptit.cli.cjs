#!/usr/bin/env node
var nY=Object.create;var{getPrototypeOf:sY,defineProperty:E$,getOwnPropertyNames:rY}=Object;var oY=Object.prototype.hasOwnProperty;var _0=($,Y,J)=>{J=$!=null?nY(sY($)):{};let Q=Y||!$||!$.__esModule?E$(J,"default",{value:$,enumerable:!0}):J;for(let Z of rY($))if(!oY.call(Q,Z))E$(Q,Z,{get:()=>$[Z],enumerable:!0});return Q};var i=($,Y)=>()=>(Y||$((Y={exports:{}}).exports,Y),Y.exports);var S0=i((Y$)=>{class $$ extends Error{constructor($,Y,J){super(J);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=Y,this.exitCode=$,this.nestedError=void 0}}class j$ extends $${constructor($){super(1,"commander.invalidArgument",$);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}Y$.CommanderError=$$;Y$.InvalidArgumentError=j$});var b0=i((J$)=>{var{InvalidArgumentError:aY}=S0();class A${constructor($,Y){switch(this.description=Y||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,$[0]){case"<":this.required=!0,this._name=$.slice(1,-1);break;case"[":this.required=!1,this._name=$.slice(1,-1);break;default:this.required=!0,this._name=$;break}if(this._name.length>3&&this._name.slice(-3)==="...")this.variadic=!0,this._name=this._name.slice(0,-3)}name(){return this._name}_concatValue($,Y){if(Y===this.defaultValue||!Array.isArray(Y))return[$];return Y.concat($)}default($,Y){return this.defaultValue=$,this.defaultValueDescription=Y,this}argParser($){return this.parseArg=$,this}choices($){return this.argChoices=$.slice(),this.parseArg=(Y,J)=>{if(!this.argChoices.includes(Y))throw new aY(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(Y,J);return Y},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}}function tY($){let Y=$.name()+($.variadic===!0?"...":"");return $.required?"<"+Y+">":"["+Y+"]"}J$.Argument=A$;J$.humanReadableArgName=tY});var Q$=i((O$)=>{var{humanReadableArgName:eY}=b0();class w${constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands($){let Y=$.commands.filter((J)=>!J._hidden);if($._hasImplicitHelpCommand()){let[,J,Q]=$._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),Z=$.createCommand(J).helpOption(!1);if(Z.description($._helpCommandDescription),Q)Z.arguments(Q);Y.push(Z)}if(this.sortSubcommands)Y.sort((J,Q)=>{return J.name().localeCompare(Q.name())});return Y}compareOptions($,Y){let J=(Q)=>{return Q.short?Q.short.replace(/^-/,""):Q.long.replace(/^--/,"")};return J($).localeCompare(J(Y))}visibleOptions($){let Y=$.options.filter((Z)=>!Z.hidden),J=$._hasHelpOption&&$._helpShortFlag&&!$._findOption($._helpShortFlag),Q=$._hasHelpOption&&!$._findOption($._helpLongFlag);if(J||Q){let Z;if(!J)Z=$.createOption($._helpLongFlag,$._helpDescription);else if(!Q)Z=$.createOption($._helpShortFlag,$._helpDescription);else Z=$.createOption($._helpFlags,$._helpDescription);Y.push(Z)}if(this.sortOptions)Y.sort(this.compareOptions);return Y}visibleGlobalOptions($){if(!this.showGlobalOptions)return[];let Y=[];for(let J=$.parent;J;J=J.parent){let Q=J.options.filter((Z)=>!Z.hidden);Y.push(...Q)}if(this.sortOptions)Y.sort(this.compareOptions);return Y}visibleArguments($){if($._argsDescription)$.registeredArguments.forEach((Y)=>{Y.description=Y.description||$._argsDescription[Y.name()]||""});if($.registeredArguments.find((Y)=>Y.description))return $.registeredArguments;return[]}subcommandTerm($){let Y=$.registeredArguments.map((J)=>eY(J)).join(" ");return $._name+($._aliases[0]?"|"+$._aliases[0]:"")+($.options.length?" [options]":"")+(Y?" "+Y:"")}optionTerm($){return $.flags}argumentTerm($){return $.name()}longestSubcommandTermLength($,Y){return Y.visibleCommands($).reduce((J,Q)=>{return Math.max(J,Y.subcommandTerm(Q).length)},0)}longestOptionTermLength($,Y){return Y.visibleOptions($).reduce((J,Q)=>{return Math.max(J,Y.optionTerm(Q).length)},0)}longestGlobalOptionTermLength($,Y){return Y.visibleGlobalOptions($).reduce((J,Q)=>{return Math.max(J,Y.optionTerm(Q).length)},0)}longestArgumentTermLength($,Y){return Y.visibleArguments($).reduce((J,Q)=>{return Math.max(J,Y.argumentTerm(Q).length)},0)}commandUsage($){let Y=$._name;if($._aliases[0])Y=Y+"|"+$._aliases[0];let J="";for(let Q=$.parent;Q;Q=Q.parent)J=Q.name()+" "+J;return J+Y+" "+$.usage()}commandDescription($){return $.description()}subcommandDescription($){return $.summary()||$.description()}optionDescription($){let Y=[];if($.argChoices)Y.push(`choices: ${$.argChoices.map((J)=>JSON.stringify(J)).join(", ")}`);if($.defaultValue!==void 0){if($.required||$.optional||$.isBoolean()&&typeof $.defaultValue==="boolean")Y.push(`default: ${$.defaultValueDescription||JSON.stringify($.defaultValue)}`)}if($.presetArg!==void 0&&$.optional)Y.push(`preset: ${JSON.stringify($.presetArg)}`);if($.envVar!==void 0)Y.push(`env: ${$.envVar}`);if(Y.length>0)return`${$.description} (${Y.join(", ")})`;return $.description}argumentDescription($){let Y=[];if($.argChoices)Y.push(`choices: ${$.argChoices.map((J)=>JSON.stringify(J)).join(", ")}`);if($.defaultValue!==void 0)Y.push(`default: ${$.defaultValueDescription||JSON.stringify($.defaultValue)}`);if(Y.length>0){let J=`(${Y.join(", ")})`;if($.description)return`${$.description} ${J}`;return J}return $.description}formatHelp($,Y){let J=Y.padWidth($,Y),Q=Y.helpWidth||80,Z=2,U=2;function q(T,R){if(R){let V=`${T.padEnd(J+2)}${R}`;return Y.wrap(V,Q-2,J+2)}return T}function G(T){return T.join(`
`).replace(/^/gm," ".repeat(2))}let X=[`Usage: ${Y.commandUsage($)}`,""],W=Y.commandDescription($);if(W.length>0)X=X.concat([Y.wrap(W,Q,0),""]);let z=Y.visibleArguments($).map((T)=>{return q(Y.argumentTerm(T),Y.argumentDescription(T))});if(z.length>0)X=X.concat(["Arguments:",G(z),""]);let H=Y.visibleOptions($).map((T)=>{return q(Y.optionTerm(T),Y.optionDescription(T))});if(H.length>0)X=X.concat(["Options:",G(H),""]);if(this.showGlobalOptions){let T=Y.visibleGlobalOptions($).map((R)=>{return q(Y.optionTerm(R),Y.optionDescription(R))});if(T.length>0)X=X.concat(["Global Options:",G(T),""])}let K=Y.visibleCommands($).map((T)=>{return q(Y.subcommandTerm(T),Y.subcommandDescription(T))});if(K.length>0)X=X.concat(["Commands:",G(K),""]);return X.join(`
`)}padWidth($,Y){return Math.max(Y.longestOptionTermLength($,Y),Y.longestGlobalOptionTermLength($,Y),Y.longestSubcommandTermLength($,Y),Y.longestArgumentTermLength($,Y))}wrap($,Y,J,Q=40){let U=new RegExp(`[\\n][${" \\f\\t\\v   -   　\uFEFF"}]+`);if($.match(U))return $;let q=Y-J;if(q<Q)return $;let G=$.slice(0,J),X=$.slice(J).replace(`\r
`,`
`),W=" ".repeat(J),H=`\\s${"​"}`,K=new RegExp(`
|.{1,${q-1}}([${H}]|$)|[^${H}]+?([${H}]|$)`,"g"),T=X.match(K)||[];return G+T.map((R,V)=>{if(R===`
`)return"";return(V>0?W:"")+R.trimEnd()}).join(`
`)}}O$.Help=w$});var Z$=i((f0)=>{var{InvalidArgumentError:$J}=S0();class C${constructor($,Y){this.flags=$,this.description=Y||"",this.required=$.includes("<"),this.optional=$.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test($),this.mandatory=!1;let J=v$($);if(this.short=J.shortFlag,this.long=J.longFlag,this.negate=!1,this.long)this.negate=this.long.startsWith("--no-");this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default($,Y){return this.defaultValue=$,this.defaultValueDescription=Y,this}preset($){return this.presetArg=$,this}conflicts($){return this.conflictsWith=this.conflictsWith.concat($),this}implies($){let Y=$;if(typeof $==="string")Y={[$]:!0};return this.implied=Object.assign(this.implied||{},Y),this}env($){return this.envVar=$,this}argParser($){return this.parseArg=$,this}makeOptionMandatory($=!0){return this.mandatory=!!$,this}hideHelp($=!0){return this.hidden=!!$,this}_concatValue($,Y){if(Y===this.defaultValue||!Array.isArray(Y))return[$];return Y.concat($)}choices($){return this.argChoices=$.slice(),this.parseArg=(Y,J)=>{if(!this.argChoices.includes(Y))throw new $J(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(Y,J);return Y},this}name(){if(this.long)return this.long.replace(/^--/,"");return this.short.replace(/^-/,"")}attributeName(){return YJ(this.name().replace(/^no-/,""))}is($){return this.short===$||this.long===$}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class k${constructor($){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,$.forEach((Y)=>{if(Y.negate)this.negativeOptions.set(Y.attributeName(),Y);else this.positiveOptions.set(Y.attributeName(),Y)}),this.negativeOptions.forEach((Y,J)=>{if(this.positiveOptions.has(J))this.dualOptions.add(J)})}valueFromOption($,Y){let J=Y.attributeName();if(!this.dualOptions.has(J))return!0;let Q=this.negativeOptions.get(J).presetArg,Z=Q!==void 0?Q:!1;return Y.negate===(Z===$)}}function YJ($){return $.split("-").reduce((Y,J)=>{return Y+J[0].toUpperCase()+J.slice(1)})}function v$($){let Y,J,Q=$.split(/[ |,]+/);if(Q.length>1&&!/^[[<]/.test(Q[1]))Y=Q.shift();if(J=Q.shift(),!Y&&/^-[^-]$/.test(J))Y=J,J=void 0;return{shortFlag:Y,longFlag:J}}f0.Option=C$;f0.splitOptionFlags=v$;f0.DualOptions=k$});var b$=i((y$)=>{function JJ($,Y){if(Math.abs($.length-Y.length)>3)return Math.max($.length,Y.length);let J=[];for(let Q=0;Q<=$.length;Q++)J[Q]=[Q];for(let Q=0;Q<=Y.length;Q++)J[0][Q]=Q;for(let Q=1;Q<=Y.length;Q++)for(let Z=1;Z<=$.length;Z++){let U=1;if($[Z-1]===Y[Q-1])U=0;else U=1;if(J[Z][Q]=Math.min(J[Z-1][Q]+1,J[Z][Q-1]+1,J[Z-1][Q-1]+U),Z>1&&Q>1&&$[Z-1]===Y[Q-2]&&$[Z-2]===Y[Q-1])J[Z][Q]=Math.min(J[Z][Q],J[Z-2][Q-2]+1)}return J[$.length][Y.length]}function QJ($,Y){if(!Y||Y.length===0)return"";Y=Array.from(new Set(Y));let J=$.startsWith("--");if(J)$=$.slice(2),Y=Y.map((q)=>q.slice(2));let Q=[],Z=3,U=0.4;if(Y.forEach((q)=>{if(q.length<=1)return;let G=JJ($,q),X=Math.max($.length,q.length);if((X-G)/X>U){if(G<Z)Z=G,Q=[q];else if(G===Z)Q.push(q)}}),Q.sort((q,G)=>q.localeCompare(G)),J)Q=Q.map((q)=>`--${q}`);if(Q.length>1)return`
(Did you mean one of ${Q.join(", ")}?)`;if(Q.length===1)return`
(Did you mean ${Q[0]}?)`;return""}y$.suggestSimilar=QJ});var u$=i((m$)=>{var ZJ=require("events").EventEmitter,U$=require("child_process"),$0=require("path"),q$=require("fs"),k=require("process"),{Argument:UJ,humanReadableArgName:qJ}=b0(),{CommanderError:G$}=S0(),{Help:GJ}=Q$(),{Option:f$,splitOptionFlags:XJ,DualOptions:WJ}=Z$(),{suggestSimilar:x$}=b$();class X$ extends ZJ{constructor($){super();this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=$||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:(Y)=>k.stdout.write(Y),writeErr:(Y)=>k.stderr.write(Y),getOutHelpWidth:()=>k.stdout.isTTY?k.stdout.columns:void 0,getErrHelpWidth:()=>k.stderr.isTTY?k.stderr.columns:void 0,outputError:(Y,J)=>J(Y)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings($){return this._outputConfiguration=$._outputConfiguration,this._hasHelpOption=$._hasHelpOption,this._helpFlags=$._helpFlags,this._helpDescription=$._helpDescription,this._helpShortFlag=$._helpShortFlag,this._helpLongFlag=$._helpLongFlag,this._helpCommandName=$._helpCommandName,this._helpCommandnameAndArgs=$._helpCommandnameAndArgs,this._helpCommandDescription=$._helpCommandDescription,this._helpConfiguration=$._helpConfiguration,this._exitCallback=$._exitCallback,this._storeOptionsAsProperties=$._storeOptionsAsProperties,this._combineFlagAndOptionalValue=$._combineFlagAndOptionalValue,this._allowExcessArguments=$._allowExcessArguments,this._enablePositionalOptions=$._enablePositionalOptions,this._showHelpAfterError=$._showHelpAfterError,this._showSuggestionAfterError=$._showSuggestionAfterError,this}_getCommandAndAncestors(){let $=[];for(let Y=this;Y;Y=Y.parent)$.push(Y);return $}command($,Y,J){let Q=Y,Z=J;if(typeof Q==="object"&&Q!==null)Z=Q,Q=null;Z=Z||{};let[,U,q]=$.match(/([^ ]+) *(.*)/),G=this.createCommand(U);if(Q)G.description(Q),G._executableHandler=!0;if(Z.isDefault)this._defaultCommandName=G._name;if(G._hidden=!!(Z.noHelp||Z.hidden),G._executableFile=Z.executableFile||null,q)G.arguments(q);if(this.commands.push(G),G.parent=this,G.copyInheritedSettings(this),Q)return this;return G}createCommand($){return new X$($)}createHelp(){return Object.assign(new GJ,this.configureHelp())}configureHelp($){if($===void 0)return this._helpConfiguration;return this._helpConfiguration=$,this}configureOutput($){if($===void 0)return this._outputConfiguration;return Object.assign(this._outputConfiguration,$),this}showHelpAfterError($=!0){if(typeof $!=="string")$=!!$;return this._showHelpAfterError=$,this}showSuggestionAfterError($=!0){return this._showSuggestionAfterError=!!$,this}addCommand($,Y){if(!$._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);if(Y=Y||{},Y.isDefault)this._defaultCommandName=$._name;if(Y.noHelp||Y.hidden)$._hidden=!0;return this.commands.push($),$.parent=this,this}createArgument($,Y){return new UJ($,Y)}argument($,Y,J,Q){let Z=this.createArgument($,Y);if(typeof J==="function")Z.default(Q).argParser(J);else Z.default(J);return this.addArgument(Z),this}arguments($){return $.trim().split(/ +/).forEach((Y)=>{this.argument(Y)}),this}addArgument($){let Y=this.registeredArguments.slice(-1)[0];if(Y&&Y.variadic)throw new Error(`only the last argument can be variadic '${Y.name()}'`);if($.required&&$.defaultValue!==void 0&&$.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${$.name()}'`);return this.registeredArguments.push($),this}addHelpCommand($,Y){if($===!1)this._addImplicitHelpCommand=!1;else{if(this._addImplicitHelpCommand=!0,typeof $==="string")this._helpCommandName=$.split(" ")[0],this._helpCommandnameAndArgs=$;this._helpCommandDescription=Y||this._helpCommandDescription}return this}_hasImplicitHelpCommand(){if(this._addImplicitHelpCommand===void 0)return this.commands.length&&!this._actionHandler&&!this._findCommand("help");return this._addImplicitHelpCommand}hook($,Y){let J=["preSubcommand","preAction","postAction"];if(!J.includes($))throw new Error(`Unexpected value for event passed to hook : '${$}'.
Expecting one of '${J.join("', '")}'`);if(this._lifeCycleHooks[$])this._lifeCycleHooks[$].push(Y);else this._lifeCycleHooks[$]=[Y];return this}exitOverride($){if($)this._exitCallback=$;else this._exitCallback=(Y)=>{if(Y.code!=="commander.executeSubCommandAsync")throw Y};return this}_exit($,Y,J){if(this._exitCallback)this._exitCallback(new G$($,Y,J));k.exit($)}action($){let Y=(J)=>{let Q=this.registeredArguments.length,Z=J.slice(0,Q);if(this._storeOptionsAsProperties)Z[Q]=this;else Z[Q]=this.opts();return Z.push(this),$.apply(this,Z)};return this._actionHandler=Y,this}createOption($,Y){return new f$($,Y)}_callParseArg($,Y,J,Q){try{return $.parseArg(Y,J)}catch(Z){if(Z.code==="commander.invalidArgument"){let U=`${Q} ${Z.message}`;this.error(U,{exitCode:Z.exitCode,code:Z.code})}throw Z}}addOption($){let Y=$.name(),J=$.attributeName();if($.negate){let Z=$.long.replace(/^--no-/,"--");if(!this._findOption(Z))this.setOptionValueWithSource(J,$.defaultValue===void 0?!0:$.defaultValue,"default")}else if($.defaultValue!==void 0)this.setOptionValueWithSource(J,$.defaultValue,"default");this.options.push($);let Q=(Z,U,q)=>{if(Z==null&&$.presetArg!==void 0)Z=$.presetArg;let G=this.getOptionValue(J);if(Z!==null&&$.parseArg)Z=this._callParseArg($,Z,G,U);else if(Z!==null&&$.variadic)Z=$._concatValue(Z,G);if(Z==null)if($.negate)Z=!1;else if($.isBoolean()||$.optional)Z=!0;else Z="";this.setOptionValueWithSource(J,Z,q)};if(this.on("option:"+Y,(Z)=>{let U=`error: option '${$.flags}' argument '${Z}' is invalid.`;Q(Z,U,"cli")}),$.envVar)this.on("optionEnv:"+Y,(Z)=>{let U=`error: option '${$.flags}' value '${Z}' from env '${$.envVar}' is invalid.`;Q(Z,U,"env")});return this}_optionEx($,Y,J,Q,Z){if(typeof Y==="object"&&Y instanceof f$)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let U=this.createOption(Y,J);if(U.makeOptionMandatory(!!$.mandatory),typeof Q==="function")U.default(Z).argParser(Q);else if(Q instanceof RegExp){let q=Q;Q=(G,X)=>{let W=q.exec(G);return W?W[0]:X},U.default(Z).argParser(Q)}else U.default(Q);return this.addOption(U)}option($,Y,J,Q){return this._optionEx({},$,Y,J,Q)}requiredOption($,Y,J,Q){return this._optionEx({mandatory:!0},$,Y,J,Q)}combineFlagAndOptionalValue($=!0){return this._combineFlagAndOptionalValue=!!$,this}allowUnknownOption($=!0){return this._allowUnknownOption=!!$,this}allowExcessArguments($=!0){return this._allowExcessArguments=!!$,this}enablePositionalOptions($=!0){return this._enablePositionalOptions=!!$,this}passThroughOptions($=!0){if(this._passThroughOptions=!!$,!!this.parent&&$&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties($=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this._storeOptionsAsProperties=!!$,this}getOptionValue($){if(this._storeOptionsAsProperties)return this[$];return this._optionValues[$]}setOptionValue($,Y){return this.setOptionValueWithSource($,Y,void 0)}setOptionValueWithSource($,Y,J){if(this._storeOptionsAsProperties)this[$]=Y;else this._optionValues[$]=Y;return this._optionValueSources[$]=J,this}getOptionValueSource($){return this._optionValueSources[$]}getOptionValueSourceWithGlobals($){let Y;return this._getCommandAndAncestors().forEach((J)=>{if(J.getOptionValueSource($)!==void 0)Y=J.getOptionValueSource($)}),Y}_prepareUserArgs($,Y){if($!==void 0&&!Array.isArray($))throw new Error("first parameter to parse must be array or undefined");if(Y=Y||{},$===void 0){if($=k.argv,k.versions&&k.versions.electron)Y.from="electron"}this.rawArgs=$.slice();let J;switch(Y.from){case void 0:case"node":this._scriptPath=$[1],J=$.slice(2);break;case"electron":if(k.defaultApp)this._scriptPath=$[1],J=$.slice(2);else J=$.slice(1);break;case"user":J=$.slice(0);break;default:throw new Error(`unexpected parse option { from: '${Y.from}' }`)}if(!this._name&&this._scriptPath)this.nameFromFilename(this._scriptPath);return this._name=this._name||"program",J}parse($,Y){let J=this._prepareUserArgs($,Y);return this._parseCommand([],J),this}async parseAsync($,Y){let J=this._prepareUserArgs($,Y);return await this._parseCommand([],J),this}_executeSubCommand($,Y){Y=Y.slice();let J=!1,Q=[".js",".ts",".tsx",".mjs",".cjs"];function Z(W,z){let H=$0.resolve(W,z);if(q$.existsSync(H))return H;if(Q.includes($0.extname(z)))return;let K=Q.find((T)=>q$.existsSync(`${H}${T}`));if(K)return`${H}${K}`;return}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let U=$._executableFile||`${this._name}-${$._name}`,q=this._executableDir||"";if(this._scriptPath){let W;try{W=q$.realpathSync(this._scriptPath)}catch(z){W=this._scriptPath}q=$0.resolve($0.dirname(W),q)}if(q){let W=Z(q,U);if(!W&&!$._executableFile&&this._scriptPath){let z=$0.basename(this._scriptPath,$0.extname(this._scriptPath));if(z!==this._name)W=Z(q,`${z}-${$._name}`)}U=W||U}J=Q.includes($0.extname(U));let G;if(k.platform!=="win32")if(J)Y.unshift(U),Y=g$(k.execArgv).concat(Y),G=U$.spawn(k.argv[0],Y,{stdio:"inherit"});else G=U$.spawn(U,Y,{stdio:"inherit"});else Y.unshift(U),Y=g$(k.execArgv).concat(Y),G=U$.spawn(k.execPath,Y,{stdio:"inherit"});if(!G.killed)["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach((z)=>{k.on(z,()=>{if(G.killed===!1&&G.exitCode===null)G.kill(z)})});let X=this._exitCallback;if(!X)G.on("close",k.exit.bind(k));else G.on("close",()=>{X(new G$(k.exitCode||0,"commander.executeSubCommandAsync","(close)"))});G.on("error",(W)=>{if(W.code==="ENOENT"){let z=q?`searched for local subcommand relative to directory '${q}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",H=`'${U}' does not exist
 - if '${$._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${z}`;throw new Error(H)}else if(W.code==="EACCES")throw new Error(`'${U}' not executable`);if(!X)k.exit(1);else{let z=new G$(1,"commander.executeSubCommandAsync","(error)");z.nestedError=W,X(z)}}),this.runningCommand=G}_dispatchSubcommand($,Y,J){let Q=this._findCommand($);if(!Q)this.help({error:!0});let Z;return Z=this._chainOrCallSubCommandHook(Z,Q,"preSubcommand"),Z=this._chainOrCall(Z,()=>{if(Q._executableHandler)this._executeSubCommand(Q,Y.concat(J));else return Q._parseCommand(Y,J)}),Z}_dispatchHelpCommand($){if(!$)this.help();let Y=this._findCommand($);if(Y&&!Y._executableHandler)Y.help();return this._dispatchSubcommand($,[],[this._helpLongFlag||this._helpShortFlag])}_checkNumberOfArguments(){if(this.registeredArguments.forEach(($,Y)=>{if($.required&&this.args[Y]==null)this.missingArgument($.name())}),this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)return;if(this.args.length>this.registeredArguments.length)this._excessArguments(this.args)}_processArguments(){let $=(J,Q,Z)=>{let U=Q;if(Q!==null&&J.parseArg){let q=`error: command-argument value '${Q}' is invalid for argument '${J.name()}'.`;U=this._callParseArg(J,Q,Z,q)}return U};this._checkNumberOfArguments();let Y=[];this.registeredArguments.forEach((J,Q)=>{let Z=J.defaultValue;if(J.variadic){if(Q<this.args.length){if(Z=this.args.slice(Q),J.parseArg)Z=Z.reduce((U,q)=>{return $(J,q,U)},J.defaultValue)}else if(Z===void 0)Z=[]}else if(Q<this.args.length){if(Z=this.args[Q],J.parseArg)Z=$(J,Z,J.defaultValue)}Y[Q]=Z}),this.processedArgs=Y}_chainOrCall($,Y){if($&&$.then&&typeof $.then==="function")return $.then(()=>Y());return Y()}_chainOrCallHooks($,Y){let J=$,Q=[];if(this._getCommandAndAncestors().reverse().filter((Z)=>Z._lifeCycleHooks[Y]!==void 0).forEach((Z)=>{Z._lifeCycleHooks[Y].forEach((U)=>{Q.push({hookedCommand:Z,callback:U})})}),Y==="postAction")Q.reverse();return Q.forEach((Z)=>{J=this._chainOrCall(J,()=>{return Z.callback(Z.hookedCommand,this)})}),J}_chainOrCallSubCommandHook($,Y,J){let Q=$;if(this._lifeCycleHooks[J]!==void 0)this._lifeCycleHooks[J].forEach((Z)=>{Q=this._chainOrCall(Q,()=>{return Z(this,Y)})});return Q}_parseCommand($,Y){let J=this.parseOptions(Y);if(this._parseOptionsEnv(),this._parseOptionsImplied(),$=$.concat(J.operands),Y=J.unknown,this.args=$.concat(Y),$&&this._findCommand($[0]))return this._dispatchSubcommand($[0],$.slice(1),Y);if(this._hasImplicitHelpCommand()&&$[0]===this._helpCommandName)return this._dispatchHelpCommand($[1]);if(this._defaultCommandName)return h$(this,Y),this._dispatchSubcommand(this._defaultCommandName,$,Y);if(this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName)this.help({error:!0});h$(this,J.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let Q=()=>{if(J.unknown.length>0)this.unknownOption(J.unknown[0])},Z=`command:${this.name()}`;if(this._actionHandler){Q(),this._processArguments();let U;if(U=this._chainOrCallHooks(U,"preAction"),U=this._chainOrCall(U,()=>this._actionHandler(this.processedArgs)),this.parent)U=this._chainOrCall(U,()=>{this.parent.emit(Z,$,Y)});return U=this._chainOrCallHooks(U,"postAction"),U}if(this.parent&&this.parent.listenerCount(Z))Q(),this._processArguments(),this.parent.emit(Z,$,Y);else if($.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",$,Y);if(this.listenerCount("command:*"))this.emit("command:*",$,Y);else if(this.commands.length)this.unknownCommand();else Q(),this._processArguments()}else if(this.commands.length)Q(),this.help({error:!0});else Q(),this._processArguments()}_findCommand($){if(!$)return;return this.commands.find((Y)=>Y._name===$||Y._aliases.includes($))}_findOption($){return this.options.find((Y)=>Y.is($))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(($)=>{$.options.forEach((Y)=>{if(Y.mandatory&&$.getOptionValue(Y.attributeName())===void 0)$.missingMandatoryOptionValue(Y)})})}_checkForConflictingLocalOptions(){let $=this.options.filter((J)=>{let Q=J.attributeName();if(this.getOptionValue(Q)===void 0)return!1;return this.getOptionValueSource(Q)!=="default"});$.filter((J)=>J.conflictsWith.length>0).forEach((J)=>{let Q=$.find((Z)=>J.conflictsWith.includes(Z.attributeName()));if(Q)this._conflictingOption(J,Q)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(($)=>{$._checkForConflictingLocalOptions()})}parseOptions($){let Y=[],J=[],Q=Y,Z=$.slice();function U(G){return G.length>1&&G[0]==="-"}let q=null;while(Z.length){let G=Z.shift();if(G==="--"){if(Q===J)Q.push(G);Q.push(...Z);break}if(q&&!U(G)){this.emit(`option:${q.name()}`,G);continue}if(q=null,U(G)){let X=this._findOption(G);if(X){if(X.required){let W=Z.shift();if(W===void 0)this.optionMissingArgument(X);this.emit(`option:${X.name()}`,W)}else if(X.optional){let W=null;if(Z.length>0&&!U(Z[0]))W=Z.shift();this.emit(`option:${X.name()}`,W)}else this.emit(`option:${X.name()}`);q=X.variadic?X:null;continue}}if(G.length>2&&G[0]==="-"&&G[1]!=="-"){let X=this._findOption(`-${G[1]}`);if(X){if(X.required||X.optional&&this._combineFlagAndOptionalValue)this.emit(`option:${X.name()}`,G.slice(2));else this.emit(`option:${X.name()}`),Z.unshift(`-${G.slice(2)}`);continue}}if(/^--[^=]+=/.test(G)){let X=G.indexOf("="),W=this._findOption(G.slice(0,X));if(W&&(W.required||W.optional)){this.emit(`option:${W.name()}`,G.slice(X+1));continue}}if(U(G))Q=J;if((this._enablePositionalOptions||this._passThroughOptions)&&Y.length===0&&J.length===0){if(this._findCommand(G)){if(Y.push(G),Z.length>0)J.push(...Z);break}else if(G===this._helpCommandName&&this._hasImplicitHelpCommand()){if(Y.push(G),Z.length>0)Y.push(...Z);break}else if(this._defaultCommandName){if(J.push(G),Z.length>0)J.push(...Z);break}}if(this._passThroughOptions){if(Q.push(G),Z.length>0)Q.push(...Z);break}Q.push(G)}return{operands:Y,unknown:J}}opts(){if(this._storeOptionsAsProperties){let $={},Y=this.options.length;for(let J=0;J<Y;J++){let Q=this.options[J].attributeName();$[Q]=Q===this._versionOptionName?this._version:this[Q]}return $}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce(($,Y)=>Object.assign($,Y.opts()),{})}error($,Y){if(this._outputConfiguration.outputError(`${$}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError==="string")this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`);else if(this._showHelpAfterError)this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0});let J=Y||{},Q=J.exitCode||1,Z=J.code||"commander.error";this._exit(Q,Z,$)}_parseOptionsEnv(){this.options.forEach(($)=>{if($.envVar&&$.envVar in k.env){let Y=$.attributeName();if(this.getOptionValue(Y)===void 0||["default","config","env"].includes(this.getOptionValueSource(Y)))if($.required||$.optional)this.emit(`optionEnv:${$.name()}`,k.env[$.envVar]);else this.emit(`optionEnv:${$.name()}`)}})}_parseOptionsImplied(){let $=new WJ(this.options),Y=(J)=>{return this.getOptionValue(J)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(J))};this.options.filter((J)=>J.implied!==void 0&&Y(J.attributeName())&&$.valueFromOption(this.getOptionValue(J.attributeName()),J)).forEach((J)=>{Object.keys(J.implied).filter((Q)=>!Y(Q)).forEach((Q)=>{this.setOptionValueWithSource(Q,J.implied[Q],"implied")})})}missingArgument($){let Y=`error: missing required argument '${$}'`;this.error(Y,{code:"commander.missingArgument"})}optionMissingArgument($){let Y=`error: option '${$.flags}' argument missing`;this.error(Y,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue($){let Y=`error: required option '${$.flags}' not specified`;this.error(Y,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption($,Y){let J=(U)=>{let q=U.attributeName(),G=this.getOptionValue(q),X=this.options.find((z)=>z.negate&&q===z.attributeName()),W=this.options.find((z)=>!z.negate&&q===z.attributeName());if(X&&(X.presetArg===void 0&&G===!1||X.presetArg!==void 0&&G===X.presetArg))return X;return W||U},Q=(U)=>{let q=J(U),G=q.attributeName();if(this.getOptionValueSource(G)==="env")return`environment variable '${q.envVar}'`;return`option '${q.flags}'`},Z=`error: ${Q($)} cannot be used with ${Q(Y)}`;this.error(Z,{code:"commander.conflictingOption"})}unknownOption($){if(this._allowUnknownOption)return;let Y="";if($.startsWith("--")&&this._showSuggestionAfterError){let Q=[],Z=this;do{let U=Z.createHelp().visibleOptions(Z).filter((q)=>q.long).map((q)=>q.long);Q=Q.concat(U),Z=Z.parent}while(Z&&!Z._enablePositionalOptions);Y=x$($,Q)}let J=`error: unknown option '${$}'${Y}`;this.error(J,{code:"commander.unknownOption"})}_excessArguments($){if(this._allowExcessArguments)return;let Y=this.registeredArguments.length,J=Y===1?"":"s",Z=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${Y} argument${J} but got ${$.length}.`;this.error(Z,{code:"commander.excessArguments"})}unknownCommand(){let $=this.args[0],Y="";if(this._showSuggestionAfterError){let Q=[];this.createHelp().visibleCommands(this).forEach((Z)=>{if(Q.push(Z.name()),Z.alias())Q.push(Z.alias())}),Y=x$($,Q)}let J=`error: unknown command '${$}'${Y}`;this.error(J,{code:"commander.unknownCommand"})}version($,Y,J){if($===void 0)return this._version;this._version=$,Y=Y||"-V, --version",J=J||"output the version number";let Q=this.createOption(Y,J);return this._versionOptionName=Q.attributeName(),this.options.push(Q),this.on("option:"+Q.name(),()=>{this._outputConfiguration.writeOut(`${$}
`),this._exit(0,"commander.version",$)}),this}description($,Y){if($===void 0&&Y===void 0)return this._description;if(this._description=$,Y)this._argsDescription=Y;return this}summary($){if($===void 0)return this._summary;return this._summary=$,this}alias($){if($===void 0)return this._aliases[0];let Y=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler)Y=this.commands[this.commands.length-1];if($===Y._name)throw new Error("Command alias can't be the same as its name");return Y._aliases.push($),this}aliases($){if($===void 0)return this._aliases;return $.forEach((Y)=>this.alias(Y)),this}usage($){if($===void 0){if(this._usage)return this._usage;let Y=this.registeredArguments.map((J)=>{return qJ(J)});return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?Y:[]).join(" ")}return this._usage=$,this}name($){if($===void 0)return this._name;return this._name=$,this}nameFromFilename($){return this._name=$0.basename($,$0.extname($)),this}executableDir($){if($===void 0)return this._executableDir;return this._executableDir=$,this}helpInformation($){let Y=this.createHelp();if(Y.helpWidth===void 0)Y.helpWidth=$&&$.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth();return Y.formatHelp(this,Y)}_getHelpContext($){$=$||{};let Y={error:!!$.error},J;if(Y.error)J=(Q)=>this._outputConfiguration.writeErr(Q);else J=(Q)=>this._outputConfiguration.writeOut(Q);return Y.write=$.write||J,Y.command=this,Y}outputHelp($){let Y;if(typeof $==="function")Y=$,$=void 0;let J=this._getHelpContext($);this._getCommandAndAncestors().reverse().forEach((Z)=>Z.emit("beforeAllHelp",J)),this.emit("beforeHelp",J);let Q=this.helpInformation(J);if(Y){if(Q=Y(Q),typeof Q!=="string"&&!Buffer.isBuffer(Q))throw new Error("outputHelp callback must return a string or a Buffer")}if(J.write(Q),this._helpLongFlag)this.emit(this._helpLongFlag);this.emit("afterHelp",J),this._getCommandAndAncestors().forEach((Z)=>Z.emit("afterAllHelp",J))}helpOption($,Y){if(typeof $==="boolean")return this._hasHelpOption=$,this;this._helpFlags=$||this._helpFlags,this._helpDescription=Y||this._helpDescription;let J=XJ(this._helpFlags);return this._helpShortFlag=J.shortFlag,this._helpLongFlag=J.longFlag,this}help($){this.outputHelp($);let Y=k.exitCode||0;if(Y===0&&$&&typeof $!=="function"&&$.error)Y=1;this._exit(Y,"commander.help","(outputHelp)")}addHelpText($,Y){let J=["beforeAll","before","after","afterAll"];if(!J.includes($))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${J.join("', '")}'`);let Q=`${$}Help`;return this.on(Q,(Z)=>{let U;if(typeof Y==="function")U=Y({error:Z.error,command:Z.command});else U=Y;if(U)Z.write(`${U}
`)}),this}}function h$($,Y){if($._hasHelpOption&&Y.find((Q)=>Q===$._helpLongFlag||Q===$._helpShortFlag))$.outputHelp(),$._exit(0,"commander.helpDisplayed","(outputHelp)")}function g$($){return $.map((Y)=>{if(!Y.startsWith("--inspect"))return Y;let J,Q="127.0.0.1",Z="9229",U;if((U=Y.match(/^(--inspect(-brk)?)$/))!==null)J=U[1];else if((U=Y.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null)if(J=U[1],/^\d+$/.test(U[3]))Z=U[3];else Q=U[3];else if((U=Y.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null)J=U[1],Q=U[3],Z=U[4];if(J&&Z!=="0")return`${J}=${Q}:${parseInt(Z)+1}`;return Y})}m$.Command=X$});var p$=i((n,d$)=>{var{Argument:zJ}=b0(),{Command:l$}=u$(),{CommanderError:HJ,InvalidArgumentError:c$}=S0(),{Help:KJ}=Q$(),{Option:TJ}=Z$();n=d$.exports=new l$;n.program=n;n.Command=l$;n.Option=TJ;n.Argument=zJ;n.Help=KJ;n.CommanderError=HJ;n.InvalidArgumentError=c$;n.InvalidOptionArgumentError=c$});var MY=i((uQ,TY)=>{var d0=/^[a-z0-9-]{1,32}$/,p0=/^[a-z0-9-]{1,32}$/,i0=/^[a-zA-Z0-9/+.-]+$/,HY=/^([a-zA-Z0-9/+.-]+|)$/,OJ=/^((-)?[1-9]\d*|0)$/,I$=/^v=(\d+)$/;function CJ($){return O0($).map((Y)=>[Y,$[Y]].join("=")).join(",")}function kJ($){let Y={};return $.split(",").forEach((J)=>{let Q=J.split("=");if(Q.length<2)throw new TypeError("params must be in the format name=value");Y[Q.shift()]=Q.join("=")}),Y}function O0($){return Object.keys($)}function KY($){if(typeof Object.values==="function")return Object.values($);return O0($).map((Y)=>$[Y])}function vJ($){let Y=[""];if(typeof $!=="object"||$===null)throw new TypeError("opts must be an object");if(typeof $.id!=="string")throw new TypeError("id must be a string");if(!d0.test($.id))throw new TypeError(`id must satisfy ${d0}`);if(Y.push($.id),typeof $.version!=="undefined"){if(typeof $.version!=="number"||$.version<0||!Number.isInteger($.version))throw new TypeError("version must be a positive integer number");Y.push(`v=${$.version}`)}if(typeof $.params!=="undefined"){if(typeof $.params!=="object"||$.params===null)throw new TypeError("params must be an object");let Q=O0($.params);if(!Q.every((q)=>p0.test(q)))throw new TypeError(`params names must satisfy ${p0}`);Q.forEach((q)=>{if(typeof $.params[q]==="number")$.params[q]=$.params[q].toString();else if(Buffer.isBuffer($.params[q]))$.params[q]=$.params[q].toString("base64").split("=")[0]});let Z=KY($.params);if(!Z.every((q)=>typeof q==="string"))throw new TypeError("params values must be strings");if(!Z.every((q)=>i0.test(q)))throw new TypeError(`params values must satisfy ${i0}`);let U=CJ($.params);Y.push(U)}if(typeof $.salt!=="undefined"){if(!Buffer.isBuffer($.salt))throw new TypeError("salt must be a Buffer");if(Y.push($.salt.toString("base64").split("=")[0]),typeof $.hash!=="undefined"){if(!Buffer.isBuffer($.hash))throw new TypeError("hash must be a Buffer");Y.push($.hash.toString("base64").split("=")[0])}}return Y.join("$")}function yJ($){if(typeof $!=="string"||$==="")throw new TypeError("pchstr must be a non-empty string");if($[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let Y=$.split("$");Y.shift();let J=5;if(!I$.test(Y[1]))J--;if(Y.length>J)throw new TypeError(`pchstr contains too many fileds: ${Y.length}/${J}`);let Q=Y.shift();if(!d0.test(Q))throw new TypeError(`id must satisfy ${d0}`);let Z;if(I$.test(Y[0]))Z=parseInt(Y.shift().match(I$)[1],10);let U,q;if(HY.test(Y[Y.length-1]))if(Y.length>1&&HY.test(Y[Y.length-2]))U=Buffer.from(Y.pop(),"base64"),q=Buffer.from(Y.pop(),"base64");else q=Buffer.from(Y.pop(),"base64");let G;if(Y.length>0){let W=Y.pop();if(G=kJ(W),!O0(G).every((K)=>p0.test(K)))throw new TypeError(`params names must satisfy ${p0}`);if(!KY(G).every((K)=>i0.test(K)))throw new TypeError(`params values must satisfy ${i0}`);O0(G).forEach((K)=>{G[K]=OJ.test(G[K])?parseInt(G[K],10):G[K]})}if(Y.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${Y}`);let X={id:Q};if(Z)X.version=Z;if(G)X.params=G;if(q)X.salt=q;if(U)X.hash=U;return X}TY.exports={serialize:vJ,deserialize:yJ}});var OY=i((lQ,wY)=>{var VY=require("fs"),U0=require("path"),BY=require("os"),NY=typeof __webpack_require__==="function"?__non_webpack_require__:require,bJ=process.config&&process.config.variables||{},fJ=!!process.env.PREBUILDS_ONLY,RY=process.versions.modules,V$=gJ()?"electron":hJ()?"node-webkit":"node",B$=process.env.npm_config_arch||BY.arch(),N$=process.env.npm_config_platform||BY.platform(),DY=process.env.LIBC||(mJ(N$)?"musl":"glibc"),D$=process.env.ARM_VERSION||(B$==="arm64"?"8":bJ.arm_version)||"",FY=(process.versions.uv||"").split(".")[0];wY.exports=t;function t($){return NY(t.resolve($))}t.resolve=t.path=function($){$=U0.resolve($||".");try{var Y=NY(U0.join($,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[Y+"_PREBUILD"])$=process.env[Y+"_PREBUILD"]}catch(X){}if(!fJ){var J=PY(U0.join($,"build/Release"),IY);if(J)return J;var Q=PY(U0.join($,"build/Debug"),IY);if(Q)return Q}var Z=G($);if(Z)return Z;var U=G(U0.dirname(process.execPath));if(U)return U;var q=["platform="+N$,"arch="+B$,"runtime="+V$,"abi="+RY,"uv="+FY,D$?"armv="+D$:"","libc="+DY,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+q+`
    loaded from: `+$+`
`);function G(X){var W=F$(U0.join(X,"prebuilds")).map(_Y),z=W.filter(SY(N$,B$)).sort(LY)[0];if(!z)return;var H=U0.join(X,"prebuilds",z.name),K=F$(H).map(EY),T=K.filter(jY(V$,RY)),R=T.sort(AY(V$))[0];if(R)return U0.join(H,R.file)}};function F$($){try{return VY.readdirSync($)}catch(Y){return[]}}function PY($,Y){var J=F$($).filter(Y);return J[0]&&U0.join($,J[0])}function IY($){return/\.node$/.test($)}function _Y($){var Y=$.split("-");if(Y.length!==2)return;var J=Y[0],Q=Y[1].split("+");if(!J)return;if(!Q.length)return;if(!Q.every(Boolean))return;return{name:$,platform:J,architectures:Q}}function SY($,Y){return function(J){if(J==null)return!1;if(J.platform!==$)return!1;return J.architectures.includes(Y)}}function LY($,Y){return $.architectures.length-Y.architectures.length}function EY($){var Y=$.split("."),J=Y.pop(),Q={file:$,specificity:0};if(J!=="node")return;for(var Z=0;Z<Y.length;Z++){var U=Y[Z];if(U==="node"||U==="electron"||U==="node-webkit")Q.runtime=U;else if(U==="napi")Q.napi=!0;else if(U.slice(0,3)==="abi")Q.abi=U.slice(3);else if(U.slice(0,2)==="uv")Q.uv=U.slice(2);else if(U.slice(0,4)==="armv")Q.armv=U.slice(4);else if(U==="glibc"||U==="musl")Q.libc=U;else continue;Q.specificity++}return Q}function jY($,Y){return function(J){if(J==null)return!1;if(J.runtime&&J.runtime!==$&&!xJ(J))return!1;if(J.abi&&J.abi!==Y&&!J.napi)return!1;if(J.uv&&J.uv!==FY)return!1;if(J.armv&&J.armv!==D$)return!1;if(J.libc&&J.libc!==DY)return!1;return!0}}function xJ($){return $.runtime==="node"&&$.napi}function AY($){return function(Y,J){if(Y.runtime!==J.runtime)return Y.runtime===$?-1:1;else if(Y.abi!==J.abi)return Y.abi?-1:1;else if(Y.specificity!==J.specificity)return Y.specificity>J.specificity?-1:1;else return 0}}function hJ(){return!!(process.versions&&process.versions.nw)}function gJ(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function mJ($){return $==="linux"&&VY.existsSync("/etc/alpine-release")}t.parseTags=EY;t.matchTags=jY;t.compareTags=AY;t.parseTuple=_Y;t.matchTuple=SY;t.compareTuples=LY});var CY=i((cQ,S$)=>{var _$=typeof __webpack_require__==="function"?__non_webpack_require__:require;if(typeof _$.addon==="function")S$.exports=_$.addon.bind(_$);else S$.exports=OY()});var bY=i((pQ,T0)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",dQ=require("node:assert"),{randomBytes:uJ,timingSafeEqual:lJ}=require("node:crypto"),{promisify:cJ}=require("node:util"),{deserialize:kY,serialize:dJ}=MY(),pJ=CY(),{hash:vY}=pJ(__dirname),iJ=cJ(uJ);T0.exports.argon2d=0;T0.exports.argon2i=1;T0.exports.argon2id=2;var C0=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),nJ=Object.freeze({[C0.argon2d]:"argon2d",[C0.argon2i]:"argon2i",[C0.argon2id]:"argon2id"}),yY={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function sJ($,Y){let{raw:J,salt:Q,...Z}={...yY,...Y};if(Z.hashLength>4294967295)throw new RangeError("Hash length is too large");if(Z.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(Z.timeCost>4294967295)throw new RangeError("Time cost is too large");if(Z.parallelism>16777215)throw new RangeError("Parallelism is too large");Q=Q??await iJ(16);let{hashLength:U,secret:q=Buffer.alloc(0),type:G,version:X,memoryCost:W,timeCost:z,parallelism:H,associatedData:K=Buffer.alloc(0)}=Z,T=await vY({password:Buffer.from($),salt:Q,secret:q,data:K,hashLength:U,m:W,t:z,p:H,version:X,type:G});if(J)return T;return dJ({id:nJ[G],version:X,params:{m:W,t:z,p:H,...K.byteLength>0?{data:K}:{}},salt:Q,hash:T})}T0.exports.hash=sJ;function rJ($,Y={}){let{memoryCost:J,timeCost:Q,parallelism:Z,version:U}={...yY,...Y},{version:q,params:{m:G,t:X,p:W}}=kY($);return+q!==+U||+G!==+J||+X!==+Q||+W!==+Z}T0.exports.needsRehash=rJ;async function oJ($,Y,J={}){let{id:Q,...Z}=kY($);if(!(Q in C0))return!1;let{version:U=16,params:{m:q,t:G,p:X,data:W=""},salt:z,hash:H}=Z,{secret:K=Buffer.alloc(0)}=J;return lJ(await vY({password:Buffer.from(Y),salt:z,secret:K,data:Buffer.from(W,"base64"),hashLength:H.byteLength,m:+q,t:+G,p:+X,version:+U,type:C0[Q]}),H)}T0.exports.verify=oJ});var i$=_0(p$()),{program:XQ,createCommand:WQ,createArgument:zQ,createOption:HQ,CommanderError:KQ,InvalidArgumentError:TQ,InvalidOptionArgumentError:MQ,Command:n$,Argument:RQ,Option:W0,Help:PQ}=i$.default;var r=require("node:fs"),R0=require("node:fs"),I=require("node:process"),t0=require("node:stream");class Y0 extends Error{constructor($){super($);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class a extends Y0{}class L0 extends Y0{}class W$ extends Y0{}class x0 extends Y0{}class z0 extends Y0{}class J0 extends Y0{}class h0 extends Y0{}class d extends Y0{}function s$(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function E0(...$){let Y=$.reduce((Z,U)=>Z+U.byteLength,0),J=new Uint8Array(Y),Q=0;for(let Z of $)J.set(Z,Q),Q+=Z.byteLength;return J}function j0(...$){try{let Y=E0(...$);if(s$())return Buffer.from(Y).toString("base64");let J="";for(let Q=0;Q<Y.length;Q++)J+=String.fromCharCode(Y[Q]);return btoa(J)}catch(Y){throw new W$("Base64 Encoding Error")}}function A0($){try{if(!/^[A-Za-z0-9+/]+={0,2}$/.test($)||$.length%4!==0)throw new Error("Invalid Base64");if(s$())return new Uint8Array(Buffer.from($,"base64"));let Y=atob($),J=new Uint8Array(Y.length);for(let Q=0;Q<Y.length;Q++)J[Q]=Y.charCodeAt(Q);return J}catch(Y){throw new L0(`Invalid Base64: length=${$.length}, content='${$.slice(0,12)}…'`)}}function s($){let Y=$.value.length,J=new Array(Y).fill("\x00").join("");$.value=J}var r$=require("fs");class z${src;#$=null;constructor($){this.src=$}get length(){if(this.src instanceof Uint8Array)return this.src.byteLength;if(this.src instanceof Blob)return this.src.size;return this.ensureUint8().byteLength}async read($,Y){if($<0||Y<0||$+Y>this.length)throw new RangeError("read() slice exceeds data bounds");if(this.src instanceof Uint8Array)return this.src.slice($,$+Y);if(this.src instanceof Blob){let J=await this.src.slice($,$+Y).arrayBuffer();return new Uint8Array(J)}return this.ensureUint8().slice($,$+Y)}ensureUint8(){if(!this.#$)this.#$=A0(this.src);return this.#$}}class w0{fd;length;constructor($,Y){this.fd=$;this.length=Y}static async open($){let Y=await r$.promises.open($,"r"),J=await Y.stat();return new w0(Y,J.size)}async read($,Y){if($<0||Y<0||$+Y>this.length)throw new RangeError("read() slice exceeds data bounds");let J=Buffer.allocUnsafe(Y);return await this.fd.read(J,0,Y,$),new Uint8Array(J)}async close(){await this.fd.close()}}class c{static byId=new Map;static register($){if(this.byId.has($.id))throw new x0(`Scheme ${$.id} already registered`);this.byId.set($.id,$)}static get($){let Y=this.byId.get($);if(!Y)throw new x0(`Unknown scheme: ${$}`);return Y}static get current(){return this.get(0)}}class H0{p;static IV_LENGTH=12;IV_LENGTH=H0.IV_LENGTH;key;constructor($){this.p=$}async setKey($){this.key=$}async encryptChunk($){let Y=this.p.getRandomValues(new Uint8Array(H0.IV_LENGTH)),J=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:Y},this.key,$));$.fill(0);let Q=new Uint8Array(Y.length+J.length);return Q.set(Y),Q.set(J,Y.length),Q}async decryptChunk($){let Y=$.slice(0,H0.IV_LENGTH),J=$.slice(H0.IV_LENGTH);try{let Q=await this.p.subtle.decrypt({name:"AES-GCM",iv:Y},this.key,J);return new Uint8Array(Q)}catch{throw new d("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){}}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function a$($){return $ instanceof Uint8Array||ArrayBuffer.isView($)&&$.constructor.name==="Uint8Array"}function g0($){if(typeof $!=="boolean")throw new Error(`boolean expected, not ${$}`)}function m0($){if(!Number.isSafeInteger($)||$<0)throw new Error("positive integer expected, got "+$)}function l($,...Y){if(!a$($))throw new Error("Uint8Array expected");if(Y.length>0&&!Y.includes($.length))throw new Error("Uint8Array expected of length "+Y+", got length="+$.length)}function H$($,Y=!0){if($.destroyed)throw new Error("Hash instance has been destroyed");if(Y&&$.finished)throw new Error("Hash#digest() has already been called")}function t$($,Y){l($);let J=Y.outputLen;if($.length<J)throw new Error("digestInto() expects output buffer of length at least "+J)}function Q0($){return new Uint32Array($.buffer,$.byteOffset,Math.floor($.byteLength/4))}function Z0(...$){for(let Y=0;Y<$.length;Y++)$[Y].fill(0)}function MJ($){return new DataView($.buffer,$.byteOffset,$.byteLength)}var RJ=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function PJ($){if(typeof $!=="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode($))}function u0($){if(typeof $==="string")$=PJ($);else if(a$($))$=l0($);else throw new Error("Uint8Array expected, got "+typeof $);return $}function e$($,Y){if(Y==null||typeof Y!=="object")throw new Error("options must be defined");return Object.assign($,Y)}function $Y($,Y){if($.length!==Y.length)return!1;let J=0;for(let Q=0;Q<$.length;Q++)J|=$[Q]^Y[Q];return J===0}var K$=($,Y)=>{function J(Q,...Z){if(l(Q),!RJ)throw new Error("Non little-endian hardware is not yet supported");if($.nonceLength!==void 0){let z=Z[0];if(!z)throw new Error("nonce / iv required");if($.varSizeNonce)l(z);else l(z,$.nonceLength)}let U=$.tagLength;if(U&&Z[1]!==void 0)l(Z[1]);let q=Y(Q,...Z),G=(z,H)=>{if(H!==void 0){if(z!==2)throw new Error("cipher output not supported");l(H)}},X=!1;return{encrypt(z,H){if(X)throw new Error("cannot encrypt() twice with same key + nonce");return X=!0,l(z),G(q.encrypt.length,H),q.encrypt(z,H)},decrypt(z,H){if(l(z),U&&z.length<U)throw new Error("invalid ciphertext length: smaller than tagLength="+U);return G(q.decrypt.length,H),q.decrypt(z,H)}}}return Object.assign(J,$),J};function T$($,Y,J=!0){if(Y===void 0)return new Uint8Array($);if(Y.length!==$)throw new Error("invalid output length, expected "+$+", got: "+Y.length);if(J&&!IJ(Y))throw new Error("invalid output, must be aligned");return Y}function o$($,Y,J,Q){if(typeof $.setBigUint64==="function")return $.setBigUint64(Y,J,Q);let Z=BigInt(32),U=BigInt(4294967295),q=Number(J>>Z&U),G=Number(J&U),X=Q?4:0,W=Q?0:4;$.setUint32(Y+X,q,Q),$.setUint32(Y+W,G,Q)}function YY($,Y,J){g0(J);let Q=new Uint8Array(16),Z=MJ(Q);return o$(Z,0,BigInt(Y),J),o$(Z,8,BigInt($),J),Q}function IJ($){return $.byteOffset%4===0}function l0($){return Uint8Array.from($)}var QY=($)=>Uint8Array.from($.split("").map((Y)=>Y.charCodeAt(0))),VJ=QY("expand 16-byte k"),BJ=QY("expand 32-byte k"),NJ=Q0(VJ),DJ=Q0(BJ);function M($,Y){return $<<Y|$>>>32-Y}function M$($){return $.byteOffset%4===0}var c0=64,FJ=16,ZY=4294967295,JY=new Uint32Array;function _J($,Y,J,Q,Z,U,q,G){let X=Z.length,W=new Uint8Array(c0),z=Q0(W),H=M$(Z)&&M$(U),K=H?Q0(Z):JY,T=H?Q0(U):JY;for(let R=0;R<X;q++){if($(Y,J,Q,z,q,G),q>=ZY)throw new Error("arx: counter overflow");let V=Math.min(c0,X-R);if(H&&V===c0){let B=R/4;if(R%4!==0)throw new Error("arx: invalid block position");for(let N=0,D;N<FJ;N++)D=B+N,T[D]=K[D]^z[N];R+=c0;continue}for(let B=0,N;B<V;B++)N=R+B,U[N]=Z[N]^W[B];R+=V}}function R$($,Y){let{allowShortKeys:J,extendNonceFn:Q,counterLength:Z,counterRight:U,rounds:q}=e$({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},Y);if(typeof $!=="function")throw new Error("core must be a function");return m0(Z),m0(q),g0(U),g0(J),(G,X,W,z,H=0)=>{l(G),l(X),l(W);let K=W.length;if(z===void 0)z=new Uint8Array(K);if(l(z),m0(H),H<0||H>=ZY)throw new Error("arx: counter overflow");if(z.length<K)throw new Error(`arx: output (${z.length}) is shorter than data (${K})`);let T=[],R=G.length,V,B;if(R===32)T.push(V=l0(G)),B=DJ;else if(R===16&&J)V=new Uint8Array(32),V.set(G),V.set(G,16),B=NJ,T.push(V);else throw new Error(`arx: invalid 32-byte key, got length=${R}`);if(!M$(X))T.push(X=l0(X));let N=Q0(V);if(Q){if(X.length!==24)throw new Error("arx: extended nonce must be 24 bytes");Q(B,N,Q0(X.subarray(0,16)),N),X=X.subarray(16)}let D=16-Z;if(D!==X.length)throw new Error(`arx: nonce must be ${D} or 16 bytes`);if(D!==12){let h=new Uint8Array(12);h.set(X,U?0:12-X.length),X=h,T.push(X)}let b=Q0(X);return _J($,B,N,b,W,z,H,q),Z0(...T),z}}var g=($,Y)=>$[Y++]&255|($[Y++]&255)<<8;class UY{constructor($){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,$=u0($),l($,32);let Y=g($,0),J=g($,2),Q=g($,4),Z=g($,6),U=g($,8),q=g($,10),G=g($,12),X=g($,14);this.r[0]=Y&8191,this.r[1]=(Y>>>13|J<<3)&8191,this.r[2]=(J>>>10|Q<<6)&7939,this.r[3]=(Q>>>7|Z<<9)&8191,this.r[4]=(Z>>>4|U<<12)&255,this.r[5]=U>>>1&8190,this.r[6]=(U>>>14|q<<2)&8191,this.r[7]=(q>>>11|G<<5)&8065,this.r[8]=(G>>>8|X<<8)&8191,this.r[9]=X>>>5&127;for(let W=0;W<8;W++)this.pad[W]=g($,16+2*W)}process($,Y,J=!1){let Q=J?0:2048,{h:Z,r:U}=this,q=U[0],G=U[1],X=U[2],W=U[3],z=U[4],H=U[5],K=U[6],T=U[7],R=U[8],V=U[9],B=g($,Y+0),N=g($,Y+2),D=g($,Y+4),b=g($,Y+6),h=g($,Y+8),G0=g($,Y+10),m=g($,Y+12),u=g($,Y+14),F=Z[0]+(B&8191),_=Z[1]+((B>>>13|N<<3)&8191),S=Z[2]+((N>>>10|D<<6)&8191),L=Z[3]+((D>>>7|b<<9)&8191),E=Z[4]+((b>>>4|h<<12)&8191),j=Z[5]+(h>>>1&8191),A=Z[6]+((h>>>14|G0<<2)&8191),w=Z[7]+((G0>>>11|m<<5)&8191),O=Z[8]+((m>>>8|u<<8)&8191),C=Z[9]+(u>>>5|Q),P=0,y=P+F*q+_*(5*V)+S*(5*R)+L*(5*T)+E*(5*K);P=y>>>13,y&=8191,y+=j*(5*H)+A*(5*z)+w*(5*W)+O*(5*X)+C*(5*G),P+=y>>>13,y&=8191;let f=P+F*G+_*q+S*(5*V)+L*(5*R)+E*(5*T);P=f>>>13,f&=8191,f+=j*(5*K)+A*(5*H)+w*(5*z)+O*(5*W)+C*(5*X),P+=f>>>13,f&=8191;let x=P+F*X+_*G+S*q+L*(5*V)+E*(5*R);P=x>>>13,x&=8191,x+=j*(5*T)+A*(5*K)+w*(5*H)+O*(5*z)+C*(5*W),P+=x>>>13,x&=8191;let v=P+F*W+_*X+S*G+L*q+E*(5*V);P=v>>>13,v&=8191,v+=j*(5*R)+A*(5*T)+w*(5*K)+O*(5*H)+C*(5*z),P+=v>>>13,v&=8191;let e=P+F*z+_*W+S*X+L*G+E*q;P=e>>>13,e&=8191,e+=j*(5*V)+A*(5*R)+w*(5*T)+O*(5*K)+C*(5*H),P+=e>>>13,e&=8191;let P0=P+F*H+_*z+S*W+L*X+E*G;P=P0>>>13,P0&=8191,P0+=j*q+A*(5*V)+w*(5*R)+O*(5*T)+C*(5*K),P+=P0>>>13,P0&=8191;let I0=P+F*K+_*H+S*z+L*W+E*X;P=I0>>>13,I0&=8191,I0+=j*G+A*q+w*(5*V)+O*(5*R)+C*(5*T),P+=I0>>>13,I0&=8191;let V0=P+F*T+_*K+S*H+L*z+E*W;P=V0>>>13,V0&=8191,V0+=j*X+A*G+w*q+O*(5*V)+C*(5*R),P+=V0>>>13,V0&=8191;let B0=P+F*R+_*T+S*K+L*H+E*z;P=B0>>>13,B0&=8191,B0+=j*W+A*X+w*G+O*q+C*(5*V),P+=B0>>>13,B0&=8191;let N0=P+F*V+_*R+S*T+L*K+E*H;P=N0>>>13,N0&=8191,N0+=j*z+A*W+w*X+O*G+C*q,P+=N0>>>13,N0&=8191,P=(P<<2)+P|0,P=P+y|0,y=P&8191,P=P>>>13,f+=P,Z[0]=y,Z[1]=f,Z[2]=x,Z[3]=v,Z[4]=e,Z[5]=P0,Z[6]=I0,Z[7]=V0,Z[8]=B0,Z[9]=N0}finalize(){let{h:$,pad:Y}=this,J=new Uint16Array(10),Q=$[1]>>>13;$[1]&=8191;for(let q=2;q<10;q++)$[q]+=Q,Q=$[q]>>>13,$[q]&=8191;$[0]+=Q*5,Q=$[0]>>>13,$[0]&=8191,$[1]+=Q,Q=$[1]>>>13,$[1]&=8191,$[2]+=Q,J[0]=$[0]+5,Q=J[0]>>>13,J[0]&=8191;for(let q=1;q<10;q++)J[q]=$[q]+Q,Q=J[q]>>>13,J[q]&=8191;J[9]-=8192;let Z=(Q^1)-1;for(let q=0;q<10;q++)J[q]&=Z;Z=~Z;for(let q=0;q<10;q++)$[q]=$[q]&Z|J[q];$[0]=($[0]|$[1]<<13)&65535,$[1]=($[1]>>>3|$[2]<<10)&65535,$[2]=($[2]>>>6|$[3]<<7)&65535,$[3]=($[3]>>>9|$[4]<<4)&65535,$[4]=($[4]>>>12|$[5]<<1|$[6]<<14)&65535,$[5]=($[6]>>>2|$[7]<<11)&65535,$[6]=($[7]>>>5|$[8]<<8)&65535,$[7]=($[8]>>>8|$[9]<<5)&65535;let U=$[0]+Y[0];$[0]=U&65535;for(let q=1;q<8;q++)U=($[q]+Y[q]|0)+(U>>>16)|0,$[q]=U&65535;Z0(J)}update($){H$(this),$=u0($),l($);let{buffer:Y,blockLen:J}=this,Q=$.length;for(let Z=0;Z<Q;){let U=Math.min(J-this.pos,Q-Z);if(U===J){for(;J<=Q-Z;Z+=J)this.process($,Z);continue}if(Y.set($.subarray(Z,Z+U),this.pos),this.pos+=U,Z+=U,this.pos===J)this.process(Y,0,!1),this.pos=0}return this}destroy(){Z0(this.h,this.r,this.buffer,this.pad)}digestInto($){H$(this),t$($,this),this.finished=!0;let{buffer:Y,h:J}=this,{pos:Q}=this;if(Q){Y[Q++]=1;for(;Q<16;Q++)Y[Q]=0;this.process(Y,0,!0)}this.finalize();let Z=0;for(let U=0;U<8;U++)$[Z++]=J[U]>>>0,$[Z++]=J[U]>>>8;return $}digest(){let{buffer:$,outputLen:Y}=this;this.digestInto($);let J=$.slice(0,Y);return this.destroy(),J}}function SJ($){let Y=(Q,Z)=>$(Z).update(u0(Q)).digest(),J=$(new Uint8Array(32));return Y.outputLen=J.outputLen,Y.blockLen=J.blockLen,Y.create=(Q)=>$(Q),Y}var qY=SJ(($)=>new UY($));function WY($,Y,J,Q,Z,U=20){let q=$[0],G=$[1],X=$[2],W=$[3],z=Y[0],H=Y[1],K=Y[2],T=Y[3],R=Y[4],V=Y[5],B=Y[6],N=Y[7],D=Z,b=J[0],h=J[1],G0=J[2],m=q,u=G,F=X,_=W,S=z,L=H,E=K,j=T,A=R,w=V,O=B,C=N,P=D,y=b,f=h,x=G0;for(let e=0;e<U;e+=2)m=m+S|0,P=M(P^m,16),A=A+P|0,S=M(S^A,12),m=m+S|0,P=M(P^m,8),A=A+P|0,S=M(S^A,7),u=u+L|0,y=M(y^u,16),w=w+y|0,L=M(L^w,12),u=u+L|0,y=M(y^u,8),w=w+y|0,L=M(L^w,7),F=F+E|0,f=M(f^F,16),O=O+f|0,E=M(E^O,12),F=F+E|0,f=M(f^F,8),O=O+f|0,E=M(E^O,7),_=_+j|0,x=M(x^_,16),C=C+x|0,j=M(j^C,12),_=_+j|0,x=M(x^_,8),C=C+x|0,j=M(j^C,7),m=m+L|0,x=M(x^m,16),O=O+x|0,L=M(L^O,12),m=m+L|0,x=M(x^m,8),O=O+x|0,L=M(L^O,7),u=u+E|0,P=M(P^u,16),C=C+P|0,E=M(E^C,12),u=u+E|0,P=M(P^u,8),C=C+P|0,E=M(E^C,7),F=F+j|0,y=M(y^F,16),A=A+y|0,j=M(j^A,12),F=F+j|0,y=M(y^F,8),A=A+y|0,j=M(j^A,7),_=_+S|0,f=M(f^_,16),w=w+f|0,S=M(S^w,12),_=_+S|0,f=M(f^_,8),w=w+f|0,S=M(S^w,7);let v=0;Q[v++]=q+m|0,Q[v++]=G+u|0,Q[v++]=X+F|0,Q[v++]=W+_|0,Q[v++]=z+S|0,Q[v++]=H+L|0,Q[v++]=K+E|0,Q[v++]=T+j|0,Q[v++]=R+A|0,Q[v++]=V+w|0,Q[v++]=B+O|0,Q[v++]=N+C|0,Q[v++]=D+P|0,Q[v++]=b+y|0,Q[v++]=h+f|0,Q[v++]=G0+x|0}function LJ($,Y,J,Q){let Z=$[0],U=$[1],q=$[2],G=$[3],X=Y[0],W=Y[1],z=Y[2],H=Y[3],K=Y[4],T=Y[5],R=Y[6],V=Y[7],B=J[0],N=J[1],D=J[2],b=J[3];for(let G0=0;G0<20;G0+=2)Z=Z+X|0,B=M(B^Z,16),K=K+B|0,X=M(X^K,12),Z=Z+X|0,B=M(B^Z,8),K=K+B|0,X=M(X^K,7),U=U+W|0,N=M(N^U,16),T=T+N|0,W=M(W^T,12),U=U+W|0,N=M(N^U,8),T=T+N|0,W=M(W^T,7),q=q+z|0,D=M(D^q,16),R=R+D|0,z=M(z^R,12),q=q+z|0,D=M(D^q,8),R=R+D|0,z=M(z^R,7),G=G+H|0,b=M(b^G,16),V=V+b|0,H=M(H^V,12),G=G+H|0,b=M(b^G,8),V=V+b|0,H=M(H^V,7),Z=Z+W|0,b=M(b^Z,16),R=R+b|0,W=M(W^R,12),Z=Z+W|0,b=M(b^Z,8),R=R+b|0,W=M(W^R,7),U=U+z|0,B=M(B^U,16),V=V+B|0,z=M(z^V,12),U=U+z|0,B=M(B^U,8),V=V+B|0,z=M(z^V,7),q=q+H|0,N=M(N^q,16),K=K+N|0,H=M(H^K,12),q=q+H|0,N=M(N^q,8),K=K+N|0,H=M(H^K,7),G=G+X|0,D=M(D^G,16),T=T+D|0,X=M(X^T,12),G=G+X|0,D=M(D^G,8),T=T+D|0,X=M(X^T,7);let h=0;Q[h++]=Z,Q[h++]=U,Q[h++]=q,Q[h++]=G,Q[h++]=B,Q[h++]=N,Q[h++]=D,Q[h++]=b}var EJ=R$(WY,{counterRight:!1,counterLength:4,allowShortKeys:!1}),jJ=R$(WY,{counterRight:!1,counterLength:8,extendNonceFn:LJ,allowShortKeys:!1});var AJ=new Uint8Array(16),GY=($,Y)=>{$.update(Y);let J=Y.length%16;if(J)$.update(AJ.subarray(J))},wJ=new Uint8Array(32);function XY($,Y,J,Q,Z){let U=$(Y,J,wJ),q=qY.create(U);if(Z)GY(q,Z);GY(q,Q);let G=YY(Q.length,Z?Z.length:0,!0);q.update(G);let X=q.digest();return Z0(U,G),X}var zY=($)=>(Y,J,Q)=>{return{encrypt(U,q){let G=U.length;q=T$(G+16,q,!1),q.set(U);let X=q.subarray(0,-16);$(Y,J,X,X,1);let W=XY($,Y,J,X,Q);return q.set(W,G),Z0(W),q},decrypt(U,q){q=T$(U.length-16,q,!1);let G=U.subarray(0,-16),X=U.subarray(-16),W=XY($,Y,J,G,Q);if(!$Y(X,W))throw new Error("invalid tag");return q.set(U.subarray(0,-16)),$(Y,J,q,q,1),Z0(W),q}}},fQ=K$({blockSize:64,nonceLength:12,tagLength:16},zY(EJ)),P$=K$({blockSize:64,nonceLength:24,tagLength:16},zY(jJ));class K0{p;static IV_LENGTH=24;IV_LENGTH=K0.IV_LENGTH;key;constructor($){this.p=$}async setKey($){this.key=new Uint8Array(await this.p.subtle.exportKey("raw",$))}async encryptChunk($){let Y=this.p.getRandomValues(new Uint8Array(K0.IV_LENGTH)),Q=P$(this.key,Y).encrypt($);$.fill(0);let Z=new Uint8Array(Y.length+Q.length);return Z.set(Y,0),Z.set(Q,Y.length),Z}async decryptChunk($){let Y=$.slice(0,K0.IV_LENGTH),J=$.slice(K0.IV_LENGTH),Q=P$(this.key,Y);try{return Q.decrypt(J)}catch{throw new d("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){this.key.fill(0)}}var n0=_0(require("argon2-browser"));async function fY($,Y,J,Q){if(Q==="node"){let Z=await Promise.resolve().then(() => _0(bY())),U=typeof $==="string"?Buffer.from($,"utf8"):Buffer.from($),q=Buffer.from(Y),G=await Z.hash(U,{salt:q,timeCost:J.time,memoryCost:J.mem,parallelism:J.parallelism,hashLength:32,raw:!0,type:Z.argon2id});return q.fill(0),U.fill(0),{hash:new Uint8Array(G)}}if(Q==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>fetch("argon2.wasm").then((Z)=>{if(!Z.ok)throw new Error("Failed to load argon2.wasm");return Z.arrayBuffer()}).then((Z)=>new Uint8Array(Z));return n0.hash({pass:$,salt:Y,time:J.time,mem:J.mem,parallelism:J.parallelism,hashLen:32,type:n0.ArgonType.Argon2id}).then((Z)=>{if(!Z||!Z.hash)throw new J0("Failed to produce key derivation");return{hash:Z.hash}}).catch((Z)=>{let U=Z instanceof Error?Z.message:typeof Z==="string"?Z:"Unknown error";throw new J0(`argon2-browser failure: ${U}`)})}throw new Error(`Unsupported environment: ${Q}`)}class s0{presets;exportExtractable;name="argon2id";constructor($,Y=!1){this.presets=$;this.exportExtractable=Y}async derive($,Y,J,Q){let{hash:Z}=await fY($,Y,this.presets[J],Q.isNode?"node":"browser");if(this.exportExtractable)return Q.subtle.importKey("raw",Z,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);else return Q.subtle.importKey("raw",Z,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var xY={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},aJ={id:0,cipher:H0,kdf:new s0(xY),saltLengths:{low:12,high:16},difficulties:xY,defaultChunkSize:524288};c.register(aJ);var hY={low:{time:5,mem:65536,parallelism:2},middle:{time:10,mem:98304,parallelism:4},high:{time:20,mem:98304,parallelism:4}},tJ={id:1,cipher:K0,kdf:new s0(hY,!0),saltLengths:{low:12,high:16},difficulties:hY,defaultChunkSize:524288};c.register(tJ);var r0=1;function k0($,Y,J,Q){let Z={low:0,middle:1,high:2}[Y]??0,U=$<<5|(J==="high"?1:0)<<2|Z;return E0(new Uint8Array([r0,U]),Q)}function M0($){if($[0]!==r0)throw new a("Invalid input format. The input is unknown.");if($.length<14)throw new a("Invalid input format. Header too short.");try{let Y=$[1],J=Y>>5,Q=Y>>2&1?"high":"low",Z=Y&3,U=["low","middle","high"][Z],q=c.get(J).saltLengths[Q],G=$.slice(2,2+q);return{scheme:J,difficulty:U,saltStrength:Q,salt:G,headerLen:2+q}}catch(Y){throw new z0(Y instanceof Error?Y.message:String(Y))}}class v0{engine;chunkSize;buffer=new Uint8Array(0);constructor($,Y=524288){this.engine=$;this.chunkSize=Y}toTransformStream(){return new TransformStream({transform:async($,Y)=>{await this.transform(await this.asUint8Array($),Y)},flush:async($)=>this.flush($)})}async transform($,Y){if($.length>this.chunkSize*4)throw new RangeError(`Input block (${$.length} B) exceeds sane limit`);let J=new Uint8Array(this.buffer.length+$.length);J.set(this.buffer),J.set($,this.buffer.length);let Q=0;while(J.length-Q>=this.chunkSize){let Z=J.slice(Q,Q+this.chunkSize);Q+=this.chunkSize;let U=await this.engine.encryptChunk(Z),q=new Uint8Array(4);new DataView(q.buffer).setUint32(0,U.length,!1);let G=new Uint8Array(4+U.length);G.set(q),G.set(U,q.length),Y.enqueue(G)}this.buffer=J.slice(Q)}async flush($){if(!this.buffer.length)return;let Y=await this.engine.encryptChunk(this.buffer),J=new Uint8Array(4);new DataView(J.buffer).setUint32(0,Y.length,!1);let Q=new Uint8Array(4+Y.length);Q.set(J),Q.set(Y,4),$.enqueue(Q),this.buffer=new Uint8Array(0),this.engine.zeroKey()}async asUint8Array($){if($ instanceof Uint8Array)return $;if($ instanceof ArrayBuffer)return new Uint8Array($);return new Uint8Array(await $.arrayBuffer())}}class D0{engine;chunkSize;buffer=new Uint8Array(0);constructor($,Y=524288){this.engine=$;this.chunkSize=Y}toTransformStream(){return new TransformStream({transform:async($,Y)=>{await this.transform(await this.asUint8Array($),Y)},flush:async($)=>this.flush($)})}async transform($,Y){let J=new Uint8Array(this.buffer.length+$.length);J.set(this.buffer),J.set($,this.buffer.length);let Q=0;while(!0){if(J.length-Q<4)break;let Z=new DataView(J.buffer,J.byteOffset+Q,4).getUint32(0,!1);if(Z>this.chunkSize*2)throw new d(`Frame length ${Z} exceeds maximum allowed ${this.chunkSize*2}`);if(J.length-Q-4<Z)break;Q+=4;let U=J.slice(Q,Q+Z);Q+=Z;try{let q=await this.engine.decryptChunk(U);Y.enqueue(q)}catch(q){throw q instanceof d?q:new d("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=J.slice(Q)}async flush($){await this.transform(new Uint8Array(0),$),this.buffer=new Uint8Array(0),this.engine.zeroKey()}async asUint8Array($){if($ instanceof Uint8Array)return $;if($ instanceof ArrayBuffer)return new Uint8Array($);return new Uint8Array(await $.arrayBuffer())}}class F0{engine;chunkSize;constructor($,Y=524288){this.engine=$;this.chunkSize=Y}encryptionStream(){let $=new v0(this.engine,this.chunkSize).toTransformStream();return{writable:$.writable,readable:$.readable}}decryptionStream($){let Y=$,J=new TransformStream({transform(Z,U){if(Y===0){U.enqueue(Z);return}if(Z.byteLength<=Y){Y-=Z.byteLength;return}U.enqueue(Z.slice(Y)),Y=0}}),Q=new D0(this.engine,this.chunkSize).toTransformStream();return{writable:J.writable,readable:J.readable.pipeThrough(Q)}}async collect($,Y,J=null){let Q=$.pipeThrough(Y).getReader(),Z=[];if(J?.length)Z.push(J);try{while(!0){let{value:X,done:W}=await Q.read();if(W)break;Z.push(X)}await Q.closed}finally{Q.releaseLock()}let U=Z.reduce((X,W)=>X+W.byteLength,0),q=new Uint8Array(U),G=0;for(let X of Z)q.set(X,G),G+=X.byteLength;return q}}function gY($=0,Y=console.info){return{level:$,log(J,Q){if(J<=$)Y(`${J}| ${Q}`)}}}var mY=new WeakMap;class X0{static getEngine($,Y){let J=mY.get($);if(!J)J=new Map,mY.set($,J);let Q=J.get(Y);if(Q)return Q;let Z=c.get(Y);return Q={desc:Z,cipher:new Z.cipher($),kdf:Z.kdf,chunkSize:Z.defaultChunkSize,provider:$},J.set(Y,Q),Q}static async deriveKey($,Y,J,Q){try{let Z=await $.kdf.derive(Y.value,J,Q,$.provider);s(Y),await $.cipher.setKey(Z)}catch(Z){let U=Z instanceof Error?Z.message:String(Z);throw new J0(U)}}}class p{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor($,Y={}){this.provider=$;this.v=c.get(Y.scheme??c.current.id),this.cipher=new this.v.cipher($),this.kdf=this.v.kdf,this.chunkSize=this.setChunkSize(Y.chunkSize??this.v.defaultChunkSize),this.stream=new F0(this.cipher,this.chunkSize),this.difficulty=Y.difficulty??"middle",this.saltStrength=Y.saltStrength??"high",this.log=gY(Y.verbose??0,Y.logger)}static async isEncrypted($){try{return await p.peekHeader($),!0}catch{return!1}}static async headerDecode($){let Y=await p.peekHeader($),J=M0(Y);return{scheme:J.scheme,difficulty:J.difficulty,salt:j0(J.salt),saltLength:J.salt.byteLength}}static async decodeData($){let Y=typeof $?.read==="function"?$:new z$($),J=await Y.read(0,Math.min(256,Y.length)),Q=await p.peekHeader(J),{scheme:Z,headerLen:U}=M0(Q),q=Y.length,G=q-U;if(G<=0)throw new a("Payload is empty");let X=await Y.read(U,4),W=new DataView(X.buffer,X.byteOffset,4).getUint32(0,!1);if(W+4<=G&&W>=28){let T=W,R=U,V=0,B=0;while(R+4<=q){let N=await Y.read(R,4),D=new DataView(N.buffer,N.byteOffset,4).getUint32(0,!1);if(D===0||R+4+D>q)break;V++,B+=D,R+=4+D}return{isChunked:!0,chunks:{chunkSize:T,count:V,totalPayload:B}}}let H=await Y.read(U,G),K=c.get(Z).cipher.IV_LENGTH;if(H.length<K+16)throw new a("Ciphertext too short for IV & tag");return{isChunked:!1,payloadLength:G,params:{iv:H.slice(0,K),tag:H.slice(H.length-16)}}}setDifficulty($){this.difficulty=$}getDifficulty(){return this.difficulty}setScheme($){this.v=c.get($),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new F0(this.cipher,this.chunkSize)}getScheme(){return this.v.id}setSaltDifficulty($){this.saltStrength=$}getSaltDifficulty(){return this.saltStrength}setChunkSize($){let Y=$,J;if(Y==null)J=this.v.defaultChunkSize;else if(J=Number(Y),!Number.isInteger(J)||J<1)throw new Error(`Invalid chunkSize: ${Y}. Must be a positive integer.`);return this.chunkSize=J,this.stream=new F0(this.cipher,this.chunkSize),J}getChunkSize(){return this.chunkSize}setVerbose($){this.log.level=$}getVerbose(){return this.log.level}async encryptText($,Y){let J={value:Y};try{this.log.log(1,`Start text encryption, scheme: ${this.getScheme()}`),this.log.log(2,"Deriving key for text encryption");let Q=this.genSalt();await this.deriveKey(J,Q),s(J),Y=null,this.log.log(3,`Salt generated: ${j0(Q)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let Z=await this.cipher.encryptChunk(typeof $==="string"?new TextEncoder().encode($):$);this.cipher.zeroKey(),this.log.log(3,"Encoding header");let U=k0(this.v.id,this.difficulty,this.saltStrength,Q);this.log.log(3,"Encoding text");let q=j0(U,Z);return this.log.log(1,"Decryption finished"),q}catch(Q){throw new h0(Q instanceof Error?Q.message:String(Q))}}async decryptText($,Y){let J={value:Y};try{this.log.log(1,`Start text decryption, Version ${this.getScheme()}`),this.log.log(3,"Start text decoding");let Q=A0($);this.log.log(3,"Start header decoding"),await p.peekHeader($);let Z=M0(Q);this.log.log(3,"Trying to get engine");let U=X0.getEngine(this.provider,Z.scheme);this.log.log(2,`Deriving key via engine for scheme: ${Z.scheme}`),this.log.log(3,`Salt use: ${j0(Z.salt)}, KDF difficulty: ${Z.difficulty}`);try{await X0.deriveKey(U,J,Z.salt,Z.difficulty)}finally{s(J),Y=null}this.log.log(2,"Decrypting text data");let q=await U.cipher.decryptChunk(Q.slice(Z.headerLen));U.cipher.zeroKey(),this.log.log(3,"Decoding text");let G=new TextDecoder().decode(q);return this.log.log(1,"Decryption finished"),G}catch(Q){if(Q instanceof d||Q instanceof a||Q instanceof z0||Q instanceof L0||Q instanceof J0)throw Q;throw new d("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile($,Y){let J={value:Y};try{if($.size===0){let q=this.genSalt();await this.deriveKey(J,q),s(J),Y=null;let G=k0(this.v.id,this.difficulty,this.saltStrength,q);return new Blob([G],{type:"application/octet-stream"})}this.log.log(2,"Deriving key for file encryption");let Q=this.genSalt();await this.deriveKey(J,Q),s(J),Y=null;let Z=k0(this.v.id,this.difficulty,this.saltStrength,Q),U=await this.stream.collect($.stream(),new v0(this.cipher,this.chunkSize).toTransformStream(),Z);return new Blob([U],{type:"application/octet-stream"})}catch(Q){throw new h0(Q instanceof Error?Q.message:String(Q))}}async decryptFile($,Y){let J={value:Y};try{let Q=await p.peekHeader($),Z=M0(Q),U=X0.getEngine(this.provider,Z.scheme);try{await X0.deriveKey(U,J,Z.salt,Z.difficulty)}finally{s(J),Y=null}if($.size===Z.headerLen)return new Blob([],{type:"application/octet-stream"});this.log.log(2,"Decrypting file data");let G=await new F0(U.cipher,U.chunkSize).collect($.slice(Z.headerLen).stream(),new D0(U.cipher,U.chunkSize).toTransformStream());return new Blob([G],{type:"application/octet-stream"})}catch(Q){if(Q instanceof d)throw Q;throw new d(Q instanceof Error?Q.message:String(Q))}}async createEncryptionStream($){let Y={value:$};this.log.log(2,"Deriving key for stream encryption");let J=this.genSalt();await this.deriveKey(Y,J),s(Y),$=null;let Q=k0(this.v.id,this.difficulty,this.saltStrength,J),Z=this.stream.encryptionStream();return{header:Q,writable:Z.writable,readable:Z.readable}}async createDecryptionStream($){let Y={value:$},J=this,Q=new Uint8Array(0),Z=null;async function U(q,G){let X=q.getReader();while(!0){let{value:W,done:z}=await X.read();if(z)break;G.enqueue(W)}}return new TransformStream({async transform(q,G){if(!Z){if(Q=E0(Q,q),Q.length<2)return;let W=Q.slice(0,30),{salt:z,difficulty:H}=M0(W),K=Q[1]>>5,T=Q[1]>>2&1?"high":"low",V=2+c.get(K).saltLengths[T];if(Q.length<V)return;let B=X0.getEngine(J.provider,K);try{await X0.deriveKey(B,Y,z,H)}finally{s(Y),$=null}Z=new D0(B.cipher,B.chunkSize).toTransformStream(),U(Z.readable,G).catch((D)=>{G.error(D)});let N=Q.slice(V);if(N.length){let D=Z.writable.getWriter();await D.write(N),D.releaseLock()}return}let X=Z.writable.getWriter();await X.write(q),X.releaseLock()},async flush(){if(Z){let q=Z.writable.getWriter();await q.close(),q.releaseLock()}}})}async deriveKey($,Y,J=this.difficulty){let Q=performance.now();try{let Z=await this.kdf.derive($.value,Y,J,this.provider);s($),await this.cipher.setKey(Z),this.log.log(3,`Key derivation completed in ${(performance.now()-Q).toFixed(1)} ms`)}catch(Z){throw new J0(Z instanceof Error?Z.message:String(Z))}}genSalt($=this.saltStrength){let Y=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(Y))}static async peekHeader($){let Y=await this.readAsUint8($);if(Y instanceof Uint8Array){if(Y.length<2)throw new a("Input too short");let{headerLen:J}=M0(Y.length>=16?Y:Uint8Array.from(Y));if(Y.length<J)throw new a("Incomplete header");return Y.slice(0,J)}throw new z0("Unsupported input type")}static async readAsUint8($){if(typeof $==="string")return A0($);if($ instanceof Uint8Array)return $;if($ instanceof Blob)return new Uint8Array(await $.arrayBuffer());throw new z0("Unsupported input type")}}var o0=require("node:crypto"),uY={subtle:o0.webcrypto.subtle,getRandomValues($){return o0.randomFillSync($),$},isNode:!0};function y0($){return new p(uY,$)}var q0=require("node:path"),a0=require("fs"),iY=_0(require("os")),L$=_0(require("path")),eJ="0.2.13",$Q=process.cwd();async function e0(){if(!I.stdin.isTTY)throw new Error("STDIN not a TTY; use --pass");I.stderr.write("Passphrase: "),I.stdin.setRawMode?.(!0),I.stdin.resume(),I.stdin.setEncoding("utf8");let $="";return new Promise((Y)=>{function J(){I.stdin.setRawMode?.(!1),I.stdin.pause(),I.stderr.write(`
`),I.stdin.off("data",Q),Y($)}function Q(Z){if(Z==="\x03")I.exit(130);if(Z==="\r"||Z===`
`)return J();if(Z==="\b"||Z===""){$=$.slice(0,-1);return}$+=Z}I.stdin.on("data",Q)})}function lY($,Y=$Q){if($==="-")return;let J=r.realpathSync(Y),Q=q0.isAbsolute($)?q0.resolve($):q0.resolve(J,$),Z=q0.dirname(Q);if(!r.realpathSync(Z).startsWith(J+q0.sep))throw new Error("Refusing to write outside of root directory.");if(!r.existsSync(Z))throw new Error(`Output directory does not exist: ${Z}`);try{r.accessSync(Z,r.constants.W_OK)}catch{throw new Error("Output directory is not writeable")}return Q}function cY($){return t0.Readable.toWeb($)}function dY($){return t0.Writable.toWeb($)}async function pY(){let $=[];for await(let Y of I.stdin)$.push(Y);return Buffer.concat($).toString("utf8")}var o=new n$;o.name("cryptit").version(eJ).description(`Text and File Encryption Utility
Scheme 0: AES-GCM (Native) / Argon2id (Single Thread)
Scheme 1: XChaCha20-Poly1305 (JS Engine) / Argon2id (Parallel)`).addOption(new W0("-S, --scheme <0-1>","encryption scheme version").argParser(($)=>{let Y=Number($);if(!Number.isInteger(Y)||Y<0||Y>7)throw new Error("Version size must be a integer between 0 and 7");return Y}).default(0,"0")).addOption(new W0("-p, --pass <passphrase>","passphrase (prompt if omitted)").hideHelp().argParser(($)=>{if(!$.trim())throw new Error("Passphrase cannot be empty");return $})).addOption(new W0("-d, --difficulty <level>","argon2 difficulty").choices(["low","middle","high"]).default("middle","middle")).addOption(new W0("-s, --salt-strength <variant>","salt length variant").choices(["low","high"]).default("high","high")).addOption(new W0("-c, --chunk-size <bytes>","chunk size in bytes").argParser(($)=>{let Y=Number($);if(!Number.isInteger(Y)||Y<=0)throw new Error("Chunk size must be a positive integer");return Y}).default(524288,"512*1024")).addOption(new W0("-v, --verbose","increase verbosity (use multiple times)").default(0).argParser(($,Y)=>{return Y+1}));process.on("uncaughtException",($)=>{if($ instanceof Error){let Y=$.constructor.name,J=$.message;I.stderr.write(`Error [${Y}]: ${J}
`)}else I.stderr.write(`Error [Unknown]: ${String($)}
`);I.exit(1)});process.on("unhandledRejection",($)=>{if($ instanceof Error){let Y=$.constructor.name,J=$.message;I.stderr.write(`Error [${Y}]: ${J}
`)}else I.stderr.write(`Error [Unknown]: ${String($)}
`);I.exit(1)});o.command("decode [src]").description("Show Cryptit header information plus payload details; omit arg or use - to read from STDIN").action(async($)=>{let Y=!$||$==="-";async function J(X){if(X.length<2)throw new Error("Input too short for header");let W=X.subarray(0,Math.min(256,X.length)),z=await p.headerDecode(W),H=await p.decodeData(X);if(H.isChunked){let{chunkSize:R,count:V,totalPayload:B}=H.chunks;return{...z,isChunked:!0,chunks:{chunkSize:R,count:V,totalPayload:B}}}let K=Buffer.from(H.params.iv).toString("base64"),T=Buffer.from(H.params.tag).toString("base64");return{...z,isChunked:!1,payloadLength:H.payloadLength,params:{iv:K,tag:T}}}async function Q(X){let W=await X.read(0,Math.min(256,X.length)),z=await p.headerDecode(W),H=await p.decodeData(X);if(H.isChunked){let{chunkSize:R,count:V,totalPayload:B}=H.chunks;return{...z,isChunked:!0,chunks:{chunkSize:R,count:V,totalPayload:B}}}let K=Buffer.from(H.params.iv).toString("base64"),T=Buffer.from(H.params.tag).toString("base64");return{...z,isChunked:!1,payloadLength:H.payloadLength,params:{iv:K,tag:T}}}async function Z(){let X=await a0.promises.mkdtemp(L$.join(iY.tmpdir(),"cryptit-")),W=L$.join(X,"stdin.bin"),z=R0.createWriteStream(W);return await new Promise((H,K)=>{process.stdin.pipe(z),z.on("finish",H),z.on("error",K),process.stdin.on("error",K)}),W}if(!Y&&$){let X=await w0.open($);try{let W=await Q(X);I.stdout.write(JSON.stringify(W,null,2)+`
`)}finally{await X.close()}return}if(Y){let X=await Z(),W=await w0.open(X);try{try{let R=await Q(W);I.stdout.write(JSON.stringify(R,null,2)+`
`);return}catch{}}finally{await W.close()}let z=(await a0.promises.readFile(X,{encoding:"utf8"})).trim();if(await a0.promises.unlink(X),!(/^[A-Za-z0-9+/]+={0,2}$/.test(z)&&z.length%4===0))I.stderr.write(`Error: Input neither valid Cryptit binary nor Base-64 text
`),I.exit(1);let K=Buffer.from(z,"base64"),T=await J(new Uint8Array(K));I.stdout.write(JSON.stringify(T,null,2)+`
`);return}let U=Buffer.from($,"utf8"),q=U.toString("utf8").trim(),G=/^[A-Za-z0-9+/]+={0,2}$/.test(q)&&q.length%4===0;try{if(G){let X=Buffer.from(q,"base64"),W=await J(new Uint8Array(X));I.stdout.write(JSON.stringify(W,null,2)+`
`)}else{let X=await J(new Uint8Array(U));I.stdout.write(JSON.stringify(X,null,2)+`
`)}}catch(X){let W=X instanceof Error?X.message:String(X);I.stderr.write(`Error: ${W}
`),I.exit(1)}});o.command("encrypt <src>").description("Encrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async($,Y)=>{if($!=="-"&&!r.existsSync($))I.stderr.write(`Error: input file not found: ${$}
`),I.exit(1);let J=o.opts(),Q=y0({difficulty:J.difficulty,saltStrength:J.saltStrength,chunkSize:J.chunkSize,verbose:J.verbose,scheme:J.scheme}),Z=J.pass??(I.stdin.isTTY?await e0():(()=>{I.stderr.write(`Use --pass when piping via STDIN
`),I.exit(1)})());try{lY(Y.out)}catch(T){I.stderr.write(`Error: ${T.message}
`),I.exit(1)}let U=$==="-"?I.stdin:R0.createReadStream($),q=Y.out==="-"?I.stdout:R0.createWriteStream(Y.out),{header:G,writable:X,readable:W}=await Q.createEncryptionStream(Z),z=cY(U),H=dY(q),K=H.getWriter();await K.write(G),K.releaseLock(),await Promise.all([z.pipeTo(X),W.pipeTo(H)])});o.command("decrypt <src>").description("Decrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async($,Y)=>{if($!=="-"&&!r.existsSync($))I.stderr.write(`Error: input file not found: ${$}
`),I.exit(1);let J=o.opts(),Q=y0({difficulty:J.difficulty,saltStrength:J.saltStrength,chunkSize:J.chunkSize,verbose:J.verbose,scheme:J.scheme});try{lY(Y.out)}catch(z){I.stderr.write(`Error: ${z.message}
`),I.exit(1)}let Z=J.pass??await e0(),U=$==="-"?I.stdin:R0.createReadStream($),q=Y.out==="-"?I.stdout:R0.createWriteStream(Y.out),G=cY(U),X=dY(q),W=await Q.createDecryptionStream(Z);await Promise.all([G.pipeTo(W.writable),W.readable.pipeTo(X)])});o.command("encrypt-text [text]").description("Encrypt plaintext; omit arg to read from STDIN").action(async($)=>{let Y=o.opts(),J=y0({difficulty:Y.difficulty,saltStrength:Y.saltStrength,verbose:Y.verbose,scheme:Y.scheme}),Q=Y.pass??(I.stdin.isTTY?await e0():(()=>{I.stderr.write(`Use --pass when piping via STDIN
`),I.exit(1)})()),Z=$??await pY(),U=await J.encryptText(Z,Q);I.stdout.write(U+`
`)});o.command("decrypt-text [b64]").description("Decrypt Base64 ciphertext; omit arg to read from STDIN").action(async($)=>{let Y=o.opts(),J=y0({difficulty:Y.difficulty,saltStrength:Y.saltStrength,verbose:Y.verbose,scheme:Y.scheme}),Q=Y.pass??await e0(),Z=$??(await pY()).trim();if(!/^[A-Za-z0-9+/]+={0,2}$/.test(Z))I.stderr.write(`Error: ciphertext does not look like Base64
`),I.exit(1);let U=await J.decryptText(Z,Q);I.stdout.write(U+`
`)});o.parse();

//# debugId=74F3AA28CA2C73A764756E2164756E21
