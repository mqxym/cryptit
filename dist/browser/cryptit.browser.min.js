var J6=Object.create;var{getPrototypeOf:V6,defineProperty:UA,getOwnPropertyNames:Bj,getOwnPropertyDescriptor:Y6}=Object,Tj=Object.prototype.hasOwnProperty;var hA=(A,j,n)=>{n=A!=null?J6(V6(A)):{};let f=j||!A||!A.__esModule?UA(n,"default",{value:A,enumerable:!0}):n;for(let q of Bj(A))if(!Tj.call(f,q))UA(f,q,{get:()=>A[q],enumerable:!0});return f},Hj=new WeakMap,gj=(A)=>{var j=Hj.get(A),n;if(j)return j;if(j=UA({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")Bj(A).map((f)=>!Tj.call(j,f)&&UA(j,f,{get:()=>A[f],enumerable:!(n=Y6(A,f))||n.enumerable}));return Hj.set(A,j),j},pA=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var Q6=(A,j)=>{for(var n in j)UA(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(f)=>j[n]=()=>f})};var X6=(A,j)=>()=>(A&&(j=A(A=0)),j);var aA=((A)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(A,{get:(j,n)=>(typeof require!=="undefined"?require:j)[n]}):A)(function(A){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+A+'" is not supported')});var Ej={};Q6(Ej,{sep:()=>dj,resolve:()=>cA,relative:()=>ej,posix:()=>pj,parse:()=>oj,normalize:()=>ij,join:()=>cj,isAbsolute:()=>Mj,format:()=>sj,extname:()=>yj,dirname:()=>uj,delimiter:()=>hj,default:()=>p6,basename:()=>bj,_makeLong:()=>lj});function p(A){if(typeof A!=="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(A))}function Cj(A,j){var n="",f=0,q=-1,i=0,v;for(var E=0;E<=A.length;++E){if(E<A.length)v=A.charCodeAt(E);else if(v===47)break;else v=47;if(v===47){if(q===E-1||i===1);else if(q!==E-1&&i===2){if(n.length<2||f!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var r=n.lastIndexOf("/");if(r!==n.length-1){if(r===-1)n="",f=0;else n=n.slice(0,r),f=n.length-1-n.lastIndexOf("/");q=E,i=0;continue}}else if(n.length===2||n.length===1){n="",f=0,q=E,i=0;continue}}if(j){if(n.length>0)n+="/..";else n="..";f=2}}else{if(n.length>0)n+="/"+A.slice(q+1,E);else n=A.slice(q+1,E);f=E-q-1}q=E,i=0}else if(v===46&&i!==-1)++i;else i=-1}return n}function h6(A,j){var n=j.dir||j.root,f=j.base||(j.name||"")+(j.ext||"");if(!n)return f;if(n===j.root)return n+f;return n+A+f}function cA(){var A="",j=!1,n;for(var f=arguments.length-1;f>=-1&&!j;f--){var q;if(f>=0)q=arguments[f];else{if(n===void 0)n=process.cwd();q=n}if(p(q),q.length===0)continue;A=q+"/"+A,j=q.charCodeAt(0)===47}if(A=Cj(A,!j),j)if(A.length>0)return"/"+A;else return"/";else if(A.length>0)return A;else return"."}function ij(A){if(p(A),A.length===0)return".";var j=A.charCodeAt(0)===47,n=A.charCodeAt(A.length-1)===47;if(A=Cj(A,!j),A.length===0&&!j)A=".";if(A.length>0&&n)A+="/";if(j)return"/"+A;return A}function Mj(A){return p(A),A.length>0&&A.charCodeAt(0)===47}function cj(){if(arguments.length===0)return".";var A;for(var j=0;j<arguments.length;++j){var n=arguments[j];if(p(n),n.length>0)if(A===void 0)A=n;else A+="/"+n}if(A===void 0)return".";return ij(A)}function ej(A,j){if(p(A),p(j),A===j)return"";if(A=cA(A),j=cA(j),A===j)return"";var n=1;for(;n<A.length;++n)if(A.charCodeAt(n)!==47)break;var f=A.length,q=f-n,i=1;for(;i<j.length;++i)if(j.charCodeAt(i)!==47)break;var v=j.length,E=v-i,r=q<E?q:E,F=-1,I=0;for(;I<=r;++I){if(I===r){if(E>r){if(j.charCodeAt(i+I)===47)return j.slice(i+I+1);else if(I===0)return j.slice(i+I)}else if(q>r){if(A.charCodeAt(n+I)===47)F=I;else if(I===0)F=0}break}var K=A.charCodeAt(n+I),B=j.charCodeAt(i+I);if(K!==B)break;else if(K===47)F=I}var U="";for(I=n+F+1;I<=f;++I)if(I===f||A.charCodeAt(I)===47)if(U.length===0)U+="..";else U+="/..";if(U.length>0)return U+j.slice(i+F);else{if(i+=F,j.charCodeAt(i)===47)++i;return j.slice(i)}}function lj(A){return A}function uj(A){if(p(A),A.length===0)return".";var j=A.charCodeAt(0),n=j===47,f=-1,q=!0;for(var i=A.length-1;i>=1;--i)if(j=A.charCodeAt(i),j===47){if(!q){f=i;break}}else q=!1;if(f===-1)return n?"/":".";if(n&&f===1)return"//";return A.slice(0,f)}function bj(A,j){if(j!==void 0&&typeof j!=="string")throw new TypeError('"ext" argument must be a string');p(A);var n=0,f=-1,q=!0,i;if(j!==void 0&&j.length>0&&j.length<=A.length){if(j.length===A.length&&j===A)return"";var v=j.length-1,E=-1;for(i=A.length-1;i>=0;--i){var r=A.charCodeAt(i);if(r===47){if(!q){n=i+1;break}}else{if(E===-1)q=!1,E=i+1;if(v>=0)if(r===j.charCodeAt(v)){if(--v===-1)f=i}else v=-1,f=E}}if(n===f)f=E;else if(f===-1)f=A.length;return A.slice(n,f)}else{for(i=A.length-1;i>=0;--i)if(A.charCodeAt(i)===47){if(!q){n=i+1;break}}else if(f===-1)q=!1,f=i+1;if(f===-1)return"";return A.slice(n,f)}}function yj(A){p(A);var j=-1,n=0,f=-1,q=!0,i=0;for(var v=A.length-1;v>=0;--v){var E=A.charCodeAt(v);if(E===47){if(!q){n=v+1;break}continue}if(f===-1)q=!1,f=v+1;if(E===46){if(j===-1)j=v;else if(i!==1)i=1}else if(j!==-1)i=-1}if(j===-1||f===-1||i===0||i===1&&j===f-1&&j===n+1)return"";return A.slice(j,f)}function sj(A){if(A===null||typeof A!=="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof A);return h6("/",A)}function oj(A){p(A);var j={root:"",dir:"",base:"",ext:"",name:""};if(A.length===0)return j;var n=A.charCodeAt(0),f=n===47,q;if(f)j.root="/",q=1;else q=0;var i=-1,v=0,E=-1,r=!0,F=A.length-1,I=0;for(;F>=q;--F){if(n=A.charCodeAt(F),n===47){if(!r){v=F+1;break}continue}if(E===-1)r=!1,E=F+1;if(n===46){if(i===-1)i=F;else if(I!==1)I=1}else if(i!==-1)I=-1}if(i===-1||E===-1||I===0||I===1&&i===E-1&&i===v+1){if(E!==-1)if(v===0&&f)j.base=j.name=A.slice(1,E);else j.base=j.name=A.slice(v,E)}else{if(v===0&&f)j.name=A.slice(1,i),j.base=A.slice(1,E);else j.name=A.slice(v,i),j.base=A.slice(v,E);j.ext=A.slice(i,E)}if(v>0)j.dir=A.slice(0,v-1);else if(f)j.dir="/";return j}var dj="/",hj=":",pj,p6;var rj=X6(()=>{pj=((A)=>(A.posix=A,A))({resolve:cA,normalize:ij,isAbsolute:Mj,join:cj,relative:ej,_makeLong:lj,dirname:uj,basename:bj,extname:yj,format:sj,parse:oj,sep:dj,delimiter:hj,win32:null,posix:null}),p6=pj});var wj=pA((rf,RA)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",k=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},a6=k,TA={},vA;for(vA in k)if(k.hasOwnProperty(vA))TA[vA]=k[vA];var gA=[],j6="./this.program",Fj=function(A,j){throw j},bA=!1,$A=!1,Pj=!1,n6=!1;bA=typeof window==="object";$A=typeof importScripts==="function";Pj=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";n6=!bA&&!Pj&&!$A;var s="";function x6(A){if(k.locateFile)return k.locateFile(A,s);return s+A}var eA,Rj,mA,An,kj,$j;if(Pj){if($A)s=(rj(),gj(Ej)).dirname(s)+"/";else s=__dirname+"/";if(eA=function A(j,n){if(!kj)kj=(()=>({}));if(!$j)$j=(rj(),gj(Ej));return j=$j.normalize(j),kj.readFileSync(j,n?null:"utf8")},mA=function A(j){var n=eA(j,!0);if(!n.buffer)n=new Uint8Array(n);return aj(n.buffer),n},process.argv.length>1)j6=process.argv[1].replace(/\\/g,"/");if(gA=process.argv.slice(2),typeof RA!=="undefined")RA.exports=k;process.on("uncaughtException",function(A){if(!(A instanceof Zn))throw A}),process.on("unhandledRejection",WA),Fj=function(A){process.exit(A)},k.inspect=function(){return"[Emscripten Module object]"}}else if(n6){if(typeof read!="undefined")eA=function A(j){return read(j)};if(mA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),aj(typeof n==="object"),n},typeof scriptArgs!="undefined")gA=scriptArgs;else if(typeof arguments!="undefined")gA=arguments;if(typeof quit==="function")Fj=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(bA||$A){if($A)s=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)s=document.currentScript.src;if(s.indexOf("blob:")!==0)s=s.substr(0,s.lastIndexOf("/")+1);else s="";{if(eA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},$A)mA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};Rj=function(A,j,n){var f=new XMLHttpRequest;f.open("GET",A,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status==200||f.status==0&&f.response){j(f.response);return}n()},f.onerror=n,f.send(null)}}An=function(A){document.title=A}}var qf=k.print||console.log.bind(console),BA=k.printErr||console.warn.bind(console);for(vA in TA)if(TA.hasOwnProperty(vA))k[vA]=TA[vA];TA=null;if(k.arguments)gA=k.arguments;if(k.thisProgram)j6=k.thisProgram;if(k.quit)Fj=k.quit;var NA;if(k.wasmBinary)NA=k.wasmBinary;var vf=k.noExitRuntime||!0;if(typeof WebAssembly!=="object")WA("no native wasm support detected");var SA,f6=!1,jn;function aj(A,j){if(!A)WA("Assertion failed: "+j)}var nn=0,fn=1;function qn(A,j){var n;if(j==fn)n=w6(A.length);else n=_6(A.length);if(A.subarray||A.slice)FA.set(A,n);else FA.set(new Uint8Array(A),n);return n}var xj=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function vn(A,j,n){var f=j+n,q=j;while(A[q]&&!(q>=f))++q;if(q-j>16&&A.subarray&&xj)return xj.decode(A.subarray(j,q));else{var i="";while(j<q){var v=A[j++];if(!(v&128)){i+=String.fromCharCode(v);continue}var E=A[j++]&63;if((v&224)==192){i+=String.fromCharCode((v&31)<<6|E);continue}var r=A[j++]&63;if((v&240)==224)v=(v&15)<<12|E<<6|r;else v=(v&7)<<18|E<<12|r<<6|A[j++]&63;if(v<65536)i+=String.fromCharCode(v);else{var F=v-65536;i+=String.fromCharCode(55296|F>>10,56320|F&1023)}}}return i}function En(A,j){return A?vn(FA,A,j):""}function rn(A,j){if(A%j>0)A+=j-A%j;return A}var Gj,q6,FA,v6,i6,E6,r6,k6,$6;function I6(A){Gj=A,k.HEAP8=q6=new Int8Array(A),k.HEAP16=v6=new Int16Array(A),k.HEAP32=E6=new Int32Array(A),k.HEAPU8=FA=new Uint8Array(A),k.HEAPU16=i6=new Uint16Array(A),k.HEAPU32=r6=new Uint32Array(A),k.HEAPF32=k6=new Float32Array(A),k.HEAPF64=$6=new Float64Array(A)}var Ef=k.INITIAL_MEMORY||16777216,lA,F6=[],R6=[],P6=[],kn=!1;function $n(){if(k.preRun){if(typeof k.preRun=="function")k.preRun=[k.preRun];while(k.preRun.length)Rn(k.preRun.shift())}Kj(F6)}function In(){kn=!0,Kj(R6)}function Fn(){if(k.postRun){if(typeof k.postRun=="function")k.postRun=[k.postRun];while(k.postRun.length)Gn(k.postRun.shift())}Kj(P6)}function Rn(A){F6.unshift(A)}function Pn(A){R6.unshift(A)}function Gn(A){P6.unshift(A)}var IA=0,Ij=null,OA=null;function Kn(A){if(IA++,k.monitorRunDependencies)k.monitorRunDependencies(IA)}function _n(A){if(IA--,k.monitorRunDependencies)k.monitorRunDependencies(IA);if(IA==0){if(Ij!==null)clearInterval(Ij),Ij=null;if(OA){var j=OA;OA=null,j()}}}k.preloadedImages={};k.preloadedAudios={};function WA(A){if(k.onAbort)k.onAbort(A);A+="",BA(A),f6=!0,jn=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var wn="data:application/octet-stream;base64,";function G6(A){return A.startsWith(wn)}function K6(A){return A.startsWith("file://")}var u="argon2.wasm";if(!G6(u))u=x6(u);function A6(A){try{if(A==u&&NA)return new Uint8Array(NA);if(mA)return mA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){WA(j)}}function Un(){if(!NA&&(bA||$A)){if(typeof fetch==="function"&&!K6(u))return fetch(u,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+u+"'";return A.arrayBuffer()}).catch(function(){return A6(u)});else if(Rj)return new Promise(function(A,j){Rj(u,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return A6(u)})}function Hn(){var A={a:mn};function j(v,E){var r=v.exports;k.asm=r,SA=k.asm.c,I6(SA.buffer),lA=k.asm.k,Pn(k.asm.d),_n("wasm-instantiate")}Kn("wasm-instantiate");function n(v){j(v.instance)}function f(v){return Un().then(function(E){var r=WebAssembly.instantiate(E,A);return r}).then(v,function(E){BA("failed to asynchronously prepare wasm: "+E),WA(E)})}function q(){if(!NA&&typeof WebAssembly.instantiateStreaming==="function"&&!G6(u)&&!K6(u)&&typeof fetch==="function")return fetch(u,{credentials:"same-origin"}).then(function(v){var E=WebAssembly.instantiateStreaming(v,A);return E.then(n,function(r){return BA("wasm streaming compile failed: "+r),BA("falling back to ArrayBuffer instantiation"),f(n)})});else return f(n)}if(k.instantiateWasm)try{var i=k.instantiateWasm(A,j);return i}catch(v){return BA("Module.instantiateWasm callback failed with error: "+v),!1}return q(),{}}function Kj(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(k);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)lA.get(n)();else lA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function Bn(A,j,n){FA.copyWithin(A,j,j+n)}function Tn(A){try{return SA.grow(A-Gj.byteLength+65535>>>16),I6(SA.buffer),1}catch(j){}}function gn(A){var j=FA.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var f=1;f<=4;f*=2){var q=j*(1+0.2/f);q=Math.min(q,A+100663296);var i=Math.min(n,rn(Math.max(A,q),65536)),v=Tn(i);if(v)return!0}return!1}var mn={a:Bn,b:gn},On=Hn(),Nn=k.___wasm_call_ctors=function(){return(Nn=k.___wasm_call_ctors=k.asm.d).apply(null,arguments)},Sn=k._argon2_hash=function(){return(Sn=k._argon2_hash=k.asm.e).apply(null,arguments)},_6=k._malloc=function(){return(_6=k._malloc=k.asm.f).apply(null,arguments)},Wn=k._free=function(){return(Wn=k._free=k.asm.g).apply(null,arguments)},Jn=k._argon2_verify=function(){return(Jn=k._argon2_verify=k.asm.h).apply(null,arguments)},Vn=k._argon2_error_message=function(){return(Vn=k._argon2_error_message=k.asm.i).apply(null,arguments)},Yn=k._argon2_encodedlen=function(){return(Yn=k._argon2_encodedlen=k.asm.j).apply(null,arguments)},Qn=k._argon2_hash_ext=function(){return(Qn=k._argon2_hash_ext=k.asm.l).apply(null,arguments)},Xn=k._argon2_verify_ext=function(){return(Xn=k._argon2_verify_ext=k.asm.m).apply(null,arguments)},w6=k.stackAlloc=function(){return(w6=k.stackAlloc=k.asm.n).apply(null,arguments)};k.allocate=qn;k.UTF8ToString=En;k.ALLOC_NORMAL=nn;var uA;function Zn(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}OA=function A(){if(!uA)_j();if(!uA)OA=A};function _j(A){if(A=A||gA,IA>0)return;if($n(),IA>0)return;function j(){if(uA)return;if(uA=!0,k.calledRun=!0,f6)return;if(In(),k.onRuntimeInitialized)k.onRuntimeInitialized();Fn()}if(k.setStatus)k.setStatus("Running..."),setTimeout(function(){setTimeout(function(){k.setStatus("")},1),j()},1);else j()}k.run=_j;if(k.preInit){if(typeof k.preInit=="function")k.preInit=[k.preInit];while(k.preInit.length>0)k.preInit.pop()()}_j();if(typeof RA!=="undefined")RA.exports=k;k.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(k=a6=SA=lA=On=Gj=q6=FA=v6=i6=E6=r6=k6=$6=void 0,typeof RA!=="undefined")delete RA.exports}});var U6=pA((kf,Dn)=>{Dn.exports="./argon2.wasm"});var B6=pA((H6,yA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof yA==="object"&&yA.exports)yA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:H6,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n($){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let R;if(A.process&&A.process.versions&&A.process.versions.node)R=q().then((P)=>new Promise((_)=>{P.postRun=()=>_(P)}));else R=i().then((P)=>{let _=$?E($):void 0;return f(P,_)});return n._promise=R,R.then((P)=>{return n._module=P,delete n._promise,P})}function f($,R){return new Promise((P)=>{return A.Module={wasmBinary:$,wasmMemory:R,postRun(){P(Module)}},q()})}function q(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(wj())}function i(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(U6()).then((R)=>{return v(R)})}function v($){let R=atob($),P=new Uint8Array(new ArrayBuffer(R.length));for(let _=0;_<R.length;_++)P[_]=R.charCodeAt(_);return P}function E($){let z=Math.min(Math.max(Math.ceil($*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:z,maximum:32767})}function r($,R){return $.allocate(R,"i8",$.ALLOC_NORMAL)}function F($,R){let P=new Uint8Array([...R,0]);return r($,P)}function I($){if(typeof $!=="string")return $;if(typeof TextEncoder==="function")return new TextEncoder().encode($);else if(typeof Buffer==="function")return Buffer.from($);else throw new Error("Don't know how to encode UTF8")}function K($){let R=$.mem||1024;return n(R).then((P)=>{let _=$.time||1,H=$.parallelism||1,Q=I($.pass),z=F(P,Q),b=Q.length,L=I($.salt),C=F(P,L),N=L.length,O=$.type||j.Argon2d,g=P.allocate(new Array($.hashLen||24),"i8",P.ALLOC_NORMAL),m=$.secret?r(P,$.secret):0,S=$.secret?$.secret.byteLength:0,T=$.ad?r(P,$.ad):0,Z=$.ad?$.ad.byteLength:0,J=$.hashLen||24,X=P._argon2_encodedlen(_,R,H,N,J,O),Y=P.allocate(new Array(X+1),"i8",P.ALLOC_NORMAL),w=19,V,D;try{D=P._argon2_hash_ext(_,R,H,z,b,C,N,g,J,Y,X,O,m,S,T,Z,19)}catch(W){V=W}let t;if(D===0&&!V){let W="",y=new Uint8Array(J);for(let o=0;o<J;o++){let a=P.HEAP8[g+o];y[o]=a,W+=("0"+(255&a).toString(16)).slice(-2)}let qA=P.UTF8ToString(Y);t={hash:y,hashHex:W,encoded:qA}}else{try{if(!V)V=P.UTF8ToString(P._argon2_error_message(D))}catch(W){}t={message:V,code:D}}try{if(P._free(z),P._free(C),P._free(g),P._free(Y),T)P._free(T);if(m)P._free(m)}catch(W){}if(V)throw t;else return t})}function B($){return n().then((R)=>{let P=I($.pass),_=F(R,P),H=P.length,Q=$.secret?r(R,$.secret):0,z=$.secret?$.secret.byteLength:0,b=$.ad?r(R,$.ad):0,L=$.ad?$.ad.byteLength:0,C=I($.encoded),N=F(R,C),O=$.type;if(O===void 0){let T=$.encoded.split("$")[1];if(T)T=T.replace("a","A"),O=j[T]||j.Argon2d}let g,m;try{m=R._argon2_verify_ext(N,_,H,Q,z,b,L,O)}catch(T){g=T}let S;if(m||g){try{if(!g)g=R.UTF8ToString(R._argon2_error_message(m))}catch(T){}S={message:g,code:m}}try{R._free(_),R._free(N)}catch(T){}if(g)throw S;else return S})}function U(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:K,verify:B,unloadRuntime:U}})});class x extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class h extends x{}class HA extends x{}class xA extends x{}class ZA extends x{}class EA extends x{}class AA extends x{}class DA extends x{}class l extends x{}class e{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new ZA(`Scheme ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new ZA(`Unknown scheme: ${A}`);return j}static get current(){return this.get(0)}}class rA{p;static IV_LENGTH=12;IV_LENGTH=rA.IV_LENGTH;key;constructor(A){this.p=A}async setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(rA.IV_LENGTH)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A));A.fill(0);let f=new Uint8Array(j.length+n.length);return f.set(j),f.set(n,j.length),f}async decryptChunk(A){let j=A.slice(0,rA.IV_LENGTH),n=A.slice(rA.IV_LENGTH);try{let f=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(f)}catch{throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){}}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Oj(A){return A instanceof Uint8Array||ArrayBuffer.isView(A)&&A.constructor.name==="Uint8Array"}function zA(A){if(typeof A!=="boolean")throw new Error(`boolean expected, not ${A}`)}function tA(A){if(!Number.isSafeInteger(A)||A<0)throw new Error("positive integer expected, got "+A)}function c(A,...j){if(!Oj(A))throw new Error("Uint8Array expected");if(j.length>0&&!j.includes(A.length))throw new Error("Uint8Array expected of length "+j+", got length="+A.length)}function Aj(A,j=!0){if(A.destroyed)throw new Error("Hash instance has been destroyed");if(j&&A.finished)throw new Error("Hash#digest() has already been called")}function Nj(A,j){c(A);let n=j.outputLen;if(A.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function jA(A){return new Uint32Array(A.buffer,A.byteOffset,Math.floor(A.byteLength/4))}function nA(...A){for(let j=0;j<A.length;j++)A[j].fill(0)}function Z6(A){return new DataView(A.buffer,A.byteOffset,A.byteLength)}var D6=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function z6(A){if(typeof A!=="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(A))}function LA(A){if(typeof A==="string")A=z6(A);else if(Oj(A))A=CA(A);else throw new Error("Uint8Array expected, got "+typeof A);return A}function Sj(A,j){if(j==null||typeof j!=="object")throw new Error("options must be defined");return Object.assign(A,j)}function Wj(A,j){if(A.length!==j.length)return!1;let n=0;for(let f=0;f<A.length;f++)n|=A[f]^j[f];return n===0}var jj=(A,j)=>{function n(f,...q){if(c(f),!D6)throw new Error("Non little-endian hardware is not yet supported");if(A.nonceLength!==void 0){let I=q[0];if(!I)throw new Error("nonce / iv required");if(A.varSizeNonce)c(I);else c(I,A.nonceLength)}let i=A.tagLength;if(i&&q[1]!==void 0)c(q[1]);let v=j(f,...q),E=(I,K)=>{if(K!==void 0){if(I!==2)throw new Error("cipher output not supported");c(K)}},r=!1;return{encrypt(I,K){if(r)throw new Error("cannot encrypt() twice with same key + nonce");return r=!0,c(I),E(v.encrypt.length,K),v.encrypt(I,K)},decrypt(I,K){if(c(I),i&&I.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return E(v.decrypt.length,K),v.decrypt(I,K)}}}return Object.assign(n,A),n};function nj(A,j,n=!0){if(j===void 0)return new Uint8Array(A);if(j.length!==A)throw new Error("invalid output length, expected "+A+", got: "+j.length);if(n&&!t6(j))throw new Error("invalid output, must be aligned");return j}function mj(A,j,n,f){if(typeof A.setBigUint64==="function")return A.setBigUint64(j,n,f);let q=BigInt(32),i=BigInt(4294967295),v=Number(n>>q&i),E=Number(n&i),r=f?4:0,F=f?0:4;A.setUint32(j+r,v,f),A.setUint32(j+F,E,f)}function Jj(A,j,n){zA(n);let f=new Uint8Array(16),q=Z6(f);return mj(q,0,BigInt(j),n),mj(q,8,BigInt(A),n),f}function t6(A){return A.byteOffset%4===0}function CA(A){return Uint8Array.from(A)}var Yj=(A)=>Uint8Array.from(A.split("").map((j)=>j.charCodeAt(0))),L6=Yj("expand 16-byte k"),C6=Yj("expand 32-byte k"),M6=jA(L6),c6=jA(C6);function G(A,j){return A<<j|A>>>32-j}function fj(A){return A.byteOffset%4===0}var MA=64,e6=16,Qj=4294967295,Vj=new Uint32Array;function l6(A,j,n,f,q,i,v,E){let r=q.length,F=new Uint8Array(MA),I=jA(F),K=fj(q)&&fj(i),B=K?jA(q):Vj,U=K?jA(i):Vj;for(let $=0;$<r;v++){if(A(j,n,f,I,v,E),v>=Qj)throw new Error("arx: counter overflow");let R=Math.min(MA,r-$);if(K&&R===MA){let P=$/4;if($%4!==0)throw new Error("arx: invalid block position");for(let _=0,H;_<e6;_++)H=P+_,U[H]=B[H]^I[_];$+=MA;continue}for(let P=0,_;P<R;P++)_=$+P,i[_]=q[_]^F[P];$+=R}}function qj(A,j){let{allowShortKeys:n,extendNonceFn:f,counterLength:q,counterRight:i,rounds:v}=Sj({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},j);if(typeof A!=="function")throw new Error("core must be a function");return tA(q),tA(v),zA(i),zA(n),(E,r,F,I,K=0)=>{c(E),c(r),c(F);let B=F.length;if(I===void 0)I=new Uint8Array(B);if(c(I),tA(K),K<0||K>=Qj)throw new Error("arx: counter overflow");if(I.length<B)throw new Error(`arx: output (${I.length}) is shorter than data (${B})`);let U=[],$=E.length,R,P;if($===32)U.push(R=CA(E)),P=c6;else if($===16&&n)R=new Uint8Array(32),R.set(E),R.set(E,16),P=M6,U.push(R);else throw new Error(`arx: invalid 32-byte key, got length=${$}`);if(!fj(r))U.push(r=CA(r));let _=jA(R);if(f){if(r.length!==24)throw new Error("arx: extended nonce must be 24 bytes");f(P,_,jA(r.subarray(0,16)),_),r=r.subarray(16)}let H=16-q;if(H!==r.length)throw new Error(`arx: nonce must be ${H} or 16 bytes`);if(H!==12){let z=new Uint8Array(12);z.set(r,i?0:12-r.length),r=z,U.push(r)}let Q=jA(r);return l6(A,P,_,Q,F,I,K,v),nA(...U),I}}var M=(A,j)=>A[j++]&255|(A[j++]&255)<<8;class Xj{constructor(A){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,A=LA(A),c(A,32);let j=M(A,0),n=M(A,2),f=M(A,4),q=M(A,6),i=M(A,8),v=M(A,10),E=M(A,12),r=M(A,14);this.r[0]=j&8191,this.r[1]=(j>>>13|n<<3)&8191,this.r[2]=(n>>>10|f<<6)&7939,this.r[3]=(f>>>7|q<<9)&8191,this.r[4]=(q>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|v<<2)&8191,this.r[7]=(v>>>11|E<<5)&8065,this.r[8]=(E>>>8|r<<8)&8191,this.r[9]=r>>>5&127;for(let F=0;F<8;F++)this.pad[F]=M(A,16+2*F)}process(A,j,n=!1){let f=n?0:2048,{h:q,r:i}=this,v=i[0],E=i[1],r=i[2],F=i[3],I=i[4],K=i[5],B=i[6],U=i[7],$=i[8],R=i[9],P=M(A,j+0),_=M(A,j+2),H=M(A,j+4),Q=M(A,j+6),z=M(A,j+8),b=M(A,j+10),L=M(A,j+12),C=M(A,j+14),N=q[0]+(P&8191),O=q[1]+((P>>>13|_<<3)&8191),g=q[2]+((_>>>10|H<<6)&8191),m=q[3]+((H>>>7|Q<<9)&8191),S=q[4]+((Q>>>4|z<<12)&8191),T=q[5]+(z>>>1&8191),Z=q[6]+((z>>>14|b<<2)&8191),J=q[7]+((b>>>11|L<<5)&8191),X=q[8]+((L>>>8|C<<8)&8191),Y=q[9]+(C>>>5|f),w=0,V=w+N*v+O*(5*R)+g*(5*$)+m*(5*U)+S*(5*B);w=V>>>13,V&=8191,V+=T*(5*K)+Z*(5*I)+J*(5*F)+X*(5*r)+Y*(5*E),w+=V>>>13,V&=8191;let D=w+N*E+O*v+g*(5*R)+m*(5*$)+S*(5*U);w=D>>>13,D&=8191,D+=T*(5*B)+Z*(5*K)+J*(5*I)+X*(5*F)+Y*(5*r),w+=D>>>13,D&=8191;let t=w+N*r+O*E+g*v+m*(5*R)+S*(5*$);w=t>>>13,t&=8191,t+=T*(5*U)+Z*(5*B)+J*(5*K)+X*(5*I)+Y*(5*F),w+=t>>>13,t&=8191;let W=w+N*F+O*r+g*E+m*v+S*(5*R);w=W>>>13,W&=8191,W+=T*(5*$)+Z*(5*U)+J*(5*B)+X*(5*K)+Y*(5*I),w+=W>>>13,W&=8191;let y=w+N*I+O*F+g*r+m*E+S*v;w=y>>>13,y&=8191,y+=T*(5*R)+Z*(5*$)+J*(5*U)+X*(5*B)+Y*(5*K),w+=y>>>13,y&=8191;let qA=w+N*K+O*I+g*F+m*r+S*E;w=qA>>>13,qA&=8191,qA+=T*v+Z*(5*R)+J*(5*$)+X*(5*U)+Y*(5*B),w+=qA>>>13,qA&=8191;let o=w+N*B+O*K+g*I+m*F+S*r;w=o>>>13,o&=8191,o+=T*E+Z*v+J*(5*R)+X*(5*$)+Y*(5*U),w+=o>>>13,o&=8191;let a=w+N*U+O*B+g*K+m*I+S*F;w=a>>>13,a&=8191,a+=T*r+Z*E+J*v+X*(5*R)+Y*(5*$),w+=a>>>13,a&=8191;let GA=w+N*$+O*U+g*B+m*K+S*I;w=GA>>>13,GA&=8191,GA+=T*F+Z*r+J*E+X*v+Y*(5*R),w+=GA>>>13,GA&=8191;let KA=w+N*R+O*$+g*U+m*B+S*K;w=KA>>>13,KA&=8191,KA+=T*I+Z*F+J*r+X*E+Y*v,w+=KA>>>13,KA&=8191,w=(w<<2)+w|0,w=w+V|0,V=w&8191,w=w>>>13,D+=w,q[0]=V,q[1]=D,q[2]=t,q[3]=W,q[4]=y,q[5]=qA,q[6]=o,q[7]=a,q[8]=GA,q[9]=KA}finalize(){let{h:A,pad:j}=this,n=new Uint16Array(10),f=A[1]>>>13;A[1]&=8191;for(let v=2;v<10;v++)A[v]+=f,f=A[v]>>>13,A[v]&=8191;A[0]+=f*5,f=A[0]>>>13,A[0]&=8191,A[1]+=f,f=A[1]>>>13,A[1]&=8191,A[2]+=f,n[0]=A[0]+5,f=n[0]>>>13,n[0]&=8191;for(let v=1;v<10;v++)n[v]=A[v]+f,f=n[v]>>>13,n[v]&=8191;n[9]-=8192;let q=(f^1)-1;for(let v=0;v<10;v++)n[v]&=q;q=~q;for(let v=0;v<10;v++)A[v]=A[v]&q|n[v];A[0]=(A[0]|A[1]<<13)&65535,A[1]=(A[1]>>>3|A[2]<<10)&65535,A[2]=(A[2]>>>6|A[3]<<7)&65535,A[3]=(A[3]>>>9|A[4]<<4)&65535,A[4]=(A[4]>>>12|A[5]<<1|A[6]<<14)&65535,A[5]=(A[6]>>>2|A[7]<<11)&65535,A[6]=(A[7]>>>5|A[8]<<8)&65535,A[7]=(A[8]>>>8|A[9]<<5)&65535;let i=A[0]+j[0];A[0]=i&65535;for(let v=1;v<8;v++)i=(A[v]+j[v]|0)+(i>>>16)|0,A[v]=i&65535;nA(n)}update(A){Aj(this),A=LA(A),c(A);let{buffer:j,blockLen:n}=this,f=A.length;for(let q=0;q<f;){let i=Math.min(n-this.pos,f-q);if(i===n){for(;n<=f-q;q+=n)this.process(A,q);continue}if(j.set(A.subarray(q,q+i),this.pos),this.pos+=i,q+=i,this.pos===n)this.process(j,0,!1),this.pos=0}return this}destroy(){nA(this.h,this.r,this.buffer,this.pad)}digestInto(A){Aj(this),Nj(A,this),this.finished=!0;let{buffer:j,h:n}=this,{pos:f}=this;if(f){j[f++]=1;for(;f<16;f++)j[f]=0;this.process(j,0,!0)}this.finalize();let q=0;for(let i=0;i<8;i++)A[q++]=n[i]>>>0,A[q++]=n[i]>>>8;return A}digest(){let{buffer:A,outputLen:j}=this;this.digestInto(A);let n=A.slice(0,j);return this.destroy(),n}}function u6(A){let j=(f,q)=>A(q).update(LA(f)).digest(),n=A(new Uint8Array(32));return j.outputLen=n.outputLen,j.blockLen=n.blockLen,j.create=(f)=>A(f),j}var Zj=u6((A)=>new Xj(A));function tj(A,j,n,f,q,i=20){let v=A[0],E=A[1],r=A[2],F=A[3],I=j[0],K=j[1],B=j[2],U=j[3],$=j[4],R=j[5],P=j[6],_=j[7],H=q,Q=n[0],z=n[1],b=n[2],L=v,C=E,N=r,O=F,g=I,m=K,S=B,T=U,Z=$,J=R,X=P,Y=_,w=H,V=Q,D=z,t=b;for(let y=0;y<i;y+=2)L=L+g|0,w=G(w^L,16),Z=Z+w|0,g=G(g^Z,12),L=L+g|0,w=G(w^L,8),Z=Z+w|0,g=G(g^Z,7),C=C+m|0,V=G(V^C,16),J=J+V|0,m=G(m^J,12),C=C+m|0,V=G(V^C,8),J=J+V|0,m=G(m^J,7),N=N+S|0,D=G(D^N,16),X=X+D|0,S=G(S^X,12),N=N+S|0,D=G(D^N,8),X=X+D|0,S=G(S^X,7),O=O+T|0,t=G(t^O,16),Y=Y+t|0,T=G(T^Y,12),O=O+T|0,t=G(t^O,8),Y=Y+t|0,T=G(T^Y,7),L=L+m|0,t=G(t^L,16),X=X+t|0,m=G(m^X,12),L=L+m|0,t=G(t^L,8),X=X+t|0,m=G(m^X,7),C=C+S|0,w=G(w^C,16),Y=Y+w|0,S=G(S^Y,12),C=C+S|0,w=G(w^C,8),Y=Y+w|0,S=G(S^Y,7),N=N+T|0,V=G(V^N,16),Z=Z+V|0,T=G(T^Z,12),N=N+T|0,V=G(V^N,8),Z=Z+V|0,T=G(T^Z,7),O=O+g|0,D=G(D^O,16),J=J+D|0,g=G(g^J,12),O=O+g|0,D=G(D^O,8),J=J+D|0,g=G(g^J,7);let W=0;f[W++]=v+L|0,f[W++]=E+C|0,f[W++]=r+N|0,f[W++]=F+O|0,f[W++]=I+g|0,f[W++]=K+m|0,f[W++]=B+S|0,f[W++]=U+T|0,f[W++]=$+Z|0,f[W++]=R+J|0,f[W++]=P+X|0,f[W++]=_+Y|0,f[W++]=H+w|0,f[W++]=Q+V|0,f[W++]=z+D|0,f[W++]=b+t|0}function b6(A,j,n,f){let q=A[0],i=A[1],v=A[2],E=A[3],r=j[0],F=j[1],I=j[2],K=j[3],B=j[4],U=j[5],$=j[6],R=j[7],P=n[0],_=n[1],H=n[2],Q=n[3];for(let b=0;b<20;b+=2)q=q+r|0,P=G(P^q,16),B=B+P|0,r=G(r^B,12),q=q+r|0,P=G(P^q,8),B=B+P|0,r=G(r^B,7),i=i+F|0,_=G(_^i,16),U=U+_|0,F=G(F^U,12),i=i+F|0,_=G(_^i,8),U=U+_|0,F=G(F^U,7),v=v+I|0,H=G(H^v,16),$=$+H|0,I=G(I^$,12),v=v+I|0,H=G(H^v,8),$=$+H|0,I=G(I^$,7),E=E+K|0,Q=G(Q^E,16),R=R+Q|0,K=G(K^R,12),E=E+K|0,Q=G(Q^E,8),R=R+Q|0,K=G(K^R,7),q=q+F|0,Q=G(Q^q,16),$=$+Q|0,F=G(F^$,12),q=q+F|0,Q=G(Q^q,8),$=$+Q|0,F=G(F^$,7),i=i+I|0,P=G(P^i,16),R=R+P|0,I=G(I^R,12),i=i+I|0,P=G(P^i,8),R=R+P|0,I=G(I^R,7),v=v+K|0,_=G(_^v,16),B=B+_|0,K=G(K^B,12),v=v+K|0,_=G(_^v,8),B=B+_|0,K=G(K^B,7),E=E+r|0,H=G(H^E,16),U=U+H|0,r=G(r^U,12),E=E+r|0,H=G(H^E,8),U=U+H|0,r=G(r^U,7);let z=0;f[z++]=q,f[z++]=i,f[z++]=v,f[z++]=E,f[z++]=P,f[z++]=_,f[z++]=H,f[z++]=Q}var y6=qj(tj,{counterRight:!1,counterLength:4,allowShortKeys:!1}),s6=qj(tj,{counterRight:!1,counterLength:8,extendNonceFn:b6,allowShortKeys:!1});var o6=new Uint8Array(16),Dj=(A,j)=>{A.update(j);let n=j.length%16;if(n)A.update(o6.subarray(n))},d6=new Uint8Array(32);function zj(A,j,n,f,q){let i=A(j,n,d6),v=Zj.create(i);if(q)Dj(v,q);Dj(v,f);let E=Jj(f.length,q?q.length:0,!0);v.update(E);let r=v.digest();return nA(i,E),r}var Lj=(A)=>(j,n,f)=>{return{encrypt(i,v){let E=i.length;v=nj(E+16,v,!1),v.set(i);let r=v.subarray(0,-16);A(j,n,r,r,1);let F=zj(A,j,n,r,f);return v.set(F,E),nA(F),v},decrypt(i,v){v=nj(i.length-16,v,!1);let E=i.subarray(0,-16),r=i.subarray(-16),F=zj(A,j,n,E,f);if(!Wj(r,F))throw new Error("invalid tag");return v.set(i.subarray(0,-16)),A(j,n,v,v,1),nA(F),v}}},xn=jj({blockSize:64,nonceLength:12,tagLength:16},Lj(y6)),vj=jj({blockSize:64,nonceLength:24,tagLength:16},Lj(s6));class kA{p;static IV_LENGTH=24;IV_LENGTH=kA.IV_LENGTH;key;constructor(A){this.p=A}async setKey(A){this.key=new Uint8Array(await this.p.subtle.exportKey("raw",A))}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(kA.IV_LENGTH)),f=vj(this.key,j).encrypt(A);A.fill(0);let q=new Uint8Array(j.length+f.length);return q.set(j,0),q.set(f,j.length),q}async decryptChunk(A){let j=A.slice(0,kA.IV_LENGTH),n=A.slice(kA.IV_LENGTH),f=vj(this.key,j);try{return f.decrypt(n)}catch{throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){this.key.fill(0)}}var sA=hA(B6(),1);async function T6(A,j,n,f){if(f==="node"){let q=await import("argon2"),i=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),v=Buffer.from(j),E=await q.hash(i,{salt:v,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:q.argon2id});return v.fill(0),i.fill(0),{hash:new Uint8Array(E)}}if(f==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>fetch("argon2.wasm").then((q)=>{if(!q.ok)throw new Error("Failed to load argon2.wasm");return q.arrayBuffer()}).then((q)=>new Uint8Array(q));return sA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:sA.ArgonType.Argon2id}).then((q)=>{if(!q||!q.hash)throw new AA("Failed to produce key derivation");return{hash:q.hash}}).catch((q)=>{let i=q instanceof Error?q.message:typeof q==="string"?q:"Unknown error";throw new AA(`argon2-browser failure: ${i}`)})}throw new Error(`Unsupported environment: ${f}`)}class oA{presets;exportExtractable;name="argon2id";constructor(A,j=!1){this.presets=A;this.exportExtractable=j}async derive(A,j,n,f){let{hash:q}=await T6(A,j,this.presets[n],f.isNode?"node":"browser");if(this.exportExtractable)return f.subtle.importKey("raw",q,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);else return f.subtle.importKey("raw",q,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var g6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},zn={id:0,cipher:rA,kdf:new oA(g6),saltLengths:{low:12,high:16},difficulties:g6,defaultChunkSize:524288};e.register(zn);var m6={low:{time:5,mem:65536,parallelism:2},middle:{time:10,mem:98304,parallelism:4},high:{time:20,mem:98304,parallelism:4}},tn={id:1,cipher:kA,kdf:new oA(m6,!0),saltLengths:{low:12,high:16},difficulties:m6,defaultChunkSize:524288};e.register(tn);var dA=1;function O6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!1}function JA(...A){let j=A.reduce((q,i)=>q+i.byteLength,0),n=new Uint8Array(j),f=0;for(let q of A)n.set(q,f),f+=q.byteLength;return n}function VA(...A){try{let j=JA(...A);if(O6())return Buffer.from(j).toString("base64");let n="";for(let f=0;f<j.length;f++)n+=String.fromCharCode(j[f]);return btoa(n)}catch(j){throw new xA("Base64 Encoding Error")}}function YA(A){try{if(!/^[A-Za-z0-9+/]+={0,2}$/.test(A)||A.length%4!==0)throw new Error("Invalid Base64");if(O6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let f=0;f<j.length;f++)n[f]=j.charCodeAt(f);return n}catch(j){throw new HA(`Invalid Base64: length=${A.length}, content='${A.slice(0,12)}â€¦'`)}}function d(A){let j=A.value.length,n=new Array(j).fill("\x00").join("");A.value=n}function QA(A,j,n,f){let q={low:0,middle:1,high:2}[j]??0,i=A<<5|(n==="high"?1:0)<<2|q;return JA(new Uint8Array([dA,i]),f)}function PA(A){if(A[0]!==dA)throw new h("Invalid input format. The input is unknown.");if(A.length<14)throw new h("Invalid input format. Header too short.");try{let j=A[1],n=j>>5,f=j>>2&1?"high":"low",q=j&3,i=["low","middle","high"][q],v=e.get(n).saltLengths[f],E=A.slice(2,2+v);return{scheme:n,difficulty:i,saltStrength:f,salt:E,headerLen:2+v}}catch(j){throw new EA(j instanceof Error?j.message:String(j))}}class XA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){if(A.length>this.chunkSize*4)throw new RangeError(`Input block (${A.length} B) exceeds sane limit`);let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let f=0;while(n.length-f>=this.chunkSize){let q=n.slice(f,f+this.chunkSize);f+=this.chunkSize;let i=await this.engine.encryptChunk(q),v=new Uint8Array(4);new DataView(v.buffer).setUint32(0,i.length,!1);let E=new Uint8Array(4+i.length);E.set(v),E.set(i,v.length),j.enqueue(E)}this.buffer=n.slice(f)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let f=new Uint8Array(4+j.length);f.set(n),f.set(j,4),A.enqueue(f),this.buffer=new Uint8Array(0),this.engine.zeroKey()}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class _A{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let f=0;while(!0){if(n.length-f<4)break;let q=new DataView(n.buffer,n.byteOffset+f,4).getUint32(0,!1);if(q>this.chunkSize*2)throw new l(`Frame length ${q} exceeds maximum allowed ${this.chunkSize*2}`);if(n.length-f-4<q)break;f+=4;let i=n.slice(f,f+q);f+=q;try{let v=await this.engine.decryptChunk(i);j.enqueue(v)}catch(v){throw v instanceof l?v:new l("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(f)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0),this.engine.zeroKey()}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class wA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new XA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(q,i){if(j===0){i.enqueue(q);return}if(q.byteLength<=j){j-=q.byteLength;return}i.enqueue(q.slice(j)),j=0}}),f=new _A(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(f)}}async collect(A,j,n=null){let f=A.pipeThrough(j).getReader(),q=[];if(n?.length)q.push(n);try{while(!0){let{value:r,done:F}=await f.read();if(F)break;q.push(r)}await f.closed}finally{f.releaseLock()}let i=q.reduce((r,F)=>r+F.byteLength,0),v=new Uint8Array(i),E=0;for(let r of q)v.set(r,E),E+=r.byteLength;return v}}function N6(A=0,j=console.info){return{level:A,log(n,f){if(n<=A)j(`${n}| ${f}`)}}}var{promises:Cf}=(()=>({}));class Uj{src;#A=null;constructor(A){this.src=A}get length(){if(this.src instanceof Uint8Array)return this.src.byteLength;if(this.src instanceof Blob)return this.src.size;return this.ensureUint8().byteLength}async read(A,j){if(A<0||j<0||A+j>this.length)throw new RangeError("read() slice exceeds data bounds");if(this.src instanceof Uint8Array)return this.src.slice(A,A+j);if(this.src instanceof Blob){let n=await this.src.slice(A,A+j).arrayBuffer();return new Uint8Array(n)}return this.ensureUint8().slice(A,A+j)}ensureUint8(){if(!this.#A)this.#A=YA(this.src);return this.#A}}var S6=new WeakMap;class iA{static getEngine(A,j){let n=S6.get(A);if(!n)n=new Map,S6.set(A,n);let f=n.get(j);if(f)return f;let q=e.get(j);return f={desc:q,cipher:new q.cipher(A),kdf:q.kdf,chunkSize:q.defaultChunkSize,provider:A},n.set(j,f),f}static async deriveKey(A,j,n,f){try{let q=await A.kdf.derive(j.value,n,f,A.provider);d(j),await A.cipher.setKey(q)}catch(q){let i=q instanceof Error?q.message:String(q);throw new AA(i)}}}class fA{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=e.get(j.scheme??e.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=this.setChunkSize(j.chunkSize??this.v.defaultChunkSize),this.stream=new wA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=N6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await fA.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await fA.peekHeader(A),n=PA(j);return{scheme:n.scheme,difficulty:n.difficulty,salt:VA(n.salt),saltLength:n.salt.byteLength}}static async decodeData(A){let j=typeof A?.read==="function"?A:new Uj(A),n=await j.read(0,Math.min(256,j.length)),f=await fA.peekHeader(n),{scheme:q,headerLen:i}=PA(f),v=j.length,E=v-i;if(E<=0)throw new h("Payload is empty");let r=await j.read(i,4),F=new DataView(r.buffer,r.byteOffset,4).getUint32(0,!1);if(F+4<=E&&F>=28){let U=F,$=i,R=0,P=0;while($+4<=v){let _=await j.read($,4),H=new DataView(_.buffer,_.byteOffset,4).getUint32(0,!1);if(H===0||$+4+H>v)break;R++,P+=H,$+=4+H}return{isChunked:!0,chunks:{chunkSize:U,count:R,totalPayload:P}}}let K=await j.read(i,E),B=e.get(q).cipher.IV_LENGTH;if(K.length<B+16)throw new h("Ciphertext too short for IV & tag");return{isChunked:!1,payloadLength:E,params:{iv:K.slice(0,B),tag:K.slice(K.length-16)}}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setScheme(A){this.v=e.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new wA(this.cipher,this.chunkSize)}getScheme(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){let j=A,n;if(j==null)n=this.v.defaultChunkSize;else if(n=Number(j),!Number.isInteger(n)||n<1)throw new Error(`Invalid chunkSize: ${j}. Must be a positive integer.`);return this.chunkSize=n,this.stream=new wA(this.cipher,this.chunkSize),n}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){let n={value:j};try{this.log.log(1,`Start text encryption, scheme: ${this.getScheme()}`),this.log.log(2,"Deriving key for text encryption");let f=this.genSalt();await this.deriveKey(n,f),d(n),j=null,this.log.log(3,`Salt generated: ${VA(f)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let q=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.cipher.zeroKey(),this.log.log(3,"Encoding header");let i=QA(this.v.id,this.difficulty,this.saltStrength,f);this.log.log(3,"Encoding text");let v=VA(i,q);return this.log.log(1,"Decryption finished"),v}catch(f){throw new DA(f instanceof Error?f.message:String(f))}}async decryptText(A,j){let n={value:j};try{this.log.log(1,`Start text decryption, Version ${this.getScheme()}`),this.log.log(3,"Start text decoding");let f=YA(A);this.log.log(3,"Start header decoding"),await fA.peekHeader(A);let q=PA(f);this.log.log(3,"Trying to get engine");let i=iA.getEngine(this.provider,q.scheme);this.log.log(2,`Deriving key via engine for scheme: ${q.scheme}`),this.log.log(3,`Salt use: ${VA(q.salt)}, KDF difficulty: ${q.difficulty}`);try{await iA.deriveKey(i,n,q.salt,q.difficulty)}finally{d(n),j=null}this.log.log(2,"Decrypting text data");let v=await i.cipher.decryptChunk(f.slice(q.headerLen));i.cipher.zeroKey(),this.log.log(3,"Decoding text");let E=new TextDecoder().decode(v);return this.log.log(1,"Decryption finished"),E}catch(f){if(f instanceof l||f instanceof h||f instanceof EA||f instanceof HA||f instanceof AA)throw f;throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){let n={value:j};try{if(A.size===0){let v=this.genSalt();await this.deriveKey(n,v),d(n),j=null;let E=QA(this.v.id,this.difficulty,this.saltStrength,v);return new Blob([E],{type:"application/octet-stream"})}this.log.log(2,"Deriving key for file encryption");let f=this.genSalt();await this.deriveKey(n,f),d(n),j=null;let q=QA(this.v.id,this.difficulty,this.saltStrength,f),i=await this.stream.collect(A.stream(),new XA(this.cipher,this.chunkSize).toTransformStream(),q);return new Blob([i],{type:"application/octet-stream"})}catch(f){throw new DA(f instanceof Error?f.message:String(f))}}async decryptFile(A,j){let n={value:j};try{let f=await fA.peekHeader(A),q=PA(f),i=iA.getEngine(this.provider,q.scheme);try{await iA.deriveKey(i,n,q.salt,q.difficulty)}finally{d(n),j=null}if(A.size===q.headerLen)return new Blob([],{type:"application/octet-stream"});this.log.log(2,"Decrypting file data");let E=await new wA(i.cipher,i.chunkSize).collect(A.slice(q.headerLen).stream(),new _A(i.cipher,i.chunkSize).toTransformStream());return new Blob([E],{type:"application/octet-stream"})}catch(f){if(f instanceof l)throw f;throw new l(f instanceof Error?f.message:String(f))}}async createEncryptionStream(A){let j={value:A};this.log.log(2,"Deriving key for stream encryption");let n=this.genSalt();await this.deriveKey(j,n),d(j),A=null;let f=QA(this.v.id,this.difficulty,this.saltStrength,n),q=this.stream.encryptionStream();return{header:f,writable:q.writable,readable:q.readable}}async createDecryptionStream(A){let j={value:A},n=this,f=new Uint8Array(0),q=null;async function i(v,E){let r=v.getReader();while(!0){let{value:F,done:I}=await r.read();if(I)break;E.enqueue(F)}}return new TransformStream({async transform(v,E){if(!q){if(f=JA(f,v),f.length<2)return;let F=f.slice(0,30),{salt:I,difficulty:K}=PA(F),B=f[1]>>5,U=f[1]>>2&1?"high":"low",R=2+e.get(B).saltLengths[U];if(f.length<R)return;let P=iA.getEngine(n.provider,B);try{await iA.deriveKey(P,j,I,K)}finally{d(j),A=null}q=new _A(P.cipher,P.chunkSize).toTransformStream(),i(q.readable,E).catch((H)=>{E.error(H)});let _=f.slice(R);if(_.length){let H=q.writable.getWriter();await H.write(_),H.releaseLock()}return}let r=q.writable.getWriter();await r.write(v),r.releaseLock()},async flush(){if(q){let v=q.writable.getWriter();await v.close(),v.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let f=performance.now();try{let q=await this.kdf.derive(A.value,j,n,this.provider);d(A),await this.cipher.setKey(q),this.log.log(3,`Key derivation completed in ${(performance.now()-f).toFixed(1)} ms`)}catch(q){throw new AA(q instanceof Error?q.message:String(q))}}genSalt(A=this.saltStrength){let j=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(j))}static async peekHeader(A){let j=await this.readAsUint8(A);if(j instanceof Uint8Array){if(j.length<2)throw new h("Input too short");let{headerLen:n}=PA(j.length>=16?j:Uint8Array.from(j));if(j.length<n)throw new h("Incomplete header");return j.slice(0,n)}throw new EA("Unsupported input type")}static async readAsUint8(A){if(typeof A==="string")return YA(A);if(A instanceof Uint8Array)return A;if(A instanceof Blob)return new Uint8Array(await A.arrayBuffer());throw new EA("Unsupported input type")}}var W6={subtle:globalThis.crypto.subtle,getRandomValues(A){return globalThis.crypto.getRandomValues(A)},isNode:!1};function rq(A){return new fA(W6,A)}export{rq as createCryptit,fA as Cryptit};

//# debugId=06BF19007F81B5B564756E2164756E21
