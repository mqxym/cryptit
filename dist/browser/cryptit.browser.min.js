var z6=Object.create;var{getPrototypeOf:L6,defineProperty:BA,getOwnPropertyNames:Wj,getOwnPropertyDescriptor:D6}=Object,Jj=Object.prototype.hasOwnProperty;var NA=(A,j,n)=>{n=A!=null?z6(L6(A)):{};let q=j||!A||!A.__esModule?BA(n,"default",{value:A,enumerable:!0}):n;for(let f of Wj(A))if(!Jj.call(q,f))BA(q,f,{get:()=>A[f],enumerable:!0});return q},Tj=new WeakMap,Vj=(A)=>{var j=Tj.get(A),n;if(j)return j;if(j=BA({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")Wj(A).map((q)=>!Jj.call(j,q)&&BA(j,q,{get:()=>A[q],enumerable:!(n=D6(A,q))||n.enumerable}));return Tj.set(A,j),j},jj=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var C6=(A,j)=>{for(var n in j)BA(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(q)=>j[n]=()=>q})};var M6=(A,j)=>()=>(A&&(j=A(A=0)),j);var _A=((A)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(A,{get:(j,n)=>(typeof require!=="undefined"?require:j)[n]}):A)(function(A){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+A+'" is not supported')});var $j={};C6($j,{sep:()=>xj,resolve:()=>cA,relative:()=>cj,posix:()=>A6,parse:()=>hj,normalize:()=>kj,join:()=>yj,isAbsolute:()=>lj,format:()=>dj,extname:()=>oj,dirname:()=>ej,delimiter:()=>aj,default:()=>qn,basename:()=>pj,_makeLong:()=>sj});function h(A){if(typeof A!=="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(A))}function bj(A,j){var n="",q=0,f=-1,v=0,i;for(var E=0;E<=A.length;++E){if(E<A.length)i=A.charCodeAt(E);else if(i===47)break;else i=47;if(i===47){if(f===E-1||v===1);else if(f!==E-1&&v===2){if(n.length<2||q!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var k=n.lastIndexOf("/");if(k!==n.length-1){if(k===-1)n="",q=0;else n=n.slice(0,k),q=n.length-1-n.lastIndexOf("/");f=E,v=0;continue}}else if(n.length===2||n.length===1){n="",q=0,f=E,v=0;continue}}if(j){if(n.length>0)n+="/..";else n="..";q=2}}else{if(n.length>0)n+="/"+A.slice(f+1,E);else n=A.slice(f+1,E);q=E-f-1}f=E,v=0}else if(i===46&&v!==-1)++v;else v=-1}return n}function nn(A,j){var n=j.dir||j.root,q=j.base||(j.name||"")+(j.ext||"");if(!n)return q;if(n===j.root)return n+q;return n+A+q}function cA(){var A="",j=!1,n;for(var q=arguments.length-1;q>=-1&&!j;q--){var f;if(q>=0)f=arguments[q];else{if(n===void 0)n=process.cwd();f=n}if(h(f),f.length===0)continue;A=f+"/"+A,j=f.charCodeAt(0)===47}if(A=bj(A,!j),j)if(A.length>0)return"/"+A;else return"/";else if(A.length>0)return A;else return"."}function kj(A){if(h(A),A.length===0)return".";var j=A.charCodeAt(0)===47,n=A.charCodeAt(A.length-1)===47;if(A=bj(A,!j),A.length===0&&!j)A=".";if(A.length>0&&n)A+="/";if(j)return"/"+A;return A}function lj(A){return h(A),A.length>0&&A.charCodeAt(0)===47}function yj(){if(arguments.length===0)return".";var A;for(var j=0;j<arguments.length;++j){var n=arguments[j];if(h(n),n.length>0)if(A===void 0)A=n;else A+="/"+n}if(A===void 0)return".";return kj(A)}function cj(A,j){if(h(A),h(j),A===j)return"";if(A=cA(A),j=cA(j),A===j)return"";var n=1;for(;n<A.length;++n)if(A.charCodeAt(n)!==47)break;var q=A.length,f=q-n,v=1;for(;v<j.length;++v)if(j.charCodeAt(v)!==47)break;var i=j.length,E=i-v,k=f<E?f:E,U=-1,F=0;for(;F<=k;++F){if(F===k){if(E>k){if(j.charCodeAt(v+F)===47)return j.slice(v+F+1);else if(F===0)return j.slice(v+F)}else if(f>k){if(A.charCodeAt(n+F)===47)U=F;else if(F===0)U=0}break}var w=A.charCodeAt(n+F),B=j.charCodeAt(v+F);if(w!==B)break;else if(w===47)U=F}var O="";for(F=n+U+1;F<=q;++F)if(F===q||A.charCodeAt(F)===47)if(O.length===0)O+="..";else O+="/..";if(O.length>0)return O+j.slice(v+U);else{if(v+=U,j.charCodeAt(v)===47)++v;return j.slice(v)}}function sj(A){return A}function ej(A){if(h(A),A.length===0)return".";var j=A.charCodeAt(0),n=j===47,q=-1,f=!0;for(var v=A.length-1;v>=1;--v)if(j=A.charCodeAt(v),j===47){if(!f){q=v;break}}else f=!1;if(q===-1)return n?"/":".";if(n&&q===1)return"//";return A.slice(0,q)}function pj(A,j){if(j!==void 0&&typeof j!=="string")throw new TypeError('"ext" argument must be a string');h(A);var n=0,q=-1,f=!0,v;if(j!==void 0&&j.length>0&&j.length<=A.length){if(j.length===A.length&&j===A)return"";var i=j.length-1,E=-1;for(v=A.length-1;v>=0;--v){var k=A.charCodeAt(v);if(k===47){if(!f){n=v+1;break}}else{if(E===-1)f=!1,E=v+1;if(i>=0)if(k===j.charCodeAt(i)){if(--i===-1)q=v}else i=-1,q=E}}if(n===q)q=E;else if(q===-1)q=A.length;return A.slice(n,q)}else{for(v=A.length-1;v>=0;--v)if(A.charCodeAt(v)===47){if(!f){n=v+1;break}}else if(q===-1)f=!1,q=v+1;if(q===-1)return"";return A.slice(n,q)}}function oj(A){h(A);var j=-1,n=0,q=-1,f=!0,v=0;for(var i=A.length-1;i>=0;--i){var E=A.charCodeAt(i);if(E===47){if(!f){n=i+1;break}continue}if(q===-1)f=!1,q=i+1;if(E===46){if(j===-1)j=i;else if(v!==1)v=1}else if(j!==-1)v=-1}if(j===-1||q===-1||v===0||v===1&&j===q-1&&j===n+1)return"";return A.slice(j,q)}function dj(A){if(A===null||typeof A!=="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof A);return nn("/",A)}function hj(A){h(A);var j={root:"",dir:"",base:"",ext:"",name:""};if(A.length===0)return j;var n=A.charCodeAt(0),q=n===47,f;if(q)j.root="/",f=1;else f=0;var v=-1,i=0,E=-1,k=!0,U=A.length-1,F=0;for(;U>=f;--U){if(n=A.charCodeAt(U),n===47){if(!k){i=U+1;break}continue}if(E===-1)k=!1,E=U+1;if(n===46){if(v===-1)v=U;else if(F!==1)F=1}else if(v!==-1)F=-1}if(v===-1||E===-1||F===0||F===1&&v===E-1&&v===i+1){if(E!==-1)if(i===0&&q)j.base=j.name=A.slice(1,E);else j.base=j.name=A.slice(i,E)}else{if(i===0&&q)j.name=A.slice(1,v),j.base=A.slice(1,E);else j.name=A.slice(i,v),j.base=A.slice(i,E);j.ext=A.slice(v,E)}if(i>0)j.dir=A.slice(0,i-1);else if(q)j.dir="/";return j}var xj="/",aj=":",A6,qn;var Ij=M6(()=>{A6=((A)=>(A.posix=A,A))({resolve:cA,normalize:kj,isAbsolute:lj,join:yj,relative:cj,_makeLong:sj,dirname:ej,basename:pj,extname:oj,format:dj,parse:hj,sep:xj,delimiter:aj,win32:null,posix:null}),qn=A6});var Bj=jj((Gq,rA)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",$=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},fn=$,VA={},$A;for($A in $)if($.hasOwnProperty($A))VA[$A]=$[$A];var mA=[],f6="./this.program",Gj=function(A,j){throw j},oA=!1,UA=!1,wj=!1,v6=!1;oA=typeof window==="object";UA=typeof importScripts==="function";wj=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";v6=!oA&&!wj&&!UA;var o="";function vn(A){if($.locateFile)return $.locateFile(A,o);return o+A}var sA,rj,gA,En,Fj,Uj;if(wj){if(UA)o=(Ij(),Vj($j)).dirname(o)+"/";else o=__dirname+"/";if(sA=function A(j,n){if(!Fj)Fj=(()=>({}));if(!Uj)Uj=(Ij(),Vj($j));return j=Uj.normalize(j),Fj.readFileSync(j,n?null:"utf8")},gA=function A(j){var n=sA(j,!0);if(!n.buffer)n=new Uint8Array(n);return j6(n.buffer),n},process.argv.length>1)f6=process.argv[1].replace(/\\/g,"/");if(mA=process.argv.slice(2),typeof rA!=="undefined")rA.exports=$;process.on("uncaughtException",function(A){if(!(A instanceof tn))throw A}),process.on("unhandledRejection",YA),Gj=function(A){process.exit(A)},$.inspect=function(){return"[Emscripten Module object]"}}else if(v6){if(typeof read!="undefined")sA=function A(j){return read(j)};if(gA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),j6(typeof n==="object"),n},typeof scriptArgs!="undefined")mA=scriptArgs;else if(typeof arguments!="undefined")mA=arguments;if(typeof quit==="function")Gj=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(oA||UA){if(UA)o=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)o=document.currentScript.src;if(o.indexOf("blob:")!==0)o=o.substr(0,o.lastIndexOf("/")+1);else o="";{if(sA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},UA)gA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};rj=function(A,j,n){var q=new XMLHttpRequest;q.open("GET",A,!0),q.responseType="arraybuffer",q.onload=function(){if(q.status==200||q.status==0&&q.response){j(q.response);return}n()},q.onerror=n,q.send(null)}}En=function(A){document.title=A}}var Fq=$.print||console.log.bind(console),JA=$.printErr||console.warn.bind(console);for($A in VA)if(VA.hasOwnProperty($A))$[$A]=VA[$A];VA=null;if($.arguments)mA=$.arguments;if($.thisProgram)f6=$.thisProgram;if($.quit)Gj=$.quit;var QA;if($.wasmBinary)QA=$.wasmBinary;var Uq=$.noExitRuntime||!0;if(typeof WebAssembly!=="object")YA("no native wasm support detected");var ZA,i6=!1,kn;function j6(A,j){if(!A)YA("Assertion failed: "+j)}var $n=0,In=1;function Fn(A,j){var n;if(j==In)n=N6(A.length);else n=B6(A.length);if(A.subarray||A.slice)GA.set(A,n);else GA.set(new Uint8Array(A),n);return n}var n6=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function Un(A,j,n){var q=j+n,f=j;while(A[f]&&!(f>=q))++f;if(f-j>16&&A.subarray&&n6)return n6.decode(A.subarray(j,f));else{var v="";while(j<f){var i=A[j++];if(!(i&128)){v+=String.fromCharCode(i);continue}var E=A[j++]&63;if((i&224)==192){v+=String.fromCharCode((i&31)<<6|E);continue}var k=A[j++]&63;if((i&240)==224)i=(i&15)<<12|E<<6|k;else i=(i&7)<<18|E<<12|k<<6|A[j++]&63;if(i<65536)v+=String.fromCharCode(i);else{var U=i-65536;v+=String.fromCharCode(55296|U>>10,56320|U&1023)}}}return v}function Kn(A,j){return A?Un(GA,A,j):""}function Gn(A,j){if(A%j>0)A+=j-A%j;return A}var Pj,E6,GA,k6,$6,I6,F6,U6,K6;function G6(A){Pj=A,$.HEAP8=E6=new Int8Array(A),$.HEAP16=k6=new Int16Array(A),$.HEAP32=I6=new Int32Array(A),$.HEAPU8=GA=new Uint8Array(A),$.HEAPU16=$6=new Uint16Array(A),$.HEAPU32=F6=new Uint32Array(A),$.HEAPF32=U6=new Float32Array(A),$.HEAPF64=K6=new Float64Array(A)}var Kq=$.INITIAL_MEMORY||16777216,eA,r6=[],w6=[],P6=[],rn=!1;function wn(){if($.preRun){if(typeof $.preRun=="function")$.preRun=[$.preRun];while($.preRun.length)On($.preRun.shift())}Rj(r6)}function Pn(){rn=!0,Rj(w6)}function Rn(){if($.postRun){if(typeof $.postRun=="function")$.postRun=[$.postRun];while($.postRun.length)Nn($.postRun.shift())}Rj(P6)}function On(A){r6.unshift(A)}function Bn(A){w6.unshift(A)}function Nn(A){P6.unshift(A)}var KA=0,Kj=null,HA=null;function _n(A){if(KA++,$.monitorRunDependencies)$.monitorRunDependencies(KA)}function Tn(A){if(KA--,$.monitorRunDependencies)$.monitorRunDependencies(KA);if(KA==0){if(Kj!==null)clearInterval(Kj),Kj=null;if(HA){var j=HA;HA=null,j()}}}$.preloadedImages={};$.preloadedAudios={};function YA(A){if($.onAbort)$.onAbort(A);A+="",JA(A),i6=!0,kn=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var Wn="data:application/octet-stream;base64,";function R6(A){return A.startsWith(Wn)}function O6(A){return A.startsWith("file://")}var s="argon2.wasm";if(!R6(s))s=vn(s);function q6(A){try{if(A==s&&QA)return new Uint8Array(QA);if(gA)return gA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){YA(j)}}function Jn(){if(!QA&&(oA||UA)){if(typeof fetch==="function"&&!O6(s))return fetch(s,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+s+"'";return A.arrayBuffer()}).catch(function(){return q6(s)});else if(rj)return new Promise(function(A,j){rj(s,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return q6(s)})}function Vn(){var A={a:Qn};function j(i,E){var k=i.exports;$.asm=k,ZA=$.asm.c,G6(ZA.buffer),eA=$.asm.k,Bn($.asm.d),Tn("wasm-instantiate")}_n("wasm-instantiate");function n(i){j(i.instance)}function q(i){return Jn().then(function(E){var k=WebAssembly.instantiate(E,A);return k}).then(i,function(E){JA("failed to asynchronously prepare wasm: "+E),YA(E)})}function f(){if(!QA&&typeof WebAssembly.instantiateStreaming==="function"&&!R6(s)&&!O6(s)&&typeof fetch==="function")return fetch(s,{credentials:"same-origin"}).then(function(i){var E=WebAssembly.instantiateStreaming(i,A);return E.then(n,function(k){return JA("wasm streaming compile failed: "+k),JA("falling back to ArrayBuffer instantiation"),q(n)})});else return q(n)}if($.instantiateWasm)try{var v=$.instantiateWasm(A,j);return v}catch(i){return JA("Module.instantiateWasm callback failed with error: "+i),!1}return f(),{}}function Rj(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j($);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)eA.get(n)();else eA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function mn(A,j,n){GA.copyWithin(A,j,j+n)}function gn(A){try{return ZA.grow(A-Pj.byteLength+65535>>>16),G6(ZA.buffer),1}catch(j){}}function Hn(A){var j=GA.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var q=1;q<=4;q*=2){var f=j*(1+0.2/q);f=Math.min(f,A+100663296);var v=Math.min(n,Gn(Math.max(A,f),65536)),i=gn(v);if(i)return!0}return!1}var Qn={a:mn,b:Hn},Zn=Vn(),Yn=$.___wasm_call_ctors=function(){return(Yn=$.___wasm_call_ctors=$.asm.d).apply(null,arguments)},Sn=$._argon2_hash=function(){return(Sn=$._argon2_hash=$.asm.e).apply(null,arguments)},B6=$._malloc=function(){return(B6=$._malloc=$.asm.f).apply(null,arguments)},Xn=$._free=function(){return(Xn=$._free=$.asm.g).apply(null,arguments)},zn=$._argon2_verify=function(){return(zn=$._argon2_verify=$.asm.h).apply(null,arguments)},Ln=$._argon2_error_message=function(){return(Ln=$._argon2_error_message=$.asm.i).apply(null,arguments)},Dn=$._argon2_encodedlen=function(){return(Dn=$._argon2_encodedlen=$.asm.j).apply(null,arguments)},Cn=$._argon2_hash_ext=function(){return(Cn=$._argon2_hash_ext=$.asm.l).apply(null,arguments)},Mn=$._argon2_verify_ext=function(){return(Mn=$._argon2_verify_ext=$.asm.m).apply(null,arguments)},N6=$.stackAlloc=function(){return(N6=$.stackAlloc=$.asm.n).apply(null,arguments)};$.allocate=Fn;$.UTF8ToString=Kn;$.ALLOC_NORMAL=$n;var pA;function tn(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}HA=function A(){if(!pA)Oj();if(!pA)HA=A};function Oj(A){if(A=A||mA,KA>0)return;if(wn(),KA>0)return;function j(){if(pA)return;if(pA=!0,$.calledRun=!0,i6)return;if(Pn(),$.onRuntimeInitialized)$.onRuntimeInitialized();Rn()}if($.setStatus)$.setStatus("Running..."),setTimeout(function(){setTimeout(function(){$.setStatus("")},1),j()},1);else j()}$.run=Oj;if($.preInit){if(typeof $.preInit=="function")$.preInit=[$.preInit];while($.preInit.length>0)$.preInit.pop()()}Oj();if(typeof rA!=="undefined")rA.exports=$;$.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if($=fn=ZA=eA=Zn=Pj=E6=GA=k6=$6=I6=F6=U6=K6=void 0,typeof rA!=="undefined")delete rA.exports}});var _6=jj((rq,un)=>{un.exports="./argon2.wasm"});var W6=jj((T6,dA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof dA==="object"&&dA.exports)dA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:T6,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(I){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let K;if(A.process&&A.process.versions&&A.process.versions.node)K=f().then((G)=>new Promise((P)=>{G.postRun=()=>P(G)}));else K=v().then((G)=>{let P=I?E(I):void 0;return q(G,P)});return n._promise=K,K.then((G)=>{return n._module=G,delete n._promise,G})}function q(I,K){return new Promise((G)=>{return A.Module={wasmBinary:I,wasmMemory:K,postRun(){G(Module)}},f()})}function f(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(Bj())}function v(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(_6()).then((K)=>{return i(K)})}function i(I){let K=atob(I),G=new Uint8Array(new ArrayBuffer(K.length));for(let P=0;P<K.length;P++)G[P]=K.charCodeAt(P);return G}function E(I){let X=Math.min(Math.max(Math.ceil(I*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:X,maximum:32767})}function k(I,K){return I.allocate(K,"i8",I.ALLOC_NORMAL)}function U(I,K){let G=new Uint8Array([...K,0]);return k(I,G)}function F(I){if(typeof I!=="string")return I;if(typeof TextEncoder==="function")return new TextEncoder().encode(I);else if(typeof Buffer==="function")return Buffer.from(I);else throw new Error("Don't know how to encode UTF8")}function w(I){let K=I.mem||1024;return n(K).then((G)=>{let P=I.time||1,_=I.parallelism||1,N=F(I.pass),X=U(G,N),e=N.length,C=F(I.salt),M=U(G,C),m=C.length,V=I.type||j.Argon2d,W=G.allocate(new Array(I.hashLen||24),"i8",G.ALLOC_NORMAL),J=I.secret?k(G,I.secret):0,g=I.secret?I.secret.byteLength:0,T=I.ad?k(G,I.ad):0,z=I.ad?I.ad.byteLength:0,Q=I.hashLen||24,S=G._argon2_encodedlen(P,K,_,m,Q,V),Y=G.allocate(new Array(S+1),"i8",G.ALLOC_NORMAL),R=19,Z,L;try{L=G._argon2_hash_ext(P,K,_,X,e,M,m,W,Q,Y,S,V,J,g,T,z,19)}catch(H){Z=H}let D;if(L===0&&!Z){let H="",p=new Uint8Array(Q);for(let d=0;d<Q;d++){let a=G.HEAP8[W+d];p[d]=a,H+=("0"+(255&a).toString(16)).slice(-2)}let iA=G.UTF8ToString(Y);D={hash:p,hashHex:H,encoded:iA}}else{try{if(!Z)Z=G.UTF8ToString(G._argon2_error_message(L))}catch(H){}D={message:Z,code:L}}try{if(G._free(X),G._free(M),G._free(W),G._free(Y),T)G._free(T);if(J)G._free(J)}catch(H){}if(Z)throw D;else return D})}function B(I){return n().then((K)=>{let G=F(I.pass),P=U(K,G),_=G.length,N=I.secret?k(K,I.secret):0,X=I.secret?I.secret.byteLength:0,e=I.ad?k(K,I.ad):0,C=I.ad?I.ad.byteLength:0,M=F(I.encoded),m=U(K,M),V=I.type;if(V===void 0){let T=I.encoded.split("$")[1];if(T)T=T.replace("a","A"),V=j[T]||j.Argon2d}let W,J;try{J=K._argon2_verify_ext(m,P,_,N,X,e,C,V)}catch(T){W=T}let g;if(J||W){try{if(!W)W=K.UTF8ToString(K._argon2_error_message(J))}catch(T){}g={message:W,code:J}}try{K._free(P),K._free(m)}catch(T){}if(W)throw g;else return g})}function O(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:w,verify:B,unloadRuntime:O}})});class AA extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class c extends AA{}class TA extends AA{}class nj extends AA{}class CA extends AA{}class EA extends AA{}class jA extends AA{}class MA extends AA{}class l extends AA{}class u{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new CA(`Scheme ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new CA(`Unknown scheme: ${A}`);return j}static get current(){return this.get(0)}}class kA{p;static IV_LENGTH=12;static TAG_LENGTH=16;IV_LENGTH=kA.IV_LENGTH;TAG_LENGTH=kA.TAG_LENGTH;key;aad=new Uint8Array(0);constructor(A){this.p=A}async setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(kA.IV_LENGTH)),n=this.aad.length?{name:"AES-GCM",iv:j,additionalData:this.aad}:{name:"AES-GCM",iv:j},q=await this.p.subtle.encrypt(n,this.requireKey(),A),f=new Uint8Array(q);A.fill(0);let v=new Uint8Array(j.length+f.length);return v.set(j,0),v.set(f,j.length),v}async decryptChunk(A){let j=A.slice(0,kA.IV_LENGTH),n=A.slice(kA.IV_LENGTH),q=this.aad.length?{name:"AES-GCM",iv:j,additionalData:this.aad}:{name:"AES-GCM",iv:j};try{let f=await this.p.subtle.decrypt(q,this.requireKey(),n);return new Uint8Array(f)}catch{throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){this.key=null}setAAD(A){this.aad=A&&A.byteLength?new Uint8Array(A):new Uint8Array(0)}requireKey(){if(!this.key)throw new Error("Encryption key not set");return this.key}}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function gj(A){return A instanceof Uint8Array||ArrayBuffer.isView(A)&&A.constructor.name==="Uint8Array"}function tA(A){if(typeof A!=="boolean")throw new Error(`boolean expected, not ${A}`)}function uA(A){if(!Number.isSafeInteger(A)||A<0)throw new Error("positive integer expected, got "+A)}function b(A,...j){if(!gj(A))throw new Error("Uint8Array expected");if(j.length>0&&!j.includes(A.length))throw new Error("Uint8Array expected of length "+j+", got length="+A.length)}function qj(A,j=!0){if(A.destroyed)throw new Error("Hash instance has been destroyed");if(j&&A.finished)throw new Error("Hash#digest() has already been called")}function Hj(A,j){b(A);let n=j.outputLen;if(A.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function nA(A){return new Uint32Array(A.buffer,A.byteOffset,Math.floor(A.byteLength/4))}function qA(...A){for(let j=0;j<A.length;j++)A[j].fill(0)}function t6(A){return new DataView(A.buffer,A.byteOffset,A.byteLength)}var u6=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function b6(A){if(typeof A!=="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(A))}function bA(A){if(typeof A==="string")A=b6(A);else if(gj(A))A=lA(A);else throw new Error("Uint8Array expected, got "+typeof A);return A}function Qj(A,j){if(j==null||typeof j!=="object")throw new Error("options must be defined");return Object.assign(A,j)}function Zj(A,j){if(A.length!==j.length)return!1;let n=0;for(let q=0;q<A.length;q++)n|=A[q]^j[q];return n===0}var fj=(A,j)=>{function n(q,...f){if(b(q),!u6)throw new Error("Non little-endian hardware is not yet supported");if(A.nonceLength!==void 0){let F=f[0];if(!F)throw new Error("nonce / iv required");if(A.varSizeNonce)b(F);else b(F,A.nonceLength)}let v=A.tagLength;if(v&&f[1]!==void 0)b(f[1]);let i=j(q,...f),E=(F,w)=>{if(w!==void 0){if(F!==2)throw new Error("cipher output not supported");b(w)}},k=!1;return{encrypt(F,w){if(k)throw new Error("cannot encrypt() twice with same key + nonce");return k=!0,b(F),E(i.encrypt.length,w),i.encrypt(F,w)},decrypt(F,w){if(b(F),v&&F.length<v)throw new Error("invalid ciphertext length: smaller than tagLength="+v);return E(i.decrypt.length,w),i.decrypt(F,w)}}}return Object.assign(n,A),n};function vj(A,j,n=!0){if(j===void 0)return new Uint8Array(A);if(j.length!==A)throw new Error("invalid output length, expected "+A+", got: "+j.length);if(n&&!l6(j))throw new Error("invalid output, must be aligned");return j}function mj(A,j,n,q){if(typeof A.setBigUint64==="function")return A.setBigUint64(j,n,q);let f=BigInt(32),v=BigInt(4294967295),i=Number(n>>f&v),E=Number(n&v),k=q?4:0,U=q?0:4;A.setUint32(j+k,i,q),A.setUint32(j+U,E,q)}function Yj(A,j,n){tA(n);let q=new Uint8Array(16),f=t6(q);return mj(f,0,BigInt(j),n),mj(f,8,BigInt(A),n),q}function l6(A){return A.byteOffset%4===0}function lA(A){return Uint8Array.from(A)}var Xj=(A)=>Uint8Array.from(A.split("").map((j)=>j.charCodeAt(0))),y6=Xj("expand 16-byte k"),c6=Xj("expand 32-byte k"),s6=nA(y6),e6=nA(c6);function r(A,j){return A<<j|A>>>32-j}function ij(A){return A.byteOffset%4===0}var yA=64,p6=16,zj=4294967295,Sj=new Uint32Array;function o6(A,j,n,q,f,v,i,E){let k=f.length,U=new Uint8Array(yA),F=nA(U),w=ij(f)&&ij(v),B=w?nA(f):Sj,O=w?nA(v):Sj;for(let I=0;I<k;i++){if(A(j,n,q,F,i,E),i>=zj)throw new Error("arx: counter overflow");let K=Math.min(yA,k-I);if(w&&K===yA){let G=I/4;if(I%4!==0)throw new Error("arx: invalid block position");for(let P=0,_;P<p6;P++)_=G+P,O[_]=B[_]^F[P];I+=yA;continue}for(let G=0,P;G<K;G++)P=I+G,v[P]=f[P]^U[G];I+=K}}function Ej(A,j){let{allowShortKeys:n,extendNonceFn:q,counterLength:f,counterRight:v,rounds:i}=Qj({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},j);if(typeof A!=="function")throw new Error("core must be a function");return uA(f),uA(i),tA(v),tA(n),(E,k,U,F,w=0)=>{b(E),b(k),b(U);let B=U.length;if(F===void 0)F=new Uint8Array(B);if(b(F),uA(w),w<0||w>=zj)throw new Error("arx: counter overflow");if(F.length<B)throw new Error(`arx: output (${F.length}) is shorter than data (${B})`);let O=[],I=E.length,K,G;if(I===32)O.push(K=lA(E)),G=e6;else if(I===16&&n)K=new Uint8Array(32),K.set(E),K.set(E,16),G=s6,O.push(K);else throw new Error(`arx: invalid 32-byte key, got length=${I}`);if(!ij(k))O.push(k=lA(k));let P=nA(K);if(q){if(k.length!==24)throw new Error("arx: extended nonce must be 24 bytes");q(G,P,nA(k.subarray(0,16)),P),k=k.subarray(16)}let _=16-f;if(_!==k.length)throw new Error(`arx: nonce must be ${_} or 16 bytes`);if(_!==12){let X=new Uint8Array(12);X.set(k,v?0:12-k.length),k=X,O.push(k)}let N=nA(k);return o6(A,G,P,N,U,F,w,i),qA(...O),F}}var t=(A,j)=>A[j++]&255|(A[j++]&255)<<8;class Lj{constructor(A){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,A=bA(A),b(A,32);let j=t(A,0),n=t(A,2),q=t(A,4),f=t(A,6),v=t(A,8),i=t(A,10),E=t(A,12),k=t(A,14);this.r[0]=j&8191,this.r[1]=(j>>>13|n<<3)&8191,this.r[2]=(n>>>10|q<<6)&7939,this.r[3]=(q>>>7|f<<9)&8191,this.r[4]=(f>>>4|v<<12)&255,this.r[5]=v>>>1&8190,this.r[6]=(v>>>14|i<<2)&8191,this.r[7]=(i>>>11|E<<5)&8065,this.r[8]=(E>>>8|k<<8)&8191,this.r[9]=k>>>5&127;for(let U=0;U<8;U++)this.pad[U]=t(A,16+2*U)}process(A,j,n=!1){let q=n?0:2048,{h:f,r:v}=this,i=v[0],E=v[1],k=v[2],U=v[3],F=v[4],w=v[5],B=v[6],O=v[7],I=v[8],K=v[9],G=t(A,j+0),P=t(A,j+2),_=t(A,j+4),N=t(A,j+6),X=t(A,j+8),e=t(A,j+10),C=t(A,j+12),M=t(A,j+14),m=f[0]+(G&8191),V=f[1]+((G>>>13|P<<3)&8191),W=f[2]+((P>>>10|_<<6)&8191),J=f[3]+((_>>>7|N<<9)&8191),g=f[4]+((N>>>4|X<<12)&8191),T=f[5]+(X>>>1&8191),z=f[6]+((X>>>14|e<<2)&8191),Q=f[7]+((e>>>11|C<<5)&8191),S=f[8]+((C>>>8|M<<8)&8191),Y=f[9]+(M>>>5|q),R=0,Z=R+m*i+V*(5*K)+W*(5*I)+J*(5*O)+g*(5*B);R=Z>>>13,Z&=8191,Z+=T*(5*w)+z*(5*F)+Q*(5*U)+S*(5*k)+Y*(5*E),R+=Z>>>13,Z&=8191;let L=R+m*E+V*i+W*(5*K)+J*(5*I)+g*(5*O);R=L>>>13,L&=8191,L+=T*(5*B)+z*(5*w)+Q*(5*F)+S*(5*U)+Y*(5*k),R+=L>>>13,L&=8191;let D=R+m*k+V*E+W*i+J*(5*K)+g*(5*I);R=D>>>13,D&=8191,D+=T*(5*O)+z*(5*B)+Q*(5*w)+S*(5*F)+Y*(5*U),R+=D>>>13,D&=8191;let H=R+m*U+V*k+W*E+J*i+g*(5*K);R=H>>>13,H&=8191,H+=T*(5*I)+z*(5*O)+Q*(5*B)+S*(5*w)+Y*(5*F),R+=H>>>13,H&=8191;let p=R+m*F+V*U+W*k+J*E+g*i;R=p>>>13,p&=8191,p+=T*(5*K)+z*(5*I)+Q*(5*O)+S*(5*B)+Y*(5*w),R+=p>>>13,p&=8191;let iA=R+m*w+V*F+W*U+J*k+g*E;R=iA>>>13,iA&=8191,iA+=T*i+z*(5*K)+Q*(5*I)+S*(5*O)+Y*(5*B),R+=iA>>>13,iA&=8191;let d=R+m*B+V*w+W*F+J*U+g*k;R=d>>>13,d&=8191,d+=T*E+z*i+Q*(5*K)+S*(5*I)+Y*(5*O),R+=d>>>13,d&=8191;let a=R+m*O+V*B+W*w+J*F+g*U;R=a>>>13,a&=8191,a+=T*k+z*E+Q*i+S*(5*K)+Y*(5*I),R+=a>>>13,a&=8191;let wA=R+m*I+V*O+W*B+J*w+g*F;R=wA>>>13,wA&=8191,wA+=T*U+z*k+Q*E+S*i+Y*(5*K),R+=wA>>>13,wA&=8191;let PA=R+m*K+V*I+W*O+J*B+g*w;R=PA>>>13,PA&=8191,PA+=T*F+z*U+Q*k+S*E+Y*i,R+=PA>>>13,PA&=8191,R=(R<<2)+R|0,R=R+Z|0,Z=R&8191,R=R>>>13,L+=R,f[0]=Z,f[1]=L,f[2]=D,f[3]=H,f[4]=p,f[5]=iA,f[6]=d,f[7]=a,f[8]=wA,f[9]=PA}finalize(){let{h:A,pad:j}=this,n=new Uint16Array(10),q=A[1]>>>13;A[1]&=8191;for(let i=2;i<10;i++)A[i]+=q,q=A[i]>>>13,A[i]&=8191;A[0]+=q*5,q=A[0]>>>13,A[0]&=8191,A[1]+=q,q=A[1]>>>13,A[1]&=8191,A[2]+=q,n[0]=A[0]+5,q=n[0]>>>13,n[0]&=8191;for(let i=1;i<10;i++)n[i]=A[i]+q,q=n[i]>>>13,n[i]&=8191;n[9]-=8192;let f=(q^1)-1;for(let i=0;i<10;i++)n[i]&=f;f=~f;for(let i=0;i<10;i++)A[i]=A[i]&f|n[i];A[0]=(A[0]|A[1]<<13)&65535,A[1]=(A[1]>>>3|A[2]<<10)&65535,A[2]=(A[2]>>>6|A[3]<<7)&65535,A[3]=(A[3]>>>9|A[4]<<4)&65535,A[4]=(A[4]>>>12|A[5]<<1|A[6]<<14)&65535,A[5]=(A[6]>>>2|A[7]<<11)&65535,A[6]=(A[7]>>>5|A[8]<<8)&65535,A[7]=(A[8]>>>8|A[9]<<5)&65535;let v=A[0]+j[0];A[0]=v&65535;for(let i=1;i<8;i++)v=(A[i]+j[i]|0)+(v>>>16)|0,A[i]=v&65535;qA(n)}update(A){qj(this),A=bA(A),b(A);let{buffer:j,blockLen:n}=this,q=A.length;for(let f=0;f<q;){let v=Math.min(n-this.pos,q-f);if(v===n){for(;n<=q-f;f+=n)this.process(A,f);continue}if(j.set(A.subarray(f,f+v),this.pos),this.pos+=v,f+=v,this.pos===n)this.process(j,0,!1),this.pos=0}return this}destroy(){qA(this.h,this.r,this.buffer,this.pad)}digestInto(A){qj(this),Hj(A,this),this.finished=!0;let{buffer:j,h:n}=this,{pos:q}=this;if(q){j[q++]=1;for(;q<16;q++)j[q]=0;this.process(j,0,!0)}this.finalize();let f=0;for(let v=0;v<8;v++)A[f++]=n[v]>>>0,A[f++]=n[v]>>>8;return A}digest(){let{buffer:A,outputLen:j}=this;this.digestInto(A);let n=A.slice(0,j);return this.destroy(),n}}function d6(A){let j=(q,f)=>A(f).update(bA(q)).digest(),n=A(new Uint8Array(32));return j.outputLen=n.outputLen,j.blockLen=n.blockLen,j.create=(q)=>A(q),j}var Dj=d6((A)=>new Lj(A));function tj(A,j,n,q,f,v=20){let i=A[0],E=A[1],k=A[2],U=A[3],F=j[0],w=j[1],B=j[2],O=j[3],I=j[4],K=j[5],G=j[6],P=j[7],_=f,N=n[0],X=n[1],e=n[2],C=i,M=E,m=k,V=U,W=F,J=w,g=B,T=O,z=I,Q=K,S=G,Y=P,R=_,Z=N,L=X,D=e;for(let p=0;p<v;p+=2)C=C+W|0,R=r(R^C,16),z=z+R|0,W=r(W^z,12),C=C+W|0,R=r(R^C,8),z=z+R|0,W=r(W^z,7),M=M+J|0,Z=r(Z^M,16),Q=Q+Z|0,J=r(J^Q,12),M=M+J|0,Z=r(Z^M,8),Q=Q+Z|0,J=r(J^Q,7),m=m+g|0,L=r(L^m,16),S=S+L|0,g=r(g^S,12),m=m+g|0,L=r(L^m,8),S=S+L|0,g=r(g^S,7),V=V+T|0,D=r(D^V,16),Y=Y+D|0,T=r(T^Y,12),V=V+T|0,D=r(D^V,8),Y=Y+D|0,T=r(T^Y,7),C=C+J|0,D=r(D^C,16),S=S+D|0,J=r(J^S,12),C=C+J|0,D=r(D^C,8),S=S+D|0,J=r(J^S,7),M=M+g|0,R=r(R^M,16),Y=Y+R|0,g=r(g^Y,12),M=M+g|0,R=r(R^M,8),Y=Y+R|0,g=r(g^Y,7),m=m+T|0,Z=r(Z^m,16),z=z+Z|0,T=r(T^z,12),m=m+T|0,Z=r(Z^m,8),z=z+Z|0,T=r(T^z,7),V=V+W|0,L=r(L^V,16),Q=Q+L|0,W=r(W^Q,12),V=V+W|0,L=r(L^V,8),Q=Q+L|0,W=r(W^Q,7);let H=0;q[H++]=i+C|0,q[H++]=E+M|0,q[H++]=k+m|0,q[H++]=U+V|0,q[H++]=F+W|0,q[H++]=w+J|0,q[H++]=B+g|0,q[H++]=O+T|0,q[H++]=I+z|0,q[H++]=K+Q|0,q[H++]=G+S|0,q[H++]=P+Y|0,q[H++]=_+R|0,q[H++]=N+Z|0,q[H++]=X+L|0,q[H++]=e+D|0}function h6(A,j,n,q){let f=A[0],v=A[1],i=A[2],E=A[3],k=j[0],U=j[1],F=j[2],w=j[3],B=j[4],O=j[5],I=j[6],K=j[7],G=n[0],P=n[1],_=n[2],N=n[3];for(let e=0;e<20;e+=2)f=f+k|0,G=r(G^f,16),B=B+G|0,k=r(k^B,12),f=f+k|0,G=r(G^f,8),B=B+G|0,k=r(k^B,7),v=v+U|0,P=r(P^v,16),O=O+P|0,U=r(U^O,12),v=v+U|0,P=r(P^v,8),O=O+P|0,U=r(U^O,7),i=i+F|0,_=r(_^i,16),I=I+_|0,F=r(F^I,12),i=i+F|0,_=r(_^i,8),I=I+_|0,F=r(F^I,7),E=E+w|0,N=r(N^E,16),K=K+N|0,w=r(w^K,12),E=E+w|0,N=r(N^E,8),K=K+N|0,w=r(w^K,7),f=f+U|0,N=r(N^f,16),I=I+N|0,U=r(U^I,12),f=f+U|0,N=r(N^f,8),I=I+N|0,U=r(U^I,7),v=v+F|0,G=r(G^v,16),K=K+G|0,F=r(F^K,12),v=v+F|0,G=r(G^v,8),K=K+G|0,F=r(F^K,7),i=i+w|0,P=r(P^i,16),B=B+P|0,w=r(w^B,12),i=i+w|0,P=r(P^i,8),B=B+P|0,w=r(w^B,7),E=E+k|0,_=r(_^E,16),O=O+_|0,k=r(k^O,12),E=E+k|0,_=r(_^E,8),O=O+_|0,k=r(k^O,7);let X=0;q[X++]=f,q[X++]=v,q[X++]=i,q[X++]=E,q[X++]=G,q[X++]=P,q[X++]=_,q[X++]=N}var x6=Ej(tj,{counterRight:!1,counterLength:4,allowShortKeys:!1}),a6=Ej(tj,{counterRight:!1,counterLength:8,extendNonceFn:h6,allowShortKeys:!1});var An=new Uint8Array(16),Cj=(A,j)=>{A.update(j);let n=j.length%16;if(n)A.update(An.subarray(n))},jn=new Uint8Array(32);function Mj(A,j,n,q,f){let v=A(j,n,jn),i=Dj.create(v);if(f)Cj(i,f);Cj(i,q);let E=Yj(q.length,f?f.length:0,!0);i.update(E);let k=i.digest();return qA(v,E),k}var uj=(A)=>(j,n,q)=>{return{encrypt(v,i){let E=v.length;i=vj(E+16,i,!1),i.set(v);let k=i.subarray(0,-16);A(j,n,k,k,1);let U=Mj(A,j,n,k,q);return i.set(U,E),qA(U),i},decrypt(v,i){i=vj(v.length-16,i,!1);let E=v.subarray(0,-16),k=v.subarray(-16),U=Mj(A,j,n,E,q);if(!Zj(k,U))throw new Error("invalid tag");return i.set(v.subarray(0,-16)),A(j,n,i,i,1),qA(U),i}}},iq=fj({blockSize:64,nonceLength:12,tagLength:16},uj(x6)),WA=fj({blockSize:64,nonceLength:24,tagLength:16},uj(a6));class fA{p;static IV_LENGTH=24;static TAG_LENGTH=16;IV_LENGTH=fA.IV_LENGTH;TAG_LENGTH=fA.TAG_LENGTH;key;aad=new Uint8Array(0);constructor(A){this.p=A}async setKey(A){this.key=new Uint8Array(await this.p.subtle.exportKey("raw",A))}async encryptChunk(A){if(!this.key)throw new Error("Key not set");let j=this.p.getRandomValues(new Uint8Array(fA.IV_LENGTH)),q=(this.aad.length?WA(this.key,j,this.aad):WA(this.key,j)).encrypt(A);A.fill(0);let f=new Uint8Array(j.length+q.length);return f.set(j,0),f.set(q,j.length),f}async decryptChunk(A){if(!this.key)throw new Error("Key not set");if(A.byteLength<fA.IV_LENGTH+16)throw new l("Invalid ciphertext: too short.");let j=A.slice(0,fA.IV_LENGTH),n=A.slice(fA.IV_LENGTH),q=this.aad.length?WA(this.key,j,this.aad):WA(this.key,j);try{return q.decrypt(n)}catch{throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){if(this.key)this.key.fill(0)}setAAD(A){this.aad=A&&A.byteLength?new Uint8Array(A):new Uint8Array(0)}}var hA=NA(W6(),1);async function bn(){if(typeof window!=="undefined")return;if(globalThis.loadArgon2WasmModule)return;try{let{createRequire:A}=await import("node:module"),{readFile:j}=await import("node:fs/promises"),n=A(import.meta.url),q=n.resolve("argon2-browser/dist/argon2.js"),f=n.resolve("argon2-browser/dist/argon2.wasm");globalThis.loadArgon2WasmModule=async()=>{let v=new Uint8Array(await j(f));return globalThis.Module={wasmBinary:v,locateFile:(i)=>i==="argon2.wasm"?f:i},n(q)}}catch{}}async function J6(A,j,n,q){if(q==="node"){let f=await import("argon2"),v=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),i=Buffer.from(j),E=await f.hash(v,{salt:i,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:f.argon2id});return i.fill(0),v.fill(0),{hash:new Uint8Array(E)}}if(q==="browser")return await bn(),hA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:hA.ArgonType.Argon2id}).then((f)=>{if(!f||!f.hash)throw new jA("Failed to produce key derivation");return{hash:f.hash}}).catch((f)=>{let v=f instanceof Error?f.message:typeof f==="string"?f:"Unknown error";throw new jA(`argon2-browser failure: ${v}`)});throw new Error(`Unsupported environment: ${q}`)}class xA{presets;exportExtractable;name="argon2id";constructor(A,j=!1){this.presets=A;this.exportExtractable=j}async derive(A,j,n,q){let{hash:f}=await J6(A,j,this.presets[n],q.isNode?"node":"browser");if(this.exportExtractable)return q.subtle.importKey("raw",f,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);else return q.subtle.importKey("raw",f,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var V6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},ln={id:0,cipher:kA,kdf:new xA(V6),saltLengths:{low:12,high:16},difficulties:V6,defaultChunkSize:524288};u.register(ln);var m6={low:{time:5,mem:65536,parallelism:2},middle:{time:10,mem:98304,parallelism:4},high:{time:20,mem:98304,parallelism:4}},yn={id:1,cipher:fA,kdf:new xA(m6,!0),saltLengths:{low:12,high:16},difficulties:m6,defaultChunkSize:524288};u.register(yn);var aA=1;function g6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!1}function SA(...A){let j=A.reduce((f,v)=>f+v.byteLength,0),n=new Uint8Array(j),q=0;for(let f of A)n.set(f,q),q+=f.byteLength;return n}function XA(...A){try{let j=SA(...A);if(g6())return Buffer.from(j).toString("base64");let n="";for(let q=0;q<j.length;q++)n+=String.fromCharCode(j[q]);return btoa(n)}catch{throw new nj("Base64 Encoding Error")}}function zA(A){try{if(!/^[A-Za-z0-9+/]+={0,2}$/.test(A)||A.length%4!==0)throw new Error("Invalid Base64");if(g6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let q=0;q<j.length;q++)n[q]=j.charCodeAt(q);return n}catch{throw new TA(`Invalid Base64: length=${A.length}, content='${A.slice(0,12)}…'`)}}function y(A){let j=A.value.length,n=new Array(j).fill("\x00").join("");A.value=n}function LA(A,j,n,q,f){let v={low:0,middle:1,high:2};if(!(j in v))throw new TypeError(`Unsupported difficulty: ${j}`);let i=v[j],E=A<<5|(n==="high"?1:0)<<2|i,k=SA(new Uint8Array([aA,E]),q);if(f)f.setAAD(k);return k}function x(A,j){if(A[0]!==aA)throw new c("Invalid input format. The input is unknown.");if(A.length<14)throw new c("Invalid input format. Header too short.");try{let n=A[1],q=n>>5,f=n>>2&1?"high":"low",v=n&3,i=["low","middle","high"][v],E=u.get(q).saltLengths[f],k=2+E;if(A.length<k)throw new c("Invalid input format. Header truncated.");if(j)j.setAAD(A.subarray(0,k));let U=A.slice(2,2+E);return{scheme:q,difficulty:i,saltStrength:f,salt:U,headerLen:k}}catch(n){throw new EA(n instanceof Error?n.message:String(n))}}async function Aj(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}function Nj(A){let j=new Uint8Array(4);return new DataView(j.buffer).setUint32(0,A,!1),j}function H6(A,j=0){if(A.length-j<4)throw new RangeError("Not enough bytes for frame header");return new DataView(A.buffer,A.byteOffset+j,4).getUint32(0,!1)}var vA=4;class DA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await Aj(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){if(A.length>Math.min(this.chunkSize*4,67108864))throw new RangeError(`Input block (${A.length} B) exceeds maximum allowed ${Math.min(this.chunkSize*4,67108864)} B`);let q=new Uint8Array(this.buffer.length+A.length);q.set(this.buffer),q.set(A,this.buffer.length);let f=0;while(q.length-f>=this.chunkSize){let v=q.slice(f,f+this.chunkSize);f+=this.chunkSize;let i=await this.engine.encryptChunk(v),E=new Uint8Array(vA+i.length);E.set(Nj(i.length)),E.set(i,vA),j.enqueue(E)}this.buffer=q.slice(f)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(vA+j.length);n.set(Nj(j.length)),n.set(j,vA),A.enqueue(n),this.buffer=new Uint8Array(0),this.engine.zeroKey()}}class RA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await Aj(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let q=0;while(!0){if(n.length-q<vA)break;let f=H6(n,q);if(f>this.chunkSize*2)throw new l(`Frame length ${f} exceeds …`);if(n.length-q-vA<f)break;q+=vA;let v=n.slice(q,q+f);q+=f;try{let i=await this.engine.decryptChunk(v);j.enqueue(i)}catch(i){throw i instanceof l?i:new l("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(q)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0),this.engine.zeroKey()}}async function Q6(A,j){let n=A.getReader(),q=j&&j.length?[j]:[];try{while(!0){let{value:E,done:k}=await n.read();if(k)break;q.push(E)}}finally{n.releaseLock()}let f=q.reduce((E,k)=>E+k.byteLength,0),v=new Uint8Array(f),i=0;for(let E of q)v.set(E,i),i+=E.byteLength;return v}class OA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new DA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(f,v){if(j===0){v.enqueue(f);return}if(f.byteLength<=j){j-=f.byteLength;return}v.enqueue(f.slice(j)),j=0}}),q=new RA(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(q)}}async collect(A,j,n=null){return Q6(A.pipeThrough(j),n??void 0)}getEngine(){return this.engine}}function Z6(A=0,j=console.info){return{level:A,log(n,q){if(n<=A)j(`${n}| ${q}`)}}}function Y6(A,j,n){if(j<0||n<0||j+n>A)throw new RangeError("read() slice exceeds data bounds")}var{promises:jf}=(()=>({}));class _j{src;#A=null;constructor(A){this.src=A}get length(){if(this.src instanceof Uint8Array)return this.src.byteLength;if(this.src instanceof Blob)return this.src.size;return this.ensureUint8().byteLength}async read(A,j){if(Y6(this.length,A,j),this.src instanceof Uint8Array)return this.src.slice(A,A+j);if(this.src instanceof Blob){let n=await this.src.slice(A,A+j).arrayBuffer();return new Uint8Array(n)}return this.ensureUint8().slice(A,A+j)}ensureUint8(){if(!this.#A)this.#A=zA(this.src);return this.#A}}var S6=new WeakMap;class IA{static getEngine(A,j){let n=S6.get(A);if(!n)n=new Map,S6.set(A,n);let q=n.get(j);if(q)return q;let f=u.get(j);return q={desc:f,cipher:new f.cipher(A),kdf:f.kdf,chunkSize:f.defaultChunkSize,provider:A},n.set(j,q),q}static async deriveKey(A,j,n,q){try{let f=await A.kdf.derive(j.value,n,q,A.provider);await A.cipher.setKey(f)}catch(f){let v=f instanceof Error?f.message:String(f);throw new jA(v)}finally{y(j)}}}class FA{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=u.get(j.scheme??u.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=this.setChunkSize(j.chunkSize??this.v.defaultChunkSize),this.stream=new OA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=Z6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await FA.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await FA.peekHeader(A),n=x(j);return{scheme:n.scheme,difficulty:n.difficulty,salt:XA(n.salt),saltLength:n.salt.byteLength}}static async decodeData(A){let j=typeof A?.read==="function"?A:new _j(A),n=await j.read(0,Math.min(256,j.length)),q=await FA.peekHeader(n),{scheme:f,headerLen:v}=x(q),i=j.length,E=i-v;if(E<=0)throw new c("Payload is empty");let k=await j.read(v,4),U=new DataView(k.buffer,k.byteOffset,4).getUint32(0,!1);if(U+4<=E&&U>=28){let I=U,K=v,G=0,P=0;while(K+4<=i){let _=await j.read(K,4),N=new DataView(_.buffer,_.byteOffset,4).getUint32(0,!1);if(N===0||K+4+N>i)break;G++,P+=N,K+=4+N}return{isChunked:!0,chunks:{chunkSize:I,count:G,totalPayload:P}}}let w=await j.read(v,E),B=u.get(f).cipher.IV_LENGTH,O=u.get(f).cipher.TAG_LENGTH;if(w.length<B+O)throw new c("Ciphertext too short for IV & tag");return{isChunked:!1,payloadLength:E-B-O,params:{iv:w.slice(0,B),ivLength:B,tag:w.slice(w.length-O),tagLength:O}}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setScheme(A){this.v=u.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new OA(this.cipher,this.chunkSize)}getScheme(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){let j=A,n;if(j==null)n=this.v.defaultChunkSize;else if(n=Number(j),!Number.isInteger(n)||n<1)throw new Error(`Invalid chunkSize: ${j}. Must be a positive integer.`);return this.chunkSize=n,this.stream=new OA(this.cipher,this.chunkSize),n}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){let n={value:j};try{this.log.log(1,`Start text encryption, scheme: ${this.getScheme()}`),this.log.log(2,"Deriving key for text encryption");let q=this.genSalt();await this.deriveKey(n,q),y(n),j=null,this.log.log(3,`Salt generated: ${XA(q)}, KDF difficulty: ${this.difficulty}`),this.log.log(3,"Encoding header");let f=LA(this.v.id,this.difficulty,this.saltStrength,q,this.cipher);this.log.log(2,"Encrypting text data");let v=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.cipher.zeroKey(),this.log.log(3,"Encoding text");let i=XA(f,v);return this.log.log(1,"Decryption finished"),i}catch(q){throw new MA(q instanceof Error?q.message:String(q))}}async decryptText(A,j){let n={value:j};try{this.log.log(1,`Start text decryption, Version ${this.getScheme()}`),this.log.log(3,"Start text decoding");let q=zA(A);this.log.log(3,"Start header decoding");let f=x(q);this.log.log(3,"Selecting decryption engine");let v=IA.getEngine(this.provider,f.scheme);this.log.log(2,`Deriving key via engine for scheme: ${f.scheme}`),this.log.log(3,`Salt use: ${XA(f.salt)}, KDF difficulty: ${f.difficulty}`);try{await IA.deriveKey(v,n,f.salt,f.difficulty)}finally{y(n),j=null}this.log.log(2,"Decrypting text data"),x(q,v.cipher);let i=await v.cipher.decryptChunk(q.slice(f.headerLen));v.cipher.zeroKey(),this.log.log(3,"Decoding text");let E=new TextDecoder().decode(i);return this.log.log(1,"Decryption finished"),E}catch(q){if(q instanceof l||q instanceof c||q instanceof EA||q instanceof TA||q instanceof jA)throw q;throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){let n={value:j};try{if(A.size===0){let i=this.genSalt();await this.deriveKey(n,i),y(n),j=null;let E=LA(this.v.id,this.difficulty,this.saltStrength,i);return new Blob([E],{type:"application/octet-stream"})}this.log.log(2,"Deriving key for file encryption");let q=this.genSalt();await this.deriveKey(n,q),y(n),j=null;let f=LA(this.v.id,this.difficulty,this.saltStrength,q,this.stream.getEngine()),v=await this.stream.collect(A.stream(),new DA(this.cipher,this.chunkSize).toTransformStream(),f);return new Blob([v],{type:"application/octet-stream"})}catch(q){throw new MA(q instanceof Error?q.message:String(q))}}async decryptFile(A,j){let n={value:j};try{let q=await FA.peekHeader(A),f=x(q),v=IA.getEngine(this.provider,f.scheme);try{await IA.deriveKey(v,n,f.salt,f.difficulty)}finally{y(n),j=null}if(A.size===f.headerLen)return new Blob([],{type:"application/octet-stream"});this.log.log(2,"Decrypting file data");let i=new OA(v.cipher,v.chunkSize);x(q,i.getEngine());let E=await i.collect(A.slice(f.headerLen).stream(),new RA(v.cipher,v.chunkSize).toTransformStream());return new Blob([E],{type:"application/octet-stream"})}catch(q){if(q instanceof l)throw q;throw new l(q instanceof Error?q.message:String(q))}}async createEncryptionStream(A){let j={value:A};this.log.log(2,"Deriving key for stream encryption");let n=this.genSalt();await this.deriveKey(j,n),y(j),A=null;let q=LA(this.v.id,this.difficulty,this.saltStrength,n,this.stream.getEngine()),f=this.stream.encryptionStream();return{header:q,writable:f.writable,readable:f.readable}}async createDecryptionStream(A){let j={value:A},n=this,q=new Uint8Array(0),f=null,v=65536,i=14;async function E(k,U){let F=k.getReader();while(!0){let{value:w,done:B}=await F.read();if(B)break;U.enqueue(w)}}return new TransformStream({async transform(k,U){if(!f){if(k&&k.byteLength){if(q.byteLength+k.byteLength>v){y(j),U.error(new c(`Header not found within ${v} bytes`));return}q=SA(q,k)}if(q.byteLength<i)return;let w=q[1],B=w>>5,O=w>>2&1?"high":"low",I=0;try{I=2+u.get(B).saltLengths[O]}catch(N){y(j),U.error(new EA(N instanceof Error?N.message:String(N)));return}if(q.byteLength<I)return;let K=q.subarray(0,I),G;try{G=x(K)}catch(N){y(j),U.error(N instanceof Error?N:new EA("Invalid header"));return}let P=IA.getEngine(n.provider,G.scheme);try{await IA.deriveKey(P,j,G.salt,G.difficulty)}finally{y(j),A=null}x(K,P.cipher),f=new RA(P.cipher,P.chunkSize).toTransformStream(),E(f.readable,U).catch((N)=>U.error(N));let _=q.subarray(I);if(q=new Uint8Array(0),_.byteLength){let N=f.writable.getWriter();await N.write(_),N.releaseLock()}return}let F=f.writable.getWriter();await F.write(k),F.releaseLock()},async flush(){if(!f)throw y(j),new c("Header not found before end of stream");let k=f.writable.getWriter();await k.close(),k.releaseLock()}})}async deriveKey(A,j,n=this.difficulty){let q=performance.now();try{let f=await this.kdf.derive(A.value,j,n,this.provider);y(A),await this.cipher.setKey(f),this.log.log(3,`Key derivation completed in ${(performance.now()-q).toFixed(1)} ms`)}catch(f){throw new jA(f instanceof Error?f.message:String(f))}}genSalt(A=this.saltStrength){let j=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(j))}static async peekHeader(A){let j=await this.readAsUint8(A);if(j instanceof Uint8Array){if(j.length<2)throw new c("Input too short");let{headerLen:n}=x(j.length>=16?j:Uint8Array.from(j));if(j.length<n)throw new c("Incomplete header");return j.slice(0,n)}throw new EA("Unsupported input type")}static async readAsUint8(A){if(typeof A==="string")return zA(A);if(A instanceof Blob){let j=A.slice(0,64);return new Uint8Array(await j.arrayBuffer())}return A}}var X6={subtle:globalThis.crypto.subtle,getRandomValues(A){return globalThis.crypto.getRandomValues(A)},isNode:!1};function Jf(A){return new FA(X6,A)}export{Jf as createCryptit,FA as Cryptit};

//# debugId=FD33C7B8FD4BE8CB64756E2164756E21
