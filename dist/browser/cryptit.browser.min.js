var O6=Object.create;var{getPrototypeOf:m6,defineProperty:GA,getOwnPropertyNames:Kj,getOwnPropertyDescriptor:N6}=Object,gj=Object.prototype.hasOwnProperty;var uA=(A,j,n)=>{n=A!=null?O6(m6(A)):{};let f=j||!A||!A.__esModule?GA(n,"default",{value:A,enumerable:!0}):n;for(let i of Kj(A))if(!gj.call(f,i))GA(f,i,{get:()=>A[i],enumerable:!0});return f},wj=new WeakMap,_j=(A)=>{var j=wj.get(A),n;if(j)return j;if(j=GA({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")Kj(A).map((f)=>!gj.call(j,f)&&GA(j,f,{get:()=>A[f],enumerable:!(n=N6(A,f))||n.enumerable}));return wj.set(A,j),j},yA=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var z6=(A,j)=>{for(var n in j)GA(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(f)=>j[n]=()=>f})};var V6=(A,j)=>()=>(A&&(j=A(A=0)),j);var oA=((A)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(A,{get:(j,n)=>(typeof require!=="undefined"?require:j)[n]}):A)(function(A){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+A+'" is not supported')});var rj={};z6(rj,{sep:()=>yj,resolve:()=>QA,relative:()=>Cj,posix:()=>dj,parse:()=>uj,normalize:()=>ij,join:()=>Lj,isAbsolute:()=>Zj,format:()=>bj,extname:()=>sj,dirname:()=>Mj,delimiter:()=>oj,default:()=>d6,basename:()=>lj,_makeLong:()=>cj});function d(A){if(typeof A!=="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(A))}function Dj(A,j){var n="",f=0,i=-1,r=0,q;for(var v=0;v<=A.length;++v){if(v<A.length)q=A.charCodeAt(v);else if(q===47)break;else q=47;if(q===47){if(i===v-1||r===1);else if(i!==v-1&&r===2){if(n.length<2||f!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var k=n.lastIndexOf("/");if(k!==n.length-1){if(k===-1)n="",f=0;else n=n.slice(0,k),f=n.length-1-n.lastIndexOf("/");i=v,r=0;continue}}else if(n.length===2||n.length===1){n="",f=0,i=v,r=0;continue}}if(j){if(n.length>0)n+="/..";else n="..";f=2}}else{if(n.length>0)n+="/"+A.slice(i+1,v);else n=A.slice(i+1,v);f=v-i-1}i=v,r=0}else if(q===46&&r!==-1)++r;else r=-1}return n}function o6(A,j){var n=j.dir||j.root,f=j.base||(j.name||"")+(j.ext||"");if(!n)return f;if(n===j.root)return n+f;return n+A+f}function QA(){var A="",j=!1,n;for(var f=arguments.length-1;f>=-1&&!j;f--){var i;if(f>=0)i=arguments[f];else{if(n===void 0)n=process.cwd();i=n}if(d(i),i.length===0)continue;A=i+"/"+A,j=i.charCodeAt(0)===47}if(A=Dj(A,!j),j)if(A.length>0)return"/"+A;else return"/";else if(A.length>0)return A;else return"."}function ij(A){if(d(A),A.length===0)return".";var j=A.charCodeAt(0)===47,n=A.charCodeAt(A.length-1)===47;if(A=Dj(A,!j),A.length===0&&!j)A=".";if(A.length>0&&n)A+="/";if(j)return"/"+A;return A}function Zj(A){return d(A),A.length>0&&A.charCodeAt(0)===47}function Lj(){if(arguments.length===0)return".";var A;for(var j=0;j<arguments.length;++j){var n=arguments[j];if(d(n),n.length>0)if(A===void 0)A=n;else A+="/"+n}if(A===void 0)return".";return ij(A)}function Cj(A,j){if(d(A),d(j),A===j)return"";if(A=QA(A),j=QA(j),A===j)return"";var n=1;for(;n<A.length;++n)if(A.charCodeAt(n)!==47)break;var f=A.length,i=f-n,r=1;for(;r<j.length;++r)if(j.charCodeAt(r)!==47)break;var q=j.length,v=q-r,k=i<v?i:v,e=-1,I=0;for(;I<=k;++I){if(I===k){if(v>k){if(j.charCodeAt(r+I)===47)return j.slice(r+I+1);else if(I===0)return j.slice(r+I)}else if(i>k){if(A.charCodeAt(n+I)===47)e=I;else if(I===0)e=0}break}var P=A.charCodeAt(n+I),g=j.charCodeAt(r+I);if(P!==g)break;else if(P===47)e=I}var K="";for(I=n+e+1;I<=f;++I)if(I===f||A.charCodeAt(I)===47)if(K.length===0)K+="..";else K+="/..";if(K.length>0)return K+j.slice(r+e);else{if(r+=e,j.charCodeAt(r)===47)++r;return j.slice(r)}}function cj(A){return A}function Mj(A){if(d(A),A.length===0)return".";var j=A.charCodeAt(0),n=j===47,f=-1,i=!0;for(var r=A.length-1;r>=1;--r)if(j=A.charCodeAt(r),j===47){if(!i){f=r;break}}else i=!1;if(f===-1)return n?"/":".";if(n&&f===1)return"//";return A.slice(0,f)}function lj(A,j){if(j!==void 0&&typeof j!=="string")throw new TypeError('"ext" argument must be a string');d(A);var n=0,f=-1,i=!0,r;if(j!==void 0&&j.length>0&&j.length<=A.length){if(j.length===A.length&&j===A)return"";var q=j.length-1,v=-1;for(r=A.length-1;r>=0;--r){var k=A.charCodeAt(r);if(k===47){if(!i){n=r+1;break}}else{if(v===-1)i=!1,v=r+1;if(q>=0)if(k===j.charCodeAt(q)){if(--q===-1)f=r}else q=-1,f=v}}if(n===f)f=v;else if(f===-1)f=A.length;return A.slice(n,f)}else{for(r=A.length-1;r>=0;--r)if(A.charCodeAt(r)===47){if(!i){n=r+1;break}}else if(f===-1)i=!1,f=r+1;if(f===-1)return"";return A.slice(n,f)}}function sj(A){d(A);var j=-1,n=0,f=-1,i=!0,r=0;for(var q=A.length-1;q>=0;--q){var v=A.charCodeAt(q);if(v===47){if(!i){n=q+1;break}continue}if(f===-1)i=!1,f=q+1;if(v===46){if(j===-1)j=q;else if(r!==1)r=1}else if(j!==-1)r=-1}if(j===-1||f===-1||r===0||r===1&&j===f-1&&j===n+1)return"";return A.slice(j,f)}function bj(A){if(A===null||typeof A!=="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof A);return o6("/",A)}function uj(A){d(A);var j={root:"",dir:"",base:"",ext:"",name:""};if(A.length===0)return j;var n=A.charCodeAt(0),f=n===47,i;if(f)j.root="/",i=1;else i=0;var r=-1,q=0,v=-1,k=!0,e=A.length-1,I=0;for(;e>=i;--e){if(n=A.charCodeAt(e),n===47){if(!k){q=e+1;break}continue}if(v===-1)k=!1,v=e+1;if(n===46){if(r===-1)r=e;else if(I!==1)I=1}else if(r!==-1)I=-1}if(r===-1||v===-1||I===0||I===1&&r===v-1&&r===q+1){if(v!==-1)if(q===0&&f)j.base=j.name=A.slice(1,v);else j.base=j.name=A.slice(q,v)}else{if(q===0&&f)j.name=A.slice(1,r),j.base=A.slice(1,v);else j.name=A.slice(q,r),j.base=A.slice(q,v);j.ext=A.slice(r,v)}if(q>0)j.dir=A.slice(0,q-1);else if(f)j.dir="/";return j}var yj="/",oj=":",dj,d6;var qj=V6(()=>{dj=((A)=>(A.posix=A,A))({resolve:QA,normalize:ij,isAbsolute:Zj,join:Lj,relative:Cj,_makeLong:cj,dirname:Mj,basename:lj,extname:sj,format:bj,parse:uj,sep:yj,delimiter:oj,win32:null,posix:null}),d6=dj});var Gj=yA((qf,kA)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",E=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},h6=E,KA={},fA;for(fA in E)if(E.hasOwnProperty(fA))KA[fA]=E[fA];var gA=[],xj="./this.program",$j=function(A,j){throw j},CA=!1,qA=!1,ej=!1,A6=!1;CA=typeof window==="object";qA=typeof importScripts==="function";ej=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";A6=!CA&&!ej&&!qA;var y="";function p6(A){if(E.locateFile)return E.locateFile(A,y);return y+A}var DA,Ij,_A,a6,vj,Ej;if(ej){if(qA)y=(qj(),_j(rj)).dirname(y)+"/";else y=__dirname+"/";if(DA=function A(j,n){if(!vj)vj=(()=>({}));if(!Ej)Ej=(qj(),_j(rj));return j=Ej.normalize(j),vj.readFileSync(j,n?null:"utf8")},_A=function A(j){var n=DA(j,!0);if(!n.buffer)n=new Uint8Array(n);return hj(n.buffer),n},process.argv.length>1)xj=process.argv[1].replace(/\\/g,"/");if(gA=process.argv.slice(2),typeof kA!=="undefined")kA.exports=E;process.on("uncaughtException",function(A){if(!(A instanceof Jn))throw A}),process.on("unhandledRejection",TA),$j=function(A){process.exit(A)},E.inspect=function(){return"[Emscripten Module object]"}}else if(A6){if(typeof read!="undefined")DA=function A(j){return read(j)};if(_A=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),hj(typeof n==="object"),n},typeof scriptArgs!="undefined")gA=scriptArgs;else if(typeof arguments!="undefined")gA=arguments;if(typeof quit==="function")$j=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(CA||qA){if(qA)y=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)y=document.currentScript.src;if(y.indexOf("blob:")!==0)y=y.substr(0,y.lastIndexOf("/")+1);else y="";{if(DA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},qA)_A=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};Ij=function(A,j,n){var f=new XMLHttpRequest;f.open("GET",A,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status==200||f.status==0&&f.response){j(f.response);return}n()},f.onerror=n,f.send(null)}}a6=function(A){document.title=A}}var nf=E.print||console.log.bind(console),wA=E.printErr||console.warn.bind(console);for(fA in KA)if(KA.hasOwnProperty(fA))E[fA]=KA[fA];KA=null;if(E.arguments)gA=E.arguments;if(E.thisProgram)xj=E.thisProgram;if(E.quit)$j=E.quit;var UA;if(E.wasmBinary)UA=E.wasmBinary;var ff=E.noExitRuntime||!0;if(typeof WebAssembly!=="object")TA("no native wasm support detected");var HA,j6=!1,x6;function hj(A,j){if(!A)TA("Assertion failed: "+j)}var An=0,jn=1;function nn(A,j){var n;if(j==jn)n=G6(A.length);else n=R6(A.length);if(A.subarray||A.slice)EA.set(A,n);else EA.set(new Uint8Array(A),n);return n}var pj=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function fn(A,j,n){var f=j+n,i=j;while(A[i]&&!(i>=f))++i;if(i-j>16&&A.subarray&&pj)return pj.decode(A.subarray(j,i));else{var r="";while(j<i){var q=A[j++];if(!(q&128)){r+=String.fromCharCode(q);continue}var v=A[j++]&63;if((q&224)==192){r+=String.fromCharCode((q&31)<<6|v);continue}var k=A[j++]&63;if((q&240)==224)q=(q&15)<<12|v<<6|k;else q=(q&7)<<18|v<<12|k<<6|A[j++]&63;if(q<65536)r+=String.fromCharCode(q);else{var e=q-65536;r+=String.fromCharCode(55296|e>>10,56320|e&1023)}}}return r}function rn(A,j){return A?fn(EA,A,j):""}function qn(A,j){if(A%j>0)A+=j-A%j;return A}var Fj,n6,EA,f6,i6,r6,q6,v6,E6;function k6(A){Fj=A,E.HEAP8=n6=new Int8Array(A),E.HEAP16=f6=new Int16Array(A),E.HEAP32=r6=new Int32Array(A),E.HEAPU8=EA=new Uint8Array(A),E.HEAPU16=i6=new Uint16Array(A),E.HEAPU32=q6=new Uint32Array(A),E.HEAPF32=v6=new Float32Array(A),E.HEAPF64=E6=new Float64Array(A)}var rf=E.INITIAL_MEMORY||16777216,ZA,$6=[],I6=[],e6=[],vn=!1;function En(){if(E.preRun){if(typeof E.preRun=="function")E.preRun=[E.preRun];while(E.preRun.length)In(E.preRun.shift())}tj($6)}function kn(){vn=!0,tj(I6)}function $n(){if(E.postRun){if(typeof E.postRun=="function")E.postRun=[E.postRun];while(E.postRun.length)Fn(E.postRun.shift())}tj(e6)}function In(A){$6.unshift(A)}function en(A){I6.unshift(A)}function Fn(A){e6.unshift(A)}var vA=0,kj=null,BA=null;function tn(A){if(vA++,E.monitorRunDependencies)E.monitorRunDependencies(vA)}function Rn(A){if(vA--,E.monitorRunDependencies)E.monitorRunDependencies(vA);if(vA==0){if(kj!==null)clearInterval(kj),kj=null;if(BA){var j=BA;BA=null,j()}}}E.preloadedImages={};E.preloadedAudios={};function TA(A){if(E.onAbort)E.onAbort(A);A+="",wA(A),j6=!0,x6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var Gn="data:application/octet-stream;base64,";function F6(A){return A.startsWith(Gn)}function t6(A){return A.startsWith("file://")}var s="argon2.wasm";if(!F6(s))s=p6(s);function aj(A){try{if(A==s&&UA)return new Uint8Array(UA);if(_A)return _A(A);else throw"both async and sync fetching of the wasm failed"}catch(j){TA(j)}}function Pn(){if(!UA&&(CA||qA)){if(typeof fetch==="function"&&!t6(s))return fetch(s,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+s+"'";return A.arrayBuffer()}).catch(function(){return aj(s)});else if(Ij)return new Promise(function(A,j){Ij(s,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return aj(s)})}function wn(){var A={a:Bn};function j(q,v){var k=q.exports;E.asm=k,HA=E.asm.c,k6(HA.buffer),ZA=E.asm.k,en(E.asm.d),Rn("wasm-instantiate")}tn("wasm-instantiate");function n(q){j(q.instance)}function f(q){return Pn().then(function(v){var k=WebAssembly.instantiate(v,A);return k}).then(q,function(v){wA("failed to asynchronously prepare wasm: "+v),TA(v)})}function i(){if(!UA&&typeof WebAssembly.instantiateStreaming==="function"&&!F6(s)&&!t6(s)&&typeof fetch==="function")return fetch(s,{credentials:"same-origin"}).then(function(q){var v=WebAssembly.instantiateStreaming(q,A);return v.then(n,function(k){return wA("wasm streaming compile failed: "+k),wA("falling back to ArrayBuffer instantiation"),f(n)})});else return f(n)}if(E.instantiateWasm)try{var r=E.instantiateWasm(A,j);return r}catch(q){return wA("Module.instantiateWasm callback failed with error: "+q),!1}return i(),{}}function tj(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(E);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)ZA.get(n)();else ZA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function Kn(A,j,n){EA.copyWithin(A,j,j+n)}function gn(A){try{return HA.grow(A-Fj.byteLength+65535>>>16),k6(HA.buffer),1}catch(j){}}function _n(A){var j=EA.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var f=1;f<=4;f*=2){var i=j*(1+0.2/f);i=Math.min(i,A+100663296);var r=Math.min(n,qn(Math.max(A,i),65536)),q=gn(r);if(q)return!0}return!1}var Bn={a:Kn,b:_n},Un=wn(),Hn=E.___wasm_call_ctors=function(){return(Hn=E.___wasm_call_ctors=E.asm.d).apply(null,arguments)},Tn=E._argon2_hash=function(){return(Tn=E._argon2_hash=E.asm.e).apply(null,arguments)},R6=E._malloc=function(){return(R6=E._malloc=E.asm.f).apply(null,arguments)},Sn=E._free=function(){return(Sn=E._free=E.asm.g).apply(null,arguments)},On=E._argon2_verify=function(){return(On=E._argon2_verify=E.asm.h).apply(null,arguments)},mn=E._argon2_error_message=function(){return(mn=E._argon2_error_message=E.asm.i).apply(null,arguments)},Nn=E._argon2_encodedlen=function(){return(Nn=E._argon2_encodedlen=E.asm.j).apply(null,arguments)},zn=E._argon2_hash_ext=function(){return(zn=E._argon2_hash_ext=E.asm.l).apply(null,arguments)},Vn=E._argon2_verify_ext=function(){return(Vn=E._argon2_verify_ext=E.asm.m).apply(null,arguments)},G6=E.stackAlloc=function(){return(G6=E.stackAlloc=E.asm.n).apply(null,arguments)};E.allocate=nn;E.UTF8ToString=rn;E.ALLOC_NORMAL=An;var LA;function Jn(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}BA=function A(){if(!LA)Rj();if(!LA)BA=A};function Rj(A){if(A=A||gA,vA>0)return;if(En(),vA>0)return;function j(){if(LA)return;if(LA=!0,E.calledRun=!0,j6)return;if(kn(),E.onRuntimeInitialized)E.onRuntimeInitialized();$n()}if(E.setStatus)E.setStatus("Running..."),setTimeout(function(){setTimeout(function(){E.setStatus("")},1),j()},1);else j()}E.run=Rj;if(E.preInit){if(typeof E.preInit=="function")E.preInit=[E.preInit];while(E.preInit.length>0)E.preInit.pop()()}Rj();if(typeof kA!=="undefined")kA.exports=E;E.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(E=h6=HA=ZA=Un=Fj=n6=EA=f6=i6=r6=q6=v6=E6=void 0,typeof kA!=="undefined")delete kA.exports}});var P6=yA((vf,Wn)=>{Wn.exports="./argon2.wasm"});var K6=yA((w6,cA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof cA==="object"&&cA.exports)cA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:w6,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n($){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let F;if(A.process&&A.process.versions&&A.process.versions.node)F=i().then((t)=>new Promise((w)=>{t.postRun=()=>w(t)}));else F=r().then((t)=>{let w=$?v($):void 0;return f(t,w)});return n._promise=F,F.then((t)=>{return n._module=t,delete n._promise,t})}function f($,F){return new Promise((t)=>{return A.Module={wasmBinary:$,wasmMemory:F,postRun(){t(Module)}},i()})}function i(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(Gj())}function r(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(P6()).then((F)=>{return q(F)})}function q($){let F=atob($),t=new Uint8Array(new ArrayBuffer(F.length));for(let w=0;w<F.length;w++)t[w]=F.charCodeAt(w);return t}function v($){let Q=Math.min(Math.max(Math.ceil($*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:Q,maximum:32767})}function k($,F){return $.allocate(F,"i8",$.ALLOC_NORMAL)}function e($,F){let t=new Uint8Array([...F,0]);return k($,t)}function I($){if(typeof $!=="string")return $;if(typeof TextEncoder==="function")return new TextEncoder().encode($);else if(typeof Buffer==="function")return Buffer.from($);else throw new Error("Don't know how to encode UTF8")}function P($){let F=$.mem||1024;return n(F).then((t)=>{let w=$.time||1,U=$.parallelism||1,J=I($.pass),Q=e(t,J),b=J.length,Z=I($.salt),L=e(t,Z),S=Z.length,T=$.type||j.Argon2d,B=t.allocate(new Array($.hashLen||24),"i8",t.ALLOC_NORMAL),H=$.secret?k(t,$.secret):0,O=$.secret?$.secret.byteLength:0,_=$.ad?k(t,$.ad):0,X=$.ad?$.ad.byteLength:0,N=$.hashLen||24,W=t._argon2_encodedlen(w,F,U,S,N,T),V=t.allocate(new Array(W+1),"i8",t.ALLOC_NORMAL),G=19,z,Y;try{Y=t._argon2_hash_ext(w,F,U,Q,b,L,S,B,N,V,W,T,H,O,_,X,19)}catch(m){z=m}let D;if(Y===0&&!z){let m="",u=new Uint8Array(N);for(let o=0;o<N;o++){let h=t.HEAP8[B+o];u[o]=h,m+=("0"+(255&h).toString(16)).slice(-2)}let AA=t.UTF8ToString(V);D={hash:u,hashHex:m,encoded:AA}}else{try{if(!z)z=t.UTF8ToString(t._argon2_error_message(Y))}catch(m){}D={message:z,code:Y}}try{if(t._free(Q),t._free(L),t._free(B),t._free(V),_)t._free(_);if(H)t._free(H)}catch(m){}if(z)throw D;else return D})}function g($){return n().then((F)=>{let t=I($.pass),w=e(F,t),U=t.length,J=$.secret?k(F,$.secret):0,Q=$.secret?$.secret.byteLength:0,b=$.ad?k(F,$.ad):0,Z=$.ad?$.ad.byteLength:0,L=I($.encoded),S=e(F,L),T=$.type;if(T===void 0){let _=$.encoded.split("$")[1];if(_)_=_.replace("a","A"),T=j[_]||j.Argon2d}let B,H;try{H=F._argon2_verify_ext(S,w,U,J,Q,b,Z,T)}catch(_){B=_}let O;if(H||B){try{if(!B)B=F.UTF8ToString(F._argon2_error_message(H))}catch(_){}O={message:B,code:H}}try{F._free(w),F._free(S)}catch(_){}if(B)throw O;else return O})}function K(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:P,verify:g,unloadRuntime:K}})});class p extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class jA extends p{}class PA extends p{}class dA extends p{}class NA extends p{}class FA extends p{}class nA extends p{}class zA extends p{}class l extends p{}class M{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new NA(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new NA(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class hA{p;key;constructor(A){this.p=A}async setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),f=new Uint8Array(j.length+n.length);return f.set(j),f.set(n,j.length),f}async decryptChunk(A){let j=A.slice(0,12),n=A.slice(12),f=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);try{let i=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(i)}catch{throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Uj(A){return A instanceof Uint8Array||ArrayBuffer.isView(A)&&A.constructor.name==="Uint8Array"}function VA(A){if(typeof A!=="boolean")throw new Error(`boolean expected, not ${A}`)}function JA(A){if(!Number.isSafeInteger(A)||A<0)throw new Error("positive integer expected, got "+A)}function c(A,...j){if(!Uj(A))throw new Error("Uint8Array expected");if(j.length>0&&!j.includes(A.length))throw new Error("Uint8Array expected of length "+j+", got length="+A.length)}function pA(A,j=!0){if(A.destroyed)throw new Error("Hash instance has been destroyed");if(j&&A.finished)throw new Error("Hash#digest() has already been called")}function Hj(A,j){c(A);let n=j.outputLen;if(A.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function a(A){return new Uint32Array(A.buffer,A.byteOffset,Math.floor(A.byteLength/4))}function x(...A){for(let j=0;j<A.length;j++)A[j].fill(0)}function J6(A){return new DataView(A.buffer,A.byteOffset,A.byteLength)}var W6=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function X6(A){if(typeof A!=="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(A))}function WA(A){if(typeof A==="string")A=X6(A);else if(Uj(A))A=XA(A);else throw new Error("Uint8Array expected, got "+typeof A);return A}function Tj(A,j){if(j==null||typeof j!=="object")throw new Error("options must be defined");return Object.assign(A,j)}function Sj(A,j){if(A.length!==j.length)return!1;let n=0;for(let f=0;f<A.length;f++)n|=A[f]^j[f];return n===0}var aA=(A,j)=>{function n(f,...i){if(c(f),!W6)throw new Error("Non little-endian hardware is not yet supported");if(A.nonceLength!==void 0){let I=i[0];if(!I)throw new Error("nonce / iv required");if(A.varSizeNonce)c(I);else c(I,A.nonceLength)}let r=A.tagLength;if(r&&i[1]!==void 0)c(i[1]);let q=j(f,...i),v=(I,P)=>{if(P!==void 0){if(I!==2)throw new Error("cipher output not supported");c(P)}},k=!1;return{encrypt(I,P){if(k)throw new Error("cannot encrypt() twice with same key + nonce");return k=!0,c(I),v(q.encrypt.length,P),q.encrypt(I,P)},decrypt(I,P){if(c(I),r&&I.length<r)throw new Error("invalid ciphertext length: smaller than tagLength="+r);return v(q.decrypt.length,P),q.decrypt(I,P)}}}return Object.assign(n,A),n};function xA(A,j,n=!0){if(j===void 0)return new Uint8Array(A);if(j.length!==A)throw new Error("invalid output length, expected "+A+", got: "+j.length);if(n&&!Y6(j))throw new Error("invalid output, must be aligned");return j}function Bj(A,j,n,f){if(typeof A.setBigUint64==="function")return A.setBigUint64(j,n,f);let i=BigInt(32),r=BigInt(4294967295),q=Number(n>>i&r),v=Number(n&r),k=f?4:0,e=f?0:4;A.setUint32(j+k,q,f),A.setUint32(j+e,v,f)}function Oj(A,j,n){VA(n);let f=new Uint8Array(16),i=J6(f);return Bj(i,0,BigInt(j),n),Bj(i,8,BigInt(A),n),f}function Y6(A){return A.byteOffset%4===0}function XA(A){return Uint8Array.from(A)}var Nj=(A)=>Uint8Array.from(A.split("").map((j)=>j.charCodeAt(0))),Q6=Nj("expand 16-byte k"),D6=Nj("expand 32-byte k"),Z6=a(Q6),L6=a(D6);function R(A,j){return A<<j|A>>>32-j}function Aj(A){return A.byteOffset%4===0}var YA=64,C6=16,zj=4294967295,mj=new Uint32Array;function c6(A,j,n,f,i,r,q,v){let k=i.length,e=new Uint8Array(YA),I=a(e),P=Aj(i)&&Aj(r),g=P?a(i):mj,K=P?a(r):mj;for(let $=0;$<k;q++){if(A(j,n,f,I,q,v),q>=zj)throw new Error("arx: counter overflow");let F=Math.min(YA,k-$);if(P&&F===YA){let t=$/4;if($%4!==0)throw new Error("arx: invalid block position");for(let w=0,U;w<C6;w++)U=t+w,K[U]=g[U]^I[w];$+=YA;continue}for(let t=0,w;t<F;t++)w=$+t,r[w]=i[w]^e[t];$+=F}}function jj(A,j){let{allowShortKeys:n,extendNonceFn:f,counterLength:i,counterRight:r,rounds:q}=Tj({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},j);if(typeof A!=="function")throw new Error("core must be a function");return JA(i),JA(q),VA(r),VA(n),(v,k,e,I,P=0)=>{c(v),c(k),c(e);let g=e.length;if(I===void 0)I=new Uint8Array(g);if(c(I),JA(P),P<0||P>=zj)throw new Error("arx: counter overflow");if(I.length<g)throw new Error(`arx: output (${I.length}) is shorter than data (${g})`);let K=[],$=v.length,F,t;if($===32)K.push(F=XA(v)),t=L6;else if($===16&&n)F=new Uint8Array(32),F.set(v),F.set(v,16),t=Z6,K.push(F);else throw new Error(`arx: invalid 32-byte key, got length=${$}`);if(!Aj(k))K.push(k=XA(k));let w=a(F);if(f){if(k.length!==24)throw new Error("arx: extended nonce must be 24 bytes");f(t,w,a(k.subarray(0,16)),w),k=k.subarray(16)}let U=16-i;if(U!==k.length)throw new Error(`arx: nonce must be ${U} or 16 bytes`);if(U!==12){let Q=new Uint8Array(12);Q.set(k,r?0:12-k.length),k=Q,K.push(k)}let J=a(k);return c6(A,t,w,J,e,I,P,q),x(...K),I}}var C=(A,j)=>A[j++]&255|(A[j++]&255)<<8;class Vj{constructor(A){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,A=WA(A),c(A,32);let j=C(A,0),n=C(A,2),f=C(A,4),i=C(A,6),r=C(A,8),q=C(A,10),v=C(A,12),k=C(A,14);this.r[0]=j&8191,this.r[1]=(j>>>13|n<<3)&8191,this.r[2]=(n>>>10|f<<6)&7939,this.r[3]=(f>>>7|i<<9)&8191,this.r[4]=(i>>>4|r<<12)&255,this.r[5]=r>>>1&8190,this.r[6]=(r>>>14|q<<2)&8191,this.r[7]=(q>>>11|v<<5)&8065,this.r[8]=(v>>>8|k<<8)&8191,this.r[9]=k>>>5&127;for(let e=0;e<8;e++)this.pad[e]=C(A,16+2*e)}process(A,j,n=!1){let f=n?0:2048,{h:i,r}=this,q=r[0],v=r[1],k=r[2],e=r[3],I=r[4],P=r[5],g=r[6],K=r[7],$=r[8],F=r[9],t=C(A,j+0),w=C(A,j+2),U=C(A,j+4),J=C(A,j+6),Q=C(A,j+8),b=C(A,j+10),Z=C(A,j+12),L=C(A,j+14),S=i[0]+(t&8191),T=i[1]+((t>>>13|w<<3)&8191),B=i[2]+((w>>>10|U<<6)&8191),H=i[3]+((U>>>7|J<<9)&8191),O=i[4]+((J>>>4|Q<<12)&8191),_=i[5]+(Q>>>1&8191),X=i[6]+((Q>>>14|b<<2)&8191),N=i[7]+((b>>>11|Z<<5)&8191),W=i[8]+((Z>>>8|L<<8)&8191),V=i[9]+(L>>>5|f),G=0,z=G+S*q+T*(5*F)+B*(5*$)+H*(5*K)+O*(5*g);G=z>>>13,z&=8191,z+=_*(5*P)+X*(5*I)+N*(5*e)+W*(5*k)+V*(5*v),G+=z>>>13,z&=8191;let Y=G+S*v+T*q+B*(5*F)+H*(5*$)+O*(5*K);G=Y>>>13,Y&=8191,Y+=_*(5*g)+X*(5*P)+N*(5*I)+W*(5*e)+V*(5*k),G+=Y>>>13,Y&=8191;let D=G+S*k+T*v+B*q+H*(5*F)+O*(5*$);G=D>>>13,D&=8191,D+=_*(5*K)+X*(5*g)+N*(5*P)+W*(5*I)+V*(5*e),G+=D>>>13,D&=8191;let m=G+S*e+T*k+B*v+H*q+O*(5*F);G=m>>>13,m&=8191,m+=_*(5*$)+X*(5*K)+N*(5*g)+W*(5*P)+V*(5*I),G+=m>>>13,m&=8191;let u=G+S*I+T*e+B*k+H*v+O*q;G=u>>>13,u&=8191,u+=_*(5*F)+X*(5*$)+N*(5*K)+W*(5*g)+V*(5*P),G+=u>>>13,u&=8191;let AA=G+S*P+T*I+B*e+H*k+O*v;G=AA>>>13,AA&=8191,AA+=_*q+X*(5*F)+N*(5*$)+W*(5*K)+V*(5*g),G+=AA>>>13,AA&=8191;let o=G+S*g+T*P+B*I+H*e+O*k;G=o>>>13,o&=8191,o+=_*v+X*q+N*(5*F)+W*(5*$)+V*(5*K),G+=o>>>13,o&=8191;let h=G+S*K+T*g+B*P+H*I+O*e;G=h>>>13,h&=8191,h+=_*k+X*v+N*q+W*(5*F)+V*(5*$),G+=h>>>13,h&=8191;let IA=G+S*$+T*K+B*g+H*P+O*I;G=IA>>>13,IA&=8191,IA+=_*e+X*k+N*v+W*q+V*(5*F),G+=IA>>>13,IA&=8191;let eA=G+S*F+T*$+B*K+H*g+O*P;G=eA>>>13,eA&=8191,eA+=_*I+X*e+N*k+W*v+V*q,G+=eA>>>13,eA&=8191,G=(G<<2)+G|0,G=G+z|0,z=G&8191,G=G>>>13,Y+=G,i[0]=z,i[1]=Y,i[2]=D,i[3]=m,i[4]=u,i[5]=AA,i[6]=o,i[7]=h,i[8]=IA,i[9]=eA}finalize(){let{h:A,pad:j}=this,n=new Uint16Array(10),f=A[1]>>>13;A[1]&=8191;for(let q=2;q<10;q++)A[q]+=f,f=A[q]>>>13,A[q]&=8191;A[0]+=f*5,f=A[0]>>>13,A[0]&=8191,A[1]+=f,f=A[1]>>>13,A[1]&=8191,A[2]+=f,n[0]=A[0]+5,f=n[0]>>>13,n[0]&=8191;for(let q=1;q<10;q++)n[q]=A[q]+f,f=n[q]>>>13,n[q]&=8191;n[9]-=8192;let i=(f^1)-1;for(let q=0;q<10;q++)n[q]&=i;i=~i;for(let q=0;q<10;q++)A[q]=A[q]&i|n[q];A[0]=(A[0]|A[1]<<13)&65535,A[1]=(A[1]>>>3|A[2]<<10)&65535,A[2]=(A[2]>>>6|A[3]<<7)&65535,A[3]=(A[3]>>>9|A[4]<<4)&65535,A[4]=(A[4]>>>12|A[5]<<1|A[6]<<14)&65535,A[5]=(A[6]>>>2|A[7]<<11)&65535,A[6]=(A[7]>>>5|A[8]<<8)&65535,A[7]=(A[8]>>>8|A[9]<<5)&65535;let r=A[0]+j[0];A[0]=r&65535;for(let q=1;q<8;q++)r=(A[q]+j[q]|0)+(r>>>16)|0,A[q]=r&65535;x(n)}update(A){pA(this),A=WA(A),c(A);let{buffer:j,blockLen:n}=this,f=A.length;for(let i=0;i<f;){let r=Math.min(n-this.pos,f-i);if(r===n){for(;n<=f-i;i+=n)this.process(A,i);continue}if(j.set(A.subarray(i,i+r),this.pos),this.pos+=r,i+=r,this.pos===n)this.process(j,0,!1),this.pos=0}return this}destroy(){x(this.h,this.r,this.buffer,this.pad)}digestInto(A){pA(this),Hj(A,this),this.finished=!0;let{buffer:j,h:n}=this,{pos:f}=this;if(f){j[f++]=1;for(;f<16;f++)j[f]=0;this.process(j,0,!0)}this.finalize();let i=0;for(let r=0;r<8;r++)A[i++]=n[r]>>>0,A[i++]=n[r]>>>8;return A}digest(){let{buffer:A,outputLen:j}=this;this.digestInto(A);let n=A.slice(0,j);return this.destroy(),n}}function M6(A){let j=(f,i)=>A(i).update(WA(f)).digest(),n=A(new Uint8Array(32));return j.outputLen=n.outputLen,j.blockLen=n.blockLen,j.create=(f)=>A(f),j}var Jj=M6((A)=>new Vj(A));function Yj(A,j,n,f,i,r=20){let q=A[0],v=A[1],k=A[2],e=A[3],I=j[0],P=j[1],g=j[2],K=j[3],$=j[4],F=j[5],t=j[6],w=j[7],U=i,J=n[0],Q=n[1],b=n[2],Z=q,L=v,S=k,T=e,B=I,H=P,O=g,_=K,X=$,N=F,W=t,V=w,G=U,z=J,Y=Q,D=b;for(let u=0;u<r;u+=2)Z=Z+B|0,G=R(G^Z,16),X=X+G|0,B=R(B^X,12),Z=Z+B|0,G=R(G^Z,8),X=X+G|0,B=R(B^X,7),L=L+H|0,z=R(z^L,16),N=N+z|0,H=R(H^N,12),L=L+H|0,z=R(z^L,8),N=N+z|0,H=R(H^N,7),S=S+O|0,Y=R(Y^S,16),W=W+Y|0,O=R(O^W,12),S=S+O|0,Y=R(Y^S,8),W=W+Y|0,O=R(O^W,7),T=T+_|0,D=R(D^T,16),V=V+D|0,_=R(_^V,12),T=T+_|0,D=R(D^T,8),V=V+D|0,_=R(_^V,7),Z=Z+H|0,D=R(D^Z,16),W=W+D|0,H=R(H^W,12),Z=Z+H|0,D=R(D^Z,8),W=W+D|0,H=R(H^W,7),L=L+O|0,G=R(G^L,16),V=V+G|0,O=R(O^V,12),L=L+O|0,G=R(G^L,8),V=V+G|0,O=R(O^V,7),S=S+_|0,z=R(z^S,16),X=X+z|0,_=R(_^X,12),S=S+_|0,z=R(z^S,8),X=X+z|0,_=R(_^X,7),T=T+B|0,Y=R(Y^T,16),N=N+Y|0,B=R(B^N,12),T=T+B|0,Y=R(Y^T,8),N=N+Y|0,B=R(B^N,7);let m=0;f[m++]=q+Z|0,f[m++]=v+L|0,f[m++]=k+S|0,f[m++]=e+T|0,f[m++]=I+B|0,f[m++]=P+H|0,f[m++]=g+O|0,f[m++]=K+_|0,f[m++]=$+X|0,f[m++]=F+N|0,f[m++]=t+W|0,f[m++]=w+V|0,f[m++]=U+G|0,f[m++]=J+z|0,f[m++]=Q+Y|0,f[m++]=b+D|0}function l6(A,j,n,f){let i=A[0],r=A[1],q=A[2],v=A[3],k=j[0],e=j[1],I=j[2],P=j[3],g=j[4],K=j[5],$=j[6],F=j[7],t=n[0],w=n[1],U=n[2],J=n[3];for(let b=0;b<20;b+=2)i=i+k|0,t=R(t^i,16),g=g+t|0,k=R(k^g,12),i=i+k|0,t=R(t^i,8),g=g+t|0,k=R(k^g,7),r=r+e|0,w=R(w^r,16),K=K+w|0,e=R(e^K,12),r=r+e|0,w=R(w^r,8),K=K+w|0,e=R(e^K,7),q=q+I|0,U=R(U^q,16),$=$+U|0,I=R(I^$,12),q=q+I|0,U=R(U^q,8),$=$+U|0,I=R(I^$,7),v=v+P|0,J=R(J^v,16),F=F+J|0,P=R(P^F,12),v=v+P|0,J=R(J^v,8),F=F+J|0,P=R(P^F,7),i=i+e|0,J=R(J^i,16),$=$+J|0,e=R(e^$,12),i=i+e|0,J=R(J^i,8),$=$+J|0,e=R(e^$,7),r=r+I|0,t=R(t^r,16),F=F+t|0,I=R(I^F,12),r=r+I|0,t=R(t^r,8),F=F+t|0,I=R(I^F,7),q=q+P|0,w=R(w^q,16),g=g+w|0,P=R(P^g,12),q=q+P|0,w=R(w^q,8),g=g+w|0,P=R(P^g,7),v=v+k|0,U=R(U^v,16),K=K+U|0,k=R(k^K,12),v=v+k|0,U=R(U^v,8),K=K+U|0,k=R(k^K,7);let Q=0;f[Q++]=i,f[Q++]=r,f[Q++]=q,f[Q++]=v,f[Q++]=t,f[Q++]=w,f[Q++]=U,f[Q++]=J}var s6=jj(Yj,{counterRight:!1,counterLength:4,allowShortKeys:!1}),b6=jj(Yj,{counterRight:!1,counterLength:8,extendNonceFn:l6,allowShortKeys:!1});var u6=new Uint8Array(16),Wj=(A,j)=>{A.update(j);let n=j.length%16;if(n)A.update(u6.subarray(n))},y6=new Uint8Array(32);function Xj(A,j,n,f,i){let r=A(j,n,y6),q=Jj.create(r);if(i)Wj(q,i);Wj(q,f);let v=Oj(f.length,i?i.length:0,!0);q.update(v);let k=q.digest();return x(r,v),k}var Qj=(A)=>(j,n,f)=>{return{encrypt(r,q){let v=r.length;q=xA(v+16,q,!1),q.set(r);let k=q.subarray(0,-16);A(j,n,k,k,1);let e=Xj(A,j,n,k,f);return q.set(e,v),x(e),q},decrypt(r,q){q=xA(r.length-16,q,!1);let v=r.subarray(0,-16),k=r.subarray(-16),e=Xj(A,j,n,v,f);if(!Sj(k,e))throw new Error("invalid tag");return q.set(r.subarray(0,-16)),A(j,n,q,q,1),x(e),q}}},pn=aA({blockSize:64,nonceLength:12,tagLength:16},Qj(s6)),nj=aA({blockSize:64,nonceLength:24,tagLength:16},Qj(b6));class fj{p;key;constructor(A){this.p=A}async setKey(A){this.key=new Uint8Array(await this.p.subtle.exportKey("raw",A))}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(24)),f=nj(this.key,j).encrypt(A),i=new Uint8Array(j.length+f.length);return i.set(j,0),i.set(f,j.length),i}async decryptChunk(A){let j=A.slice(0,24),n=A.slice(24),f=nj(this.key,j);try{return f.decrypt(n)}catch{throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var MA=uA(K6(),1);async function g6(A,j,n,f){if(f==="node"){let i=await import("argon2"),r=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),q=Buffer.from(j),v=await i.hash(r,{salt:q,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:i.argon2id});return{hash:new Uint8Array(v)}}if(f==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>fetch("argon2.wasm").then((i)=>{if(!i.ok)throw new Error("Failed to load argon2.wasm");return i.arrayBuffer()}).then((i)=>new Uint8Array(i));return MA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:MA.ArgonType.Argon2id}).then((i)=>{if(!i||!i.hash)throw new Error("Failed to produce key derivation");return{hash:i.hash}}).catch((i)=>{let r=i instanceof Error?i.message:typeof i==="string"?i:"Unknown error";throw new nA(`argon2-browser failure: ${r}`)})}throw new Error(`Unsupported environment: ${f}`)}class lA{presets;exportExtractable;name="argon2id";constructor(A,j=!1){this.presets=A;this.exportExtractable=j}async derive(A,j,n,f){let{hash:i}=await g6(A,j,this.presets[n],f.isNode?"node":"browser");if(this.exportExtractable)return f.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);else return f.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var _6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},Xn={id:0,cipher:hA,kdf:new lA(_6),saltLengths:{low:12,high:16},difficulties:_6,defaultChunkSize:524288};M.register(Xn);var B6={low:{time:5,mem:65536,parallelism:2},middle:{time:10,mem:98304,parallelism:4},high:{time:20,mem:98304,parallelism:4}},Yn={id:1,cipher:fj,kdf:new lA(B6,!0),saltLengths:{low:12,high:16},difficulties:B6,defaultChunkSize:524288};M.register(Yn);var sA=1;function U6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!1}function SA(...A){let j=A.reduce((i,r)=>i+r.byteLength,0),n=new Uint8Array(j),f=0;for(let i of A)n.set(i,f),f+=i.byteLength;return n}function OA(...A){try{let j=SA(...A);if(U6())return Buffer.from(j).toString("base64");let n="";for(let f=0;f<j.length;f++)n+=String.fromCharCode(j[f]);return btoa(n)}catch(j){throw new dA("Base64 Enconding Error")}}function Pj(A){try{if(!/^[A-Za-z0-9+/]+={0,2}$/.test(A)||A.length%4!==0)throw new Error("invalid base64");if(U6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let f=0;f<j.length;f++)n[f]=j.charCodeAt(f);return n}catch(j){throw new PA("Base64 Decoding Error")}}function bA(A,j,n,f){let i={low:0,middle:1,high:2}[j]??0,r=A<<5|(n==="high"?1:0)<<2|i;return SA(new Uint8Array([sA,r]),f)}function $A(A){if(A[0]!==sA)throw new jA("Invalid input format. The input is unknown.");try{let j=A[1],n=j>>5,f=j>>2&1?"high":"low",i=j&3,r=["low","middle","high"][i],q=M.get(n).saltLengths[f],v=A.slice(2,2+q);return{version:n,difficulty:r,saltStrength:f,salt:v,headerLen:2+q}}catch(j){throw new FA(j instanceof Error?j.message:String(j))}}class mA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let f=0;while(n.length-f>=this.chunkSize){let i=n.slice(f,f+this.chunkSize);f+=this.chunkSize;let r=await this.engine.encryptChunk(i),q=new Uint8Array(4);new DataView(q.buffer).setUint32(0,r.length,!1);let v=new Uint8Array(4+r.length);v.set(q),v.set(r,q.length),j.enqueue(v)}this.buffer=n.slice(f)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let f=new Uint8Array(4+j.length);f.set(n),f.set(j,4),A.enqueue(f),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class tA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let f=0;while(!0){if(n.length-f<4)break;let i=new DataView(n.buffer,n.byteOffset+f,4).getUint32(0,!1);if(n.length-f-4<i)break;f+=4;let r=n.slice(f,f+i);f+=i;try{let q=await this.engine.decryptChunk(r);j.enqueue(q)}catch(q){throw q instanceof l?q:new l("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(f)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class RA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new mA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(i,r){if(j===0){r.enqueue(i);return}if(i.byteLength<=j){j-=i.byteLength;return}r.enqueue(i.slice(j)),j=0}}),f=new tA(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(f)}}async collect(A,j,n=null){let f=A.pipeThrough(j).getReader(),i=[];if(n?.length)i.push(n);while(!0){let{value:k,done:e}=await f.read();if(e)break;i.push(k)}let r=i.reduce((k,e)=>k+e.byteLength,0),q=new Uint8Array(r),v=0;for(let k of i)q.set(k,v),v+=k.byteLength;return q}}function H6(A=0,j=console.info){return{level:A,log(n,f){if(n<=A)j(`${n}| ${f}`)}}}var T6=new Map;class iA{static getEngine(A,j){let n=T6.get(j);if(n)return n;let f=M.get(j),i=new f.cipher(A),r=f.kdf,q=f.defaultChunkSize;return n={desc:f,cipher:i,kdf:r,chunkSize:q,provider:A},T6.set(j,n),n}static async deriveKey(A,j,n,f){try{let i=await A.kdf.derive(j,n,f,A.provider);await A.cipher.setKey(i)}catch(i){let r=i instanceof Error?i.message:String(i);throw new nA(r)}}}class rA{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=M.get(j.version??M.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new RA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=H6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await rA.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await rA.peekHeader(A),n=$A(j);return{version:n.version,difficulty:n.difficulty,salt:OA(n.salt),saltLength:n.salt.byteLength}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setScheme(A){this.v=M.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new RA(this.cipher,this.chunkSize)}getScheme(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){this.chunkSize=A,this.stream=new RA(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){try{this.log.log(1,`Start text encryption, scheme: ${this.getScheme()}`),this.log.log(2,"Deriving key for text encryption");let n=this.genSalt();await this.deriveKey(j,n),this.log.log(3,`Salt generated: ${OA(n)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let f=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.log.log(3,"Encoding header");let i=bA(this.v.id,this.difficulty,this.saltStrength,n);this.log.log(3,"Encoding text");let r=OA(i,f);return this.log.log(1,"Decryption finished"),r}catch(n){throw new zA(n instanceof Error?n.message:String(n))}}async decryptText(A,j){try{this.log.log(1,`Start text decryption, Version ${this.getScheme()}`),this.log.log(3,"Start text decoding");let n=Pj(A);this.log.log(3,"Start header decoding"),await rA.peekHeader(A);let f=$A(n);this.log.log(3,"Trying to get engine");let i=iA.getEngine(this.provider,f.version);this.log.log(2,`Deriving key via engine for scheme: ${f.version}`),this.log.log(3,`Salt use: ${OA(f.salt)}, KDF difficulty: ${f.difficulty}`),await iA.deriveKey(i,j,f.salt,f.difficulty),this.log.log(2,"Decrypting text data");let r=await i.cipher.decryptChunk(n.slice(f.headerLen));this.log.log(3,"Decoding text");let q=new TextDecoder().decode(r);return this.log.log(1,"Decryption finished"),q}catch(n){if(n instanceof l||n instanceof jA||n instanceof FA||n instanceof PA||n instanceof nA)throw n;throw new l("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){try{this.log.log(2,"Deriving key for file encryption");let n=this.genSalt();await this.deriveKey(j,n);let f=bA(this.v.id,this.difficulty,this.saltStrength,n),i=await this.stream.collect(A.stream(),new mA(this.cipher,this.chunkSize).toTransformStream(),f);return new Blob([i],{type:"application/octet-stream"})}catch(n){throw new zA(n instanceof Error?n.message:String(n))}}async decryptFile(A,j){try{let n=await rA.peekHeader(A),f=$A(n),i=iA.getEngine(this.provider,f.version);await iA.deriveKey(i,j,f.salt,f.difficulty),this.log.log(2,"Decrypting file data");let q=await new RA(i.cipher,i.chunkSize).collect(A.slice(f.headerLen).stream(),new tA(i.cipher,i.chunkSize).toTransformStream());return new Blob([q],{type:"application/octet-stream"})}catch(n){if(n instanceof l)throw n;throw new l(n instanceof Error?n.message:String(n))}}async createEncryptionStream(A){this.log.log(2,"Deriving key for stream encryption");let j=this.genSalt();await this.deriveKey(A,j);let n=bA(this.v.id,this.difficulty,this.saltStrength,j),f=this.stream.encryptionStream();return{header:n,writable:f.writable,readable:f.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),f=null;async function i(r,q){let v=r.getReader();while(!0){let{value:k,done:e}=await v.read();if(e)break;q.enqueue(k)}}return new TransformStream({async transform(r,q){if(!f){if(n=SA(n,r),n.length<2)return;let k=n.slice(0,30),{salt:e,difficulty:I}=$A(k),P=n[1]>>5,g=n[1]>>2&1?"high":"low",$=2+M.get(P).saltLengths[g];if(n.length<$)return;let F=iA.getEngine(j.provider,P);await iA.deriveKey(F,A,e,I),f=new tA(F.cipher,F.chunkSize).toTransformStream(),i(f.readable,q);let t=n.slice($);if(t.length){let w=f.writable.getWriter();await w.write(t),w.releaseLock()}return}let v=f.writable.getWriter();await v.write(r),v.releaseLock()},async flush(){if(f){let r=f.writable.getWriter();await r.close(),r.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let f=performance.now();try{let i=await this.kdf.derive(A,j,n,this.provider);await this.cipher.setKey(i),this.log.log(3,`Key derivation completed in ${(performance.now()-f).toFixed(1)} ms`)}catch(i){throw new nA(i instanceof Error?i.message:String(i))}}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}static async peekHeader(A){if(typeof A==="string")A=Pj(A);if(A instanceof Uint8Array){if(A.length<2)throw new jA("Input too short");let{headerLen:j}=$A(A.length>=16?A:Uint8Array.from(A));if(A.length<j)throw new jA("Incomplete header");return A.slice(0,j)}if(A instanceof Blob){let j=new Uint8Array(await A.slice(0,2).arrayBuffer());if(j[0]!==1)throw new jA("Invalid input format. The input is unknown.");let n=j[1],f=n>>5,i=n>>2&1?"high":"low",r=M.get(f).saltLengths[i],q=new Uint8Array(await A.slice(0,2+r).arrayBuffer());return $A(q),q}throw new FA("Unsupported input type")}}var S6={subtle:globalThis.crypto.subtle,getRandomValues(A){return globalThis.crypto.getRandomValues(A)},isNode:!1};function xf(A){return new rA(S6,A)}export{xf as createCryptit,rA as Cryptit};

//# debugId=82E332C06E11499264756E2164756E21
