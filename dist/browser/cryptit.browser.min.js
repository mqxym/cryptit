var Dn=Object.create;var{getPrototypeOf:zn,defineProperty:mA,getOwnPropertyNames:_j,getOwnPropertyDescriptor:Ln}=Object,Hj=Object.prototype.hasOwnProperty;var gA=(A,j,n)=>{n=A!=null?Dn(zn(A)):{};let f=j||!A||!A.__esModule?mA(n,"default",{value:A,enumerable:!0}):n;for(let i of _j(A))if(!Hj.call(f,i))mA(f,i,{get:()=>A[i],enumerable:!0});return f},Tj=new WeakMap,Oj=(A)=>{var j=Tj.get(A),n;if(j)return j;if(j=mA({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")_j(A).map((f)=>!Hj.call(j,f)&&mA(j,f,{get:()=>A[f],enumerable:!(n=Ln(A,f))||n.enumerable}));return Tj.set(A,j),j},Aj=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var en=(A,j)=>{for(var n in j)mA(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(f)=>j[n]=()=>f})};var Cn=(A,j)=>()=>(A&&(j=A(A=0)),j);var BA=((A)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(A,{get:(j,n)=>(typeof require!=="undefined"?require:j)[n]}):A)(function(A){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+A+'" is not supported')});var kj={};en(kj,{sep:()=>aj,resolve:()=>lA,relative:()=>yj,posix:()=>An,parse:()=>hj,normalize:()=>Ej,join:()=>lj,isAbsolute:()=>uj,format:()=>pj,extname:()=>dj,dirname:()=>sj,delimiter:()=>xj,default:()=>i6,basename:()=>oj,_makeLong:()=>bj});function h(A){if(typeof A!=="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(A))}function cj(A,j){var n="",f=0,i=-1,r=0,q;for(var v=0;v<=A.length;++v){if(v<A.length)q=A.charCodeAt(v);else if(q===47)break;else q=47;if(q===47){if(i===v-1||r===1);else if(i!==v-1&&r===2){if(n.length<2||f!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var k=n.lastIndexOf("/");if(k!==n.length-1){if(k===-1)n="",f=0;else n=n.slice(0,k),f=n.length-1-n.lastIndexOf("/");i=v,r=0;continue}}else if(n.length===2||n.length===1){n="",f=0,i=v,r=0;continue}}if(j){if(n.length>0)n+="/..";else n="..";f=2}}else{if(n.length>0)n+="/"+A.slice(i+1,v);else n=A.slice(i+1,v);f=v-i-1}i=v,r=0}else if(q===46&&r!==-1)++r;else r=-1}return n}function f6(A,j){var n=j.dir||j.root,f=j.base||(j.name||"")+(j.ext||"");if(!n)return f;if(n===j.root)return n+f;return n+A+f}function lA(){var A="",j=!1,n;for(var f=arguments.length-1;f>=-1&&!j;f--){var i;if(f>=0)i=arguments[f];else{if(n===void 0)n=process.cwd();i=n}if(h(i),i.length===0)continue;A=i+"/"+A,j=i.charCodeAt(0)===47}if(A=cj(A,!j),j)if(A.length>0)return"/"+A;else return"/";else if(A.length>0)return A;else return"."}function Ej(A){if(h(A),A.length===0)return".";var j=A.charCodeAt(0)===47,n=A.charCodeAt(A.length-1)===47;if(A=cj(A,!j),A.length===0&&!j)A=".";if(A.length>0&&n)A+="/";if(j)return"/"+A;return A}function uj(A){return h(A),A.length>0&&A.charCodeAt(0)===47}function lj(){if(arguments.length===0)return".";var A;for(var j=0;j<arguments.length;++j){var n=arguments[j];if(h(n),n.length>0)if(A===void 0)A=n;else A+="/"+n}if(A===void 0)return".";return Ej(A)}function yj(A,j){if(h(A),h(j),A===j)return"";if(A=lA(A),j=lA(j),A===j)return"";var n=1;for(;n<A.length;++n)if(A.charCodeAt(n)!==47)break;var f=A.length,i=f-n,r=1;for(;r<j.length;++r)if(j.charCodeAt(r)!==47)break;var q=j.length,v=q-r,k=i<v?i:v,U=-1,I=0;for(;I<=k;++I){if(I===k){if(v>k){if(j.charCodeAt(r+I)===47)return j.slice(r+I+1);else if(I===0)return j.slice(r+I)}else if(i>k){if(A.charCodeAt(n+I)===47)U=I;else if(I===0)U=0}break}var R=A.charCodeAt(n+I),g=j.charCodeAt(r+I);if(R!==g)break;else if(R===47)U=I}var K="";for(I=n+U+1;I<=f;++I)if(I===f||A.charCodeAt(I)===47)if(K.length===0)K+="..";else K+="/..";if(K.length>0)return K+j.slice(r+U);else{if(r+=U,j.charCodeAt(r)===47)++r;return j.slice(r)}}function bj(A){return A}function sj(A){if(h(A),A.length===0)return".";var j=A.charCodeAt(0),n=j===47,f=-1,i=!0;for(var r=A.length-1;r>=1;--r)if(j=A.charCodeAt(r),j===47){if(!i){f=r;break}}else i=!1;if(f===-1)return n?"/":".";if(n&&f===1)return"//";return A.slice(0,f)}function oj(A,j){if(j!==void 0&&typeof j!=="string")throw new TypeError('"ext" argument must be a string');h(A);var n=0,f=-1,i=!0,r;if(j!==void 0&&j.length>0&&j.length<=A.length){if(j.length===A.length&&j===A)return"";var q=j.length-1,v=-1;for(r=A.length-1;r>=0;--r){var k=A.charCodeAt(r);if(k===47){if(!i){n=r+1;break}}else{if(v===-1)i=!1,v=r+1;if(q>=0)if(k===j.charCodeAt(q)){if(--q===-1)f=r}else q=-1,f=v}}if(n===f)f=v;else if(f===-1)f=A.length;return A.slice(n,f)}else{for(r=A.length-1;r>=0;--r)if(A.charCodeAt(r)===47){if(!i){n=r+1;break}}else if(f===-1)i=!1,f=r+1;if(f===-1)return"";return A.slice(n,f)}}function dj(A){h(A);var j=-1,n=0,f=-1,i=!0,r=0;for(var q=A.length-1;q>=0;--q){var v=A.charCodeAt(q);if(v===47){if(!i){n=q+1;break}continue}if(f===-1)i=!1,f=q+1;if(v===46){if(j===-1)j=q;else if(r!==1)r=1}else if(j!==-1)r=-1}if(j===-1||f===-1||r===0||r===1&&j===f-1&&j===n+1)return"";return A.slice(j,f)}function pj(A){if(A===null||typeof A!=="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof A);return f6("/",A)}function hj(A){h(A);var j={root:"",dir:"",base:"",ext:"",name:""};if(A.length===0)return j;var n=A.charCodeAt(0),f=n===47,i;if(f)j.root="/",i=1;else i=0;var r=-1,q=0,v=-1,k=!0,U=A.length-1,I=0;for(;U>=i;--U){if(n=A.charCodeAt(U),n===47){if(!k){q=U+1;break}continue}if(v===-1)k=!1,v=U+1;if(n===46){if(r===-1)r=U;else if(I!==1)I=1}else if(r!==-1)I=-1}if(r===-1||v===-1||I===0||I===1&&r===v-1&&r===q+1){if(v!==-1)if(q===0&&f)j.base=j.name=A.slice(1,v);else j.base=j.name=A.slice(q,v)}else{if(q===0&&f)j.name=A.slice(1,r),j.base=A.slice(1,v);else j.name=A.slice(q,r),j.base=A.slice(q,v);j.ext=A.slice(r,v)}if(q>0)j.dir=A.slice(0,q-1);else if(f)j.dir="/";return j}var aj="/",xj=":",An,i6;var $j=Cn(()=>{An=((A)=>(A.posix=A,A))({resolve:lA,normalize:Ej,isAbsolute:uj,join:lj,relative:yj,_makeLong:bj,dirname:sj,basename:oj,extname:dj,format:pj,parse:hj,sep:aj,delimiter:xj,win32:null,posix:null}),i6=An});var mj=Aj((wf,FA)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",E=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},q6=E,HA={},rA;for(rA in E)if(E.hasOwnProperty(rA))HA[rA]=E[rA];var OA=[],qn="./this.program",Uj=function(A,j){throw j},oA=!1,$A=!1,Rj=!1,rn=!1;oA=typeof window==="object";$A=typeof importScripts==="function";Rj=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";rn=!oA&&!Rj&&!$A;var s="";function r6(A){if(E.locateFile)return E.locateFile(A,s);return s+A}var yA,wj,NA,v6,Ij,tj;if(Rj){if($A)s=($j(),Oj(kj)).dirname(s)+"/";else s=__dirname+"/";if(yA=function A(j,n){if(!Ij)Ij=(()=>({}));if(!tj)tj=($j(),Oj(kj));return j=tj.normalize(j),Ij.readFileSync(j,n?null:"utf8")},NA=function A(j){var n=yA(j,!0);if(!n.buffer)n=new Uint8Array(n);return jn(n.buffer),n},process.argv.length>1)qn=process.argv[1].replace(/\\/g,"/");if(OA=process.argv.slice(2),typeof FA!=="undefined")FA.exports=E;process.on("uncaughtException",function(A){if(!(A instanceof C6))throw A}),process.on("unhandledRejection",VA),Uj=function(A){process.exit(A)},E.inspect=function(){return"[Emscripten Module object]"}}else if(rn){if(typeof read!="undefined")yA=function A(j){return read(j)};if(NA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),jn(typeof n==="object"),n},typeof scriptArgs!="undefined")OA=scriptArgs;else if(typeof arguments!="undefined")OA=arguments;if(typeof quit==="function")Uj=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(oA||$A){if($A)s=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)s=document.currentScript.src;if(s.indexOf("blob:")!==0)s=s.substr(0,s.lastIndexOf("/")+1);else s="";{if(yA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},$A)NA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};wj=function(A,j,n){var f=new XMLHttpRequest;f.open("GET",A,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status==200||f.status==0&&f.response){j(f.response);return}n()},f.onerror=n,f.send(null)}}v6=function(A){document.title=A}}var tf=E.print||console.log.bind(console),_A=E.printErr||console.warn.bind(console);for(rA in HA)if(HA.hasOwnProperty(rA))E[rA]=HA[rA];HA=null;if(E.arguments)OA=E.arguments;if(E.thisProgram)qn=E.thisProgram;if(E.quit)Uj=E.quit;var WA;if(E.wasmBinary)WA=E.wasmBinary;var Ff=E.noExitRuntime||!0;if(typeof WebAssembly!=="object")VA("no native wasm support detected");var JA,vn=!1,E6;function jn(A,j){if(!A)VA("Assertion failed: "+j)}var k6=0,$6=1;function I6(A,j){var n;if(j==$6)n=Bn(A.length);else n=gn(A.length);if(A.subarray||A.slice)tA.set(A,n);else tA.set(new Uint8Array(A),n);return n}var nn=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function t6(A,j,n){var f=j+n,i=j;while(A[i]&&!(i>=f))++i;if(i-j>16&&A.subarray&&nn)return nn.decode(A.subarray(j,i));else{var r="";while(j<i){var q=A[j++];if(!(q&128)){r+=String.fromCharCode(q);continue}var v=A[j++]&63;if((q&224)==192){r+=String.fromCharCode((q&31)<<6|v);continue}var k=A[j++]&63;if((q&240)==224)q=(q&15)<<12|v<<6|k;else q=(q&7)<<18|v<<12|k<<6|A[j++]&63;if(q<65536)r+=String.fromCharCode(q);else{var U=q-65536;r+=String.fromCharCode(55296|U>>10,56320|U&1023)}}}return r}function F6(A,j){return A?t6(tA,A,j):""}function U6(A,j){if(A%j>0)A+=j-A%j;return A}var Pj,En,tA,kn,$n,In,tn,Fn,Un;function wn(A){Pj=A,E.HEAP8=En=new Int8Array(A),E.HEAP16=kn=new Int16Array(A),E.HEAP32=In=new Int32Array(A),E.HEAPU8=tA=new Uint8Array(A),E.HEAPU16=$n=new Uint16Array(A),E.HEAPU32=tn=new Uint32Array(A),E.HEAPF32=Fn=new Float32Array(A),E.HEAPF64=Un=new Float64Array(A)}var Uf=E.INITIAL_MEMORY||16777216,bA,Rn=[],Pn=[],Gn=[],w6=!1;function R6(){if(E.preRun){if(typeof E.preRun=="function")E.preRun=[E.preRun];while(E.preRun.length)K6(E.preRun.shift())}Gj(Rn)}function P6(){w6=!0,Gj(Pn)}function G6(){if(E.postRun){if(typeof E.postRun=="function")E.postRun=[E.postRun];while(E.postRun.length)g6(E.postRun.shift())}Gj(Gn)}function K6(A){Rn.unshift(A)}function m6(A){Pn.unshift(A)}function g6(A){Gn.unshift(A)}var IA=0,Fj=null,SA=null;function B6(A){if(IA++,E.monitorRunDependencies)E.monitorRunDependencies(IA)}function T6(A){if(IA--,E.monitorRunDependencies)E.monitorRunDependencies(IA);if(IA==0){if(Fj!==null)clearInterval(Fj),Fj=null;if(SA){var j=SA;SA=null,j()}}}E.preloadedImages={};E.preloadedAudios={};function VA(A){if(E.onAbort)E.onAbort(A);A+="",_A(A),vn=!0,E6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var _6="data:application/octet-stream;base64,";function Kn(A){return A.startsWith(_6)}function mn(A){return A.startsWith("file://")}var l="argon2.wasm";if(!Kn(l))l=r6(l);function fn(A){try{if(A==l&&WA)return new Uint8Array(WA);if(NA)return NA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){VA(j)}}function H6(){if(!WA&&(oA||$A)){if(typeof fetch==="function"&&!mn(l))return fetch(l,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+l+"'";return A.arrayBuffer()}).catch(function(){return fn(l)});else if(wj)return new Promise(function(A,j){wj(l,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return fn(l)})}function O6(){var A={a:J6};function j(q,v){var k=q.exports;E.asm=k,JA=E.asm.c,wn(JA.buffer),bA=E.asm.k,m6(E.asm.d),T6("wasm-instantiate")}B6("wasm-instantiate");function n(q){j(q.instance)}function f(q){return H6().then(function(v){var k=WebAssembly.instantiate(v,A);return k}).then(q,function(v){_A("failed to asynchronously prepare wasm: "+v),VA(v)})}function i(){if(!WA&&typeof WebAssembly.instantiateStreaming==="function"&&!Kn(l)&&!mn(l)&&typeof fetch==="function")return fetch(l,{credentials:"same-origin"}).then(function(q){var v=WebAssembly.instantiateStreaming(q,A);return v.then(n,function(k){return _A("wasm streaming compile failed: "+k),_A("falling back to ArrayBuffer instantiation"),f(n)})});else return f(n)}if(E.instantiateWasm)try{var r=E.instantiateWasm(A,j);return r}catch(q){return _A("Module.instantiateWasm callback failed with error: "+q),!1}return i(),{}}function Gj(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(E);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)bA.get(n)();else bA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function N6(A,j,n){tA.copyWithin(A,j,j+n)}function S6(A){try{return JA.grow(A-Pj.byteLength+65535>>>16),wn(JA.buffer),1}catch(j){}}function W6(A){var j=tA.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var f=1;f<=4;f*=2){var i=j*(1+0.2/f);i=Math.min(i,A+100663296);var r=Math.min(n,U6(Math.max(A,i),65536)),q=S6(r);if(q)return!0}return!1}var J6={a:N6,b:W6},V6=O6(),Q6=E.___wasm_call_ctors=function(){return(Q6=E.___wasm_call_ctors=E.asm.d).apply(null,arguments)},Y6=E._argon2_hash=function(){return(Y6=E._argon2_hash=E.asm.e).apply(null,arguments)},gn=E._malloc=function(){return(gn=E._malloc=E.asm.f).apply(null,arguments)},X6=E._free=function(){return(X6=E._free=E.asm.g).apply(null,arguments)},Z6=E._argon2_verify=function(){return(Z6=E._argon2_verify=E.asm.h).apply(null,arguments)},D6=E._argon2_error_message=function(){return(D6=E._argon2_error_message=E.asm.i).apply(null,arguments)},z6=E._argon2_encodedlen=function(){return(z6=E._argon2_encodedlen=E.asm.j).apply(null,arguments)},L6=E._argon2_hash_ext=function(){return(L6=E._argon2_hash_ext=E.asm.l).apply(null,arguments)},e6=E._argon2_verify_ext=function(){return(e6=E._argon2_verify_ext=E.asm.m).apply(null,arguments)},Bn=E.stackAlloc=function(){return(Bn=E.stackAlloc=E.asm.n).apply(null,arguments)};E.allocate=I6;E.UTF8ToString=F6;E.ALLOC_NORMAL=k6;var sA;function C6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}SA=function A(){if(!sA)Kj();if(!sA)SA=A};function Kj(A){if(A=A||OA,IA>0)return;if(R6(),IA>0)return;function j(){if(sA)return;if(sA=!0,E.calledRun=!0,vn)return;if(P6(),E.onRuntimeInitialized)E.onRuntimeInitialized();G6()}if(E.setStatus)E.setStatus("Running..."),setTimeout(function(){setTimeout(function(){E.setStatus("")},1),j()},1);else j()}E.run=Kj;if(E.preInit){if(typeof E.preInit=="function")E.preInit=[E.preInit];while(E.preInit.length>0)E.preInit.pop()()}Kj();if(typeof FA!=="undefined")FA.exports=E;E.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(E=q6=JA=bA=V6=Pj=En=tA=kn=$n=In=tn=Fn=Un=void 0,typeof FA!=="undefined")delete FA.exports}});var Tn=Aj((Rf,M6)=>{M6.exports="./argon2.wasm"});var Hn=Aj((_n,dA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof dA==="object"&&dA.exports)dA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:_n,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n($){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let t;if(A.process&&A.process.versions&&A.process.versions.node)t=i().then((F)=>new Promise((P)=>{F.postRun=()=>P(F)}));else t=r().then((F)=>{let P=$?v($):void 0;return f(F,P)});return n._promise=t,t.then((F)=>{return n._module=F,delete n._promise,F})}function f($,t){return new Promise((F)=>{return A.Module={wasmBinary:$,wasmMemory:t,postRun(){F(Module)}},i()})}function i(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(mj())}function r(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(Tn()).then((t)=>{return q(t)})}function q($){let t=atob($),F=new Uint8Array(new ArrayBuffer(t.length));for(let P=0;P<t.length;P++)F[P]=t.charCodeAt(P);return F}function v($){let D=Math.min(Math.max(Math.ceil($*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:D,maximum:32767})}function k($,t){return $.allocate(t,"i8",$.ALLOC_NORMAL)}function U($,t){let F=new Uint8Array([...t,0]);return k($,F)}function I($){if(typeof $!=="string")return $;if(typeof TextEncoder==="function")return new TextEncoder().encode($);else if(typeof Buffer==="function")return Buffer.from($);else throw new Error("Don't know how to encode UTF8")}function R($){let t=$.mem||1024;return n(t).then((F)=>{let P=$.time||1,m=$.parallelism||1,Q=I($.pass),D=U(F,Q),y=Q.length,L=I($.salt),e=U(F,L),O=L.length,H=$.type||j.Argon2d,T=F.allocate(new Array($.hashLen||24),"i8",F.ALLOC_NORMAL),_=$.secret?k(F,$.secret):0,N=$.secret?$.secret.byteLength:0,B=$.ad?k(F,$.ad):0,X=$.ad?$.ad.byteLength:0,W=$.hashLen||24,Y=F._argon2_encodedlen(P,t,m,O,W,H),V=F.allocate(new Array(Y+1),"i8",F.ALLOC_NORMAL),G=19,J,Z;try{Z=F._argon2_hash_ext(P,t,m,D,y,e,O,T,W,V,Y,H,_,N,B,X,19)}catch(S){J=S}let z;if(Z===0&&!J){let S="",b=new Uint8Array(W);for(let o=0;o<W;o++){let a=F.HEAP8[T+o];b[o]=a,S+=("0"+(255&a).toString(16)).slice(-2)}let qA=F.UTF8ToString(V);z={hash:b,hashHex:S,encoded:qA}}else{try{if(!J)J=F.UTF8ToString(F._argon2_error_message(Z))}catch(S){}z={message:J,code:Z}}try{if(F._free(D),F._free(e),F._free(T),F._free(V),B)F._free(B);if(_)F._free(_)}catch(S){}if(J)throw z;else return z})}function g($){return n().then((t)=>{let F=I($.pass),P=U(t,F),m=F.length,Q=$.secret?k(t,$.secret):0,D=$.secret?$.secret.byteLength:0,y=$.ad?k(t,$.ad):0,L=$.ad?$.ad.byteLength:0,e=I($.encoded),O=U(t,e),H=$.type;if(H===void 0){let B=$.encoded.split("$")[1];if(B)B=B.replace("a","A"),H=j[B]||j.Argon2d}let T,_;try{_=t._argon2_verify_ext(O,P,m,Q,D,y,L,H)}catch(B){T=B}let N;if(_||T){try{if(!T)T=t.UTF8ToString(t._argon2_error_message(_))}catch(B){}N={message:T,code:_}}try{t._free(P),t._free(O)}catch(B){}if(T)throw N;else return N})}function K(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:R,verify:g,unloadRuntime:K}})});class x extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class p extends x{}class TA extends x{}class jj extends x{}class zA extends x{}class PA extends x{}class AA extends x{}class LA extends x{}class u extends x{}class c{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new zA(`Scheme ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new zA(`Unknown scheme: ${A}`);return j}static get current(){return this.get(0)}}class EA{p;static IV_LENGTH=12;IV_LENGTH=EA.IV_LENGTH;key;constructor(A){this.p=A}async setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(EA.IV_LENGTH)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A));A.fill(0);let f=new Uint8Array(j.length+n.length);return f.set(j),f.set(n,j.length),f}async decryptChunk(A){let j=A.slice(0,EA.IV_LENGTH),n=A.slice(EA.IV_LENGTH);try{let f=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(f)}catch{throw new u("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){}}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Sj(A){return A instanceof Uint8Array||ArrayBuffer.isView(A)&&A.constructor.name==="Uint8Array"}function eA(A){if(typeof A!=="boolean")throw new Error(`boolean expected, not ${A}`)}function CA(A){if(!Number.isSafeInteger(A)||A<0)throw new Error("positive integer expected, got "+A)}function M(A,...j){if(!Sj(A))throw new Error("Uint8Array expected");if(j.length>0&&!j.includes(A.length))throw new Error("Uint8Array expected of length "+j+", got length="+A.length)}function nj(A,j=!0){if(A.destroyed)throw new Error("Hash instance has been destroyed");if(j&&A.finished)throw new Error("Hash#digest() has already been called")}function Wj(A,j){M(A);let n=j.outputLen;if(A.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function jA(A){return new Uint32Array(A.buffer,A.byteOffset,Math.floor(A.byteLength/4))}function nA(...A){for(let j=0;j<A.length;j++)A[j].fill(0)}function Mn(A){return new DataView(A.buffer,A.byteOffset,A.byteLength)}var cn=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function un(A){if(typeof A!=="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(A))}function MA(A){if(typeof A==="string")A=un(A);else if(Sj(A))A=cA(A);else throw new Error("Uint8Array expected, got "+typeof A);return A}function Jj(A,j){if(j==null||typeof j!=="object")throw new Error("options must be defined");return Object.assign(A,j)}function Vj(A,j){if(A.length!==j.length)return!1;let n=0;for(let f=0;f<A.length;f++)n|=A[f]^j[f];return n===0}var fj=(A,j)=>{function n(f,...i){if(M(f),!cn)throw new Error("Non little-endian hardware is not yet supported");if(A.nonceLength!==void 0){let I=i[0];if(!I)throw new Error("nonce / iv required");if(A.varSizeNonce)M(I);else M(I,A.nonceLength)}let r=A.tagLength;if(r&&i[1]!==void 0)M(i[1]);let q=j(f,...i),v=(I,R)=>{if(R!==void 0){if(I!==2)throw new Error("cipher output not supported");M(R)}},k=!1;return{encrypt(I,R){if(k)throw new Error("cannot encrypt() twice with same key + nonce");return k=!0,M(I),v(q.encrypt.length,R),q.encrypt(I,R)},decrypt(I,R){if(M(I),r&&I.length<r)throw new Error("invalid ciphertext length: smaller than tagLength="+r);return v(q.decrypt.length,R),q.decrypt(I,R)}}}return Object.assign(n,A),n};function ij(A,j,n=!0){if(j===void 0)return new Uint8Array(A);if(j.length!==A)throw new Error("invalid output length, expected "+A+", got: "+j.length);if(n&&!ln(j))throw new Error("invalid output, must be aligned");return j}function Nj(A,j,n,f){if(typeof A.setBigUint64==="function")return A.setBigUint64(j,n,f);let i=BigInt(32),r=BigInt(4294967295),q=Number(n>>i&r),v=Number(n&r),k=f?4:0,U=f?0:4;A.setUint32(j+k,q,f),A.setUint32(j+U,v,f)}function Qj(A,j,n){eA(n);let f=new Uint8Array(16),i=Mn(f);return Nj(i,0,BigInt(j),n),Nj(i,8,BigInt(A),n),f}function ln(A){return A.byteOffset%4===0}function cA(A){return Uint8Array.from(A)}var Xj=(A)=>Uint8Array.from(A.split("").map((j)=>j.charCodeAt(0))),yn=Xj("expand 16-byte k"),bn=Xj("expand 32-byte k"),sn=jA(yn),on=jA(bn);function w(A,j){return A<<j|A>>>32-j}function qj(A){return A.byteOffset%4===0}var uA=64,dn=16,Zj=4294967295,Yj=new Uint32Array;function pn(A,j,n,f,i,r,q,v){let k=i.length,U=new Uint8Array(uA),I=jA(U),R=qj(i)&&qj(r),g=R?jA(i):Yj,K=R?jA(r):Yj;for(let $=0;$<k;q++){if(A(j,n,f,I,q,v),q>=Zj)throw new Error("arx: counter overflow");let t=Math.min(uA,k-$);if(R&&t===uA){let F=$/4;if($%4!==0)throw new Error("arx: invalid block position");for(let P=0,m;P<dn;P++)m=F+P,K[m]=g[m]^I[P];$+=uA;continue}for(let F=0,P;F<t;F++)P=$+F,r[P]=i[P]^U[F];$+=t}}function rj(A,j){let{allowShortKeys:n,extendNonceFn:f,counterLength:i,counterRight:r,rounds:q}=Jj({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},j);if(typeof A!=="function")throw new Error("core must be a function");return CA(i),CA(q),eA(r),eA(n),(v,k,U,I,R=0)=>{M(v),M(k),M(U);let g=U.length;if(I===void 0)I=new Uint8Array(g);if(M(I),CA(R),R<0||R>=Zj)throw new Error("arx: counter overflow");if(I.length<g)throw new Error(`arx: output (${I.length}) is shorter than data (${g})`);let K=[],$=v.length,t,F;if($===32)K.push(t=cA(v)),F=on;else if($===16&&n)t=new Uint8Array(32),t.set(v),t.set(v,16),F=sn,K.push(t);else throw new Error(`arx: invalid 32-byte key, got length=${$}`);if(!qj(k))K.push(k=cA(k));let P=jA(t);if(f){if(k.length!==24)throw new Error("arx: extended nonce must be 24 bytes");f(F,P,jA(k.subarray(0,16)),P),k=k.subarray(16)}let m=16-i;if(m!==k.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(m!==12){let D=new Uint8Array(12);D.set(k,r?0:12-k.length),k=D,K.push(k)}let Q=jA(k);return pn(A,F,P,Q,U,I,R,q),nA(...K),I}}var C=(A,j)=>A[j++]&255|(A[j++]&255)<<8;class Dj{constructor(A){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,A=MA(A),M(A,32);let j=C(A,0),n=C(A,2),f=C(A,4),i=C(A,6),r=C(A,8),q=C(A,10),v=C(A,12),k=C(A,14);this.r[0]=j&8191,this.r[1]=(j>>>13|n<<3)&8191,this.r[2]=(n>>>10|f<<6)&7939,this.r[3]=(f>>>7|i<<9)&8191,this.r[4]=(i>>>4|r<<12)&255,this.r[5]=r>>>1&8190,this.r[6]=(r>>>14|q<<2)&8191,this.r[7]=(q>>>11|v<<5)&8065,this.r[8]=(v>>>8|k<<8)&8191,this.r[9]=k>>>5&127;for(let U=0;U<8;U++)this.pad[U]=C(A,16+2*U)}process(A,j,n=!1){let f=n?0:2048,{h:i,r}=this,q=r[0],v=r[1],k=r[2],U=r[3],I=r[4],R=r[5],g=r[6],K=r[7],$=r[8],t=r[9],F=C(A,j+0),P=C(A,j+2),m=C(A,j+4),Q=C(A,j+6),D=C(A,j+8),y=C(A,j+10),L=C(A,j+12),e=C(A,j+14),O=i[0]+(F&8191),H=i[1]+((F>>>13|P<<3)&8191),T=i[2]+((P>>>10|m<<6)&8191),_=i[3]+((m>>>7|Q<<9)&8191),N=i[4]+((Q>>>4|D<<12)&8191),B=i[5]+(D>>>1&8191),X=i[6]+((D>>>14|y<<2)&8191),W=i[7]+((y>>>11|L<<5)&8191),Y=i[8]+((L>>>8|e<<8)&8191),V=i[9]+(e>>>5|f),G=0,J=G+O*q+H*(5*t)+T*(5*$)+_*(5*K)+N*(5*g);G=J>>>13,J&=8191,J+=B*(5*R)+X*(5*I)+W*(5*U)+Y*(5*k)+V*(5*v),G+=J>>>13,J&=8191;let Z=G+O*v+H*q+T*(5*t)+_*(5*$)+N*(5*K);G=Z>>>13,Z&=8191,Z+=B*(5*g)+X*(5*R)+W*(5*I)+Y*(5*U)+V*(5*k),G+=Z>>>13,Z&=8191;let z=G+O*k+H*v+T*q+_*(5*t)+N*(5*$);G=z>>>13,z&=8191,z+=B*(5*K)+X*(5*g)+W*(5*R)+Y*(5*I)+V*(5*U),G+=z>>>13,z&=8191;let S=G+O*U+H*k+T*v+_*q+N*(5*t);G=S>>>13,S&=8191,S+=B*(5*$)+X*(5*K)+W*(5*g)+Y*(5*R)+V*(5*I),G+=S>>>13,S&=8191;let b=G+O*I+H*U+T*k+_*v+N*q;G=b>>>13,b&=8191,b+=B*(5*t)+X*(5*$)+W*(5*K)+Y*(5*g)+V*(5*R),G+=b>>>13,b&=8191;let qA=G+O*R+H*I+T*U+_*k+N*v;G=qA>>>13,qA&=8191,qA+=B*q+X*(5*t)+W*(5*$)+Y*(5*K)+V*(5*g),G+=qA>>>13,qA&=8191;let o=G+O*g+H*R+T*I+_*U+N*k;G=o>>>13,o&=8191,o+=B*v+X*q+W*(5*t)+Y*(5*$)+V*(5*K),G+=o>>>13,o&=8191;let a=G+O*K+H*g+T*R+_*I+N*U;G=a>>>13,a&=8191,a+=B*k+X*v+W*q+Y*(5*t)+V*(5*$),G+=a>>>13,a&=8191;let wA=G+O*$+H*K+T*g+_*R+N*I;G=wA>>>13,wA&=8191,wA+=B*U+X*k+W*v+Y*q+V*(5*t),G+=wA>>>13,wA&=8191;let RA=G+O*t+H*$+T*K+_*g+N*R;G=RA>>>13,RA&=8191,RA+=B*I+X*U+W*k+Y*v+V*q,G+=RA>>>13,RA&=8191,G=(G<<2)+G|0,G=G+J|0,J=G&8191,G=G>>>13,Z+=G,i[0]=J,i[1]=Z,i[2]=z,i[3]=S,i[4]=b,i[5]=qA,i[6]=o,i[7]=a,i[8]=wA,i[9]=RA}finalize(){let{h:A,pad:j}=this,n=new Uint16Array(10),f=A[1]>>>13;A[1]&=8191;for(let q=2;q<10;q++)A[q]+=f,f=A[q]>>>13,A[q]&=8191;A[0]+=f*5,f=A[0]>>>13,A[0]&=8191,A[1]+=f,f=A[1]>>>13,A[1]&=8191,A[2]+=f,n[0]=A[0]+5,f=n[0]>>>13,n[0]&=8191;for(let q=1;q<10;q++)n[q]=A[q]+f,f=n[q]>>>13,n[q]&=8191;n[9]-=8192;let i=(f^1)-1;for(let q=0;q<10;q++)n[q]&=i;i=~i;for(let q=0;q<10;q++)A[q]=A[q]&i|n[q];A[0]=(A[0]|A[1]<<13)&65535,A[1]=(A[1]>>>3|A[2]<<10)&65535,A[2]=(A[2]>>>6|A[3]<<7)&65535,A[3]=(A[3]>>>9|A[4]<<4)&65535,A[4]=(A[4]>>>12|A[5]<<1|A[6]<<14)&65535,A[5]=(A[6]>>>2|A[7]<<11)&65535,A[6]=(A[7]>>>5|A[8]<<8)&65535,A[7]=(A[8]>>>8|A[9]<<5)&65535;let r=A[0]+j[0];A[0]=r&65535;for(let q=1;q<8;q++)r=(A[q]+j[q]|0)+(r>>>16)|0,A[q]=r&65535;nA(n)}update(A){nj(this),A=MA(A),M(A);let{buffer:j,blockLen:n}=this,f=A.length;for(let i=0;i<f;){let r=Math.min(n-this.pos,f-i);if(r===n){for(;n<=f-i;i+=n)this.process(A,i);continue}if(j.set(A.subarray(i,i+r),this.pos),this.pos+=r,i+=r,this.pos===n)this.process(j,0,!1),this.pos=0}return this}destroy(){nA(this.h,this.r,this.buffer,this.pad)}digestInto(A){nj(this),Wj(A,this),this.finished=!0;let{buffer:j,h:n}=this,{pos:f}=this;if(f){j[f++]=1;for(;f<16;f++)j[f]=0;this.process(j,0,!0)}this.finalize();let i=0;for(let r=0;r<8;r++)A[i++]=n[r]>>>0,A[i++]=n[r]>>>8;return A}digest(){let{buffer:A,outputLen:j}=this;this.digestInto(A);let n=A.slice(0,j);return this.destroy(),n}}function hn(A){let j=(f,i)=>A(i).update(MA(f)).digest(),n=A(new Uint8Array(32));return j.outputLen=n.outputLen,j.blockLen=n.blockLen,j.create=(f)=>A(f),j}var zj=hn((A)=>new Dj(A));function Cj(A,j,n,f,i,r=20){let q=A[0],v=A[1],k=A[2],U=A[3],I=j[0],R=j[1],g=j[2],K=j[3],$=j[4],t=j[5],F=j[6],P=j[7],m=i,Q=n[0],D=n[1],y=n[2],L=q,e=v,O=k,H=U,T=I,_=R,N=g,B=K,X=$,W=t,Y=F,V=P,G=m,J=Q,Z=D,z=y;for(let b=0;b<r;b+=2)L=L+T|0,G=w(G^L,16),X=X+G|0,T=w(T^X,12),L=L+T|0,G=w(G^L,8),X=X+G|0,T=w(T^X,7),e=e+_|0,J=w(J^e,16),W=W+J|0,_=w(_^W,12),e=e+_|0,J=w(J^e,8),W=W+J|0,_=w(_^W,7),O=O+N|0,Z=w(Z^O,16),Y=Y+Z|0,N=w(N^Y,12),O=O+N|0,Z=w(Z^O,8),Y=Y+Z|0,N=w(N^Y,7),H=H+B|0,z=w(z^H,16),V=V+z|0,B=w(B^V,12),H=H+B|0,z=w(z^H,8),V=V+z|0,B=w(B^V,7),L=L+_|0,z=w(z^L,16),Y=Y+z|0,_=w(_^Y,12),L=L+_|0,z=w(z^L,8),Y=Y+z|0,_=w(_^Y,7),e=e+N|0,G=w(G^e,16),V=V+G|0,N=w(N^V,12),e=e+N|0,G=w(G^e,8),V=V+G|0,N=w(N^V,7),O=O+B|0,J=w(J^O,16),X=X+J|0,B=w(B^X,12),O=O+B|0,J=w(J^O,8),X=X+J|0,B=w(B^X,7),H=H+T|0,Z=w(Z^H,16),W=W+Z|0,T=w(T^W,12),H=H+T|0,Z=w(Z^H,8),W=W+Z|0,T=w(T^W,7);let S=0;f[S++]=q+L|0,f[S++]=v+e|0,f[S++]=k+O|0,f[S++]=U+H|0,f[S++]=I+T|0,f[S++]=R+_|0,f[S++]=g+N|0,f[S++]=K+B|0,f[S++]=$+X|0,f[S++]=t+W|0,f[S++]=F+Y|0,f[S++]=P+V|0,f[S++]=m+G|0,f[S++]=Q+J|0,f[S++]=D+Z|0,f[S++]=y+z|0}function an(A,j,n,f){let i=A[0],r=A[1],q=A[2],v=A[3],k=j[0],U=j[1],I=j[2],R=j[3],g=j[4],K=j[5],$=j[6],t=j[7],F=n[0],P=n[1],m=n[2],Q=n[3];for(let y=0;y<20;y+=2)i=i+k|0,F=w(F^i,16),g=g+F|0,k=w(k^g,12),i=i+k|0,F=w(F^i,8),g=g+F|0,k=w(k^g,7),r=r+U|0,P=w(P^r,16),K=K+P|0,U=w(U^K,12),r=r+U|0,P=w(P^r,8),K=K+P|0,U=w(U^K,7),q=q+I|0,m=w(m^q,16),$=$+m|0,I=w(I^$,12),q=q+I|0,m=w(m^q,8),$=$+m|0,I=w(I^$,7),v=v+R|0,Q=w(Q^v,16),t=t+Q|0,R=w(R^t,12),v=v+R|0,Q=w(Q^v,8),t=t+Q|0,R=w(R^t,7),i=i+U|0,Q=w(Q^i,16),$=$+Q|0,U=w(U^$,12),i=i+U|0,Q=w(Q^i,8),$=$+Q|0,U=w(U^$,7),r=r+I|0,F=w(F^r,16),t=t+F|0,I=w(I^t,12),r=r+I|0,F=w(F^r,8),t=t+F|0,I=w(I^t,7),q=q+R|0,P=w(P^q,16),g=g+P|0,R=w(R^g,12),q=q+R|0,P=w(P^q,8),g=g+P|0,R=w(R^g,7),v=v+k|0,m=w(m^v,16),K=K+m|0,k=w(k^K,12),v=v+k|0,m=w(m^v,8),K=K+m|0,k=w(k^K,7);let D=0;f[D++]=i,f[D++]=r,f[D++]=q,f[D++]=v,f[D++]=F,f[D++]=P,f[D++]=m,f[D++]=Q}var xn=rj(Cj,{counterRight:!1,counterLength:4,allowShortKeys:!1}),A6=rj(Cj,{counterRight:!1,counterLength:8,extendNonceFn:an,allowShortKeys:!1});var j6=new Uint8Array(16),Lj=(A,j)=>{A.update(j);let n=j.length%16;if(n)A.update(j6.subarray(n))},n6=new Uint8Array(32);function ej(A,j,n,f,i){let r=A(j,n,n6),q=zj.create(r);if(i)Lj(q,i);Lj(q,f);let v=Qj(f.length,i?i.length:0,!0);q.update(v);let k=q.digest();return nA(r,v),k}var Mj=(A)=>(j,n,f)=>{return{encrypt(r,q){let v=r.length;q=ij(v+16,q,!1),q.set(r);let k=q.subarray(0,-16);A(j,n,k,k,1);let U=ej(A,j,n,k,f);return q.set(U,v),nA(U),q},decrypt(r,q){q=ij(r.length-16,q,!1);let v=r.subarray(0,-16),k=r.subarray(-16),U=ej(A,j,n,v,f);if(!Vj(k,U))throw new Error("invalid tag");return q.set(r.subarray(0,-16)),A(j,n,q,q,1),nA(U),q}}},vf=fj({blockSize:64,nonceLength:12,tagLength:16},Mj(xn)),vj=fj({blockSize:64,nonceLength:24,tagLength:16},Mj(A6));class kA{p;static IV_LENGTH=24;IV_LENGTH=kA.IV_LENGTH;key;constructor(A){this.p=A}async setKey(A){this.key=new Uint8Array(await this.p.subtle.exportKey("raw",A))}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(kA.IV_LENGTH)),f=vj(this.key,j).encrypt(A);A.fill(0);let i=new Uint8Array(j.length+f.length);return i.set(j,0),i.set(f,j.length),i}async decryptChunk(A){let j=A.slice(0,kA.IV_LENGTH),n=A.slice(kA.IV_LENGTH),f=vj(this.key,j);try{return f.decrypt(n)}catch{throw new u("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){this.key.fill(0)}}var pA=gA(Hn(),1);async function c6(){if(typeof window!=="undefined")return;if(globalThis.loadArgon2WasmModule)return;try{let{createRequire:A}=await import("node:module"),{readFile:j}=await import("node:fs/promises"),n=A(import.meta.url),f=n.resolve("argon2-browser/dist/argon2.js"),i=n.resolve("argon2-browser/dist/argon2.wasm");globalThis.loadArgon2WasmModule=async()=>{let r=new Uint8Array(await j(i));return globalThis.Module={wasmBinary:r,locateFile:(q)=>q==="argon2.wasm"?i:q},n(f)}}catch{}}async function On(A,j,n,f){if(f==="node"){let i=await import("argon2"),r=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),q=Buffer.from(j),v=await i.hash(r,{salt:q,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:i.argon2id});return q.fill(0),r.fill(0),{hash:new Uint8Array(v)}}if(f==="browser")return await c6(),pA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:pA.ArgonType.Argon2id}).then((i)=>{if(!i||!i.hash)throw new AA("Failed to produce key derivation");return{hash:i.hash}}).catch((i)=>{let r=i instanceof Error?i.message:typeof i==="string"?i:"Unknown error";throw new AA(`argon2-browser failure: ${r}`)});throw new Error(`Unsupported environment: ${f}`)}class hA{presets;exportExtractable;name="argon2id";constructor(A,j=!1){this.presets=A;this.exportExtractable=j}async derive(A,j,n,f){let{hash:i}=await On(A,j,this.presets[n],f.isNode?"node":"browser");if(this.exportExtractable)return f.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);else return f.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var Nn={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},u6={id:0,cipher:EA,kdf:new hA(Nn),saltLengths:{low:12,high:16},difficulties:Nn,defaultChunkSize:524288};c.register(u6);var Sn={low:{time:5,mem:65536,parallelism:2},middle:{time:10,mem:98304,parallelism:4},high:{time:20,mem:98304,parallelism:4}},l6={id:1,cipher:kA,kdf:new hA(Sn,!0),saltLengths:{low:12,high:16},difficulties:Sn,defaultChunkSize:524288};c.register(l6);var aA=1;function Wn(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!1}function QA(...A){let j=A.reduce((i,r)=>i+r.byteLength,0),n=new Uint8Array(j),f=0;for(let i of A)n.set(i,f),f+=i.byteLength;return n}function YA(...A){try{let j=QA(...A);if(Wn())return Buffer.from(j).toString("base64");let n="";for(let f=0;f<j.length;f++)n+=String.fromCharCode(j[f]);return btoa(n)}catch{throw new jj("Base64 Encoding Error")}}function XA(A){try{if(!/^[A-Za-z0-9+/]+={0,2}$/.test(A)||A.length%4!==0)throw new Error("Invalid Base64");if(Wn())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let f=0;f<j.length;f++)n[f]=j.charCodeAt(f);return n}catch{throw new TA(`Invalid Base64: length=${A.length}, content='${A.slice(0,12)}…'`)}}function d(A){let j=A.value.length,n=new Array(j).fill("\x00").join("");A.value=n}function ZA(A,j,n,f){let i={low:0,middle:1,high:2};if(!(j in i))throw new TypeError(`Unsupported difficulty: ${j}`);let r=i[j],q=A<<5|(n==="high"?1:0)<<2|r;return QA(new Uint8Array([aA,q]),f)}function UA(A){if(A[0]!==aA)throw new p("Invalid input format. The input is unknown.");if(A.length<14)throw new p("Invalid input format. Header too short.");try{let j=A[1],n=j>>5,f=j>>2&1?"high":"low",i=j&3,r=["low","middle","high"][i],q=c.get(n).saltLengths[f],v=A.slice(2,2+q);return{scheme:n,difficulty:r,saltStrength:f,salt:v,headerLen:2+q}}catch(j){throw new PA(j instanceof Error?j.message:String(j))}}async function xA(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}function gj(A){let j=new Uint8Array(4);return new DataView(j.buffer).setUint32(0,A,!1),j}function Jn(A,j=0){if(A.length-j<4)throw new RangeError("Not enough bytes for frame header");return new DataView(A.buffer,A.byteOffset+j,4).getUint32(0,!1)}var fA=4;class DA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await xA(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){if(A.length>this.chunkSize*4)throw new RangeError(`Input block (${A.length} B) exceeds sane limit`);let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let f=0;while(n.length-f>=this.chunkSize){let i=n.slice(f,f+this.chunkSize);f+=this.chunkSize;let r=await this.engine.encryptChunk(i),q=new Uint8Array(fA+r.length);q.set(gj(r.length)),q.set(r,fA),j.enqueue(q)}this.buffer=n.slice(f)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(fA+j.length);n.set(gj(j.length)),n.set(j,fA),A.enqueue(n),this.buffer=new Uint8Array(0),this.engine.zeroKey()}}class GA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await xA(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let f=0;while(!0){if(n.length-f<fA)break;let i=Jn(n,f);if(i>this.chunkSize*2)throw new u(`Frame length ${i} exceeds …`);if(n.length-f-fA<i)break;f+=fA;let r=n.slice(f,f+i);f+=i;try{let q=await this.engine.decryptChunk(r);j.enqueue(q)}catch(q){throw q instanceof u?q:new u("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(f)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0),this.engine.zeroKey()}}async function Vn(A,j){let n=A.getReader(),f=j&&j.length?[j]:[];try{while(!0){let{value:v,done:k}=await n.read();if(k)break;f.push(v)}}finally{n.releaseLock()}let i=f.reduce((v,k)=>v+k.byteLength,0),r=new Uint8Array(i),q=0;for(let v of f)r.set(v,q),q+=v.byteLength;return r}class KA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new DA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(i,r){if(j===0){r.enqueue(i);return}if(i.byteLength<=j){j-=i.byteLength;return}r.enqueue(i.slice(j)),j=0}}),f=new GA(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(f)}}async collect(A,j,n=null){return Vn(A.pipeThrough(j),n??void 0)}}function Qn(A=0,j=console.info){return{level:A,log(n,f){if(n<=A)j(`${n}| ${f}`)}}}function Yn(A,j,n){if(j<0||n<0||j+n>A)throw new RangeError("read() slice exceeds data bounds")}var{promises:ni}=(()=>({}));class Bj{src;#A=null;constructor(A){this.src=A}get length(){if(this.src instanceof Uint8Array)return this.src.byteLength;if(this.src instanceof Blob)return this.src.size;return this.ensureUint8().byteLength}async read(A,j){if(Yn(this.length,A,j),this.src instanceof Uint8Array)return this.src.slice(A,A+j);if(this.src instanceof Blob){let n=await this.src.slice(A,A+j).arrayBuffer();return new Uint8Array(n)}return this.ensureUint8().slice(A,A+j)}ensureUint8(){if(!this.#A)this.#A=XA(this.src);return this.#A}}var Xn=new WeakMap;class vA{static getEngine(A,j){let n=Xn.get(A);if(!n)n=new Map,Xn.set(A,n);let f=n.get(j);if(f)return f;let i=c.get(j);return f={desc:i,cipher:new i.cipher(A),kdf:i.kdf,chunkSize:i.defaultChunkSize,provider:A},n.set(j,f),f}static async deriveKey(A,j,n,f){try{let i=await A.kdf.derive(j.value,n,f,A.provider);await A.cipher.setKey(i)}catch(i){let r=i instanceof Error?i.message:String(i);throw new AA(r)}finally{d(j)}}}class iA{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=c.get(j.scheme??c.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=this.setChunkSize(j.chunkSize??this.v.defaultChunkSize),this.stream=new KA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=Qn(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await iA.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await iA.peekHeader(A),n=UA(j);return{scheme:n.scheme,difficulty:n.difficulty,salt:YA(n.salt),saltLength:n.salt.byteLength}}static async decodeData(A){let j=typeof A?.read==="function"?A:new Bj(A),n=await j.read(0,Math.min(256,j.length)),f=await iA.peekHeader(n),{scheme:i,headerLen:r}=UA(f),q=j.length,v=q-r;if(v<=0)throw new p("Payload is empty");let k=await j.read(r,4),U=new DataView(k.buffer,k.byteOffset,4).getUint32(0,!1);if(U+4<=v&&U>=28){let K=U,$=r,t=0,F=0;while($+4<=q){let P=await j.read($,4),m=new DataView(P.buffer,P.byteOffset,4).getUint32(0,!1);if(m===0||$+4+m>q)break;t++,F+=m,$+=4+m}return{isChunked:!0,chunks:{chunkSize:K,count:t,totalPayload:F}}}let R=await j.read(r,v),g=c.get(i).cipher.IV_LENGTH;if(R.length<g+16)throw new p("Ciphertext too short for IV & tag");return{isChunked:!1,payloadLength:v,params:{iv:R.slice(0,g),tag:R.slice(R.length-16)}}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setScheme(A){this.v=c.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new KA(this.cipher,this.chunkSize)}getScheme(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){let j=A,n;if(j==null)n=this.v.defaultChunkSize;else if(n=Number(j),!Number.isInteger(n)||n<1)throw new Error(`Invalid chunkSize: ${j}. Must be a positive integer.`);return this.chunkSize=n,this.stream=new KA(this.cipher,this.chunkSize),n}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){let n={value:j};try{this.log.log(1,`Start text encryption, scheme: ${this.getScheme()}`),this.log.log(2,"Deriving key for text encryption");let f=this.genSalt();await this.deriveKey(n,f),d(n),j=null,this.log.log(3,`Salt generated: ${YA(f)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let i=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.cipher.zeroKey(),this.log.log(3,"Encoding header");let r=ZA(this.v.id,this.difficulty,this.saltStrength,f);this.log.log(3,"Encoding text");let q=YA(r,i);return this.log.log(1,"Decryption finished"),q}catch(f){throw new LA(f instanceof Error?f.message:String(f))}}async decryptText(A,j){let n={value:j};try{this.log.log(1,`Start text decryption, Version ${this.getScheme()}`),this.log.log(3,"Start text decoding");let f=XA(A);this.log.log(3,"Start header decoding"),await iA.peekHeader(A);let i=UA(f);this.log.log(3,"Trying to get engine");let r=vA.getEngine(this.provider,i.scheme);this.log.log(2,`Deriving key via engine for scheme: ${i.scheme}`),this.log.log(3,`Salt use: ${YA(i.salt)}, KDF difficulty: ${i.difficulty}`);try{await vA.deriveKey(r,n,i.salt,i.difficulty)}finally{d(n),j=null}this.log.log(2,"Decrypting text data");let q=await r.cipher.decryptChunk(f.slice(i.headerLen));r.cipher.zeroKey(),this.log.log(3,"Decoding text");let v=new TextDecoder().decode(q);return this.log.log(1,"Decryption finished"),v}catch(f){if(f instanceof u||f instanceof p||f instanceof PA||f instanceof TA||f instanceof AA)throw f;throw new u("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){let n={value:j};try{if(A.size===0){let q=this.genSalt();await this.deriveKey(n,q),d(n),j=null;let v=ZA(this.v.id,this.difficulty,this.saltStrength,q);return new Blob([v],{type:"application/octet-stream"})}this.log.log(2,"Deriving key for file encryption");let f=this.genSalt();await this.deriveKey(n,f),d(n),j=null;let i=ZA(this.v.id,this.difficulty,this.saltStrength,f),r=await this.stream.collect(A.stream(),new DA(this.cipher,this.chunkSize).toTransformStream(),i);return new Blob([r],{type:"application/octet-stream"})}catch(f){throw new LA(f instanceof Error?f.message:String(f))}}async decryptFile(A,j){let n={value:j};try{let f=await iA.peekHeader(A),i=UA(f),r=vA.getEngine(this.provider,i.scheme);try{await vA.deriveKey(r,n,i.salt,i.difficulty)}finally{d(n),j=null}if(A.size===i.headerLen)return new Blob([],{type:"application/octet-stream"});this.log.log(2,"Decrypting file data");let v=await new KA(r.cipher,r.chunkSize).collect(A.slice(i.headerLen).stream(),new GA(r.cipher,r.chunkSize).toTransformStream());return new Blob([v],{type:"application/octet-stream"})}catch(f){if(f instanceof u)throw f;throw new u(f instanceof Error?f.message:String(f))}}async createEncryptionStream(A){let j={value:A};this.log.log(2,"Deriving key for stream encryption");let n=this.genSalt();await this.deriveKey(j,n),d(j),A=null;let f=ZA(this.v.id,this.difficulty,this.saltStrength,n),i=this.stream.encryptionStream();return{header:f,writable:i.writable,readable:i.readable}}async createDecryptionStream(A){let j={value:A},n=this,f=new Uint8Array(0),i=null;async function r(q,v){let k=q.getReader();while(!0){let{value:U,done:I}=await k.read();if(I)break;v.enqueue(U)}}return new TransformStream({async transform(q,v){if(!i){if(f=QA(f,q),f.length<2)return;let U=f.slice(0,30),{salt:I,difficulty:R}=UA(U),g=f[1]>>5,K=f[1]>>2&1?"high":"low",t=2+c.get(g).saltLengths[K];if(f.length<t)return;let F=vA.getEngine(n.provider,g);try{await vA.deriveKey(F,j,I,R)}finally{d(j),A=null}i=new GA(F.cipher,F.chunkSize).toTransformStream(),r(i.readable,v).catch((m)=>{v.error(m)});let P=f.slice(t);if(P.length){let m=i.writable.getWriter();await m.write(P),m.releaseLock()}return}let k=i.writable.getWriter();await k.write(q),k.releaseLock()},async flush(){if(i){let q=i.writable.getWriter();await q.close(),q.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let f=performance.now();try{let i=await this.kdf.derive(A.value,j,n,this.provider);d(A),await this.cipher.setKey(i),this.log.log(3,`Key derivation completed in ${(performance.now()-f).toFixed(1)} ms`)}catch(i){throw new AA(i instanceof Error?i.message:String(i))}}genSalt(A=this.saltStrength){let j=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(j))}static async peekHeader(A){let j=await this.readAsUint8(A);if(j instanceof Uint8Array){if(j.length<2)throw new p("Input too short");let{headerLen:n}=UA(j.length>=16?j:Uint8Array.from(j));if(j.length<n)throw new p("Incomplete header");return j.slice(0,n)}throw new PA("Unsupported input type")}static async readAsUint8(A){if(typeof A==="string")return XA(A);if(A instanceof Blob){let j=A.slice(0,64);return new Uint8Array(await j.arrayBuffer())}return A}}var Zn={subtle:globalThis.crypto.subtle,getRandomValues(A){return globalThis.crypto.getRandomValues(A)},isNode:!1};function Hi(A){return new iA(Zn,A)}export{Hi as createCryptit,iA as Cryptit};

//# debugId=3A3C286DD3F3B73564756E2164756E21
