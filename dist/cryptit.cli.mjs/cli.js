#!/usr/bin/env node
import{createRequire as qq}from"node:module";var a6=Object.create;var{getPrototypeOf:e6,defineProperty:Wj,getOwnPropertyNames:Aq}=Object;var jq=Object.prototype.hasOwnProperty;var MA=(A,j,q)=>{q=A!=null?a6(e6(A)):{};let E=j||!A||!A.__esModule?Wj(q,"default",{value:A,enumerable:!0}):q;for(let _ of Aq(A))if(!jq.call(E,_))Wj(E,_,{get:()=>A[_],enumerable:!0});return E};var Z=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var J=qq(import.meta.url);var UA=Z((Eq)=>{class dA extends Error{constructor(A,j,q){super(q);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=j,this.exitCode=A,this.nestedError=void 0}}class Sj extends dA{constructor(A){super(1,"commander.invalidArgument",A);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}Eq.CommanderError=dA;Eq.InvalidArgumentError=Sj});var wA=Z((Gq)=>{var{InvalidArgumentError:$q}=UA();class Nj{constructor(A,j){switch(this.description=j||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,A[0]){case"<":this.required=!0,this._name=A.slice(1,-1);break;case"[":this.required=!1,this._name=A.slice(1,-1);break;default:this.required=!0,this._name=A;break}if(this._name.length>3&&this._name.slice(-3)==="...")this.variadic=!0,this._name=this._name.slice(0,-3)}name(){return this._name}_concatValue(A,j){if(j===this.defaultValue||!Array.isArray(j))return[A];return j.concat(A)}default(A,j){return this.defaultValue=A,this.defaultValueDescription=j,this}argParser(A){return this.parseArg=A,this}choices(A){return this.argChoices=A.slice(),this.parseArg=(j,q)=>{if(!this.argChoices.includes(j))throw new $q(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(j,q);return j},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}}function Iq(A){let j=A.name()+(A.variadic===!0?"...":"");return A.required?"<"+j+">":"["+j+"]"}Gq.Argument=Nj;Gq.humanReadableArgName=Iq});var pA=Z((Rq)=>{var{humanReadableArgName:Lq}=wA();class Dj{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands(A){let j=A.commands.filter((q)=>!q._hidden);if(A._hasImplicitHelpCommand()){let[,q,E]=A._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),_=A.createCommand(q).helpOption(!1);if(_.description(A._helpCommandDescription),E)_.arguments(E);j.push(_)}if(this.sortSubcommands)j.sort((q,E)=>{return q.name().localeCompare(E.name())});return j}compareOptions(A,j){let q=(E)=>{return E.short?E.short.replace(/^-/,""):E.long.replace(/^--/,"")};return q(A).localeCompare(q(j))}visibleOptions(A){let j=A.options.filter((_)=>!_.hidden),q=A._hasHelpOption&&A._helpShortFlag&&!A._findOption(A._helpShortFlag),E=A._hasHelpOption&&!A._findOption(A._helpLongFlag);if(q||E){let _;if(!q)_=A.createOption(A._helpLongFlag,A._helpDescription);else if(!E)_=A.createOption(A._helpShortFlag,A._helpDescription);else _=A.createOption(A._helpFlags,A._helpDescription);j.push(_)}if(this.sortOptions)j.sort(this.compareOptions);return j}visibleGlobalOptions(A){if(!this.showGlobalOptions)return[];let j=[];for(let q=A.parent;q;q=q.parent){let E=q.options.filter((_)=>!_.hidden);j.push(...E)}if(this.sortOptions)j.sort(this.compareOptions);return j}visibleArguments(A){if(A._argsDescription)A.registeredArguments.forEach((j)=>{j.description=j.description||A._argsDescription[j.name()]||""});if(A.registeredArguments.find((j)=>j.description))return A.registeredArguments;return[]}subcommandTerm(A){let j=A.registeredArguments.map((q)=>Lq(q)).join(" ");return A._name+(A._aliases[0]?"|"+A._aliases[0]:"")+(A.options.length?" [options]":"")+(j?" "+j:"")}optionTerm(A){return A.flags}argumentTerm(A){return A.name()}longestSubcommandTermLength(A,j){return j.visibleCommands(A).reduce((q,E)=>{return Math.max(q,j.subcommandTerm(E).length)},0)}longestOptionTermLength(A,j){return j.visibleOptions(A).reduce((q,E)=>{return Math.max(q,j.optionTerm(E).length)},0)}longestGlobalOptionTermLength(A,j){return j.visibleGlobalOptions(A).reduce((q,E)=>{return Math.max(q,j.optionTerm(E).length)},0)}longestArgumentTermLength(A,j){return j.visibleArguments(A).reduce((q,E)=>{return Math.max(q,j.argumentTerm(E).length)},0)}commandUsage(A){let j=A._name;if(A._aliases[0])j=j+"|"+A._aliases[0];let q="";for(let E=A.parent;E;E=E.parent)q=E.name()+" "+q;return q+j+" "+A.usage()}commandDescription(A){return A.description()}subcommandDescription(A){return A.summary()||A.description()}optionDescription(A){let j=[];if(A.argChoices)j.push(`choices: ${A.argChoices.map((q)=>JSON.stringify(q)).join(", ")}`);if(A.defaultValue!==void 0){if(A.required||A.optional||A.isBoolean()&&typeof A.defaultValue==="boolean")j.push(`default: ${A.defaultValueDescription||JSON.stringify(A.defaultValue)}`)}if(A.presetArg!==void 0&&A.optional)j.push(`preset: ${JSON.stringify(A.presetArg)}`);if(A.envVar!==void 0)j.push(`env: ${A.envVar}`);if(j.length>0)return`${A.description} (${j.join(", ")})`;return A.description}argumentDescription(A){let j=[];if(A.argChoices)j.push(`choices: ${A.argChoices.map((q)=>JSON.stringify(q)).join(", ")}`);if(A.defaultValue!==void 0)j.push(`default: ${A.defaultValueDescription||JSON.stringify(A.defaultValue)}`);if(j.length>0){let q=`(${j.join(", ")})`;if(A.description)return`${A.description} ${q}`;return q}return A.description}formatHelp(A,j){let q=j.padWidth(A,j),E=j.helpWidth||80,_=2,k=2;function $(H,L){if(L){let K=`${H.padEnd(q+2)}${L}`;return j.wrap(K,E-2,q+2)}return H}function I(H){return H.join(`
`).replace(/^/gm," ".repeat(2))}let B=[`Usage: ${j.commandUsage(A)}`,""],U=j.commandDescription(A);if(U.length>0)B=B.concat([j.wrap(U,E,0),""]);let R=j.visibleArguments(A).map((H)=>{return $(j.argumentTerm(H),j.argumentDescription(H))});if(R.length>0)B=B.concat(["Arguments:",I(R),""]);let F=j.visibleOptions(A).map((H)=>{return $(j.optionTerm(H),j.optionDescription(H))});if(F.length>0)B=B.concat(["Options:",I(F),""]);if(this.showGlobalOptions){let H=j.visibleGlobalOptions(A).map((L)=>{return $(j.optionTerm(L),j.optionDescription(L))});if(H.length>0)B=B.concat(["Global Options:",I(H),""])}let P=j.visibleCommands(A).map((H)=>{return $(j.subcommandTerm(H),j.subcommandDescription(H))});if(P.length>0)B=B.concat(["Commands:",I(P),""]);return B.join(`
`)}padWidth(A,j){return Math.max(j.longestOptionTermLength(A,j),j.longestGlobalOptionTermLength(A,j),j.longestSubcommandTermLength(A,j),j.longestArgumentTermLength(A,j))}wrap(A,j,q,E=40){let k=new RegExp(`[\\n][${" \\f\\t\\v   -   　\uFEFF"}]+`);if(A.match(k))return A;let $=j-q;if($<E)return A;let I=A.slice(0,q),B=A.slice(q).replace(`\r
`,`
`),U=" ".repeat(q),F=`\\s${"​"}`,P=new RegExp(`
|.{1,${$-1}}([${F}]|$)|[^${F}]+?([${F}]|$)`,"g"),H=B.match(P)||[];return I+H.map((L,K)=>{if(L===`
`)return"";return(K>0?U:"")+L.trimEnd()}).join(`
`)}}Rq.Help=Dj});var sA=Z((Pq)=>{var{InvalidArgumentError:Tq}=UA();class Vj{constructor(A,j){this.flags=A,this.description=j||"",this.required=A.includes("<"),this.optional=A.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(A),this.mandatory=!1;let q=wj(A);if(this.short=q.shortFlag,this.long=q.longFlag,this.negate=!1,this.long)this.negate=this.long.startsWith("--no-");this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default(A,j){return this.defaultValue=A,this.defaultValueDescription=j,this}preset(A){return this.presetArg=A,this}conflicts(A){return this.conflictsWith=this.conflictsWith.concat(A),this}implies(A){let j=A;if(typeof A==="string")j={[A]:!0};return this.implied=Object.assign(this.implied||{},j),this}env(A){return this.envVar=A,this}argParser(A){return this.parseArg=A,this}makeOptionMandatory(A=!0){return this.mandatory=!!A,this}hideHelp(A=!0){return this.hidden=!!A,this}_concatValue(A,j){if(j===this.defaultValue||!Array.isArray(j))return[A];return j.concat(A)}choices(A){return this.argChoices=A.slice(),this.parseArg=(j,q)=>{if(!this.argChoices.includes(j))throw new Tq(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(j,q);return j},this}name(){if(this.long)return this.long.replace(/^--/,"");return this.short.replace(/^-/,"")}attributeName(){return Fq(this.name().replace(/^no-/,""))}is(A){return this.short===A||this.long===A}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class Mj{constructor(A){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,A.forEach((j)=>{if(j.negate)this.negativeOptions.set(j.attributeName(),j);else this.positiveOptions.set(j.attributeName(),j)}),this.negativeOptions.forEach((j,q)=>{if(this.positiveOptions.has(q))this.dualOptions.add(q)})}valueFromOption(A,j){let q=j.attributeName();if(!this.dualOptions.has(q))return!0;let E=this.negativeOptions.get(q).presetArg,_=E!==void 0?E:!1;return j.negate===(_===A)}}function Fq(A){return A.split("-").reduce((j,q)=>{return j+q[0].toUpperCase()+q.slice(1)})}function wj(A){let j,q,E=A.split(/[ |,]+/);if(E.length>1&&!/^[[<]/.test(E[1]))j=E.shift();if(q=E.shift(),!j&&/^-[^-]$/.test(q))j=q,q=void 0;return{shortFlag:j,longFlag:q}}Pq.Option=Vj;Pq.splitOptionFlags=wj;Pq.DualOptions=Mj});var yj=Z((Qq)=>{function Yq(A,j){if(Math.abs(A.length-j.length)>3)return Math.max(A.length,j.length);let q=[];for(let E=0;E<=A.length;E++)q[E]=[E];for(let E=0;E<=j.length;E++)q[0][E]=E;for(let E=1;E<=j.length;E++)for(let _=1;_<=A.length;_++){let k=1;if(A[_-1]===j[E-1])k=0;else k=1;if(q[_][E]=Math.min(q[_-1][E]+1,q[_][E-1]+1,q[_-1][E-1]+k),_>1&&E>1&&A[_-1]===j[E-2]&&A[_-2]===j[E-1])q[_][E]=Math.min(q[_][E],q[_-2][E-2]+1)}return q[A.length][j.length]}function zq(A,j){if(!j||j.length===0)return"";j=Array.from(new Set(j));let q=A.startsWith("--");if(q)A=A.slice(2),j=j.map(($)=>$.slice(2));let E=[],_=3,k=0.4;if(j.forEach(($)=>{if($.length<=1)return;let I=Yq(A,$),B=Math.max(A.length,$.length);if((B-I)/B>k){if(I<_)_=I,E=[$];else if(I===_)E.push($)}}),E.sort(($,I)=>$.localeCompare(I)),q)E=E.map(($)=>`--${$}`);if(E.length>1)return`
(Did you mean one of ${E.join(", ")}?)`;if(E.length===1)return`
(Did you mean ${E[0]}?)`;return""}Qq.suggestSimilar=zq});var bj=Z((Mq)=>{var fq=J("events").EventEmitter,oA=J("child_process"),C=J("path"),aA=J("fs"),X=J("process"),{Argument:Wq,humanReadableArgName:Sq}=wA(),{CommanderError:eA}=UA(),{Help:Nq}=pA(),{Option:vj,splitOptionFlags:Dq,DualOptions:Vq}=sA(),{suggestSimilar:Oj}=yj();class Aj extends fq{constructor(A){super();this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=A||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:(j)=>X.stdout.write(j),writeErr:(j)=>X.stderr.write(j),getOutHelpWidth:()=>X.stdout.isTTY?X.stdout.columns:void 0,getErrHelpWidth:()=>X.stderr.isTTY?X.stderr.columns:void 0,outputError:(j,q)=>q(j)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings(A){return this._outputConfiguration=A._outputConfiguration,this._hasHelpOption=A._hasHelpOption,this._helpFlags=A._helpFlags,this._helpDescription=A._helpDescription,this._helpShortFlag=A._helpShortFlag,this._helpLongFlag=A._helpLongFlag,this._helpCommandName=A._helpCommandName,this._helpCommandnameAndArgs=A._helpCommandnameAndArgs,this._helpCommandDescription=A._helpCommandDescription,this._helpConfiguration=A._helpConfiguration,this._exitCallback=A._exitCallback,this._storeOptionsAsProperties=A._storeOptionsAsProperties,this._combineFlagAndOptionalValue=A._combineFlagAndOptionalValue,this._allowExcessArguments=A._allowExcessArguments,this._enablePositionalOptions=A._enablePositionalOptions,this._showHelpAfterError=A._showHelpAfterError,this._showSuggestionAfterError=A._showSuggestionAfterError,this}_getCommandAndAncestors(){let A=[];for(let j=this;j;j=j.parent)A.push(j);return A}command(A,j,q){let E=j,_=q;if(typeof E==="object"&&E!==null)_=E,E=null;_=_||{};let[,k,$]=A.match(/([^ ]+) *(.*)/),I=this.createCommand(k);if(E)I.description(E),I._executableHandler=!0;if(_.isDefault)this._defaultCommandName=I._name;if(I._hidden=!!(_.noHelp||_.hidden),I._executableFile=_.executableFile||null,$)I.arguments($);if(this.commands.push(I),I.parent=this,I.copyInheritedSettings(this),E)return this;return I}createCommand(A){return new Aj(A)}createHelp(){return Object.assign(new Nq,this.configureHelp())}configureHelp(A){if(A===void 0)return this._helpConfiguration;return this._helpConfiguration=A,this}configureOutput(A){if(A===void 0)return this._outputConfiguration;return Object.assign(this._outputConfiguration,A),this}showHelpAfterError(A=!0){if(typeof A!=="string")A=!!A;return this._showHelpAfterError=A,this}showSuggestionAfterError(A=!0){return this._showSuggestionAfterError=!!A,this}addCommand(A,j){if(!A._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);if(j=j||{},j.isDefault)this._defaultCommandName=A._name;if(j.noHelp||j.hidden)A._hidden=!0;return this.commands.push(A),A.parent=this,this}createArgument(A,j){return new Wq(A,j)}argument(A,j,q,E){let _=this.createArgument(A,j);if(typeof q==="function")_.default(E).argParser(q);else _.default(q);return this.addArgument(_),this}arguments(A){return A.trim().split(/ +/).forEach((j)=>{this.argument(j)}),this}addArgument(A){let j=this.registeredArguments.slice(-1)[0];if(j&&j.variadic)throw new Error(`only the last argument can be variadic '${j.name()}'`);if(A.required&&A.defaultValue!==void 0&&A.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${A.name()}'`);return this.registeredArguments.push(A),this}addHelpCommand(A,j){if(A===!1)this._addImplicitHelpCommand=!1;else{if(this._addImplicitHelpCommand=!0,typeof A==="string")this._helpCommandName=A.split(" ")[0],this._helpCommandnameAndArgs=A;this._helpCommandDescription=j||this._helpCommandDescription}return this}_hasImplicitHelpCommand(){if(this._addImplicitHelpCommand===void 0)return this.commands.length&&!this._actionHandler&&!this._findCommand("help");return this._addImplicitHelpCommand}hook(A,j){let q=["preSubcommand","preAction","postAction"];if(!q.includes(A))throw new Error(`Unexpected value for event passed to hook : '${A}'.
Expecting one of '${q.join("', '")}'`);if(this._lifeCycleHooks[A])this._lifeCycleHooks[A].push(j);else this._lifeCycleHooks[A]=[j];return this}exitOverride(A){if(A)this._exitCallback=A;else this._exitCallback=(j)=>{if(j.code!=="commander.executeSubCommandAsync")throw j};return this}_exit(A,j,q){if(this._exitCallback)this._exitCallback(new eA(A,j,q));X.exit(A)}action(A){let j=(q)=>{let E=this.registeredArguments.length,_=q.slice(0,E);if(this._storeOptionsAsProperties)_[E]=this;else _[E]=this.opts();return _.push(this),A.apply(this,_)};return this._actionHandler=j,this}createOption(A,j){return new vj(A,j)}_callParseArg(A,j,q,E){try{return A.parseArg(j,q)}catch(_){if(_.code==="commander.invalidArgument"){let k=`${E} ${_.message}`;this.error(k,{exitCode:_.exitCode,code:_.code})}throw _}}addOption(A){let j=A.name(),q=A.attributeName();if(A.negate){let _=A.long.replace(/^--no-/,"--");if(!this._findOption(_))this.setOptionValueWithSource(q,A.defaultValue===void 0?!0:A.defaultValue,"default")}else if(A.defaultValue!==void 0)this.setOptionValueWithSource(q,A.defaultValue,"default");this.options.push(A);let E=(_,k,$)=>{if(_==null&&A.presetArg!==void 0)_=A.presetArg;let I=this.getOptionValue(q);if(_!==null&&A.parseArg)_=this._callParseArg(A,_,I,k);else if(_!==null&&A.variadic)_=A._concatValue(_,I);if(_==null)if(A.negate)_=!1;else if(A.isBoolean()||A.optional)_=!0;else _="";this.setOptionValueWithSource(q,_,$)};if(this.on("option:"+j,(_)=>{let k=`error: option '${A.flags}' argument '${_}' is invalid.`;E(_,k,"cli")}),A.envVar)this.on("optionEnv:"+j,(_)=>{let k=`error: option '${A.flags}' value '${_}' from env '${A.envVar}' is invalid.`;E(_,k,"env")});return this}_optionEx(A,j,q,E,_){if(typeof j==="object"&&j instanceof vj)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let k=this.createOption(j,q);if(k.makeOptionMandatory(!!A.mandatory),typeof E==="function")k.default(_).argParser(E);else if(E instanceof RegExp){let $=E;E=(I,B)=>{let U=$.exec(I);return U?U[0]:B},k.default(_).argParser(E)}else k.default(E);return this.addOption(k)}option(A,j,q,E){return this._optionEx({},A,j,q,E)}requiredOption(A,j,q,E){return this._optionEx({mandatory:!0},A,j,q,E)}combineFlagAndOptionalValue(A=!0){return this._combineFlagAndOptionalValue=!!A,this}allowUnknownOption(A=!0){return this._allowUnknownOption=!!A,this}allowExcessArguments(A=!0){return this._allowExcessArguments=!!A,this}enablePositionalOptions(A=!0){return this._enablePositionalOptions=!!A,this}passThroughOptions(A=!0){if(this._passThroughOptions=!!A,!!this.parent&&A&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties(A=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this._storeOptionsAsProperties=!!A,this}getOptionValue(A){if(this._storeOptionsAsProperties)return this[A];return this._optionValues[A]}setOptionValue(A,j){return this.setOptionValueWithSource(A,j,void 0)}setOptionValueWithSource(A,j,q){if(this._storeOptionsAsProperties)this[A]=j;else this._optionValues[A]=j;return this._optionValueSources[A]=q,this}getOptionValueSource(A){return this._optionValueSources[A]}getOptionValueSourceWithGlobals(A){let j;return this._getCommandAndAncestors().forEach((q)=>{if(q.getOptionValueSource(A)!==void 0)j=q.getOptionValueSource(A)}),j}_prepareUserArgs(A,j){if(A!==void 0&&!Array.isArray(A))throw new Error("first parameter to parse must be array or undefined");if(j=j||{},A===void 0){if(A=X.argv,X.versions&&X.versions.electron)j.from="electron"}this.rawArgs=A.slice();let q;switch(j.from){case void 0:case"node":this._scriptPath=A[1],q=A.slice(2);break;case"electron":if(X.defaultApp)this._scriptPath=A[1],q=A.slice(2);else q=A.slice(1);break;case"user":q=A.slice(0);break;default:throw new Error(`unexpected parse option { from: '${j.from}' }`)}if(!this._name&&this._scriptPath)this.nameFromFilename(this._scriptPath);return this._name=this._name||"program",q}parse(A,j){let q=this._prepareUserArgs(A,j);return this._parseCommand([],q),this}async parseAsync(A,j){let q=this._prepareUserArgs(A,j);return await this._parseCommand([],q),this}_executeSubCommand(A,j){j=j.slice();let q=!1,E=[".js",".ts",".tsx",".mjs",".cjs"];function _(U,R){let F=C.resolve(U,R);if(aA.existsSync(F))return F;if(E.includes(C.extname(R)))return;let P=E.find((H)=>aA.existsSync(`${F}${H}`));if(P)return`${F}${P}`;return}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let k=A._executableFile||`${this._name}-${A._name}`,$=this._executableDir||"";if(this._scriptPath){let U;try{U=aA.realpathSync(this._scriptPath)}catch(R){U=this._scriptPath}$=C.resolve(C.dirname(U),$)}if($){let U=_($,k);if(!U&&!A._executableFile&&this._scriptPath){let R=C.basename(this._scriptPath,C.extname(this._scriptPath));if(R!==this._name)U=_($,`${R}-${A._name}`)}k=U||k}q=E.includes(C.extname(k));let I;if(X.platform!=="win32")if(q)j.unshift(k),j=xj(X.execArgv).concat(j),I=oA.spawn(X.argv[0],j,{stdio:"inherit"});else I=oA.spawn(k,j,{stdio:"inherit"});else j.unshift(k),j=xj(X.execArgv).concat(j),I=oA.spawn(X.execPath,j,{stdio:"inherit"});if(!I.killed)["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach((R)=>{X.on(R,()=>{if(I.killed===!1&&I.exitCode===null)I.kill(R)})});let B=this._exitCallback;if(!B)I.on("close",X.exit.bind(X));else I.on("close",()=>{B(new eA(X.exitCode||0,"commander.executeSubCommandAsync","(close)"))});I.on("error",(U)=>{if(U.code==="ENOENT"){let R=$?`searched for local subcommand relative to directory '${$}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",F=`'${k}' does not exist
 - if '${A._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${R}`;throw new Error(F)}else if(U.code==="EACCES")throw new Error(`'${k}' not executable`);if(!B)X.exit(1);else{let R=new eA(1,"commander.executeSubCommandAsync","(error)");R.nestedError=U,B(R)}}),this.runningCommand=I}_dispatchSubcommand(A,j,q){let E=this._findCommand(A);if(!E)this.help({error:!0});let _;return _=this._chainOrCallSubCommandHook(_,E,"preSubcommand"),_=this._chainOrCall(_,()=>{if(E._executableHandler)this._executeSubCommand(E,j.concat(q));else return E._parseCommand(j,q)}),_}_dispatchHelpCommand(A){if(!A)this.help();let j=this._findCommand(A);if(j&&!j._executableHandler)j.help();return this._dispatchSubcommand(A,[],[this._helpLongFlag||this._helpShortFlag])}_checkNumberOfArguments(){if(this.registeredArguments.forEach((A,j)=>{if(A.required&&this.args[j]==null)this.missingArgument(A.name())}),this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)return;if(this.args.length>this.registeredArguments.length)this._excessArguments(this.args)}_processArguments(){let A=(q,E,_)=>{let k=E;if(E!==null&&q.parseArg){let $=`error: command-argument value '${E}' is invalid for argument '${q.name()}'.`;k=this._callParseArg(q,E,_,$)}return k};this._checkNumberOfArguments();let j=[];this.registeredArguments.forEach((q,E)=>{let _=q.defaultValue;if(q.variadic){if(E<this.args.length){if(_=this.args.slice(E),q.parseArg)_=_.reduce((k,$)=>{return A(q,$,k)},q.defaultValue)}else if(_===void 0)_=[]}else if(E<this.args.length){if(_=this.args[E],q.parseArg)_=A(q,_,q.defaultValue)}j[E]=_}),this.processedArgs=j}_chainOrCall(A,j){if(A&&A.then&&typeof A.then==="function")return A.then(()=>j());return j()}_chainOrCallHooks(A,j){let q=A,E=[];if(this._getCommandAndAncestors().reverse().filter((_)=>_._lifeCycleHooks[j]!==void 0).forEach((_)=>{_._lifeCycleHooks[j].forEach((k)=>{E.push({hookedCommand:_,callback:k})})}),j==="postAction")E.reverse();return E.forEach((_)=>{q=this._chainOrCall(q,()=>{return _.callback(_.hookedCommand,this)})}),q}_chainOrCallSubCommandHook(A,j,q){let E=A;if(this._lifeCycleHooks[q]!==void 0)this._lifeCycleHooks[q].forEach((_)=>{E=this._chainOrCall(E,()=>{return _(this,j)})});return E}_parseCommand(A,j){let q=this.parseOptions(j);if(this._parseOptionsEnv(),this._parseOptionsImplied(),A=A.concat(q.operands),j=q.unknown,this.args=A.concat(j),A&&this._findCommand(A[0]))return this._dispatchSubcommand(A[0],A.slice(1),j);if(this._hasImplicitHelpCommand()&&A[0]===this._helpCommandName)return this._dispatchHelpCommand(A[1]);if(this._defaultCommandName)return Cj(this,j),this._dispatchSubcommand(this._defaultCommandName,A,j);if(this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName)this.help({error:!0});Cj(this,q.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let E=()=>{if(q.unknown.length>0)this.unknownOption(q.unknown[0])},_=`command:${this.name()}`;if(this._actionHandler){E(),this._processArguments();let k;if(k=this._chainOrCallHooks(k,"preAction"),k=this._chainOrCall(k,()=>this._actionHandler(this.processedArgs)),this.parent)k=this._chainOrCall(k,()=>{this.parent.emit(_,A,j)});return k=this._chainOrCallHooks(k,"postAction"),k}if(this.parent&&this.parent.listenerCount(_))E(),this._processArguments(),this.parent.emit(_,A,j);else if(A.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",A,j);if(this.listenerCount("command:*"))this.emit("command:*",A,j);else if(this.commands.length)this.unknownCommand();else E(),this._processArguments()}else if(this.commands.length)E(),this.help({error:!0});else E(),this._processArguments()}_findCommand(A){if(!A)return;return this.commands.find((j)=>j._name===A||j._aliases.includes(A))}_findOption(A){return this.options.find((j)=>j.is(A))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach((A)=>{A.options.forEach((j)=>{if(j.mandatory&&A.getOptionValue(j.attributeName())===void 0)A.missingMandatoryOptionValue(j)})})}_checkForConflictingLocalOptions(){let A=this.options.filter((q)=>{let E=q.attributeName();if(this.getOptionValue(E)===void 0)return!1;return this.getOptionValueSource(E)!=="default"});A.filter((q)=>q.conflictsWith.length>0).forEach((q)=>{let E=A.find((_)=>q.conflictsWith.includes(_.attributeName()));if(E)this._conflictingOption(q,E)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach((A)=>{A._checkForConflictingLocalOptions()})}parseOptions(A){let j=[],q=[],E=j,_=A.slice();function k(I){return I.length>1&&I[0]==="-"}let $=null;while(_.length){let I=_.shift();if(I==="--"){if(E===q)E.push(I);E.push(..._);break}if($&&!k(I)){this.emit(`option:${$.name()}`,I);continue}if($=null,k(I)){let B=this._findOption(I);if(B){if(B.required){let U=_.shift();if(U===void 0)this.optionMissingArgument(B);this.emit(`option:${B.name()}`,U)}else if(B.optional){let U=null;if(_.length>0&&!k(_[0]))U=_.shift();this.emit(`option:${B.name()}`,U)}else this.emit(`option:${B.name()}`);$=B.variadic?B:null;continue}}if(I.length>2&&I[0]==="-"&&I[1]!=="-"){let B=this._findOption(`-${I[1]}`);if(B){if(B.required||B.optional&&this._combineFlagAndOptionalValue)this.emit(`option:${B.name()}`,I.slice(2));else this.emit(`option:${B.name()}`),_.unshift(`-${I.slice(2)}`);continue}}if(/^--[^=]+=/.test(I)){let B=I.indexOf("="),U=this._findOption(I.slice(0,B));if(U&&(U.required||U.optional)){this.emit(`option:${U.name()}`,I.slice(B+1));continue}}if(k(I))E=q;if((this._enablePositionalOptions||this._passThroughOptions)&&j.length===0&&q.length===0){if(this._findCommand(I)){if(j.push(I),_.length>0)q.push(..._);break}else if(I===this._helpCommandName&&this._hasImplicitHelpCommand()){if(j.push(I),_.length>0)j.push(..._);break}else if(this._defaultCommandName){if(q.push(I),_.length>0)q.push(..._);break}}if(this._passThroughOptions){if(E.push(I),_.length>0)E.push(..._);break}E.push(I)}return{operands:j,unknown:q}}opts(){if(this._storeOptionsAsProperties){let A={},j=this.options.length;for(let q=0;q<j;q++){let E=this.options[q].attributeName();A[E]=E===this._versionOptionName?this._version:this[E]}return A}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((A,j)=>Object.assign(A,j.opts()),{})}error(A,j){if(this._outputConfiguration.outputError(`${A}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError==="string")this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`);else if(this._showHelpAfterError)this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0});let q=j||{},E=q.exitCode||1,_=q.code||"commander.error";this._exit(E,_,A)}_parseOptionsEnv(){this.options.forEach((A)=>{if(A.envVar&&A.envVar in X.env){let j=A.attributeName();if(this.getOptionValue(j)===void 0||["default","config","env"].includes(this.getOptionValueSource(j)))if(A.required||A.optional)this.emit(`optionEnv:${A.name()}`,X.env[A.envVar]);else this.emit(`optionEnv:${A.name()}`)}})}_parseOptionsImplied(){let A=new Vq(this.options),j=(q)=>{return this.getOptionValue(q)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(q))};this.options.filter((q)=>q.implied!==void 0&&j(q.attributeName())&&A.valueFromOption(this.getOptionValue(q.attributeName()),q)).forEach((q)=>{Object.keys(q.implied).filter((E)=>!j(E)).forEach((E)=>{this.setOptionValueWithSource(E,q.implied[E],"implied")})})}missingArgument(A){let j=`error: missing required argument '${A}'`;this.error(j,{code:"commander.missingArgument"})}optionMissingArgument(A){let j=`error: option '${A.flags}' argument missing`;this.error(j,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(A){let j=`error: required option '${A.flags}' not specified`;this.error(j,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(A,j){let q=(k)=>{let $=k.attributeName(),I=this.getOptionValue($),B=this.options.find((R)=>R.negate&&$===R.attributeName()),U=this.options.find((R)=>!R.negate&&$===R.attributeName());if(B&&(B.presetArg===void 0&&I===!1||B.presetArg!==void 0&&I===B.presetArg))return B;return U||k},E=(k)=>{let $=q(k),I=$.attributeName();if(this.getOptionValueSource(I)==="env")return`environment variable '${$.envVar}'`;return`option '${$.flags}'`},_=`error: ${E(A)} cannot be used with ${E(j)}`;this.error(_,{code:"commander.conflictingOption"})}unknownOption(A){if(this._allowUnknownOption)return;let j="";if(A.startsWith("--")&&this._showSuggestionAfterError){let E=[],_=this;do{let k=_.createHelp().visibleOptions(_).filter(($)=>$.long).map(($)=>$.long);E=E.concat(k),_=_.parent}while(_&&!_._enablePositionalOptions);j=Oj(A,E)}let q=`error: unknown option '${A}'${j}`;this.error(q,{code:"commander.unknownOption"})}_excessArguments(A){if(this._allowExcessArguments)return;let j=this.registeredArguments.length,q=j===1?"":"s",_=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${j} argument${q} but got ${A.length}.`;this.error(_,{code:"commander.excessArguments"})}unknownCommand(){let A=this.args[0],j="";if(this._showSuggestionAfterError){let E=[];this.createHelp().visibleCommands(this).forEach((_)=>{if(E.push(_.name()),_.alias())E.push(_.alias())}),j=Oj(A,E)}let q=`error: unknown command '${A}'${j}`;this.error(q,{code:"commander.unknownCommand"})}version(A,j,q){if(A===void 0)return this._version;this._version=A,j=j||"-V, --version",q=q||"output the version number";let E=this.createOption(j,q);return this._versionOptionName=E.attributeName(),this.options.push(E),this.on("option:"+E.name(),()=>{this._outputConfiguration.writeOut(`${A}
`),this._exit(0,"commander.version",A)}),this}description(A,j){if(A===void 0&&j===void 0)return this._description;if(this._description=A,j)this._argsDescription=j;return this}summary(A){if(A===void 0)return this._summary;return this._summary=A,this}alias(A){if(A===void 0)return this._aliases[0];let j=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler)j=this.commands[this.commands.length-1];if(A===j._name)throw new Error("Command alias can't be the same as its name");return j._aliases.push(A),this}aliases(A){if(A===void 0)return this._aliases;return A.forEach((j)=>this.alias(j)),this}usage(A){if(A===void 0){if(this._usage)return this._usage;let j=this.registeredArguments.map((q)=>{return Sq(q)});return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?j:[]).join(" ")}return this._usage=A,this}name(A){if(A===void 0)return this._name;return this._name=A,this}nameFromFilename(A){return this._name=C.basename(A,C.extname(A)),this}executableDir(A){if(A===void 0)return this._executableDir;return this._executableDir=A,this}helpInformation(A){let j=this.createHelp();if(j.helpWidth===void 0)j.helpWidth=A&&A.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth();return j.formatHelp(this,j)}_getHelpContext(A){A=A||{};let j={error:!!A.error},q;if(j.error)q=(E)=>this._outputConfiguration.writeErr(E);else q=(E)=>this._outputConfiguration.writeOut(E);return j.write=A.write||q,j.command=this,j}outputHelp(A){let j;if(typeof A==="function")j=A,A=void 0;let q=this._getHelpContext(A);this._getCommandAndAncestors().reverse().forEach((_)=>_.emit("beforeAllHelp",q)),this.emit("beforeHelp",q);let E=this.helpInformation(q);if(j){if(E=j(E),typeof E!=="string"&&!Buffer.isBuffer(E))throw new Error("outputHelp callback must return a string or a Buffer")}if(q.write(E),this._helpLongFlag)this.emit(this._helpLongFlag);this.emit("afterHelp",q),this._getCommandAndAncestors().forEach((_)=>_.emit("afterAllHelp",q))}helpOption(A,j){if(typeof A==="boolean")return this._hasHelpOption=A,this;this._helpFlags=A||this._helpFlags,this._helpDescription=j||this._helpDescription;let q=Dq(this._helpFlags);return this._helpShortFlag=q.shortFlag,this._helpLongFlag=q.longFlag,this}help(A){this.outputHelp(A);let j=X.exitCode||0;if(j===0&&A&&typeof A!=="function"&&A.error)j=1;this._exit(j,"commander.help","(outputHelp)")}addHelpText(A,j){let q=["beforeAll","before","after","afterAll"];if(!q.includes(A))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${q.join("', '")}'`);let E=`${A}Help`;return this.on(E,(_)=>{let k;if(typeof j==="function")k=j({error:_.error,command:_.command});else k=j;if(k)_.write(`${k}
`)}),this}}function Cj(A,j){if(A._hasHelpOption&&j.find((E)=>E===A._helpLongFlag||E===A._helpShortFlag))A.outputHelp(),A._exit(0,"commander.helpDisplayed","(outputHelp)")}function xj(A){return A.map((j)=>{if(!j.startsWith("--inspect"))return j;let q,E="127.0.0.1",_="9229",k;if((k=j.match(/^(--inspect(-brk)?)$/))!==null)q=k[1];else if((k=j.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null)if(q=k[1],/^\d+$/.test(k[3]))_=k[3];else E=k[3];else if((k=j.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null)q=k[1],E=k[3],_=k[4];if(q&&_!=="0")return`${q}=${E}:${parseInt(_)+1}`;return j})}Mq.Command=Aj});var cj=Z((V,gj)=>{var{Argument:yq}=wA(),{Command:hj}=bj(),{CommanderError:vq,InvalidArgumentError:uj}=UA(),{Help:Oq}=pA(),{Option:Cq}=sA();V=gj.exports=new hj;V.program=V;V.Command=hj;V.Option=Cq;V.Argument=yq;V.Help=Oq;V.CommanderError=vq;V.InvalidArgumentError=uj;V.InvalidOptionArgumentError=uj});var Lj=Z((D_,t)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",G=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},xq=G,RA={},g;for(g in G)if(G.hasOwnProperty(g))RA[g]=G[g];var KA=[],rj="./this.program",kj=function(A,j){throw j},bA=!1,m=!1,Ij=!1,dj=!1;bA=typeof window==="object";m=typeof importScripts==="function";Ij=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";dj=!bA&&!Ij&&!m;var N="";function bq(A){if(G.locateFile)return G.locateFile(A,N);return N+A}var OA,$j,TA,hq,qj,Ej;if(Ij){if(m)N=J("path").dirname(N)+"/";else N=__dirname+"/";if(OA=function A(j,q){if(!qj)qj=J("fs");if(!Ej)Ej=J("path");return j=Ej.normalize(j),qj.readFileSync(j,q?null:"utf8")},TA=function A(j){var q=OA(j,!0);if(!q.buffer)q=new Uint8Array(q);return nj(q.buffer),q},process.argv.length>1)rj=process.argv[1].replace(/\\/g,"/");if(KA=process.argv.slice(2),typeof t!=="undefined")t.exports=G;process.on("uncaughtException",function(A){if(!(A instanceof HE))throw A}),process.on("unhandledRejection",XA),kj=function(A){process.exit(A)},G.inspect=function(){return"[Emscripten Module object]"}}else if(dj){if(typeof read!="undefined")OA=function A(j){return read(j)};if(TA=function A(j){var q;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return q=read(j,"binary"),nj(typeof q==="object"),q},typeof scriptArgs!="undefined")KA=scriptArgs;else if(typeof arguments!="undefined")KA=arguments;if(typeof quit==="function")kj=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(bA||m){if(m)N=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)N=document.currentScript.src;if(N.indexOf("blob:")!==0)N=N.substr(0,N.lastIndexOf("/")+1);else N="";{if(OA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},m)TA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};$j=function(A,j,q){var E=new XMLHttpRequest;E.open("GET",A,!0),E.responseType="arraybuffer",E.onload=function(){if(E.status==200||E.status==0&&E.response){j(E.response);return}q()},E.onerror=q,E.send(null)}}hq=function(A){document.title=A}}var W_=G.print||console.log.bind(console),LA=G.printErr||console.warn.bind(console);for(g in RA)if(RA.hasOwnProperty(g))G[g]=RA[g];RA=null;if(G.arguments)KA=G.arguments;if(G.thisProgram)rj=G.thisProgram;if(G.quit)kj=G.quit;var PA;if(G.wasmBinary)PA=G.wasmBinary;var S_=G.noExitRuntime||!0;if(typeof WebAssembly!=="object")XA("no native wasm support detected");var HA,pj=!1,uq;function nj(A,j){if(!A)XA("Assertion failed: "+j)}var gq=0,cq=1;function lq(A,j){var q;if(j==cq)q=U6(A.length);else q=B6(A.length);if(A.subarray||A.slice)i.set(A,q);else i.set(new Uint8Array(A),q);return q}var ij=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function mq(A,j,q){var E=j+q,_=j;while(A[_]&&!(_>=E))++_;if(_-j>16&&A.subarray&&ij)return ij.decode(A.subarray(j,_));else{var k="";while(j<_){var $=A[j++];if(!($&128)){k+=String.fromCharCode($);continue}var I=A[j++]&63;if(($&224)==192){k+=String.fromCharCode(($&31)<<6|I);continue}var B=A[j++]&63;if(($&240)==224)$=($&15)<<12|I<<6|B;else $=($&7)<<18|I<<12|B<<6|A[j++]&63;if($<65536)k+=String.fromCharCode($);else{var U=$-65536;k+=String.fromCharCode(55296|U>>10,56320|U&1023)}}}return k}function nq(A,j){return A?mq(i,A,j):""}function iq(A,j){if(A%j>0)A+=j-A%j;return A}var Gj,sj,i,oj,aj,ej,A6,j6,q6;function E6(A){Gj=A,G.HEAP8=sj=new Int8Array(A),G.HEAP16=oj=new Int16Array(A),G.HEAP32=ej=new Int32Array(A),G.HEAPU8=i=new Uint8Array(A),G.HEAPU16=aj=new Uint16Array(A),G.HEAPU32=A6=new Uint32Array(A),G.HEAPF32=j6=new Float32Array(A),G.HEAPF64=q6=new Float64Array(A)}var N_=G.INITIAL_MEMORY||16777216,CA,_6=[],k6=[],$6=[],tq=!1;function rq(){if(G.preRun){if(typeof G.preRun=="function")G.preRun=[G.preRun];while(G.preRun.length)sq(G.preRun.shift())}Bj(_6)}function dq(){tq=!0,Bj(k6)}function pq(){if(G.postRun){if(typeof G.postRun=="function")G.postRun=[G.postRun];while(G.postRun.length)aq(G.postRun.shift())}Bj($6)}function sq(A){_6.unshift(A)}function oq(A){k6.unshift(A)}function aq(A){$6.unshift(A)}var n=0,_j=null,FA=null;function eq(A){if(n++,G.monitorRunDependencies)G.monitorRunDependencies(n)}function AE(A){if(n--,G.monitorRunDependencies)G.monitorRunDependencies(n);if(n==0){if(_j!==null)clearInterval(_j),_j=null;if(FA){var j=FA;FA=null,j()}}}G.preloadedImages={};G.preloadedAudios={};function XA(A){if(G.onAbort)G.onAbort(A);A+="",LA(A),pj=!0,uq=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var jE="data:application/octet-stream;base64,";function I6(A){return A.startsWith(jE)}function G6(A){return A.startsWith("file://")}var W="argon2.wasm";if(!I6(W))W=bq(W);function tj(A){try{if(A==W&&PA)return new Uint8Array(PA);if(TA)return TA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){XA(j)}}function qE(){if(!PA&&(bA||m)){if(typeof fetch==="function"&&!G6(W))return fetch(W,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+W+"'";return A.arrayBuffer()}).catch(function(){return tj(W)});else if($j)return new Promise(function(A,j){$j(W,function(q){A(new Uint8Array(q))},j)})}return Promise.resolve().then(function(){return tj(W)})}function EE(){var A={a:IE};function j($,I){var B=$.exports;G.asm=B,HA=G.asm.c,E6(HA.buffer),CA=G.asm.k,oq(G.asm.d),AE("wasm-instantiate")}eq("wasm-instantiate");function q($){j($.instance)}function E($){return qE().then(function(I){var B=WebAssembly.instantiate(I,A);return B}).then($,function(I){LA("failed to asynchronously prepare wasm: "+I),XA(I)})}function _(){if(!PA&&typeof WebAssembly.instantiateStreaming==="function"&&!I6(W)&&!G6(W)&&typeof fetch==="function")return fetch(W,{credentials:"same-origin"}).then(function($){var I=WebAssembly.instantiateStreaming($,A);return I.then(q,function(B){return LA("wasm streaming compile failed: "+B),LA("falling back to ArrayBuffer instantiation"),E(q)})});else return E(q)}if(G.instantiateWasm)try{var k=G.instantiateWasm(A,j);return k}catch($){return LA("Module.instantiateWasm callback failed with error: "+$),!1}return _(),{}}function Bj(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(G);continue}var q=j.func;if(typeof q==="number")if(j.arg===void 0)CA.get(q)();else CA.get(q)(j.arg);else q(j.arg===void 0?null:j.arg)}}function _E(A,j,q){i.copyWithin(A,j,j+q)}function kE(A){try{return HA.grow(A-Gj.byteLength+65535>>>16),E6(HA.buffer),1}catch(j){}}function $E(A){var j=i.length;A=A>>>0;var q=2147418112;if(A>q)return!1;for(var E=1;E<=4;E*=2){var _=j*(1+0.2/E);_=Math.min(_,A+100663296);var k=Math.min(q,iq(Math.max(A,_),65536)),$=kE(k);if($)return!0}return!1}var IE={a:_E,b:$E},GE=EE(),BE=G.___wasm_call_ctors=function(){return(BE=G.___wasm_call_ctors=G.asm.d).apply(null,arguments)},UE=G._argon2_hash=function(){return(UE=G._argon2_hash=G.asm.e).apply(null,arguments)},B6=G._malloc=function(){return(B6=G._malloc=G.asm.f).apply(null,arguments)},LE=G._free=function(){return(LE=G._free=G.asm.g).apply(null,arguments)},RE=G._argon2_verify=function(){return(RE=G._argon2_verify=G.asm.h).apply(null,arguments)},KE=G._argon2_error_message=function(){return(KE=G._argon2_error_message=G.asm.i).apply(null,arguments)},TE=G._argon2_encodedlen=function(){return(TE=G._argon2_encodedlen=G.asm.j).apply(null,arguments)},FE=G._argon2_hash_ext=function(){return(FE=G._argon2_hash_ext=G.asm.l).apply(null,arguments)},PE=G._argon2_verify_ext=function(){return(PE=G._argon2_verify_ext=G.asm.m).apply(null,arguments)},U6=G.stackAlloc=function(){return(U6=G.stackAlloc=G.asm.n).apply(null,arguments)};G.allocate=lq;G.UTF8ToString=nq;G.ALLOC_NORMAL=gq;var xA;function HE(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}FA=function A(){if(!xA)Uj();if(!xA)FA=A};function Uj(A){if(A=A||KA,n>0)return;if(rq(),n>0)return;function j(){if(xA)return;if(xA=!0,G.calledRun=!0,pj)return;if(dq(),G.onRuntimeInitialized)G.onRuntimeInitialized();pq()}if(G.setStatus)G.setStatus("Running..."),setTimeout(function(){setTimeout(function(){G.setStatus("")},1),j()},1);else j()}G.run=Uj;if(G.preInit){if(typeof G.preInit=="function")G.preInit=[G.preInit];while(G.preInit.length>0)G.preInit.pop()()}Uj();if(typeof t!=="undefined")t.exports=G;G.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(G=xq=HA=CA=GE=Gj=sj=i=oj=aj=ej=A6=j6=q6=void 0,typeof t!=="undefined")delete t.exports}});var L6=Z((V_,XE)=>{XE.exports="./cryptit.cli.wasm"});var K6=Z((R6,hA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof hA==="object"&&hA.exports)hA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:R6,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function q(L){if(q._promise)return q._promise;if(q._module)return Promise.resolve(q._module);let K;if(A.process&&A.process.versions&&A.process.versions.node)K=_().then((T)=>new Promise((Y)=>{T.postRun=()=>Y(T)}));else K=k().then((T)=>{let Y=L?I(L):void 0;return E(T,Y)});return q._promise=K,K.then((T)=>{return q._module=T,delete q._promise,T})}function E(L,K){return new Promise((T)=>{return A.Module={wasmBinary:L,wasmMemory:K,postRun(){T(Module)}},_()})}function _(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(Lj())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(L6()).then((K)=>{return $(K)})}function $(L){let K=atob(L),T=new Uint8Array(new ArrayBuffer(K.length));for(let Y=0;Y<K.length;Y++)T[Y]=K.charCodeAt(Y);return T}function I(L){let p=Math.min(Math.max(Math.ceil(L*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:p,maximum:32767})}function B(L,K){return L.allocate(K,"i8",L.ALLOC_NORMAL)}function U(L,K){let T=new Uint8Array([...K,0]);return B(L,T)}function R(L){if(typeof L!=="string")return L;if(typeof TextEncoder==="function")return new TextEncoder().encode(L);else if(typeof Buffer==="function")return Buffer.from(L);else throw new Error("Don't know how to encode UTF8")}function F(L){let K=L.mem||1024;return q(K).then((T)=>{let Y=L.time||1,$A=L.parallelism||1,IA=R(L.pass),p=U(T,IA),tA=IA.length,fA=R(L.salt),WA=U(T,fA),GA=fA.length,s=L.type||j.Argon2d,v=T.allocate(new Array(L.hashLen||24),"i8",T.ALLOC_NORMAL),b=L.secret?B(T,L.secret):0,BA=L.secret?L.secret.byteLength:0,S=L.ad?B(T,L.ad):0,s6=L.ad?L.ad.byteLength:0,SA=L.hashLen||24,Qj=T._argon2_encodedlen(Y,K,$A,GA,SA,s),rA=T.allocate(new Array(Qj+1),"i8",T.ALLOC_NORMAL),j_=19,o,NA;try{NA=T._argon2_hash_ext(Y,K,$A,p,tA,WA,GA,v,SA,rA,Qj,s,b,BA,S,s6,19)}catch(a){o=a}let DA;if(NA===0&&!o){let a="",Zj=new Uint8Array(SA);for(let VA=0;VA<SA;VA++){let fj=T.HEAP8[v+VA];Zj[VA]=fj,a+=("0"+(255&fj).toString(16)).slice(-2)}let o6=T.UTF8ToString(rA);DA={hash:Zj,hashHex:a,encoded:o6}}else{try{if(!o)o=T.UTF8ToString(T._argon2_error_message(NA))}catch(a){}DA={message:o,code:NA}}try{if(T._free(p),T._free(WA),T._free(v),T._free(rA),S)T._free(S);if(b)T._free(b)}catch(a){}if(o)throw DA;else return DA})}function P(L){return q().then((K)=>{let T=R(L.pass),Y=U(K,T),$A=T.length,IA=L.secret?B(K,L.secret):0,p=L.secret?L.secret.byteLength:0,tA=L.ad?B(K,L.ad):0,fA=L.ad?L.ad.byteLength:0,WA=R(L.encoded),GA=U(K,WA),s=L.type;if(s===void 0){let S=L.encoded.split("$")[1];if(S)S=S.replace("a","A"),s=j[S]||j.Argon2d}let v,b;try{b=K._argon2_verify_ext(GA,Y,$A,IA,p,tA,fA,s)}catch(S){v=S}let BA;if(b||v){try{if(!v)v=K.UTF8ToString(K._argon2_error_message(b))}catch(S){}BA={message:v,code:b}}try{K._free(Y),K._free(GA)}catch(S){}if(v)throw BA;else return BA})}function H(){if(q._module)q._module.unloadRuntime(),delete q._promise,delete q._module}return{ArgonType:j,hash:F,verify:P,unloadRuntime:H}})});var H6=Z((w_,P6)=>{var uA=/^[a-z0-9-]{1,32}$/,gA=/^[a-z0-9-]{1,32}$/,cA=/^[a-zA-Z0-9/+.-]+$/,T6=/^([a-zA-Z0-9/+.-]+|)$/,JE=/^((-)?[1-9]\d*|0)$/,Rj=/^v=(\d+)$/;function YE(A){return JA(A).map((j)=>[j,A[j]].join("=")).join(",")}function zE(A){let j={};return A.split(",").forEach((q)=>{let E=q.split("=");if(E.length<2)throw new TypeError("params must be in the format name=value");j[E.shift()]=E.join("=")}),j}function JA(A){return Object.keys(A)}function F6(A){if(typeof Object.values==="function")return Object.values(A);return JA(A).map((j)=>A[j])}function QE(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!uA.test(A.id))throw new TypeError(`id must satisfy ${uA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let E=JA(A.params);if(!E.every(($)=>gA.test($)))throw new TypeError(`params names must satisfy ${gA}`);E.forEach(($)=>{if(typeof A.params[$]==="number")A.params[$]=A.params[$].toString();else if(Buffer.isBuffer(A.params[$]))A.params[$]=A.params[$].toString("base64").split("=")[0]});let _=F6(A.params);if(!_.every(($)=>typeof $==="string"))throw new TypeError("params values must be strings");if(!_.every(($)=>cA.test($)))throw new TypeError(`params values must satisfy ${cA}`);let k=YE(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function ZE(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let q=5;if(!Rj.test(j[1]))q--;if(j.length>q)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${q}`);let E=j.shift();if(!uA.test(E))throw new TypeError(`id must satisfy ${uA}`);let _;if(Rj.test(j[0]))_=parseInt(j.shift().match(Rj)[1],10);let k,$;if(T6.test(j[j.length-1]))if(j.length>1&&T6.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),$=Buffer.from(j.pop(),"base64");else $=Buffer.from(j.pop(),"base64");let I;if(j.length>0){let U=j.pop();if(I=zE(U),!JA(I).every((P)=>gA.test(P)))throw new TypeError(`params names must satisfy ${gA}`);if(!F6(I).every((P)=>cA.test(P)))throw new TypeError(`params values must satisfy ${cA}`);JA(I).forEach((P)=>{I[P]=JE.test(I[P])?parseInt(I[P],10):I[P]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let B={id:E};if(_)B.version=_;if(I)B.params=I;if($)B.salt=$;if(k)B.hash=k;return B}P6.exports={serialize:QE,deserialize:ZE}});var v6=Z((y_,y6)=>{var z6=J("fs"),x=J("path"),Q6=J("os"),Z6=typeof __webpack_require__==="function"?__non_webpack_require__:J,fE=process.config&&process.config.variables||{},WE=!!process.env.PREBUILDS_ONLY,X6=process.versions.modules,Kj=DE()?"electron":NE()?"node-webkit":"node",Tj=process.env.npm_config_arch||Q6.arch(),Fj=process.env.npm_config_platform||Q6.platform(),f6=process.env.LIBC||(VE(Fj)?"musl":"glibc"),Pj=process.env.ARM_VERSION||(Tj==="arm64"?"8":fE.arm_version)||"",W6=(process.versions.uv||"").split(".")[0];y6.exports=O;function O(A){return Z6(O.resolve(A))}O.resolve=O.path=function(A){A=x.resolve(A||".");try{var j=Z6(x.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(B){}if(!WE){var q=J6(x.join(A,"build/Release"),Y6);if(q)return q;var E=J6(x.join(A,"build/Debug"),Y6);if(E)return E}var _=I(A);if(_)return _;var k=I(x.dirname(process.execPath));if(k)return k;var $=["platform="+Fj,"arch="+Tj,"runtime="+Kj,"abi="+X6,"uv="+W6,Pj?"armv="+Pj:"","libc="+f6,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+$+`
    loaded from: `+A+`
`);function I(B){var U=Hj(x.join(B,"prebuilds")).map(S6),R=U.filter(N6(Fj,Tj)).sort(D6)[0];if(!R)return;var F=x.join(B,"prebuilds",R.name),P=Hj(F).map(V6),H=P.filter(M6(Kj,X6)),L=H.sort(w6(Kj))[0];if(L)return x.join(F,L.file)}};function Hj(A){try{return z6.readdirSync(A)}catch(j){return[]}}function J6(A,j){var q=Hj(A).filter(j);return q[0]&&x.join(A,q[0])}function Y6(A){return/\.node$/.test(A)}function S6(A){var j=A.split("-");if(j.length!==2)return;var q=j[0],E=j[1].split("+");if(!q)return;if(!E.length)return;if(!E.every(Boolean))return;return{name:A,platform:q,architectures:E}}function N6(A,j){return function(q){if(q==null)return!1;if(q.platform!==A)return!1;return q.architectures.includes(j)}}function D6(A,j){return A.architectures.length-j.architectures.length}function V6(A){var j=A.split("."),q=j.pop(),E={file:A,specificity:0};if(q!=="node")return;for(var _=0;_<j.length;_++){var k=j[_];if(k==="node"||k==="electron"||k==="node-webkit")E.runtime=k;else if(k==="napi")E.napi=!0;else if(k.slice(0,3)==="abi")E.abi=k.slice(3);else if(k.slice(0,2)==="uv")E.uv=k.slice(2);else if(k.slice(0,4)==="armv")E.armv=k.slice(4);else if(k==="glibc"||k==="musl")E.libc=k;else continue;E.specificity++}return E}function M6(A,j){return function(q){if(q==null)return!1;if(q.runtime&&q.runtime!==A&&!SE(q))return!1;if(q.abi&&q.abi!==j&&!q.napi)return!1;if(q.uv&&q.uv!==W6)return!1;if(q.armv&&q.armv!==Pj)return!1;if(q.libc&&q.libc!==f6)return!1;return!0}}function SE(A){return A.runtime==="node"&&A.napi}function w6(A){return function(j,q){if(j.runtime!==q.runtime)return j.runtime===A?-1:1;else if(j.abi!==q.abi)return j.abi?-1:1;else if(j.specificity!==q.specificity)return j.specificity>q.specificity?-1:1;else return 0}}function NE(){return!!(process.versions&&process.versions.nw)}function DE(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function VE(A){return A==="linux"&&z6.existsSync("/etc/alpine-release")}O.parseTags=V6;O.matchTags=M6;O.compareTags=w6;O.parseTuple=S6;O.matchTuple=N6;O.compareTuples=D6});var O6=Z((O_,Jj)=>{var Xj=typeof __webpack_require__==="function"?__non_webpack_require__:J;if(typeof Xj.addon==="function")Jj.exports=Xj.addon.bind(Xj);else Jj.exports=v6()});var h6=Z((gE,r)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",x_=J("node:assert"),{randomBytes:ME,timingSafeEqual:wE}=J("node:crypto"),{promisify:yE}=J("node:util"),{deserialize:C6,serialize:vE}=H6(),OE=O6(),{hash:x6}=OE(__dirname),CE=yE(ME);gE.argon2d=0;gE.argon2i=1;gE.argon2id=2;var YA=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),xE=Object.freeze({[YA.argon2d]:"argon2d",[YA.argon2i]:"argon2i",[YA.argon2id]:"argon2id"}),b6={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function bE(A,j){let{raw:q,salt:E,..._}={...b6,...j};if(_.hashLength>4294967295)throw new RangeError("Hash length is too large");if(_.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(_.timeCost>4294967295)throw new RangeError("Time cost is too large");if(_.parallelism>16777215)throw new RangeError("Parallelism is too large");E=E??await CE(16);let{hashLength:k,secret:$=Buffer.alloc(0),type:I,version:B,memoryCost:U,timeCost:R,parallelism:F,associatedData:P=Buffer.alloc(0)}=_,H=await x6({password:Buffer.from(A),salt:E,secret:$,data:P,hashLength:k,m:U,t:R,p:F,version:B,type:I});if(q)return H;return vE({id:xE[I],version:B,params:{m:U,t:R,p:F,...P.byteLength>0?{data:P}:{}},salt:E,hash:H})}gE.hash=bE;function hE(A,j={}){let{memoryCost:q,timeCost:E,parallelism:_,version:k}={...b6,...j},{version:$,params:{m:I,t:B,p:U}}=C6(A);return+$!==+k||+I!==+q||+B!==+E||+U!==+_}gE.needsRehash=hE;async function uE(A,j,q={}){let{id:E,..._}=C6(A);if(!(E in YA))return!1;let{version:k=16,params:{m:$,t:I,p:B,data:U=""},salt:R,hash:F}=_,{secret:P=Buffer.alloc(0)}=q;return wE(await x6({password:Buffer.from(j),salt:R,secret:P,data:Buffer.from(U,"base64"),hashLength:F.byteLength,m:+$,t:+I,p:+B,version:+k,type:YA[E]}),F)}gE.verify=uE});var lj=MA(cj(),1),{program:U_,createCommand:L_,createArgument:R_,createOption:K_,CommanderError:T_,InvalidArgumentError:F_,InvalidOptionArgumentError:P_,Command:mj,Argument:H_,Option:e,Help:X_}=lj.default;import{existsSync as _A}from"node:fs";import{createReadStream as i6,createWriteStream as t6}from"node:fs";import{stdin as f,stdout as kA,stderr as Q,exit as y}from"node:process";import{Readable as sE,Writable as oE}from"node:stream";import{open as aE}from"node:fs/promises";class l extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class h extends l{}class yA extends l{}class AA extends l{}class u extends l{}class vA extends l{}class M extends l{}class z{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new yA(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new yA(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class jj{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),q=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),E=new Uint8Array(j.length+q.length);return E.set(j),E.set(q,j.length),E}async decryptChunk(A){let j=A.slice(0,12),q=A.slice(12),E=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,q);try{let _=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,q);return new Uint8Array(_)}catch{throw new M("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var lA=MA(K6(),1);async function u6(A,j,q,E){if(E==="node"){let _=await Promise.resolve().then(() => MA(h6(),1)),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),$=Buffer.from(j),I=await _.hash(k,{salt:$,timeCost:q.time,memoryCost:q.mem,parallelism:q.parallelism,hashLength:32,raw:!0,type:_.argon2id});return{hash:new Uint8Array(I)}}if(E==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>{let _=new URL("argon2.wasm",import.meta.url).href;return fetch(_).then((k)=>{if(!k.ok)throw new Error("Failed to load argon2.wasm");return k.arrayBuffer()}).then((k)=>new Uint8Array(k))};return lA.hash({pass:A,salt:j,time:q.time,mem:q.mem,parallelism:q.parallelism,hashLen:32,type:lA.ArgonType.Argon2id}).then((_)=>{if(!_||!_.hash)throw new Error("Failed to produce key derivation");return{hash:_.hash}}).catch((_)=>{let k=_ instanceof Error?_.message:typeof _==="string"?_:"Unknown error";throw new u(`argon2-browser failure: ${k}`)})}throw new Error(`Unsupported environment: ${E}`)}class Yj{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,q,E){let{hash:_}=await u6(A,j,this.presets[q],E.isNode?"node":"browser");return E.subtle.importKey("raw",_,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var g6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},rE={id:0,cipher:jj,kdf:new Yj(g6),saltLengths:{low:12,high:16},difficulties:g6,defaultChunkSize:524288};z.register(rE);var mA=1;function c6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function zA(...A){let j=A.reduce((_,k)=>_+k.byteLength,0),q=new Uint8Array(j),E=0;for(let _ of A)q.set(_,E),E+=_.byteLength;return q}function QA(...A){let j=zA(...A);if(c6())return Buffer.from(j).toString("base64");let q="";for(let E=0;E<j.length;E++)q+=String.fromCharCode(j[E]);return btoa(q)}function zj(A){if(c6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),q=new Uint8Array(j.length);for(let E=0;E<j.length;E++)q[E]=j.charCodeAt(E);return q}function nA(A,j,q,E){let _={low:0,middle:1,high:2}[j]??0,k=A<<5|(q==="high"?1:0)<<2|_;return zA(new Uint8Array([mA,k]),E)}function d(A){if(A[0]!==mA)throw new h("Invalid input format. The input is unknown.");try{let j=A[1],q=j>>5,E=j>>2&1?"high":"low",_=j&3,k=["low","middle","high"][_],$=z.get(q).saltLengths[E],I=A.slice(2,2+$);return{version:q,difficulty:k,saltStrength:E,salt:I,headerLen:2+$}}catch(j){throw new AA(j instanceof Error?j.message:String(j))}}class ZA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let q=new Uint8Array(this.buffer.length+A.length);q.set(this.buffer),q.set(A,this.buffer.length);let E=0;while(q.length-E>=this.chunkSize){let _=q.slice(E,E+this.chunkSize);E+=this.chunkSize;let k=await this.engine.encryptChunk(_),$=new Uint8Array(4);new DataView($.buffer).setUint32(0,k.length,!1);let I=new Uint8Array(4+k.length);I.set($),I.set(k,$.length),j.enqueue(I)}this.buffer=q.slice(E)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),q=new Uint8Array(4);new DataView(q.buffer).setUint32(0,j.length,!1);let E=new Uint8Array(4+j.length);E.set(q),E.set(j,4),A.enqueue(E),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class jA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let q=new Uint8Array(this.buffer.length+A.length);q.set(this.buffer),q.set(A,this.buffer.length);let E=0;while(!0){if(q.length-E<4)break;let _=new DataView(q.buffer,q.byteOffset+E,4).getUint32(0,!1);if(q.length-E-4<_)break;E+=4;let k=q.slice(E,E+_);E+=_;try{let $=await this.engine.decryptChunk(k);j.enqueue($)}catch($){throw $ instanceof M?$:new M("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=q.slice(E)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class qA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new ZA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,q=new TransformStream({transform(_,k){if(j===0){k.enqueue(_);return}if(_.byteLength<=j){j-=_.byteLength;return}k.enqueue(_.slice(j)),j=0}}),E=new jA(this.engine,this.chunkSize).toTransformStream();return{writable:q.writable,readable:q.readable.pipeThrough(E)}}async collect(A,j,q=null){let E=A.pipeThrough(j).getReader(),_=[];if(q?.length)_.push(q);while(!0){let{value:B,done:U}=await E.read();if(U)break;_.push(B)}let k=_.reduce((B,U)=>B+U.byteLength,0),$=new Uint8Array(k),I=0;for(let B of _)$.set(B,I),I+=B.byteLength;return $}}function l6(A=0,j=console.info){return{level:A,log(q,E){if(q<=A)j(`${q}| ${E}`)}}}var m6=new Map;class c{static getEngine(A,j){let q=m6.get(j);if(q)return q;let E=z.get(j),_=new E.cipher(A),k=E.kdf,$=E.defaultChunkSize;return q={desc:E,cipher:_,kdf:k,chunkSize:$,provider:A},m6.set(j,q),q}static async deriveKey(A,j,q,E){try{let _=await A.kdf.derive(j,q,E,A.provider);A.cipher.key=_}catch(_){let k=_ instanceof Error?_.message:String(_);throw new u(k)}}}class w{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=z.get(j.version??z.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new qA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=l6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await w.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await w.peekHeader(A),q=d(j);return{version:q.version,difficulty:q.difficulty,salt:QA(q.salt),saltLength:q.salt.byteLength}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setVersion(A){this.v=z.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new qA(this.cipher,this.chunkSize)}getVersion(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){this.chunkSize=A,this.stream=new qA(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){try{this.log.log(1,"Start text encryption"),this.log.log(2,"Deriving key for text encryption");let q=this.genSalt();await this.deriveKey(j,q),this.log.log(3,`Salt generated: ${QA(q)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let E=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.log.log(3,"Encoding header");let _=nA(this.v.id,this.difficulty,this.saltStrength,q);return this.log.log(3,"Encoding text"),QA(_,E)}catch(q){throw new vA(q instanceof Error?q.message:String(q))}}async decryptText(A,j){try{this.log.log(1,"Start text decryption");let q=zj(A);this.log.log(3,"Start header decoding"),await w.peekHeader(A);let E=d(q);this.log.log(3,"Trying to get engine");let _=c.getEngine(this.provider,E.version);this.log.log(2,"Deriving key via engine for text decryption"),this.log.log(3,`Salt use: ${QA(E.salt)}, KDF difficulty: ${E.difficulty}`),await c.deriveKey(_,j,E.salt,E.difficulty),this.log.log(2,"Decrypting text data");let k=await _.cipher.decryptChunk(q.slice(E.headerLen));return this.log.log(3,"Decoding text"),new TextDecoder().decode(k)}catch(q){if(q instanceof M||q instanceof h||q instanceof AA||q instanceof u)throw q;throw new M("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){try{this.log.log(2,"Deriving key for file encryption");let q=this.genSalt();await this.deriveKey(j,q);let E=nA(this.v.id,this.difficulty,this.saltStrength,q),_=await this.stream.collect(A.stream(),new ZA(this.cipher,this.chunkSize).toTransformStream(),E);return new Blob([_],{type:"application/octet-stream"})}catch(q){throw new vA(q instanceof Error?q.message:String(q))}}async decryptFile(A,j){try{let q=await w.peekHeader(A),E=d(q),_=c.getEngine(this.provider,E.version);await c.deriveKey(_,j,E.salt,E.difficulty),this.log.log(2,"Decrypting file data");let $=await new qA(_.cipher,_.chunkSize).collect(A.slice(E.headerLen).stream(),new jA(_.cipher,_.chunkSize).toTransformStream());return new Blob([$],{type:"application/octet-stream"})}catch(q){if(q instanceof M)throw q;throw new M(q instanceof Error?q.message:String(q))}}async createEncryptionStream(A){this.log.log(2,"Deriving key for stream encryption");let j=this.genSalt();await this.deriveKey(A,j);let q=nA(this.v.id,this.difficulty,this.saltStrength,j),E=this.stream.encryptionStream();return{header:q,writable:E.writable,readable:E.readable}}async createDecryptionStream(A){let j=this,q=new Uint8Array(0),E=null;async function _(k,$){let I=k.getReader();while(!0){let{value:B,done:U}=await I.read();if(U)break;$.enqueue(B)}}return new TransformStream({async transform(k,$){if(!E){if(q=zA(q,k),q.length<2)return;let B=q.slice(0,30),{salt:U,difficulty:R}=d(B),F=q[1]>>5,P=q[1]>>2&1?"high":"low",L=2+z.get(F).saltLengths[P];if(q.length<L)return;let K=c.getEngine(j.provider,F);await c.deriveKey(K,A,U,R),E=new jA(K.cipher,K.chunkSize).toTransformStream(),_(E.readable,$);let T=q.slice(L);if(T.length){let Y=E.writable.getWriter();await Y.write(T),Y.releaseLock()}return}let I=E.writable.getWriter();await I.write(k),I.releaseLock()},async flush(){if(E){let k=E.writable.getWriter();await k.close(),k.releaseLock()}}})}async deriveKey(A,j,q=this.difficulty){let E=performance.now();try{let _=await this.kdf.derive(A,j,q,this.provider);this.cipher.key=_,this.log.log(3,`Key derivation completed in ${(performance.now()-E).toFixed(1)} ms`)}catch(_){throw new u(_ instanceof Error?_.message:String(_))}}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}static async peekHeader(A){if(typeof A==="string")A=zj(A);if(A instanceof Uint8Array){if(A.length<2)throw new h("Input too short");let{headerLen:j}=d(A.length>=16?A:Uint8Array.from(A));if(A.length<j)throw new h("Incomplete header");return A.slice(0,j)}if(A instanceof Blob){let j=new Uint8Array(await A.slice(0,2).arrayBuffer());if(j[0]!==1)throw new h("Invalid input format. The input is unknown.");let q=j[1],E=q>>5,_=q>>2&1?"high":"low",k=z.get(E).saltLengths[_],$=new Uint8Array(await A.slice(0,2+k).arrayBuffer());return d($),$}throw new AA("Unsupported input type")}}import{webcrypto as dE,randomFillSync as pE}from"node:crypto";var n6={subtle:dE.subtle,getRandomValues(A){return pE(A),A},isNode:!0};function EA(A){return new w(n6,A)}var eE="0.2.3";async function iA(){if(!f.isTTY)throw new Error("STDIN not a TTY; use --pass");Q.write("Passphrase: "),f.setRawMode?.(!0),f.resume(),f.setEncoding("utf8");let A="";return new Promise((j)=>{function q(){f.setRawMode?.(!1),f.pause(),Q.write(`
`),f.off("data",E),j(A)}function E(_){if(_==="\x03")y(130);if(_==="\r"||_===`
`)return q();if(_==="\b"||_===""){A=A.slice(0,-1);return}A+=_}f.on("data",E)})}function r6(A){return sE.toWeb(A)}function d6(A){return oE.toWeb(A)}async function p6(){let A=[];for await(let j of f)A.push(j);return Buffer.concat(A).toString("utf8")}var D=new mj;D.name("cryptit").version(eE).description("AES-GCM / Argon2 encryption utility").addOption(new e("-p, --pass <passphrase>","passphrase (prompt if omitted)").hideHelp().argParser((A)=>{if(!A.trim())throw new Error("Passphrase cannot be empty");return A})).addOption(new e("-d, --difficulty <level>","argon2 difficulty").choices(["low","middle","high"]).default("middle","middle")).addOption(new e("-s, --salt-strength <variant>","salt length variant").choices(["low","high"]).default("high","high")).addOption(new e("-c, --chunk-size <bytes>","chunk size in bytes").argParser((A)=>{let j=Number(A);if(!Number.isInteger(j)||j<=0)throw new Error("Chunk size must be a positive integer");return j}).default(524288,"512*1024")).addOption(new e("-v, --verbose","increase verbosity (use multiple times)").default(0).argParser((A,j)=>{return j+1}));process.on("uncaughtException",(A)=>{if(A instanceof Error){let j=A.constructor.name,q=A.message;Q.write(`Error [${j}]: ${q}
`)}else Q.write(`Error [Unknown]: ${String(A)}
`);y(1)});process.on("unhandledRejection",(A)=>{if(A instanceof Error){let j=A.constructor.name,q=A.message;Q.write(`Error [${j}]: ${q}
`)}else Q.write(`Error [Unknown]: ${String(A)}
`);y(1)});async function A_(){let A=[];for await(let j of f)A.push(j);return Buffer.concat(A)}D.command("decode [src]").description("Show Cryptit header information; omit arg or use - to read from STDIN").action(async(A)=>{let{verbose:j}=D.opts(),E=EA({verbose:j,logger:(U)=>Q.write(U)}),_=!A||A==="-";async function k(U){if(U.length<2)throw new Error("Input too short for header");let R=U[1],F=R>>5,P=R>>2&1?"high":"low",H=z.get(F).saltLengths[P],L=U.slice(0,2+H);return w.headerDecode(L)}if(!_&&A){let U=await aE(A,"r"),R=Buffer.alloc(2);await U.read(R,0,2,0);let F=R[1],P=F>>5,H=F>>2&1?"high":"low",L=z.get(P).saltLengths[H],K=Buffer.alloc(2+L);await U.read(K,0,2+L,0),await U.close();let T=await w.headerDecode(new Uint8Array(K));kA.write(JSON.stringify(T,null,2)+`
`);return}let $=_?await A_():Buffer.from(A,"utf8"),I=$.toString("utf8").trim(),B=/^[A-Za-z0-9\/+]+={0,2}$/.test(I)&&I.length%4===0;try{let U=B?await w.headerDecode(I):await k($);kA.write(JSON.stringify(U,null,2)+`
`)}catch(U){let R=U instanceof Error?U.message:String(U);Q.write(`Error: ${R}
`),y(1)}});D.command("encrypt <src>").description("Encrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async(A,j)=>{if(A!=="-"&&!_A(A))Q.write(`Error: input file not found: ${A}
`),y(1);let q=D.opts(),E=EA({difficulty:q.difficulty,saltStrength:q.saltStrength,chunkSize:q.chunkSize,verbose:q.verbose}),_=q.pass??(f.isTTY?await iA():(()=>{Q.write(`Use --pass when piping via STDIN
`),y(1)})()),k=j.out;if(k!=="-"&&!_A(k)&&!_A(J("path").dirname(k)))Q.write(`Error: output directory does not exist: ${J("path").dirname(k)}
`),y(1);let $=A==="-"?f:i6(A),I=j.out==="-"?kA:t6(j.out),{header:B,writable:U,readable:R}=await E.createEncryptionStream(_),F=r6($),P=d6(I),H=P.getWriter();await H.write(B),H.releaseLock(),await Promise.all([F.pipeTo(U),R.pipeTo(P)])});D.command("decrypt <src>").description("Decrypt file; use - for STDIN, --out - for STDOUT").option("-o, --out <file>","output file (default STDOUT)","-").action(async(A,j)=>{if(A!=="-"&&!_A(A))Q.write(`Error: input file not found: ${A}
`),y(1);let q=D.opts(),E=EA({difficulty:q.difficulty,saltStrength:q.saltStrength,chunkSize:q.chunkSize,verbose:q.verbose}),_=j.out;if(_!=="-"&&!_A(_)&&!_A(J("path").dirname(_)))Q.write(`Error: output directory does not exist: ${J("path").dirname(_)}
`),y(1);let k=q.pass??await iA(),$=A==="-"?f:i6(A),I=j.out==="-"?kA:t6(j.out),B=r6($),U=d6(I),R=await E.createDecryptionStream(k);await Promise.all([B.pipeTo(R.writable),R.readable.pipeTo(U)])});D.command("encrypt-text [text]").description("Encrypt plaintext; omit arg to read from STDIN").action(async(A)=>{let j=D.opts(),q=EA({difficulty:j.difficulty,saltStrength:j.saltStrength,verbose:j.verbose}),E=j.pass??(f.isTTY?await iA():(()=>{Q.write(`Use --pass when piping via STDIN
`),y(1)})()),_=A??await p6(),k=await q.encryptText(_,E);kA.write(k+`
`)});D.command("decrypt-text [b64]").description("Decrypt Base64 ciphertext; omit arg to read from STDIN").action(async(A)=>{let j=D.opts(),q=EA({difficulty:j.difficulty,saltStrength:j.saltStrength,verbose:j.verbose}),E=j.pass??await iA(),_=A??(await p6()).trim();if(!/^[A-Za-z0-9+/]+={0,2}$/.test(_))Q.write(`Error: ciphertext does not look like Base64
`),y(1);let k=await q.decryptText(_,E);kA.write(k+`
`)});D.parse();

//# debugId=D129BC11731E16D464756E2164756E21
