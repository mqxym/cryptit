import{createRequire as sj}from"node:module";var bj=Object.create;var{getPrototypeOf:ej,defineProperty:mA,getOwnPropertyNames:lj}=Object;var pj=Object.prototype.hasOwnProperty;var KA=(A,j,n)=>{n=A!=null?bj(ej(A)):{};let E=j||!A||!A.__esModule?mA(n,"default",{value:A,enumerable:!0}):n;for(let q of lj(A))if(!pj.call(E,q))mA(E,q,{get:()=>A[q],enumerable:!0});return E};var T=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var R=sj(import.meta.url);var cA=T((On,C)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",t=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},dj=t,h={},x;for(x in t)if(t.hasOwnProperty(x))h[x]=t[x];var m=[],pA="./this.program",UA=function(A,j){throw j},vA=!1,y=!1,DA=!1,sA=!1;vA=typeof window==="object";y=typeof importScripts==="function";DA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";sA=!vA&&!DA&&!y;var K="";function aj(A){if(t.locateFile)return t.locateFile(A,K);return K+A}var kA,SA,b,A6,PA,uA;if(DA){if(y)K=R("path").dirname(K)+"/";else K=__dirname+"/";if(kA=function A(j,n){if(!PA)PA=R("fs");if(!uA)uA=R("path");return j=uA.normalize(j),PA.readFileSync(j,n?null:"utf8")},b=function A(j){var n=kA(j,!0);if(!n.buffer)n=new Uint8Array(n);return bA(n.buffer),n},process.argv.length>1)pA=process.argv[1].replace(/\\/g,"/");if(m=process.argv.slice(2),typeof C!=="undefined")C.exports=t;process.on("uncaughtException",function(A){if(!(A instanceof C6))throw A}),process.on("unhandledRejection",s),UA=function(A){process.exit(A)},t.inspect=function(){return"[Emscripten Module object]"}}else if(sA){if(typeof read!="undefined")kA=function A(j){return read(j)};if(b=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),bA(typeof n==="object"),n},typeof scriptArgs!="undefined")m=scriptArgs;else if(typeof arguments!="undefined")m=arguments;if(typeof quit==="function")UA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(vA||y){if(y)K=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)K=document.currentScript.src;if(K.indexOf("blob:")!==0)K=K.substr(0,K.lastIndexOf("/")+1);else K="";{if(kA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},y)b=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};SA=function(A,j,n){var E=new XMLHttpRequest;E.open("GET",A,!0),E.responseType="arraybuffer",E.onload=function(){if(E.status==200||E.status==0&&E.response){j(E.response);return}n()},E.onerror=n,E.send(null)}}A6=function(A){document.title=A}}var Bn=t.print||console.log.bind(console),g=t.printErr||console.warn.bind(console);for(x in h)if(h.hasOwnProperty(x))t[x]=h[x];h=null;if(t.arguments)m=t.arguments;if(t.thisProgram)pA=t.thisProgram;if(t.quit)UA=t.quit;var l;if(t.wasmBinary)l=t.wasmBinary;var Ln=t.noExitRuntime||!0;if(typeof WebAssembly!=="object")s("no native wasm support detected");var p,dA=!1,j6;function bA(A,j){if(!A)s("Assertion failed: "+j)}var n6=0,E6=1;function t6(A,j){var n;if(j==E6)n=$j(A.length);else n=Ij(A.length);if(A.subarray||A.slice)w.set(A,n);else w.set(new Uint8Array(A),n);return n}var eA=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function q6(A,j,n){var E=j+n,q=j;while(A[q]&&!(q>=E))++q;if(q-j>16&&A.subarray&&eA)return eA.decode(A.subarray(j,q));else{var k="";while(j<q){var r=A[j++];if(!(r&128)){k+=String.fromCharCode(r);continue}var f=A[j++]&63;if((r&224)==192){k+=String.fromCharCode((r&31)<<6|f);continue}var v=A[j++]&63;if((r&240)==224)r=(r&15)<<12|f<<6|v;else r=(r&7)<<18|f<<12|v<<6|A[j++]&63;if(r<65536)k+=String.fromCharCode(r);else{var $=r-65536;k+=String.fromCharCode(55296|$>>10,56320|$&1023)}}}return k}function r6(A,j){return A?q6(w,A,j):""}function k6(A,j){if(A%j>0)A+=j-A%j;return A}var xA,aA,w,Aj,jj,nj,Ej,tj,qj;function rj(A){xA=A,t.HEAP8=aA=new Int8Array(A),t.HEAP16=Aj=new Int16Array(A),t.HEAP32=nj=new Int32Array(A),t.HEAPU8=w=new Uint8Array(A),t.HEAPU16=jj=new Uint16Array(A),t.HEAPU32=Ej=new Uint32Array(A),t.HEAPF32=tj=new Float32Array(A),t.HEAPF64=qj=new Float64Array(A)}var Rn=t.INITIAL_MEMORY||16777216,iA,kj=[],ij=[],fj=[],i6=!1;function f6(){if(t.preRun){if(typeof t.preRun=="function")t.preRun=[t.preRun];while(t.preRun.length)I6(t.preRun.shift())}TA(kj)}function v6(){i6=!0,TA(ij)}function _6(){if(t.postRun){if(typeof t.postRun=="function")t.postRun=[t.postRun];while(t.postRun.length)F6(t.postRun.shift())}TA(fj)}function I6(A){kj.unshift(A)}function $6(A){ij.unshift(A)}function F6(A){fj.unshift(A)}var c=0,NA=null,e=null;function B6(A){if(c++,t.monitorRunDependencies)t.monitorRunDependencies(c)}function L6(A){if(c--,t.monitorRunDependencies)t.monitorRunDependencies(c);if(c==0){if(NA!==null)clearInterval(NA),NA=null;if(e){var j=e;e=null,j()}}}t.preloadedImages={};t.preloadedAudios={};function s(A){if(t.onAbort)t.onAbort(A);A+="",g(A),dA=!0,j6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var R6="data:application/octet-stream;base64,";function vj(A){return A.startsWith(R6)}function _j(A){return A.startsWith("file://")}var G="argon2.wasm";if(!vj(G))G=aj(G);function lA(A){try{if(A==G&&l)return new Uint8Array(l);if(b)return b(A);else throw"both async and sync fetching of the wasm failed"}catch(j){s(j)}}function O6(){if(!l&&(vA||y)){if(typeof fetch==="function"&&!_j(G))return fetch(G,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+G+"'";return A.arrayBuffer()}).catch(function(){return lA(G)});else if(SA)return new Promise(function(A,j){SA(G,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return lA(G)})}function G6(){var A={a:u6};function j(r,f){var v=r.exports;t.asm=v,p=t.asm.c,rj(p.buffer),iA=t.asm.k,$6(t.asm.d),L6("wasm-instantiate")}B6("wasm-instantiate");function n(r){j(r.instance)}function E(r){return O6().then(function(f){var v=WebAssembly.instantiate(f,A);return v}).then(r,function(f){g("failed to asynchronously prepare wasm: "+f),s(f)})}function q(){if(!l&&typeof WebAssembly.instantiateStreaming==="function"&&!vj(G)&&!_j(G)&&typeof fetch==="function")return fetch(G,{credentials:"same-origin"}).then(function(r){var f=WebAssembly.instantiateStreaming(r,A);return f.then(n,function(v){return g("wasm streaming compile failed: "+v),g("falling back to ArrayBuffer instantiation"),E(n)})});else return E(n)}if(t.instantiateWasm)try{var k=t.instantiateWasm(A,j);return k}catch(r){return g("Module.instantiateWasm callback failed with error: "+r),!1}return q(),{}}function TA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(t);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)iA.get(n)();else iA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function H6(A,j,n){w.copyWithin(A,j,j+n)}function K6(A){try{return p.grow(A-xA.byteLength+65535>>>16),rj(p.buffer),1}catch(j){}}function P6(A){var j=w.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var E=1;E<=4;E*=2){var q=j*(1+0.2/E);q=Math.min(q,A+100663296);var k=Math.min(n,k6(Math.max(A,q),65536)),r=K6(k);if(r)return!0}return!1}var u6={a:H6,b:P6},N6=G6(),U6=t.___wasm_call_ctors=function(){return(U6=t.___wasm_call_ctors=t.asm.d).apply(null,arguments)},S6=t._argon2_hash=function(){return(S6=t._argon2_hash=t.asm.e).apply(null,arguments)},Ij=t._malloc=function(){return(Ij=t._malloc=t.asm.f).apply(null,arguments)},D6=t._free=function(){return(D6=t._free=t.asm.g).apply(null,arguments)},x6=t._argon2_verify=function(){return(x6=t._argon2_verify=t.asm.h).apply(null,arguments)},T6=t._argon2_error_message=function(){return(T6=t._argon2_error_message=t.asm.i).apply(null,arguments)},y6=t._argon2_encodedlen=function(){return(y6=t._argon2_encodedlen=t.asm.j).apply(null,arguments)},c6=t._argon2_hash_ext=function(){return(c6=t._argon2_hash_ext=t.asm.l).apply(null,arguments)},w6=t._argon2_verify_ext=function(){return(w6=t._argon2_verify_ext=t.asm.m).apply(null,arguments)},$j=t.stackAlloc=function(){return($j=t.stackAlloc=t.asm.n).apply(null,arguments)};t.allocate=t6;t.UTF8ToString=r6;t.ALLOC_NORMAL=n6;var fA;function C6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}e=function A(){if(!fA)yA();if(!fA)e=A};function yA(A){if(A=A||m,c>0)return;if(f6(),c>0)return;function j(){if(fA)return;if(fA=!0,t.calledRun=!0,dA)return;if(v6(),t.onRuntimeInitialized)t.onRuntimeInitialized();_6()}if(t.setStatus)t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),j()},1);else j()}t.run=yA;if(t.preInit){if(typeof t.preInit=="function")t.preInit=[t.preInit];while(t.preInit.length>0)t.preInit.pop()()}yA();if(typeof C!=="undefined")C.exports=t;t.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(t=dj=p=iA=N6=xA=aA=w=Aj=jj=nj=Ej=tj=qj=void 0,typeof C!=="undefined")delete C.exports}});var Fj=T((Gn,W6)=>{W6.exports="./cryptit.index.wasm"});var Lj=T((Bj,_A)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof _A==="object"&&_A.exports)_A.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:Bj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(i){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=q().then((_)=>new Promise((L)=>{_.postRun=()=>L(_)}));else I=k().then((_)=>{let L=i?f(i):void 0;return E(_,L)});return n._promise=I,I.then((_)=>{return n._module=_,delete n._promise,_})}function E(i,I){return new Promise((_)=>{return A.Module={wasmBinary:i,wasmMemory:I,postRun(){_(Module)}},q()})}function q(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(cA())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(Fj()).then((I)=>{return r(I)})}function r(i){let I=atob(i),_=new Uint8Array(new ArrayBuffer(I.length));for(let L=0;L<I.length;L++)_[L]=I.charCodeAt(L);return _}function f(i){let X=Math.min(Math.max(Math.ceil(i*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:X,maximum:32767})}function v(i,I){return i.allocate(I,"i8",i.ALLOC_NORMAL)}function $(i,I){let _=new Uint8Array([...I,0]);return v(i,_)}function B(i){if(typeof i!=="string")return i;if(typeof TextEncoder==="function")return new TextEncoder().encode(i);else if(typeof Buffer==="function")return Buffer.from(i);else throw new Error("Don't know how to encode UTF8")}function O(i){let I=i.mem||1024;return n(I).then((_)=>{let L=i.time||1,z=i.parallelism||1,Z=B(i.pass),X=$(_,Z),GA=Z.length,jA=B(i.salt),nA=$(_,jA),M=jA.length,J=i.type||j.Argon2d,P=_.allocate(new Array(i.hashLen||24),"i8",_.ALLOC_NORMAL),D=i.secret?v(_,i.secret):0,o=i.secret?i.secret.byteLength:0,H=i.ad?v(_,i.ad):0,hj=i.ad?i.ad.byteLength:0,EA=i.hashLen||24,oA=_._argon2_encodedlen(L,I,z,M,EA,J),HA=_.allocate(new Array(oA+1),"i8",_.ALLOC_NORMAL),In=19,V,tA;try{tA=_._argon2_hash_ext(L,I,z,X,GA,nA,M,P,EA,HA,oA,J,D,o,H,hj,19)}catch(Y){V=Y}let qA;if(tA===0&&!V){let Y="",gA=new Uint8Array(EA);for(let rA=0;rA<EA;rA++){let hA=_.HEAP8[P+rA];gA[rA]=hA,Y+=("0"+(255&hA).toString(16)).slice(-2)}let mj=_.UTF8ToString(HA);qA={hash:gA,hashHex:Y,encoded:mj}}else{try{if(!V)V=_.UTF8ToString(_._argon2_error_message(tA))}catch(Y){}qA={message:V,code:tA}}try{if(_._free(X),_._free(nA),_._free(P),_._free(HA),H)_._free(H);if(D)_._free(D)}catch(Y){}if(V)throw qA;else return qA})}function F(i){return n().then((I)=>{let _=B(i.pass),L=$(I,_),z=_.length,Z=i.secret?v(I,i.secret):0,X=i.secret?i.secret.byteLength:0,GA=i.ad?v(I,i.ad):0,jA=i.ad?i.ad.byteLength:0,nA=B(i.encoded),M=$(I,nA),J=i.type;if(J===void 0){let H=i.encoded.split("$")[1];if(H)H=H.replace("a","A"),J=j[H]||j.Argon2d}let P,D;try{D=I._argon2_verify_ext(M,L,z,Z,X,GA,jA,J)}catch(H){P=H}let o;if(D||P){try{if(!P)P=I.UTF8ToString(I._argon2_error_message(D))}catch(H){}o={message:P,code:D}}try{I._free(L),I._free(M)}catch(H){}if(P)throw o;else return o})}function S(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:O,verify:F,unloadRuntime:S}})});var Hj=T((Kn,Gj)=>{var IA=/^[a-z0-9-]{1,32}$/,$A=/^[a-z0-9-]{1,32}$/,FA=/^[a-zA-Z0-9/+.-]+$/,Rj=/^([a-zA-Z0-9/+.-]+|)$/,X6=/^((-)?[1-9]\d*|0)$/,wA=/^v=(\d+)$/;function J6(A){return d(A).map((j)=>[j,A[j]].join("=")).join(",")}function V6(A){let j={};return A.split(",").forEach((n)=>{let E=n.split("=");if(E.length<2)throw new TypeError("params must be in the format name=value");j[E.shift()]=E.join("=")}),j}function d(A){return Object.keys(A)}function Oj(A){if(typeof Object.values==="function")return Object.values(A);return d(A).map((j)=>A[j])}function Y6(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!IA.test(A.id))throw new TypeError(`id must satisfy ${IA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let E=d(A.params);if(!E.every((r)=>$A.test(r)))throw new TypeError(`params names must satisfy ${$A}`);E.forEach((r)=>{if(typeof A.params[r]==="number")A.params[r]=A.params[r].toString();else if(Buffer.isBuffer(A.params[r]))A.params[r]=A.params[r].toString("base64").split("=")[0]});let q=Oj(A.params);if(!q.every((r)=>typeof r==="string"))throw new TypeError("params values must be strings");if(!q.every((r)=>FA.test(r)))throw new TypeError(`params values must satisfy ${FA}`);let k=J6(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function Q6(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!wA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let E=j.shift();if(!IA.test(E))throw new TypeError(`id must satisfy ${IA}`);let q;if(wA.test(j[0]))q=parseInt(j.shift().match(wA)[1],10);let k,r;if(Rj.test(j[j.length-1]))if(j.length>1&&Rj.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),r=Buffer.from(j.pop(),"base64");else r=Buffer.from(j.pop(),"base64");let f;if(j.length>0){let $=j.pop();if(f=V6($),!d(f).every((F)=>$A.test(F)))throw new TypeError(`params names must satisfy ${$A}`);if(!Oj(f).every((F)=>FA.test(F)))throw new TypeError(`params values must satisfy ${FA}`);d(f).forEach((F)=>{f[F]=X6.test(f[F])?parseInt(f[F],10):f[F]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let v={id:E};if(q)v.version=q;if(f)v.params=f;if(r)v.salt=r;if(k)v.hash=k;return v}Gj.exports={serialize:Y6,deserialize:Q6}});var Jj=T((Pn,Xj)=>{var Nj=R("fs"),N=R("path"),Uj=R("os"),Sj=typeof __webpack_require__==="function"?__non_webpack_require__:R,z6=process.config&&process.config.variables||{},Z6=!!process.env.PREBUILDS_ONLY,Kj=process.versions.modules,CA=g6()?"electron":o6()?"node-webkit":"node",WA=process.env.npm_config_arch||Uj.arch(),XA=process.env.npm_config_platform||Uj.platform(),Dj=process.env.LIBC||(h6(XA)?"musl":"glibc"),JA=process.env.ARM_VERSION||(WA==="arm64"?"8":z6.arm_version)||"",xj=(process.versions.uv||"").split(".")[0];Xj.exports=u;function u(A){return Sj(u.resolve(A))}u.resolve=u.path=function(A){A=N.resolve(A||".");try{var j=Sj(N.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(v){}if(!Z6){var n=Pj(N.join(A,"build/Release"),uj);if(n)return n;var E=Pj(N.join(A,"build/Debug"),uj);if(E)return E}var q=f(A);if(q)return q;var k=f(N.dirname(process.execPath));if(k)return k;var r=["platform="+XA,"arch="+WA,"runtime="+CA,"abi="+Kj,"uv="+xj,JA?"armv="+JA:"","libc="+Dj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+r+`
    loaded from: `+A+`
`);function f(v){var $=VA(N.join(v,"prebuilds")).map(Tj),B=$.filter(yj(XA,WA)).sort(cj)[0];if(!B)return;var O=N.join(v,"prebuilds",B.name),F=VA(O).map(wj),S=F.filter(Cj(CA,Kj)),i=S.sort(Wj(CA))[0];if(i)return N.join(O,i.file)}};function VA(A){try{return Nj.readdirSync(A)}catch(j){return[]}}function Pj(A,j){var n=VA(A).filter(j);return n[0]&&N.join(A,n[0])}function uj(A){return/\.node$/.test(A)}function Tj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],E=j[1].split("+");if(!n)return;if(!E.length)return;if(!E.every(Boolean))return;return{name:A,platform:n,architectures:E}}function yj(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function cj(A,j){return A.architectures.length-j.architectures.length}function wj(A){var j=A.split("."),n=j.pop(),E={file:A,specificity:0};if(n!=="node")return;for(var q=0;q<j.length;q++){var k=j[q];if(k==="node"||k==="electron"||k==="node-webkit")E.runtime=k;else if(k==="napi")E.napi=!0;else if(k.slice(0,3)==="abi")E.abi=k.slice(3);else if(k.slice(0,2)==="uv")E.uv=k.slice(2);else if(k.slice(0,4)==="armv")E.armv=k.slice(4);else if(k==="glibc"||k==="musl")E.libc=k;else continue;E.specificity++}return E}function Cj(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!M6(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==xj)return!1;if(n.armv&&n.armv!==JA)return!1;if(n.libc&&n.libc!==Dj)return!1;return!0}}function M6(A){return A.runtime==="node"&&A.napi}function Wj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function o6(){return!!(process.versions&&process.versions.nw)}function g6(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function h6(A){return A==="linux"&&Nj.existsSync("/etc/alpine-release")}u.parseTags=wj;u.matchTags=Cj;u.compareTags=Wj;u.parseTuple=Tj;u.matchTuple=yj;u.compareTuples=cj});var Vj=T((Nn,QA)=>{var YA=typeof __webpack_require__==="function"?__non_webpack_require__:R;if(typeof YA.addon==="function")QA.exports=YA.addon.bind(YA);else QA.exports=Jj()});var Zj=T((nn,W)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",Sn=R("node:assert"),{randomBytes:m6,timingSafeEqual:b6}=R("node:crypto"),{promisify:e6}=R("node:util"),{deserialize:Yj,serialize:l6}=Hj(),p6=Vj(),{hash:Qj}=p6(__dirname),s6=e6(m6);nn.argon2d=0;nn.argon2i=1;nn.argon2id=2;var a=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),d6=Object.freeze({[a.argon2d]:"argon2d",[a.argon2i]:"argon2i",[a.argon2id]:"argon2id"}),zj={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function a6(A,j){let{raw:n,salt:E,...q}={...zj,...j};if(q.hashLength>4294967295)throw new RangeError("Hash length is too large");if(q.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(q.timeCost>4294967295)throw new RangeError("Time cost is too large");if(q.parallelism>16777215)throw new RangeError("Parallelism is too large");E=E??await s6(16);let{hashLength:k,secret:r=Buffer.alloc(0),type:f,version:v,memoryCost:$,timeCost:B,parallelism:O,associatedData:F=Buffer.alloc(0)}=q,S=await Qj({password:Buffer.from(A),salt:E,secret:r,data:F,hashLength:k,m:$,t:B,p:O,version:v,type:f});if(n)return S;return l6({id:d6[f],version:v,params:{m:$,t:B,p:O,...F.byteLength>0?{data:F}:{}},salt:E,hash:S})}nn.hash=a6;function An(A,j={}){let{memoryCost:n,timeCost:E,parallelism:q,version:k}={...zj,...j},{version:r,params:{m:f,t:v,p:$}}=Yj(A);return+r!==+k||+f!==+n||+v!==+E||+$!==+q}nn.needsRehash=An;async function jn(A,j,n={}){let{id:E,...q}=Yj(A);if(!(E in a))return!1;let{version:k=16,params:{m:r,t:f,p:v,data:$=""},salt:B,hash:O}=q,{secret:F=Buffer.alloc(0)}=n;return b6(await Qj({password:Buffer.from(j),salt:B,secret:F,data:Buffer.from($,"base64"),hashLength:O.byteLength,m:+r,t:+f,p:+v,version:+k,type:a[E]}),O)}nn.verify=jn});var BA=KA(Lj(),1);async function Mj(A,j,n,E){if(E==="node"){let q=await Promise.resolve().then(() => KA(Zj(),1)),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),r=Buffer.from(j),f=await q.hash(k,{salt:r,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:q.argon2id});return{hash:new Uint8Array(f)}}if(E==="browser"){let{hash:q}=await BA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:BA.ArgonType.Argon2id});return{hash:q}}throw new Error(`Unsupported environment: ${E}`)}var U={saltLengths:{low:12,high:16},argon:{low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},chunkSize:524288};class zA{provider;key=null;constructor(A){this.provider=A}async deriveKey(A,j,n){let E=this.provider.isNode?"node":"browser",{hash:q}=await Mj(A,j,U.argon[n],E);this.key=await this.provider.subtle.importKey("raw",q,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async encryptChunk(A){if(!this.key)throw new Error("KEY_NOT_DERIVED");let j=this.provider.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.provider.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),E=new Uint8Array(j.length+n.length);return E.set(j),E.set(n,j.length),E}async decryptChunk(A){if(!this.key)throw new Error("KEY_NOT_DERIVED");let j=A.slice(0,12),n=A.slice(12),E=await this.provider.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(E)}}var LA=1,oj=0;function RA(A,j,n){let E=oj<<5|(j==="high"?1:0)<<2|{low:0,middle:1,high:2}[A];return new Uint8Array([LA,E,...n])}function OA(A){if(A[0]!==LA)throw new Error("INVALID_HEADER");let j=A[1],n=j>>5,E=j>>2&1?"high":"low",q=j&3,k=["low","middle","high"][q],r=U.saltLengths[E],f=A.slice(2,2+r);return{version:n,difficulty:k,saltStrength:E,salt:f,headerLen:2+r}}class AA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let E=0;while(n.length-E>=this.chunkSize){let q=n.slice(E,E+this.chunkSize);E+=this.chunkSize;let k=await this.engine.encryptChunk(q),r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,k.length,!1);let f=new Uint8Array(r.length+k.length);f.set(r),f.set(k,r.length),j.enqueue(f)}this.buffer=n.slice(E)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let E=new Uint8Array(4+j.length);E.set(n),E.set(j,4),A.enqueue(E),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class Q{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let E=0;while(!0){if(n.length-E<4)break;let q=new DataView(n.buffer,n.byteOffset+E,4).getUint32(0,!1);if(n.length-E-4<q)break;E+=4;let k=n.slice(E,E+q);E+=q;let r=await this.engine.decryptChunk(k);j.enqueue(r)}this.buffer=n.slice(E)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class ZA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new AA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A;console.log(j);let n=new TransformStream({transform(q,k){if(j===0){k.enqueue(q);return}if(q.byteLength<=j){j-=q.byteLength;return}k.enqueue(q.slice(j)),j=0}}),E=new Q(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(E)}}async collect(A,j,n=null){let E=A.pipeThrough(j).getReader(),q=[];if(n?.length)q.push(n);while(!0){let{value:v,done:$}=await E.read();if($)break;q.push(v)}let k=q.reduce((v,$)=>v+$.byteLength,0),r=new Uint8Array(k),f=0;for(let v of q)r.set(v,f),f+=v.byteLength;return r}}class MA{provider;algo;difficulty;saltStrength;chunkSize;streamer;constructor(A,j={}){this.provider=A;this.algo=new zA(A),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.chunkSize=j.chunkSize??U.chunkSize,this.streamer=new ZA(this.algo,this.chunkSize)}async encryptText(A,j){let n=this.genSalt();await this.algo.deriveKey(j,n,this.difficulty);let E=await this.algo.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A),q=RA(this.difficulty,this.saltStrength,n);return Buffer.from([...q,...E]).toString("base64")}async decryptText(A,j){let n=Uint8Array.from(Buffer.from(A,"base64")),{difficulty:E,salt:q,headerLen:k}=OA(n);await this.algo.deriveKey(j,q,E);let r=await this.algo.decryptChunk(n.slice(k));return new TextDecoder().decode(r)}async encryptFile(A,j){let n=this.genSalt();await this.algo.deriveKey(j,n,this.difficulty);let E=RA(this.difficulty,this.saltStrength,n),q=await this.streamer.collect(A.stream(),new AA(this.algo,this.chunkSize).toTransformStream(),E);return new Blob([q],{type:"application/octet-stream"})}async decryptFile(A,j){let E=new Uint8Array(await A.slice(0,2).arrayBuffer())[1]>>2&1?"high":"low",q=2+U.saltLengths[E],k=new Uint8Array(await A.slice(0,q).arrayBuffer()),r=OA(k);await this.algo.deriveKey(j,r.salt,r.difficulty);let f=await this.streamer.collect(A.slice(q).stream(),new Q(this.algo,this.chunkSize).toTransformStream());return new Blob([f],{type:"application/octet-stream"})}async createEncryptionStream(A){let j=this.genSalt();await this.algo.deriveKey(A,j,this.difficulty);let n=RA(this.difficulty,this.saltStrength,j),E=this.streamer.encryptionStream();return{header:n,writable:E.writable,readable:E.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),E=!1,q;async function k(r,f){let v=r.getReader();while(!0){let{value:$,done:B}=await v.read();if(B)break;f.enqueue($)}}return new TransformStream({async transform(r,f){if(!E){if(n=j.concat(n,r),n.length<2)return;let $=n[1]>>2&1?"high":"low",B=2+U.saltLengths[$];if(n.length<B)return;let O=n.slice(0,B),{salt:F,difficulty:S}=OA(O);await j.algo.deriveKey(A,F,S),q=new Q(j.algo,j.chunkSize).toTransformStream(),k(q.readable,f);let i=n.slice(B);if(i.length){let I=q.writable.getWriter();await I.write(i),I.releaseLock()}E=!0;return}let v=q.writable.getWriter();await v.write(r),v.releaseLock()},async flush(){if(E){let r=q.writable.getWriter();await r.close(),r.releaseLock()}}})}concat(A,j){let n=new Uint8Array(A.length+j.length);return n.set(A,0),n.set(j,A.length),n}genSalt(){let A=U.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}}import{webcrypto as vn,randomFillSync as _n}from"node:crypto";var gj={subtle:vn.subtle,getRandomValues(A){return _n(A),A},isNode:!0};function qE(A){return new MA(gj,A)}export{qE as createCryptit};

//# debugId=006D3CDDCC89DE1364756E2164756E21
