import{createRequire as j6}from"node:module";var sj=Object.create;var{getPrototypeOf:pj,defineProperty:eA,getOwnPropertyNames:dj}=Object;var A6=Object.prototype.hasOwnProperty;var PA=(A,j,n)=>{n=A!=null?sj(pj(A)):{};let r=j||!A||!A.__esModule?eA(n,"default",{value:A,enumerable:!0}):n;for(let t of dj(A))if(!A6.call(r,t))eA(r,t,{get:()=>A[t],enumerable:!0});return r};var w=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var U=j6(import.meta.url);var WA=w((Nn,X)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",E=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},n6=E,o={},y;for(y in E)if(E.hasOwnProperty(y))o[y]=E[y];var m=[],pA="./this.program",TA=function(A,j){throw j},vA=!1,D=!1,SA=!1,dA=!1;vA=typeof window==="object";D=typeof importScripts==="function";SA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";dA=!vA&&!SA&&!D;var O="";function r6(A){if(E.locateFile)return E.locateFile(A,O);return O+A}var kA,cA,b,E6,KA,RA;if(SA){if(D)O=U("path").dirname(O)+"/";else O=__dirname+"/";if(kA=function A(j,n){if(!KA)KA=U("fs");if(!RA)RA=U("path");return j=RA.normalize(j),KA.readFileSync(j,n?null:"utf8")},b=function A(j){var n=kA(j,!0);if(!n.buffer)n=new Uint8Array(n);return lA(n.buffer),n},process.argv.length>1)pA=process.argv[1].replace(/\\/g,"/");if(m=process.argv.slice(2),typeof X!=="undefined")X.exports=E;process.on("uncaughtException",function(A){if(!(A instanceof Q6))throw A}),process.on("unhandledRejection",s),TA=function(A){process.exit(A)},E.inspect=function(){return"[Emscripten Module object]"}}else if(dA){if(typeof read!="undefined")kA=function A(j){return read(j)};if(b=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),lA(typeof n==="object"),n},typeof scriptArgs!="undefined")m=scriptArgs;else if(typeof arguments!="undefined")m=arguments;if(typeof quit==="function")TA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(vA||D){if(D)O=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)O=document.currentScript.src;if(O.indexOf("blob:")!==0)O=O.substr(0,O.lastIndexOf("/")+1);else O="";{if(kA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},D)b=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};cA=function(A,j,n){var r=new XMLHttpRequest;r.open("GET",A,!0),r.responseType="arraybuffer",r.onload=function(){if(r.status==200||r.status==0&&r.response){j(r.response);return}n()},r.onerror=n,r.send(null)}}E6=function(A){document.title=A}}var On=E.print||console.log.bind(console),g=E.printErr||console.warn.bind(console);for(y in o)if(o.hasOwnProperty(y))E[y]=o[y];o=null;if(E.arguments)m=E.arguments;if(E.thisProgram)pA=E.thisProgram;if(E.quit)TA=E.quit;var l;if(E.wasmBinary)l=E.wasmBinary;var Kn=E.noExitRuntime||!0;if(typeof WebAssembly!=="object")s("no native wasm support detected");var a,Aj=!1,t6;function lA(A,j){if(!A)s("Assertion failed: "+j)}var q6=0,k6=1;function f6(A,j){var n;if(j==k6)n=Bj(A.length);else n=Fj(A.length);if(A.subarray||A.slice)x.set(A,n);else x.set(new Uint8Array(A),n);return n}var aA=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function i6(A,j,n){var r=j+n,t=j;while(A[t]&&!(t>=r))++t;if(t-j>16&&A.subarray&&aA)return aA.decode(A.subarray(j,t));else{var k="";while(j<t){var q=A[j++];if(!(q&128)){k+=String.fromCharCode(q);continue}var f=A[j++]&63;if((q&224)==192){k+=String.fromCharCode((q&31)<<6|f);continue}var v=A[j++]&63;if((q&240)==224)q=(q&15)<<12|f<<6|v;else q=(q&7)<<18|f<<12|v<<6|A[j++]&63;if(q<65536)k+=String.fromCharCode(q);else{var $=q-65536;k+=String.fromCharCode(55296|$>>10,56320|$&1023)}}}return k}function v6(A,j){return A?i6(x,A,j):""}function _6(A,j){if(A%j>0)A+=j-A%j;return A}var yA,jj,x,nj,rj,Ej,tj,qj,kj;function fj(A){yA=A,E.HEAP8=jj=new Int8Array(A),E.HEAP16=nj=new Int16Array(A),E.HEAP32=Ej=new Int32Array(A),E.HEAPU8=x=new Uint8Array(A),E.HEAPU16=rj=new Uint16Array(A),E.HEAPU32=tj=new Uint32Array(A),E.HEAPF32=qj=new Float32Array(A),E.HEAPF64=kj=new Float64Array(A)}var Rn=E.INITIAL_MEMORY||16777216,fA,ij=[],vj=[],_j=[],I6=!1;function $6(){if(E.preRun){if(typeof E.preRun=="function")E.preRun=[E.preRun];while(E.preRun.length)L6(E.preRun.shift())}wA(ij)}function F6(){I6=!0,wA(vj)}function B6(){if(E.postRun){if(typeof E.postRun=="function")E.postRun=[E.postRun];while(E.postRun.length)U6(E.postRun.shift())}wA(_j)}function L6(A){ij.unshift(A)}function u6(A){vj.unshift(A)}function U6(A){_j.unshift(A)}var W=0,NA=null,e=null;function G6(A){if(W++,E.monitorRunDependencies)E.monitorRunDependencies(W)}function H6(A){if(W--,E.monitorRunDependencies)E.monitorRunDependencies(W);if(W==0){if(NA!==null)clearInterval(NA),NA=null;if(e){var j=e;e=null,j()}}}E.preloadedImages={};E.preloadedAudios={};function s(A){if(E.onAbort)E.onAbort(A);A+="",g(A),Aj=!0,t6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var P6="data:application/octet-stream;base64,";function Ij(A){return A.startsWith(P6)}function $j(A){return A.startsWith("file://")}var H="argon2.wasm";if(!Ij(H))H=r6(H);function sA(A){try{if(A==H&&l)return new Uint8Array(l);if(b)return b(A);else throw"both async and sync fetching of the wasm failed"}catch(j){s(j)}}function O6(){if(!l&&(vA||D)){if(typeof fetch==="function"&&!$j(H))return fetch(H,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+H+"'";return A.arrayBuffer()}).catch(function(){return sA(H)});else if(cA)return new Promise(function(A,j){cA(H,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return sA(H)})}function K6(){var A={a:c6};function j(q,f){var v=q.exports;E.asm=v,a=E.asm.c,fj(a.buffer),fA=E.asm.k,u6(E.asm.d),H6("wasm-instantiate")}G6("wasm-instantiate");function n(q){j(q.instance)}function r(q){return O6().then(function(f){var v=WebAssembly.instantiate(f,A);return v}).then(q,function(f){g("failed to asynchronously prepare wasm: "+f),s(f)})}function t(){if(!l&&typeof WebAssembly.instantiateStreaming==="function"&&!Ij(H)&&!$j(H)&&typeof fetch==="function")return fetch(H,{credentials:"same-origin"}).then(function(q){var f=WebAssembly.instantiateStreaming(q,A);return f.then(n,function(v){return g("wasm streaming compile failed: "+v),g("falling back to ArrayBuffer instantiation"),r(n)})});else return r(n)}if(E.instantiateWasm)try{var k=E.instantiateWasm(A,j);return k}catch(q){return g("Module.instantiateWasm callback failed with error: "+q),!1}return t(),{}}function wA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(E);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)fA.get(n)();else fA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function R6(A,j,n){x.copyWithin(A,j,j+n)}function N6(A){try{return a.grow(A-yA.byteLength+65535>>>16),fj(a.buffer),1}catch(j){}}function T6(A){var j=x.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var r=1;r<=4;r*=2){var t=j*(1+0.2/r);t=Math.min(t,A+100663296);var k=Math.min(n,_6(Math.max(A,t),65536)),q=N6(k);if(q)return!0}return!1}var c6={a:R6,b:T6},S6=K6(),y6=E.___wasm_call_ctors=function(){return(y6=E.___wasm_call_ctors=E.asm.d).apply(null,arguments)},w6=E._argon2_hash=function(){return(w6=E._argon2_hash=E.asm.e).apply(null,arguments)},Fj=E._malloc=function(){return(Fj=E._malloc=E.asm.f).apply(null,arguments)},D6=E._free=function(){return(D6=E._free=E.asm.g).apply(null,arguments)},W6=E._argon2_verify=function(){return(W6=E._argon2_verify=E.asm.h).apply(null,arguments)},x6=E._argon2_error_message=function(){return(x6=E._argon2_error_message=E.asm.i).apply(null,arguments)},X6=E._argon2_encodedlen=function(){return(X6=E._argon2_encodedlen=E.asm.j).apply(null,arguments)},J6=E._argon2_hash_ext=function(){return(J6=E._argon2_hash_ext=E.asm.l).apply(null,arguments)},Y6=E._argon2_verify_ext=function(){return(Y6=E._argon2_verify_ext=E.asm.m).apply(null,arguments)},Bj=E.stackAlloc=function(){return(Bj=E.stackAlloc=E.asm.n).apply(null,arguments)};E.allocate=f6;E.UTF8ToString=v6;E.ALLOC_NORMAL=q6;var iA;function Q6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}e=function A(){if(!iA)DA();if(!iA)e=A};function DA(A){if(A=A||m,W>0)return;if($6(),W>0)return;function j(){if(iA)return;if(iA=!0,E.calledRun=!0,Aj)return;if(F6(),E.onRuntimeInitialized)E.onRuntimeInitialized();B6()}if(E.setStatus)E.setStatus("Running..."),setTimeout(function(){setTimeout(function(){E.setStatus("")},1),j()},1);else j()}E.run=DA;if(E.preInit){if(typeof E.preInit=="function")E.preInit=[E.preInit];while(E.preInit.length>0)E.preInit.pop()()}DA();if(typeof X!=="undefined")X.exports=E;E.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(E=n6=a=fA=S6=yA=jj=x=nj=rj=Ej=tj=qj=kj=void 0,typeof X!=="undefined")delete X.exports}});var Lj=w((Tn,z6)=>{z6.exports="./cryptit.index.wasm"});var Uj=w((uj,_A)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof _A==="object"&&_A.exports)_A.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:uj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(i){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=t().then((_)=>new Promise((L)=>{_.postRun=()=>L(_)}));else I=k().then((_)=>{let L=i?f(i):void 0;return r(_,L)});return n._promise=I,I.then((_)=>{return n._module=_,delete n._promise,_})}function r(i,I){return new Promise((_)=>{return A.Module={wasmBinary:i,wasmMemory:I,postRun(){_(Module)}},t()})}function t(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(WA())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(Lj()).then((I)=>{return q(I)})}function q(i){let I=atob(i),_=new Uint8Array(new ArrayBuffer(I.length));for(let L=0;L<I.length;L++)_[L]=I.charCodeAt(L);return _}function f(i){let Y=Math.min(Math.max(Math.ceil(i*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:Y,maximum:32767})}function v(i,I){return i.allocate(I,"i8",i.ALLOC_NORMAL)}function $(i,I){let _=new Uint8Array([...I,0]);return v(i,_)}function F(i){if(typeof i!=="string")return i;if(typeof TextEncoder==="function")return new TextEncoder().encode(i);else if(typeof Buffer==="function")return Buffer.from(i);else throw new Error("Don't know how to encode UTF8")}function u(i){let I=i.mem||1024;return n(I).then((_)=>{let L=i.time||1,c=i.parallelism||1,V=F(i.pass),Y=$(_,V),GA=V.length,jA=F(i.salt),nA=$(_,jA),M=jA.length,Q=i.type||j.Argon2d,R=_.allocate(new Array(i.hashLen||24),"i8",_.ALLOC_NORMAL),S=i.secret?v(_,i.secret):0,h=i.secret?i.secret.byteLength:0,P=i.ad?v(_,i.ad):0,lj=i.ad?i.ad.byteLength:0,rA=i.hashLen||24,oA=_._argon2_encodedlen(L,I,c,M,rA,Q),HA=_.allocate(new Array(oA+1),"i8",_.ALLOC_NORMAL),un=19,z,EA;try{EA=_._argon2_hash_ext(L,I,c,Y,GA,nA,M,R,rA,HA,oA,Q,S,h,P,lj,19)}catch(C){z=C}let tA;if(EA===0&&!z){let C="",mA=new Uint8Array(rA);for(let qA=0;qA<rA;qA++){let bA=_.HEAP8[R+qA];mA[qA]=bA,C+=("0"+(255&bA).toString(16)).slice(-2)}let aj=_.UTF8ToString(HA);tA={hash:mA,hashHex:C,encoded:aj}}else{try{if(!z)z=_.UTF8ToString(_._argon2_error_message(EA))}catch(C){}tA={message:z,code:EA}}try{if(_._free(Y),_._free(nA),_._free(R),_._free(HA),P)_._free(P);if(S)_._free(S)}catch(C){}if(z)throw tA;else return tA})}function B(i){return n().then((I)=>{let _=F(i.pass),L=$(I,_),c=_.length,V=i.secret?v(I,i.secret):0,Y=i.secret?i.secret.byteLength:0,GA=i.ad?v(I,i.ad):0,jA=i.ad?i.ad.byteLength:0,nA=F(i.encoded),M=$(I,nA),Q=i.type;if(Q===void 0){let P=i.encoded.split("$")[1];if(P)P=P.replace("a","A"),Q=j[P]||j.Argon2d}let R,S;try{S=I._argon2_verify_ext(M,L,c,V,Y,GA,jA,Q)}catch(P){R=P}let h;if(S||R){try{if(!R)R=I.UTF8ToString(I._argon2_error_message(S))}catch(P){}h={message:R,code:S}}try{I._free(L),I._free(M)}catch(P){}if(R)throw h;else return h})}function K(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:u,verify:B,unloadRuntime:K}})});var Oj=w((Sn,Pj)=>{var IA=/^[a-z0-9-]{1,32}$/,$A=/^[a-z0-9-]{1,32}$/,FA=/^[a-zA-Z0-9/+.-]+$/,Gj=/^([a-zA-Z0-9/+.-]+|)$/,C6=/^((-)?[1-9]\d*|0)$/,xA=/^v=(\d+)$/;function Z6(A){return p(A).map((j)=>[j,A[j]].join("=")).join(",")}function V6(A){let j={};return A.split(",").forEach((n)=>{let r=n.split("=");if(r.length<2)throw new TypeError("params must be in the format name=value");j[r.shift()]=r.join("=")}),j}function p(A){return Object.keys(A)}function Hj(A){if(typeof Object.values==="function")return Object.values(A);return p(A).map((j)=>A[j])}function M6(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!IA.test(A.id))throw new TypeError(`id must satisfy ${IA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let r=p(A.params);if(!r.every((q)=>$A.test(q)))throw new TypeError(`params names must satisfy ${$A}`);r.forEach((q)=>{if(typeof A.params[q]==="number")A.params[q]=A.params[q].toString();else if(Buffer.isBuffer(A.params[q]))A.params[q]=A.params[q].toString("base64").split("=")[0]});let t=Hj(A.params);if(!t.every((q)=>typeof q==="string"))throw new TypeError("params values must be strings");if(!t.every((q)=>FA.test(q)))throw new TypeError(`params values must satisfy ${FA}`);let k=Z6(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function h6(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!xA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let r=j.shift();if(!IA.test(r))throw new TypeError(`id must satisfy ${IA}`);let t;if(xA.test(j[0]))t=parseInt(j.shift().match(xA)[1],10);let k,q;if(Gj.test(j[j.length-1]))if(j.length>1&&Gj.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),q=Buffer.from(j.pop(),"base64");else q=Buffer.from(j.pop(),"base64");let f;if(j.length>0){let $=j.pop();if(f=V6($),!p(f).every((B)=>$A.test(B)))throw new TypeError(`params names must satisfy ${$A}`);if(!Hj(f).every((B)=>FA.test(B)))throw new TypeError(`params values must satisfy ${FA}`);p(f).forEach((B)=>{f[B]=C6.test(f[B])?parseInt(f[B],10):f[B]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let v={id:r};if(t)v.version=t;if(f)v.params=f;if(q)v.salt=q;if(k)v.hash=k;return v}Pj.exports={serialize:M6,deserialize:h6}});var zj=w((yn,Qj)=>{var Tj=U("fs"),T=U("path"),cj=U("os"),Sj=typeof __webpack_require__==="function"?__non_webpack_require__:U,g6=process.config&&process.config.variables||{},o6=!!process.env.PREBUILDS_ONLY,Kj=process.versions.modules,XA=e6()?"electron":b6()?"node-webkit":"node",JA=process.env.npm_config_arch||cj.arch(),YA=process.env.npm_config_platform||cj.platform(),yj=process.env.LIBC||(l6(YA)?"musl":"glibc"),QA=process.env.ARM_VERSION||(JA==="arm64"?"8":g6.arm_version)||"",wj=(process.versions.uv||"").split(".")[0];Qj.exports=N;function N(A){return Sj(N.resolve(A))}N.resolve=N.path=function(A){A=T.resolve(A||".");try{var j=Sj(T.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(v){}if(!o6){var n=Rj(T.join(A,"build/Release"),Nj);if(n)return n;var r=Rj(T.join(A,"build/Debug"),Nj);if(r)return r}var t=f(A);if(t)return t;var k=f(T.dirname(process.execPath));if(k)return k;var q=["platform="+YA,"arch="+JA,"runtime="+XA,"abi="+Kj,"uv="+wj,QA?"armv="+QA:"","libc="+yj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+q+`
    loaded from: `+A+`
`);function f(v){var $=zA(T.join(v,"prebuilds")).map(Dj),F=$.filter(Wj(YA,JA)).sort(xj)[0];if(!F)return;var u=T.join(v,"prebuilds",F.name),B=zA(u).map(Xj),K=B.filter(Jj(XA,Kj)),i=K.sort(Yj(XA))[0];if(i)return T.join(u,i.file)}};function zA(A){try{return Tj.readdirSync(A)}catch(j){return[]}}function Rj(A,j){var n=zA(A).filter(j);return n[0]&&T.join(A,n[0])}function Nj(A){return/\.node$/.test(A)}function Dj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],r=j[1].split("+");if(!n)return;if(!r.length)return;if(!r.every(Boolean))return;return{name:A,platform:n,architectures:r}}function Wj(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function xj(A,j){return A.architectures.length-j.architectures.length}function Xj(A){var j=A.split("."),n=j.pop(),r={file:A,specificity:0};if(n!=="node")return;for(var t=0;t<j.length;t++){var k=j[t];if(k==="node"||k==="electron"||k==="node-webkit")r.runtime=k;else if(k==="napi")r.napi=!0;else if(k.slice(0,3)==="abi")r.abi=k.slice(3);else if(k.slice(0,2)==="uv")r.uv=k.slice(2);else if(k.slice(0,4)==="armv")r.armv=k.slice(4);else if(k==="glibc"||k==="musl")r.libc=k;else continue;r.specificity++}return r}function Jj(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!m6(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==wj)return!1;if(n.armv&&n.armv!==QA)return!1;if(n.libc&&n.libc!==yj)return!1;return!0}}function m6(A){return A.runtime==="node"&&A.napi}function Yj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function b6(){return!!(process.versions&&process.versions.nw)}function e6(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function l6(A){return A==="linux"&&Tj.existsSync("/etc/alpine-release")}N.parseTags=Xj;N.matchTags=Jj;N.compareTags=Yj;N.parseTuple=Dj;N.matchTuple=Wj;N.compareTuples=xj});var Cj=w((Dn,ZA)=>{var CA=typeof __webpack_require__==="function"?__non_webpack_require__:U;if(typeof CA.addon==="function")ZA.exports=CA.addon.bind(CA);else ZA.exports=zj()});var hj=w((qn,J)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",xn=U("node:assert"),{randomBytes:a6,timingSafeEqual:s6}=U("node:crypto"),{promisify:p6}=U("node:util"),{deserialize:Zj,serialize:d6}=Oj(),An=Cj(),{hash:Vj}=An(__dirname),jn=p6(a6);qn.argon2d=0;qn.argon2i=1;qn.argon2id=2;var d=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),nn=Object.freeze({[d.argon2d]:"argon2d",[d.argon2i]:"argon2i",[d.argon2id]:"argon2id"}),Mj={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function rn(A,j){let{raw:n,salt:r,...t}={...Mj,...j};if(t.hashLength>4294967295)throw new RangeError("Hash length is too large");if(t.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(t.timeCost>4294967295)throw new RangeError("Time cost is too large");if(t.parallelism>16777215)throw new RangeError("Parallelism is too large");r=r??await jn(16);let{hashLength:k,secret:q=Buffer.alloc(0),type:f,version:v,memoryCost:$,timeCost:F,parallelism:u,associatedData:B=Buffer.alloc(0)}=t,K=await Vj({password:Buffer.from(A),salt:r,secret:q,data:B,hashLength:k,m:$,t:F,p:u,version:v,type:f});if(n)return K;return d6({id:nn[f],version:v,params:{m:$,t:F,p:u,...B.byteLength>0?{data:B}:{}},salt:r,hash:K})}qn.hash=rn;function En(A,j={}){let{memoryCost:n,timeCost:r,parallelism:t,version:k}={...Mj,...j},{version:q,params:{m:f,t:v,p:$}}=Zj(A);return+q!==+k||+f!==+n||+v!==+r||+$!==+t}qn.needsRehash=En;async function tn(A,j,n={}){let{id:r,...t}=Zj(A);if(!(r in d))return!1;let{version:k=16,params:{m:q,t:f,p:v,data:$=""},salt:F,hash:u}=t,{secret:B=Buffer.alloc(0)}=n;return s6(await Vj({password:Buffer.from(j),salt:F,secret:B,data:Buffer.from($,"base64"),hashLength:u.byteLength,m:+q,t:+f,p:+v,version:+k,type:d[r]}),u)}qn.verify=tn});class G{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new Error(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new Error(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class OA{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),r=new Uint8Array(j.length+n.length);return r.set(j),r.set(n,j.length),r}async decryptChunk(A){let j=A.slice(0,12),n=A.slice(12),r=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(r)}}var BA=PA(Uj(),1);async function gj(A,j,n,r){if(r==="node"){let t=await Promise.resolve().then(() => PA(hj(),1)),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),q=Buffer.from(j),f=await t.hash(k,{salt:q,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:t.argon2id});return{hash:new Uint8Array(f)}}if(r==="browser"){let{hash:t}=await BA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:BA.ArgonType.Argon2id});return{hash:t}}throw new Error(`Unsupported environment: ${r}`)}class VA{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,n,r){let{hash:t}=await gj(A,j,this.presets[n],r.isNode?"node":"browser");return r.subtle.importKey("raw",t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var oj={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},Fn={id:0,cipher:OA,kdf:new VA(oj),saltLengths:{low:12,high:16},difficulties:oj,defaultChunkSize:524288};G.register(Fn);var LA=1;function MA(...A){let j=A.reduce((t,k)=>t+k.byteLength,0),n=new Uint8Array(j),r=0;for(let t of A)n.set(t,r),r+=t.byteLength;return n}function mj(...A){return Buffer.from(MA(...A)).toString("base64")}function bj(A){return Uint8Array.from(Buffer.from(A,"base64"))}function uA(A,j,n,r){let t={low:0,middle:1,high:2}[j]??0,k=A<<5|(n==="high"?1:0)<<2|t;return MA(new Uint8Array([LA,k]),r)}function UA(A){if(A[0]!==LA)throw new Error("INVALID_HEADER");let j=A[1],n=j>>5,r=j>>2&1?"high":"low",t=j&3,k=["low","middle","high"][t],q=G.get(n).saltLengths[r],f=A.slice(2,2+q);return{version:n,difficulty:k,saltStrength:r,salt:f,headerLen:2+q}}class AA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let r=0;while(n.length-r>=this.chunkSize){let t=n.slice(r,r+this.chunkSize);r+=this.chunkSize;let k=await this.engine.encryptChunk(t),q=new Uint8Array(4);new DataView(q.buffer).setUint32(0,k.length,!1);let f=new Uint8Array(4+k.length);f.set(q),f.set(k,q.length),j.enqueue(f)}this.buffer=n.slice(r)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let r=new Uint8Array(4+j.length);r.set(n),r.set(j,4),A.enqueue(r),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class Z{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let r=0;while(!0){if(n.length-r<4)break;let t=new DataView(n.buffer,n.byteOffset+r,4).getUint32(0,!1);if(n.length-r-4<t)break;r+=4;let k=n.slice(r,r+t);r+=t;let q=await this.engine.decryptChunk(k);j.enqueue(q)}this.buffer=n.slice(r)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class hA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new AA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(t,k){if(j===0){k.enqueue(t);return}if(t.byteLength<=j){j-=t.byteLength;return}k.enqueue(t.slice(j)),j=0}}),r=new Z(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(r)}}async collect(A,j,n=null){let r=A.pipeThrough(j).getReader(),t=[];if(n?.length)t.push(n);while(!0){let{value:v,done:$}=await r.read();if($)break;t.push(v)}let k=t.reduce((v,$)=>v+$.byteLength,0),q=new Uint8Array(k),f=0;for(let v of t)q.set(v,f),f+=v.byteLength;return q}}class gA{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;constructor(A,j={}){this.provider=A;this.v=G.get(j.version??G.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new hA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high"}async encryptText(A,j){let n=this.genSalt();await this.deriveKey(j,n);let r=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A),t=uA(this.v.id,this.difficulty,this.saltStrength,n);return mj(t,r)}async decryptText(A,j){let n=bj(A),r=UA(n),t=G.get(r.version);this.ensureSameVersion(t),await this.deriveKey(j,r.salt,r.difficulty);let k=await this.cipher.decryptChunk(n.slice(r.headerLen));return new TextDecoder().decode(k)}async encryptFile(A,j){let n=this.genSalt();await this.deriveKey(j,n);let r=uA(this.v.id,this.difficulty,this.saltStrength,n),t=await this.stream.collect(A.stream(),new AA(this.cipher,this.chunkSize).toTransformStream(),r);return new Blob([t],{type:"application/octet-stream"})}async decryptFile(A,j){let n=new Uint8Array(await A.slice(0,2).arrayBuffer()),r=n[1]>>5,t=n[1]>>2&1?"high":"low",q=2+G.get(r).saltLengths[t],f=new Uint8Array(await A.slice(0,q).arrayBuffer()),v=UA(f);await this.deriveKey(j,v.salt,v.difficulty);let $=await this.stream.collect(A.slice(q).stream(),new Z(this.cipher,this.chunkSize).toTransformStream());return new Blob([$],{type:"application/octet-stream"})}async createEncryptionStream(A){let j=this.genSalt();await this.deriveKey(A,j);let n=uA(this.v.id,this.difficulty,this.saltStrength,j),r=this.stream.encryptionStream();return{header:n,writable:r.writable,readable:r.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),r=!1,t;function k(f,v){let $=new Uint8Array(f.length+v.length);return $.set(f),$.set(v,f.length),$}async function q(f,v){let $=f.getReader();while(!0){let{value:F,done:u}=await $.read();if(u)break;v.enqueue(F)}}return new TransformStream({async transform(f,v){if(!r){if(n=k(n,f),n.length<2)return;let F=n[1]>>5,u=n[1]>>2&1?"high":"low",K=2+G.get(F).saltLengths[u];if(n.length<K)return;let i=n.slice(0,K),{salt:I,difficulty:_}=UA(i);if(F!==j.v.id)throw new Error(`Ciphertext v${F} but Cryptit instance is v${j.v.id}`);await j.deriveKey(A,I,_),t=new Z(j.cipher,j.chunkSize).toTransformStream(),q(t.readable,v);let L=n.slice(K);if(L.length){let c=t.writable.getWriter();await c.write(L),c.releaseLock()}r=!0;return}let $=t.writable.getWriter();await $.write(f),$.releaseLock()},async flush(){if(r){let f=t.writable.getWriter();await f.close(),f.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let r=await this.kdf.derive(A,j,n,this.provider);this.cipher.key=r}concat(A,j){let n=new Uint8Array(A.length+j.length);return n.set(A,0),n.set(j,A.length),n}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}ensureSameVersion(A){if(A.id!==this.v.id)throw new Error(`This Cryptit instance was created for v${this.v.id} but ciphertext is v${A.id}`)}}import{webcrypto as Bn,randomFillSync as Ln}from"node:crypto";var ej={subtle:Bn.subtle,getRandomValues(A){return Ln(A),A},isNode:!0};function $r(A){return new gA(ej,A)}export{$r as createCryptit};

//# debugId=563E628BCF4E612864756E2164756E21
