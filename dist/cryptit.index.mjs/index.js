import{createRequire as $6}from"node:module";var v6=Object.create;var{getPrototypeOf:_6,defineProperty:kj,getOwnPropertyNames:I6}=Object;var c6=Object.prototype.hasOwnProperty;var DA=(A,j,n)=>{n=A!=null?v6(_6(A)):{};let t=j||!A||!A.__esModule?kj(n,"default",{value:A,enumerable:!0}):n;for(let r of I6(A))if(!c6.call(t,r))kj(t,r,{get:()=>A[r],enumerable:!0});return t};var D=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var P=$6(import.meta.url);var gA=D((Cn,z)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",q=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},F6=q,jA={},S;for(S in q)if(q.hasOwnProperty(S))jA[S]=q[S];var nA=[],vj="./this.program",QA=function(A,j){throw j},uA=!1,X=!1,ZA=!1,_j=!1;uA=typeof window==="object";X=typeof importScripts==="function";ZA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";_j=!uA&&!ZA&&!X;var K="";function B6(A){if(q.locateFile)return q.locateFile(A,K);return K+A}var GA,CA,tA,L6,YA,zA;if(ZA){if(X)K=P("path").dirname(K)+"/";else K=__dirname+"/";if(GA=function A(j,n){if(!YA)YA=P("fs");if(!zA)zA=P("path");return j=zA.normalize(j),YA.readFileSync(j,n?null:"utf8")},tA=function A(j){var n=GA(j,!0);if(!n.buffer)n=new Uint8Array(n);return Ej(n.buffer),n},process.argv.length>1)vj=process.argv[1].replace(/\\/g,"/");if(nA=process.argv.slice(2),typeof z!=="undefined")z.exports=q;process.on("uncaughtException",function(A){if(!(A instanceof s6))throw A}),process.on("unhandledRejection",EA),QA=function(A){process.exit(A)},q.inspect=function(){return"[Emscripten Module object]"}}else if(_j){if(typeof read!="undefined")GA=function A(j){return read(j)};if(tA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),Ej(typeof n==="object"),n},typeof scriptArgs!="undefined")nA=scriptArgs;else if(typeof arguments!="undefined")nA=arguments;if(typeof quit==="function")QA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(uA||X){if(X)K=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)K=document.currentScript.src;if(K.indexOf("blob:")!==0)K=K.substr(0,K.lastIndexOf("/")+1);else K="";{if(GA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},X)tA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};CA=function(A,j,n){var t=new XMLHttpRequest;t.open("GET",A,!0),t.responseType="arraybuffer",t.onload=function(){if(t.status==200||t.status==0&&t.response){j(t.response);return}n()},t.onerror=n,t.send(null)}}L6=function(A){document.title=A}}var zn=q.print||console.log.bind(console),AA=q.printErr||console.warn.bind(console);for(S in jA)if(jA.hasOwnProperty(S))q[S]=jA[S];jA=null;if(q.arguments)nA=q.arguments;if(q.thisProgram)vj=q.thisProgram;if(q.quit)QA=q.quit;var qA;if(q.wasmBinary)qA=q.wasmBinary;var on=q.noExitRuntime||!0;if(typeof WebAssembly!=="object")EA("no native wasm support detected");var kA,Ij=!1,P6;function Ej(A,j){if(!A)EA("Assertion failed: "+j)}var U6=0,O6=1;function G6(A,j){var n;if(j==O6)n=Hj(A.length);else n=wj(A.length);if(A.subarray||A.slice)Y.set(A,n);else Y.set(new Uint8Array(A),n);return n}var fj=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function K6(A,j,n){var t=j+n,r=j;while(A[r]&&!(r>=t))++r;if(r-j>16&&A.subarray&&fj)return fj.decode(A.subarray(j,r));else{var k="";while(j<r){var E=A[j++];if(!(E&128)){k+=String.fromCharCode(E);continue}var i=A[j++]&63;if((E&224)==192){k+=String.fromCharCode((E&31)<<6|i);continue}var v=A[j++]&63;if((E&240)==224)E=(E&15)<<12|i<<6|v;else E=(E&7)<<18|i<<12|v<<6|A[j++]&63;if(E<65536)k+=String.fromCharCode(E);else{var c=E-65536;k+=String.fromCharCode(55296|c>>10,56320|c&1023)}}}return k}function R6(A,j){return A?K6(Y,A,j):""}function u6(A,j){if(A%j>0)A+=j-A%j;return A}var hA,cj,Y,$j,Fj,Bj,Lj,Pj,Uj;function Oj(A){hA=A,q.HEAP8=cj=new Int8Array(A),q.HEAP16=$j=new Int16Array(A),q.HEAP32=Bj=new Int32Array(A),q.HEAPU8=Y=new Uint8Array(A),q.HEAPU16=Fj=new Uint16Array(A),q.HEAPU32=Lj=new Uint32Array(A),q.HEAPF32=Pj=new Float32Array(A),q.HEAPF64=Uj=new Float64Array(A)}var Qn=q.INITIAL_MEMORY||16777216,KA,Gj=[],Kj=[],Rj=[],y6=!1;function w6(){if(q.preRun){if(typeof q.preRun=="function")q.preRun=[q.preRun];while(q.preRun.length)T6(q.preRun.shift())}MA(Gj)}function H6(){y6=!0,MA(Kj)}function x6(){if(q.postRun){if(typeof q.postRun=="function")q.postRun=[q.postRun];while(q.postRun.length)S6(q.postRun.shift())}MA(Rj)}function T6(A){Gj.unshift(A)}function N6(A){Kj.unshift(A)}function S6(A){Rj.unshift(A)}var J=0,oA=null,rA=null;function V6(A){if(J++,q.monitorRunDependencies)q.monitorRunDependencies(J)}function W6(A){if(J--,q.monitorRunDependencies)q.monitorRunDependencies(J);if(J==0){if(oA!==null)clearInterval(oA),oA=null;if(rA){var j=rA;rA=null,j()}}}q.preloadedImages={};q.preloadedAudios={};function EA(A){if(q.onAbort)q.onAbort(A);A+="",AA(A),Ij=!0,P6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var D6="data:application/octet-stream;base64,";function uj(A){return A.startsWith(D6)}function yj(A){return A.startsWith("file://")}var O="argon2.wasm";if(!uj(O))O=B6(O);function ij(A){try{if(A==O&&qA)return new Uint8Array(qA);if(tA)return tA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){EA(j)}}function X6(){if(!qA&&(uA||X)){if(typeof fetch==="function"&&!yj(O))return fetch(O,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+O+"'";return A.arrayBuffer()}).catch(function(){return ij(O)});else if(CA)return new Promise(function(A,j){CA(O,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return ij(O)})}function J6(){var A={a:Q6};function j(E,i){var v=E.exports;q.asm=v,kA=q.asm.c,Oj(kA.buffer),KA=q.asm.k,N6(q.asm.d),W6("wasm-instantiate")}V6("wasm-instantiate");function n(E){j(E.instance)}function t(E){return X6().then(function(i){var v=WebAssembly.instantiate(i,A);return v}).then(E,function(i){AA("failed to asynchronously prepare wasm: "+i),EA(i)})}function r(){if(!qA&&typeof WebAssembly.instantiateStreaming==="function"&&!uj(O)&&!yj(O)&&typeof fetch==="function")return fetch(O,{credentials:"same-origin"}).then(function(E){var i=WebAssembly.instantiateStreaming(E,A);return i.then(n,function(v){return AA("wasm streaming compile failed: "+v),AA("falling back to ArrayBuffer instantiation"),t(n)})});else return t(n)}if(q.instantiateWasm)try{var k=q.instantiateWasm(A,j);return k}catch(E){return AA("Module.instantiateWasm callback failed with error: "+E),!1}return r(),{}}function MA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(q);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)KA.get(n)();else KA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function Y6(A,j,n){Y.copyWithin(A,j,j+n)}function z6(A){try{return kA.grow(A-hA.byteLength+65535>>>16),Oj(kA.buffer),1}catch(j){}}function o6(A){var j=Y.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var t=1;t<=4;t*=2){var r=j*(1+0.2/t);r=Math.min(r,A+100663296);var k=Math.min(n,u6(Math.max(A,r),65536)),E=z6(k);if(E)return!0}return!1}var Q6={a:Y6,b:o6},C6=J6(),Z6=q.___wasm_call_ctors=function(){return(Z6=q.___wasm_call_ctors=q.asm.d).apply(null,arguments)},h6=q._argon2_hash=function(){return(h6=q._argon2_hash=q.asm.e).apply(null,arguments)},wj=q._malloc=function(){return(wj=q._malloc=q.asm.f).apply(null,arguments)},M6=q._free=function(){return(M6=q._free=q.asm.g).apply(null,arguments)},m6=q._argon2_verify=function(){return(m6=q._argon2_verify=q.asm.h).apply(null,arguments)},g6=q._argon2_error_message=function(){return(g6=q._argon2_error_message=q.asm.i).apply(null,arguments)},e6=q._argon2_encodedlen=function(){return(e6=q._argon2_encodedlen=q.asm.j).apply(null,arguments)},b6=q._argon2_hash_ext=function(){return(b6=q._argon2_hash_ext=q.asm.l).apply(null,arguments)},l6=q._argon2_verify_ext=function(){return(l6=q._argon2_verify_ext=q.asm.m).apply(null,arguments)},Hj=q.stackAlloc=function(){return(Hj=q.stackAlloc=q.asm.n).apply(null,arguments)};q.allocate=G6;q.UTF8ToString=R6;q.ALLOC_NORMAL=U6;var RA;function s6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}rA=function A(){if(!RA)mA();if(!RA)rA=A};function mA(A){if(A=A||nA,J>0)return;if(w6(),J>0)return;function j(){if(RA)return;if(RA=!0,q.calledRun=!0,Ij)return;if(H6(),q.onRuntimeInitialized)q.onRuntimeInitialized();x6()}if(q.setStatus)q.setStatus("Running..."),setTimeout(function(){setTimeout(function(){q.setStatus("")},1),j()},1);else j()}q.run=mA;if(q.preInit){if(typeof q.preInit=="function")q.preInit=[q.preInit];while(q.preInit.length>0)q.preInit.pop()()}mA();if(typeof z!=="undefined")z.exports=q;q.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(q=F6=kA=KA=C6=hA=cj=Y=$j=Fj=Bj=Lj=Pj=Uj=void 0,typeof z!=="undefined")delete z.exports}});var xj=D((Zn,a6)=>{a6.exports="./cryptit.index.wasm"});var Nj=D((Tj,yA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof yA==="object"&&yA.exports)yA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:Tj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(f){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=r().then((_)=>new Promise((F)=>{_.postRun=()=>F(_)}));else I=k().then((_)=>{let F=f?i(f):void 0;return t(_,F)});return n._promise=I,I.then((_)=>{return n._module=_,delete n._promise,_})}function t(f,I){return new Promise((_)=>{return A.Module={wasmBinary:f,wasmMemory:I,postRun(){_(Module)}},r()})}function r(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(gA())}function k(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(xj()).then((I)=>{return E(I)})}function E(f){let I=atob(f),_=new Uint8Array(new ArrayBuffer(I.length));for(let F=0;F<I.length;F++)_[F]=I.charCodeAt(F);return _}function i(f){let Z=Math.min(Math.max(Math.ceil(f*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:Z,maximum:32767})}function v(f,I){return f.allocate(I,"i8",f.ALLOC_NORMAL)}function c(f,I){let _=new Uint8Array([...I,0]);return v(f,_)}function B(f){if(typeof f!=="string")return f;if(typeof TextEncoder==="function")return new TextEncoder().encode(f);else if(typeof Buffer==="function")return Buffer.from(f);else throw new Error("Don't know how to encode UTF8")}function L(f){let I=f.mem||1024;return n(I).then((_)=>{let F=f.time||1,l=f.parallelism||1,s=B(f.pass),Z=c(_,s),VA=s.length,cA=B(f.salt),$A=c(_,cA),a=cA.length,h=f.type||j.Argon2d,u=_.allocate(new Array(f.hashLen||24),"i8",_.ALLOC_NORMAL),x=f.secret?v(_,f.secret):0,p=f.secret?f.secret.byteLength:0,G=f.ad?v(_,f.ad):0,f6=f.ad?f.ad.byteLength:0,FA=f.hashLen||24,tj=_._argon2_encodedlen(F,I,l,a,FA,h),WA=_.allocate(new Array(tj+1),"i8",_.ALLOC_NORMAL),Nn=19,M,BA;try{BA=_._argon2_hash_ext(F,I,l,Z,VA,$A,a,u,FA,WA,tj,h,x,p,G,f6,19)}catch(m){M=m}let LA;if(BA===0&&!M){let m="",rj=new Uint8Array(FA);for(let PA=0;PA<FA;PA++){let qj=_.HEAP8[u+PA];rj[PA]=qj,m+=("0"+(255&qj).toString(16)).slice(-2)}let i6=_.UTF8ToString(WA);LA={hash:rj,hashHex:m,encoded:i6}}else{try{if(!M)M=_.UTF8ToString(_._argon2_error_message(BA))}catch(m){}LA={message:M,code:BA}}try{if(_._free(Z),_._free($A),_._free(u),_._free(WA),G)_._free(G);if(x)_._free(x)}catch(m){}if(M)throw LA;else return LA})}function $(f){return n().then((I)=>{let _=B(f.pass),F=c(I,_),l=_.length,s=f.secret?v(I,f.secret):0,Z=f.secret?f.secret.byteLength:0,VA=f.ad?v(I,f.ad):0,cA=f.ad?f.ad.byteLength:0,$A=B(f.encoded),a=c(I,$A),h=f.type;if(h===void 0){let G=f.encoded.split("$")[1];if(G)G=G.replace("a","A"),h=j[G]||j.Argon2d}let u,x;try{x=I._argon2_verify_ext(a,F,l,s,Z,VA,cA,h)}catch(G){u=G}let p;if(x||u){try{if(!u)u=I.UTF8ToString(I._argon2_error_message(x))}catch(G){}p={message:u,code:x}}try{I._free(F),I._free(a)}catch(G){}if(u)throw p;else return p})}function W(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:L,verify:$,unloadRuntime:W}})});var Dj=D((Mn,Wj)=>{var wA=/^[a-z0-9-]{1,32}$/,HA=/^[a-z0-9-]{1,32}$/,xA=/^[a-zA-Z0-9/+.-]+$/,Sj=/^([a-zA-Z0-9/+.-]+|)$/,p6=/^((-)?[1-9]\d*|0)$/,eA=/^v=(\d+)$/;function d6(A){return fA(A).map((j)=>[j,A[j]].join("=")).join(",")}function An(A){let j={};return A.split(",").forEach((n)=>{let t=n.split("=");if(t.length<2)throw new TypeError("params must be in the format name=value");j[t.shift()]=t.join("=")}),j}function fA(A){return Object.keys(A)}function Vj(A){if(typeof Object.values==="function")return Object.values(A);return fA(A).map((j)=>A[j])}function jn(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!wA.test(A.id))throw new TypeError(`id must satisfy ${wA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let t=fA(A.params);if(!t.every((E)=>HA.test(E)))throw new TypeError(`params names must satisfy ${HA}`);t.forEach((E)=>{if(typeof A.params[E]==="number")A.params[E]=A.params[E].toString();else if(Buffer.isBuffer(A.params[E]))A.params[E]=A.params[E].toString("base64").split("=")[0]});let r=Vj(A.params);if(!r.every((E)=>typeof E==="string"))throw new TypeError("params values must be strings");if(!r.every((E)=>xA.test(E)))throw new TypeError(`params values must satisfy ${xA}`);let k=d6(A.params);j.push(k)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function nn(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!eA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let t=j.shift();if(!wA.test(t))throw new TypeError(`id must satisfy ${wA}`);let r;if(eA.test(j[0]))r=parseInt(j.shift().match(eA)[1],10);let k,E;if(Sj.test(j[j.length-1]))if(j.length>1&&Sj.test(j[j.length-2]))k=Buffer.from(j.pop(),"base64"),E=Buffer.from(j.pop(),"base64");else E=Buffer.from(j.pop(),"base64");let i;if(j.length>0){let c=j.pop();if(i=An(c),!fA(i).every(($)=>HA.test($)))throw new TypeError(`params names must satisfy ${HA}`);if(!Vj(i).every(($)=>xA.test($)))throw new TypeError(`params values must satisfy ${xA}`);fA(i).forEach(($)=>{i[$]=p6.test(i[$])?parseInt(i[$],10):i[$]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let v={id:t};if(r)v.version=r;if(i)v.params=i;if(E)v.salt=E;if(k)v.hash=k;return v}Wj.exports={serialize:jn,deserialize:nn}});var sj=D((mn,lj)=>{var zj=P("fs"),H=P("path"),oj=P("os"),Qj=typeof __webpack_require__==="function"?__non_webpack_require__:P,tn=process.config&&process.config.variables||{},rn=!!process.env.PREBUILDS_ONLY,Xj=process.versions.modules,bA=En()?"electron":kn()?"node-webkit":"node",lA=process.env.npm_config_arch||oj.arch(),sA=process.env.npm_config_platform||oj.platform(),Cj=process.env.LIBC||(fn(sA)?"musl":"glibc"),aA=process.env.ARM_VERSION||(lA==="arm64"?"8":tn.arm_version)||"",Zj=(process.versions.uv||"").split(".")[0];lj.exports=y;function y(A){return Qj(y.resolve(A))}y.resolve=y.path=function(A){A=H.resolve(A||".");try{var j=Qj(H.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(v){}if(!rn){var n=Jj(H.join(A,"build/Release"),Yj);if(n)return n;var t=Jj(H.join(A,"build/Debug"),Yj);if(t)return t}var r=i(A);if(r)return r;var k=i(H.dirname(process.execPath));if(k)return k;var E=["platform="+sA,"arch="+lA,"runtime="+bA,"abi="+Xj,"uv="+Zj,aA?"armv="+aA:"","libc="+Cj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+E+`
    loaded from: `+A+`
`);function i(v){var c=pA(H.join(v,"prebuilds")).map(hj),B=c.filter(Mj(sA,lA)).sort(mj)[0];if(!B)return;var L=H.join(v,"prebuilds",B.name),$=pA(L).map(gj),W=$.filter(ej(bA,Xj)),f=W.sort(bj(bA))[0];if(f)return H.join(L,f.file)}};function pA(A){try{return zj.readdirSync(A)}catch(j){return[]}}function Jj(A,j){var n=pA(A).filter(j);return n[0]&&H.join(A,n[0])}function Yj(A){return/\.node$/.test(A)}function hj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],t=j[1].split("+");if(!n)return;if(!t.length)return;if(!t.every(Boolean))return;return{name:A,platform:n,architectures:t}}function Mj(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function mj(A,j){return A.architectures.length-j.architectures.length}function gj(A){var j=A.split("."),n=j.pop(),t={file:A,specificity:0};if(n!=="node")return;for(var r=0;r<j.length;r++){var k=j[r];if(k==="node"||k==="electron"||k==="node-webkit")t.runtime=k;else if(k==="napi")t.napi=!0;else if(k.slice(0,3)==="abi")t.abi=k.slice(3);else if(k.slice(0,2)==="uv")t.uv=k.slice(2);else if(k.slice(0,4)==="armv")t.armv=k.slice(4);else if(k==="glibc"||k==="musl")t.libc=k;else continue;t.specificity++}return t}function ej(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!qn(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==Zj)return!1;if(n.armv&&n.armv!==aA)return!1;if(n.libc&&n.libc!==Cj)return!1;return!0}}function qn(A){return A.runtime==="node"&&A.napi}function bj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function kn(){return!!(process.versions&&process.versions.nw)}function En(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function fn(A){return A==="linux"&&zj.existsSync("/etc/alpine-release")}y.parseTags=gj;y.matchTags=ej;y.compareTags=bj;y.parseTuple=hj;y.matchTuple=Mj;y.compareTuples=mj});var aj=D((en,Aj)=>{var dA=typeof __webpack_require__==="function"?__non_webpack_require__:P;if(typeof dA.addon==="function")Aj.exports=dA.addon.bind(dA);else Aj.exports=sj()});var j6=D((On,o)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",ln=P("node:assert"),{randomBytes:vn,timingSafeEqual:_n}=P("node:crypto"),{promisify:In}=P("node:util"),{deserialize:pj,serialize:cn}=Dj(),$n=aj(),{hash:dj}=$n(__dirname),Fn=In(vn);On.argon2d=0;On.argon2i=1;On.argon2id=2;var iA=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),Bn=Object.freeze({[iA.argon2d]:"argon2d",[iA.argon2i]:"argon2i",[iA.argon2id]:"argon2id"}),A6={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function Ln(A,j){let{raw:n,salt:t,...r}={...A6,...j};if(r.hashLength>4294967295)throw new RangeError("Hash length is too large");if(r.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(r.timeCost>4294967295)throw new RangeError("Time cost is too large");if(r.parallelism>16777215)throw new RangeError("Parallelism is too large");t=t??await Fn(16);let{hashLength:k,secret:E=Buffer.alloc(0),type:i,version:v,memoryCost:c,timeCost:B,parallelism:L,associatedData:$=Buffer.alloc(0)}=r,W=await dj({password:Buffer.from(A),salt:t,secret:E,data:$,hashLength:k,m:c,t:B,p:L,version:v,type:i});if(n)return W;return cn({id:Bn[i],version:v,params:{m:c,t:B,p:L,...$.byteLength>0?{data:$}:{}},salt:t,hash:W})}On.hash=Ln;function Pn(A,j={}){let{memoryCost:n,timeCost:t,parallelism:r,version:k}={...A6,...j},{version:E,params:{m:i,t:v,p:c}}=pj(A);return+E!==+k||+i!==+n||+v!==+t||+c!==+r}On.needsRehash=Pn;async function Un(A,j,n={}){let{id:t,...r}=pj(A);if(!(t in iA))return!1;let{version:k=16,params:{m:E,t:i,p:v,data:c=""},salt:B,hash:L}=r,{secret:$=Buffer.alloc(0)}=n;return _n(await dj({password:Buffer.from(j),salt:B,secret:$,data:Buffer.from(c,"base64"),hashLength:L.byteLength,m:+E,t:+i,p:+v,version:+k,type:iA[t]}),L)}On.verify=Un});class w extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class T extends w{}class d extends w{}class XA extends w{}class UA extends w{}class g extends w{}class N extends w{}class OA extends w{}class R extends w{}class U{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new UA(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new UA(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class JA{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),t=new Uint8Array(j.length+n.length);return t.set(j),t.set(n,j.length),t}async decryptChunk(A){let j=A.slice(0,12),n=A.slice(12),t=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);try{let r=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(r)}catch{throw new R("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var TA=DA(Nj(),1);async function n6(A,j,n,t){if(t==="node"){let r=await Promise.resolve().then(() => DA(j6(),1)),k=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),E=Buffer.from(j),i=await r.hash(k,{salt:E,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:r.argon2id});return{hash:new Uint8Array(i)}}if(t==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>{let r=new URL("argon2.wasm",import.meta.url).href;return fetch(r).then((k)=>{if(!k.ok)throw new Error("Failed to load argon2.wasm");return k.arrayBuffer()}).then((k)=>new Uint8Array(k))};return TA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:TA.ArgonType.Argon2id}).then((r)=>{if(!r||!r.hash)throw new Error("Failed to produce key derivation");return{hash:r.hash}}).catch((r)=>{let k=r instanceof Error?r.message:typeof r==="string"?r:"Unknown error";throw new N(`argon2-browser failure: ${k}`)})}throw new Error(`Unsupported environment: ${t}`)}class jj{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,n,t){let{hash:r}=await n6(A,j,this.presets[n],t.isNode?"node":"browser");return t.subtle.importKey("raw",r,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var t6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},Hn={id:0,cipher:JA,kdf:new jj(t6),saltLengths:{low:12,high:16},difficulties:t6,defaultChunkSize:524288};U.register(Hn);var NA=1;function r6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function vA(...A){let j=A.reduce((r,k)=>r+k.byteLength,0),n=new Uint8Array(j),t=0;for(let r of A)n.set(r,t),t+=r.byteLength;return n}function _A(...A){try{let j=vA(...A);if(r6())return Buffer.from(j).toString("base64");let n="";for(let t=0;t<j.length;t++)n+=String.fromCharCode(j[t]);return btoa(n)}catch(j){throw new XA("Base64 Enconding Error")}}function nj(A){try{if(r6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let t=0;t<j.length;t++)n[t]=j.charCodeAt(t);return n}catch(j){throw new d("Base64 Decoding Error")}}function SA(A,j,n,t){let r={low:0,middle:1,high:2}[j]??0,k=A<<5|(n==="high"?1:0)<<2|r;return vA(new Uint8Array([NA,k]),t)}function Q(A){if(A[0]!==NA)throw new T("Invalid input format. The input is unknown.");try{let j=A[1],n=j>>5,t=j>>2&1?"high":"low",r=j&3,k=["low","middle","high"][r],E=U.get(n).saltLengths[t],i=A.slice(2,2+E);return{version:n,difficulty:k,saltStrength:t,salt:i,headerLen:2+E}}catch(j){throw new g(j instanceof Error?j.message:String(j))}}class IA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(n.length-t>=this.chunkSize){let r=n.slice(t,t+this.chunkSize);t+=this.chunkSize;let k=await this.engine.encryptChunk(r),E=new Uint8Array(4);new DataView(E.buffer).setUint32(0,k.length,!1);let i=new Uint8Array(4+k.length);i.set(E),i.set(k,E.length),j.enqueue(i)}this.buffer=n.slice(t)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let t=new Uint8Array(4+j.length);t.set(n),t.set(j,4),A.enqueue(t),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class e{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(!0){if(n.length-t<4)break;let r=new DataView(n.buffer,n.byteOffset+t,4).getUint32(0,!1);if(n.length-t-4<r)break;t+=4;let k=n.slice(t,t+r);t+=r;try{let E=await this.engine.decryptChunk(k);j.enqueue(E)}catch(E){throw E instanceof R?E:new R("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(t)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class b{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new IA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(r,k){if(j===0){k.enqueue(r);return}if(r.byteLength<=j){j-=r.byteLength;return}k.enqueue(r.slice(j)),j=0}}),t=new e(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(t)}}async collect(A,j,n=null){let t=A.pipeThrough(j).getReader(),r=[];if(n?.length)r.push(n);while(!0){let{value:v,done:c}=await t.read();if(c)break;r.push(v)}let k=r.reduce((v,c)=>v+c.byteLength,0),E=new Uint8Array(k),i=0;for(let v of r)E.set(v,i),i+=v.byteLength;return E}}function q6(A=0,j=console.info){return{level:A,log(n,t){if(n<=A)j(`${n}| ${t}`)}}}var k6=new Map;class V{static getEngine(A,j){let n=k6.get(j);if(n)return n;let t=U.get(j),r=new t.cipher(A),k=t.kdf,E=t.defaultChunkSize;return n={desc:t,cipher:r,kdf:k,chunkSize:E,provider:A},k6.set(j,n),n}static async deriveKey(A,j,n,t){try{let r=await A.kdf.derive(j,n,t,A.provider);A.cipher.key=r}catch(r){let k=r instanceof Error?r.message:String(r);throw new N(k)}}}class C{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=U.get(j.version??U.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new b(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=q6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await C.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await C.peekHeader(A),n=Q(j);return{version:n.version,difficulty:n.difficulty,salt:_A(n.salt),saltLength:n.salt.byteLength}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setVersion(A){this.v=U.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new b(this.cipher,this.chunkSize)}getVersion(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){this.chunkSize=A,this.stream=new b(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){try{this.log.log(1,"Start text encryption"),this.log.log(2,"Deriving key for text encryption");let n=this.genSalt();await this.deriveKey(j,n),this.log.log(3,`Salt generated: ${_A(n)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let t=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.log.log(3,"Encoding header");let r=SA(this.v.id,this.difficulty,this.saltStrength,n);return this.log.log(3,"Encoding text"),_A(r,t)}catch(n){throw new OA(n instanceof Error?n.message:String(n))}}async decryptText(A,j){try{this.log.log(1,"Start text decryption");let n=nj(A);this.log.log(3,"Start header decoding"),await C.peekHeader(A);let t=Q(n);this.log.log(3,"Trying to get engine");let r=V.getEngine(this.provider,t.version);this.log.log(2,"Deriving key via engine for text decryption"),this.log.log(3,`Salt use: ${_A(t.salt)}, KDF difficulty: ${t.difficulty}`),await V.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting text data");let k=await r.cipher.decryptChunk(n.slice(t.headerLen));return this.log.log(3,"Decoding text"),new TextDecoder().decode(k)}catch(n){if(n instanceof R||n instanceof T||n instanceof g||n instanceof d||n instanceof N)throw n;throw new R("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){try{this.log.log(2,"Deriving key for file encryption");let n=this.genSalt();await this.deriveKey(j,n);let t=SA(this.v.id,this.difficulty,this.saltStrength,n),r=await this.stream.collect(A.stream(),new IA(this.cipher,this.chunkSize).toTransformStream(),t);return new Blob([r],{type:"application/octet-stream"})}catch(n){throw new OA(n instanceof Error?n.message:String(n))}}async decryptFile(A,j){try{let n=await C.peekHeader(A),t=Q(n),r=V.getEngine(this.provider,t.version);await V.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting file data");let E=await new b(r.cipher,r.chunkSize).collect(A.slice(t.headerLen).stream(),new e(r.cipher,r.chunkSize).toTransformStream());return new Blob([E],{type:"application/octet-stream"})}catch(n){if(n instanceof R)throw n;throw new R(n instanceof Error?n.message:String(n))}}async createEncryptionStream(A){this.log.log(2,"Deriving key for stream encryption");let j=this.genSalt();await this.deriveKey(A,j);let n=SA(this.v.id,this.difficulty,this.saltStrength,j),t=this.stream.encryptionStream();return{header:n,writable:t.writable,readable:t.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),t=null;async function r(k,E){let i=k.getReader();while(!0){let{value:v,done:c}=await i.read();if(c)break;E.enqueue(v)}}return new TransformStream({async transform(k,E){if(!t){if(n=vA(n,k),n.length<2)return;let v=n.slice(0,30),{salt:c,difficulty:B}=Q(v),L=n[1]>>5,$=n[1]>>2&1?"high":"low",f=2+U.get(L).saltLengths[$];if(n.length<f)return;let I=V.getEngine(j.provider,L);await V.deriveKey(I,A,c,B),t=new e(I.cipher,I.chunkSize).toTransformStream(),r(t.readable,E);let _=n.slice(f);if(_.length){let F=t.writable.getWriter();await F.write(_),F.releaseLock()}return}let i=t.writable.getWriter();await i.write(k),i.releaseLock()},async flush(){if(t){let k=t.writable.getWriter();await k.close(),k.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let t=performance.now();try{let r=await this.kdf.derive(A,j,n,this.provider);this.cipher.key=r,this.log.log(3,`Key derivation completed in ${(performance.now()-t).toFixed(1)} ms`)}catch(r){throw new N(r instanceof Error?r.message:String(r))}}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}static async peekHeader(A){if(typeof A==="string")A=nj(A);if(A instanceof Uint8Array){if(A.length<2)throw new T("Input too short");let{headerLen:j}=Q(A.length>=16?A:Uint8Array.from(A));if(A.length<j)throw new T("Incomplete header");return A.slice(0,j)}if(A instanceof Blob){let j=new Uint8Array(await A.slice(0,2).arrayBuffer());if(j[0]!==1)throw new T("Invalid input format. The input is unknown.");let n=j[1],t=n>>5,r=n>>2&1?"high":"low",k=U.get(t).saltLengths[r],E=new Uint8Array(await A.slice(0,2+k).arrayBuffer());return Q(E),E}throw new g("Unsupported input type")}}import{webcrypto as xn,randomFillSync as Tn}from"node:crypto";var E6={subtle:xn.subtle,getRandomValues(A){return Tn(A),A},isNode:!0};function Qt(A){return new C(E6,A)}export{Qt as createCryptit};

//# debugId=3C49A2CAB17AA5BD64756E2164756E21
