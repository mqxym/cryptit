import{createRequire as I6}from"node:module";var f6=Object.create;var{getPrototypeOf:i6,defineProperty:rj,getOwnPropertyNames:v6}=Object;var _6=Object.prototype.hasOwnProperty;var VA=(A,j,n)=>{n=A!=null?f6(i6(A)):{};let t=j||!A||!A.__esModule?rj(n,"default",{value:A,enumerable:!0}):n;for(let r of v6(A))if(!_6.call(t,r))rj(t,r,{get:()=>A[r],enumerable:!0});return t};var V=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var P=I6(import.meta.url);var MA=V((zn,Y)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",q=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},c6=q,AA={},N;for(N in q)if(q.hasOwnProperty(N))AA[N]=q[N];var jA=[],fj="./this.program",YA=function(A,j){throw j},RA=!1,X=!1,CA=!1,ij=!1;RA=typeof window==="object";X=typeof importScripts==="function";CA=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";ij=!RA&&!CA&&!X;var K="";function $6(A){if(q.locateFile)return q.locateFile(A,K);return K+A}var OA,zA,nA,F6,XA,JA;if(CA){if(X)K=P("path").dirname(K)+"/";else K=__dirname+"/";if(OA=function A(j,n){if(!XA)XA=P("fs");if(!JA)JA=P("path");return j=JA.normalize(j),XA.readFileSync(j,n?null:"utf8")},nA=function A(j){var n=OA(j,!0);if(!n.buffer)n=new Uint8Array(n);return qj(n.buffer),n},process.argv.length>1)fj=process.argv[1].replace(/\\/g,"/");if(jA=process.argv.slice(2),typeof Y!=="undefined")Y.exports=q;process.on("uncaughtException",function(A){if(!(A instanceof b6))throw A}),process.on("unhandledRejection",EA),YA=function(A){process.exit(A)},q.inspect=function(){return"[Emscripten Module object]"}}else if(ij){if(typeof read!="undefined")OA=function A(j){return read(j)};if(nA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),qj(typeof n==="object"),n},typeof scriptArgs!="undefined")jA=scriptArgs;else if(typeof arguments!="undefined")jA=arguments;if(typeof quit==="function")YA=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(RA||X){if(X)K=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)K=document.currentScript.src;if(K.indexOf("blob:")!==0)K=K.substr(0,K.lastIndexOf("/")+1);else K="";{if(OA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},X)nA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};zA=function(A,j,n){var t=new XMLHttpRequest;t.open("GET",A,!0),t.responseType="arraybuffer",t.onload=function(){if(t.status==200||t.status==0&&t.response){j(t.response);return}n()},t.onerror=n,t.send(null)}}F6=function(A){document.title=A}}var Jn=q.print||console.log.bind(console),d=q.printErr||console.warn.bind(console);for(N in AA)if(AA.hasOwnProperty(N))q[N]=AA[N];AA=null;if(q.arguments)jA=q.arguments;if(q.thisProgram)fj=q.thisProgram;if(q.quit)YA=q.quit;var rA;if(q.wasmBinary)rA=q.wasmBinary;var on=q.noExitRuntime||!0;if(typeof WebAssembly!=="object")EA("no native wasm support detected");var qA,vj=!1,B6;function qj(A,j){if(!A)EA("Assertion failed: "+j)}var L6=0,P6=1;function U6(A,j){var n;if(j==P6)n=uj(A.length);else n=yj(A.length);if(A.subarray||A.slice)o.set(A,n);else o.set(new Uint8Array(A),n);return n}var Ej=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function O6(A,j,n){var t=j+n,r=j;while(A[r]&&!(r>=t))++r;if(r-j>16&&A.subarray&&Ej)return Ej.decode(A.subarray(j,r));else{var E="";while(j<r){var k=A[j++];if(!(k&128)){E+=String.fromCharCode(k);continue}var i=A[j++]&63;if((k&224)==192){E+=String.fromCharCode((k&31)<<6|i);continue}var v=A[j++]&63;if((k&240)==224)k=(k&15)<<12|i<<6|v;else k=(k&7)<<18|i<<12|v<<6|A[j++]&63;if(k<65536)E+=String.fromCharCode(k);else{var c=k-65536;E+=String.fromCharCode(55296|c>>10,56320|c&1023)}}}return E}function G6(A,j){return A?O6(o,A,j):""}function K6(A,j){if(A%j>0)A+=j-A%j;return A}var QA,_j,o,Ij,cj,$j,Fj,Bj,Lj;function Pj(A){QA=A,q.HEAP8=_j=new Int8Array(A),q.HEAP16=Ij=new Int16Array(A),q.HEAP32=$j=new Int32Array(A),q.HEAPU8=o=new Uint8Array(A),q.HEAPU16=cj=new Uint16Array(A),q.HEAPU32=Fj=new Uint32Array(A),q.HEAPF32=Bj=new Float32Array(A),q.HEAPF64=Lj=new Float64Array(A)}var Yn=q.INITIAL_MEMORY||16777216,GA,Uj=[],Oj=[],Gj=[],R6=!1;function y6(){if(q.preRun){if(typeof q.preRun=="function")q.preRun=[q.preRun];while(q.preRun.length)H6(q.preRun.shift())}ZA(Uj)}function u6(){R6=!0,ZA(Oj)}function w6(){if(q.postRun){if(typeof q.postRun=="function")q.postRun=[q.postRun];while(q.postRun.length)T6(q.postRun.shift())}ZA(Gj)}function H6(A){Uj.unshift(A)}function x6(A){Oj.unshift(A)}function T6(A){Gj.unshift(A)}var J=0,oA=null,tA=null;function N6(A){if(J++,q.monitorRunDependencies)q.monitorRunDependencies(J)}function S6(A){if(J--,q.monitorRunDependencies)q.monitorRunDependencies(J);if(J==0){if(oA!==null)clearInterval(oA),oA=null;if(tA){var j=tA;tA=null,j()}}}q.preloadedImages={};q.preloadedAudios={};function EA(A){if(q.onAbort)q.onAbort(A);A+="",d(A),vj=!0,B6=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var D6="data:application/octet-stream;base64,";function Kj(A){return A.startsWith(D6)}function Rj(A){return A.startsWith("file://")}var O="argon2.wasm";if(!Kj(O))O=$6(O);function kj(A){try{if(A==O&&rA)return new Uint8Array(rA);if(nA)return nA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){EA(j)}}function V6(){if(!rA&&(RA||X)){if(typeof fetch==="function"&&!Rj(O))return fetch(O,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+O+"'";return A.arrayBuffer()}).catch(function(){return kj(O)});else if(zA)return new Promise(function(A,j){zA(O,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return kj(O)})}function W6(){var A={a:Y6};function j(k,i){var v=k.exports;q.asm=v,qA=q.asm.c,Pj(qA.buffer),GA=q.asm.k,x6(q.asm.d),S6("wasm-instantiate")}N6("wasm-instantiate");function n(k){j(k.instance)}function t(k){return V6().then(function(i){var v=WebAssembly.instantiate(i,A);return v}).then(k,function(i){d("failed to asynchronously prepare wasm: "+i),EA(i)})}function r(){if(!rA&&typeof WebAssembly.instantiateStreaming==="function"&&!Kj(O)&&!Rj(O)&&typeof fetch==="function")return fetch(O,{credentials:"same-origin"}).then(function(k){var i=WebAssembly.instantiateStreaming(k,A);return i.then(n,function(v){return d("wasm streaming compile failed: "+v),d("falling back to ArrayBuffer instantiation"),t(n)})});else return t(n)}if(q.instantiateWasm)try{var E=q.instantiateWasm(A,j);return E}catch(k){return d("Module.instantiateWasm callback failed with error: "+k),!1}return r(),{}}function ZA(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(q);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)GA.get(n)();else GA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function X6(A,j,n){o.copyWithin(A,j,j+n)}function J6(A){try{return qA.grow(A-QA.byteLength+65535>>>16),Pj(qA.buffer),1}catch(j){}}function o6(A){var j=o.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var t=1;t<=4;t*=2){var r=j*(1+0.2/t);r=Math.min(r,A+100663296);var E=Math.min(n,K6(Math.max(A,r),65536)),k=J6(E);if(k)return!0}return!1}var Y6={a:X6,b:o6},z6=W6(),C6=q.___wasm_call_ctors=function(){return(C6=q.___wasm_call_ctors=q.asm.d).apply(null,arguments)},Q6=q._argon2_hash=function(){return(Q6=q._argon2_hash=q.asm.e).apply(null,arguments)},yj=q._malloc=function(){return(yj=q._malloc=q.asm.f).apply(null,arguments)},Z6=q._free=function(){return(Z6=q._free=q.asm.g).apply(null,arguments)},h6=q._argon2_verify=function(){return(h6=q._argon2_verify=q.asm.h).apply(null,arguments)},M6=q._argon2_error_message=function(){return(M6=q._argon2_error_message=q.asm.i).apply(null,arguments)},m6=q._argon2_encodedlen=function(){return(m6=q._argon2_encodedlen=q.asm.j).apply(null,arguments)},g6=q._argon2_hash_ext=function(){return(g6=q._argon2_hash_ext=q.asm.l).apply(null,arguments)},e6=q._argon2_verify_ext=function(){return(e6=q._argon2_verify_ext=q.asm.m).apply(null,arguments)},uj=q.stackAlloc=function(){return(uj=q.stackAlloc=q.asm.n).apply(null,arguments)};q.allocate=U6;q.UTF8ToString=G6;q.ALLOC_NORMAL=L6;var KA;function b6(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}tA=function A(){if(!KA)hA();if(!KA)tA=A};function hA(A){if(A=A||jA,J>0)return;if(y6(),J>0)return;function j(){if(KA)return;if(KA=!0,q.calledRun=!0,vj)return;if(u6(),q.onRuntimeInitialized)q.onRuntimeInitialized();w6()}if(q.setStatus)q.setStatus("Running..."),setTimeout(function(){setTimeout(function(){q.setStatus("")},1),j()},1);else j()}q.run=hA;if(q.preInit){if(typeof q.preInit=="function")q.preInit=[q.preInit];while(q.preInit.length>0)q.preInit.pop()()}hA();if(typeof Y!=="undefined")Y.exports=q;q.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(q=c6=qA=GA=z6=QA=_j=o=Ij=cj=$j=Fj=Bj=Lj=void 0,typeof Y!=="undefined")delete Y.exports}});var wj=V((Cn,l6)=>{l6.exports="./cryptit.index.wasm"});var xj=V((Hj,yA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof yA==="object"&&yA.exports)yA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:Hj,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(f){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let I;if(A.process&&A.process.versions&&A.process.versions.node)I=r().then((_)=>new Promise((F)=>{_.postRun=()=>F(_)}));else I=E().then((_)=>{let F=f?i(f):void 0;return t(_,F)});return n._promise=I,I.then((_)=>{return n._module=_,delete n._promise,_})}function t(f,I){return new Promise((_)=>{return A.Module={wasmBinary:f,wasmMemory:I,postRun(){_(Module)}},r()})}function r(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(MA())}function E(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(wj()).then((I)=>{return k(I)})}function k(f){let I=atob(f),_=new Uint8Array(new ArrayBuffer(I.length));for(let F=0;F<I.length;F++)_[F]=I.charCodeAt(F);return _}function i(f){let Z=Math.min(Math.max(Math.ceil(f*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:Z,maximum:32767})}function v(f,I){return f.allocate(I,"i8",f.ALLOC_NORMAL)}function c(f,I){let _=new Uint8Array([...I,0]);return v(f,_)}function B(f){if(typeof f!=="string")return f;if(typeof TextEncoder==="function")return new TextEncoder().encode(f);else if(typeof Buffer==="function")return Buffer.from(f);else throw new Error("Don't know how to encode UTF8")}function L(f){let I=f.mem||1024;return n(I).then((_)=>{let F=f.time||1,l=f.parallelism||1,s=B(f.pass),Z=c(_,s),SA=s.length,IA=B(f.salt),cA=c(_,IA),a=IA.length,h=f.type||j.Argon2d,y=_.allocate(new Array(f.hashLen||24),"i8",_.ALLOC_NORMAL),H=f.secret?v(_,f.secret):0,p=f.secret?f.secret.byteLength:0,G=f.ad?v(_,f.ad):0,E6=f.ad?f.ad.byteLength:0,$A=f.hashLen||24,jj=_._argon2_encodedlen(F,I,l,a,$A,h),DA=_.allocate(new Array(jj+1),"i8",_.ALLOC_NORMAL),xn=19,M,FA;try{FA=_._argon2_hash_ext(F,I,l,Z,SA,cA,a,y,$A,DA,jj,h,H,p,G,E6,19)}catch(m){M=m}let BA;if(FA===0&&!M){let m="",nj=new Uint8Array($A);for(let LA=0;LA<$A;LA++){let tj=_.HEAP8[y+LA];nj[LA]=tj,m+=("0"+(255&tj).toString(16)).slice(-2)}let k6=_.UTF8ToString(DA);BA={hash:nj,hashHex:m,encoded:k6}}else{try{if(!M)M=_.UTF8ToString(_._argon2_error_message(FA))}catch(m){}BA={message:M,code:FA}}try{if(_._free(Z),_._free(cA),_._free(y),_._free(DA),G)_._free(G);if(H)_._free(H)}catch(m){}if(M)throw BA;else return BA})}function $(f){return n().then((I)=>{let _=B(f.pass),F=c(I,_),l=_.length,s=f.secret?v(I,f.secret):0,Z=f.secret?f.secret.byteLength:0,SA=f.ad?v(I,f.ad):0,IA=f.ad?f.ad.byteLength:0,cA=B(f.encoded),a=c(I,cA),h=f.type;if(h===void 0){let G=f.encoded.split("$")[1];if(G)G=G.replace("a","A"),h=j[G]||j.Argon2d}let y,H;try{H=I._argon2_verify_ext(a,F,l,s,Z,SA,IA,h)}catch(G){y=G}let p;if(H||y){try{if(!y)y=I.UTF8ToString(I._argon2_error_message(H))}catch(G){}p={message:y,code:H}}try{I._free(F),I._free(a)}catch(G){}if(y)throw p;else return p})}function D(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:L,verify:$,unloadRuntime:D}})});var Dj=V((Zn,Sj)=>{var uA=/^[a-z0-9-]{1,32}$/,wA=/^[a-z0-9-]{1,32}$/,HA=/^[a-zA-Z0-9/+.-]+$/,Tj=/^([a-zA-Z0-9/+.-]+|)$/,s6=/^((-)?[1-9]\d*|0)$/,mA=/^v=(\d+)$/;function a6(A){return kA(A).map((j)=>[j,A[j]].join("=")).join(",")}function p6(A){let j={};return A.split(",").forEach((n)=>{let t=n.split("=");if(t.length<2)throw new TypeError("params must be in the format name=value");j[t.shift()]=t.join("=")}),j}function kA(A){return Object.keys(A)}function Nj(A){if(typeof Object.values==="function")return Object.values(A);return kA(A).map((j)=>A[j])}function d6(A){let j=[""];if(typeof A!=="object"||A===null)throw new TypeError("opts must be an object");if(typeof A.id!=="string")throw new TypeError("id must be a string");if(!uA.test(A.id))throw new TypeError(`id must satisfy ${uA}`);if(j.push(A.id),typeof A.version!=="undefined"){if(typeof A.version!=="number"||A.version<0||!Number.isInteger(A.version))throw new TypeError("version must be a positive integer number");j.push(`v=${A.version}`)}if(typeof A.params!=="undefined"){if(typeof A.params!=="object"||A.params===null)throw new TypeError("params must be an object");let t=kA(A.params);if(!t.every((k)=>wA.test(k)))throw new TypeError(`params names must satisfy ${wA}`);t.forEach((k)=>{if(typeof A.params[k]==="number")A.params[k]=A.params[k].toString();else if(Buffer.isBuffer(A.params[k]))A.params[k]=A.params[k].toString("base64").split("=")[0]});let r=Nj(A.params);if(!r.every((k)=>typeof k==="string"))throw new TypeError("params values must be strings");if(!r.every((k)=>HA.test(k)))throw new TypeError(`params values must satisfy ${HA}`);let E=a6(A.params);j.push(E)}if(typeof A.salt!=="undefined"){if(!Buffer.isBuffer(A.salt))throw new TypeError("salt must be a Buffer");if(j.push(A.salt.toString("base64").split("=")[0]),typeof A.hash!=="undefined"){if(!Buffer.isBuffer(A.hash))throw new TypeError("hash must be a Buffer");j.push(A.hash.toString("base64").split("=")[0])}}return j.join("$")}function An(A){if(typeof A!=="string"||A==="")throw new TypeError("pchstr must be a non-empty string");if(A[0]!=="$")throw new TypeError("pchstr must contain a $ as first char");let j=A.split("$");j.shift();let n=5;if(!mA.test(j[1]))n--;if(j.length>n)throw new TypeError(`pchstr contains too many fileds: ${j.length}/${n}`);let t=j.shift();if(!uA.test(t))throw new TypeError(`id must satisfy ${uA}`);let r;if(mA.test(j[0]))r=parseInt(j.shift().match(mA)[1],10);let E,k;if(Tj.test(j[j.length-1]))if(j.length>1&&Tj.test(j[j.length-2]))E=Buffer.from(j.pop(),"base64"),k=Buffer.from(j.pop(),"base64");else k=Buffer.from(j.pop(),"base64");let i;if(j.length>0){let c=j.pop();if(i=p6(c),!kA(i).every(($)=>wA.test($)))throw new TypeError(`params names must satisfy ${wA}`);if(!Nj(i).every(($)=>HA.test($)))throw new TypeError(`params values must satisfy ${HA}`);kA(i).forEach(($)=>{i[$]=s6.test(i[$])?parseInt(i[$],10):i[$]})}if(j.length>0)throw new TypeError(`pchstr contains unrecognized fileds: ${j}`);let v={id:t};if(r)v.version=r;if(i)v.params=i;if(k)v.salt=k;if(E)v.hash=E;return v}Sj.exports={serialize:d6,deserialize:An}});var bj=V((hn,ej)=>{var Jj=P("fs"),w=P("path"),oj=P("os"),Yj=typeof __webpack_require__==="function"?__non_webpack_require__:P,jn=process.config&&process.config.variables||{},nn=!!process.env.PREBUILDS_ONLY,Vj=process.versions.modules,gA=qn()?"electron":rn()?"node-webkit":"node",eA=process.env.npm_config_arch||oj.arch(),bA=process.env.npm_config_platform||oj.platform(),zj=process.env.LIBC||(En(bA)?"musl":"glibc"),lA=process.env.ARM_VERSION||(eA==="arm64"?"8":jn.arm_version)||"",Cj=(process.versions.uv||"").split(".")[0];ej.exports=u;function u(A){return Yj(u.resolve(A))}u.resolve=u.path=function(A){A=w.resolve(A||".");try{var j=Yj(w.join(A,"package.json")).name.toUpperCase().replace(/-/g,"_");if(process.env[j+"_PREBUILD"])A=process.env[j+"_PREBUILD"]}catch(v){}if(!nn){var n=Wj(w.join(A,"build/Release"),Xj);if(n)return n;var t=Wj(w.join(A,"build/Debug"),Xj);if(t)return t}var r=i(A);if(r)return r;var E=i(w.dirname(process.execPath));if(E)return E;var k=["platform="+bA,"arch="+eA,"runtime="+gA,"abi="+Vj,"uv="+Cj,lA?"armv="+lA:"","libc="+zj,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__==="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+k+`
    loaded from: `+A+`
`);function i(v){var c=sA(w.join(v,"prebuilds")).map(Qj),B=c.filter(Zj(bA,eA)).sort(hj)[0];if(!B)return;var L=w.join(v,"prebuilds",B.name),$=sA(L).map(Mj),D=$.filter(mj(gA,Vj)),f=D.sort(gj(gA))[0];if(f)return w.join(L,f.file)}};function sA(A){try{return Jj.readdirSync(A)}catch(j){return[]}}function Wj(A,j){var n=sA(A).filter(j);return n[0]&&w.join(A,n[0])}function Xj(A){return/\.node$/.test(A)}function Qj(A){var j=A.split("-");if(j.length!==2)return;var n=j[0],t=j[1].split("+");if(!n)return;if(!t.length)return;if(!t.every(Boolean))return;return{name:A,platform:n,architectures:t}}function Zj(A,j){return function(n){if(n==null)return!1;if(n.platform!==A)return!1;return n.architectures.includes(j)}}function hj(A,j){return A.architectures.length-j.architectures.length}function Mj(A){var j=A.split("."),n=j.pop(),t={file:A,specificity:0};if(n!=="node")return;for(var r=0;r<j.length;r++){var E=j[r];if(E==="node"||E==="electron"||E==="node-webkit")t.runtime=E;else if(E==="napi")t.napi=!0;else if(E.slice(0,3)==="abi")t.abi=E.slice(3);else if(E.slice(0,2)==="uv")t.uv=E.slice(2);else if(E.slice(0,4)==="armv")t.armv=E.slice(4);else if(E==="glibc"||E==="musl")t.libc=E;else continue;t.specificity++}return t}function mj(A,j){return function(n){if(n==null)return!1;if(n.runtime&&n.runtime!==A&&!tn(n))return!1;if(n.abi&&n.abi!==j&&!n.napi)return!1;if(n.uv&&n.uv!==Cj)return!1;if(n.armv&&n.armv!==lA)return!1;if(n.libc&&n.libc!==zj)return!1;return!0}}function tn(A){return A.runtime==="node"&&A.napi}function gj(A){return function(j,n){if(j.runtime!==n.runtime)return j.runtime===A?-1:1;else if(j.abi!==n.abi)return j.abi?-1:1;else if(j.specificity!==n.specificity)return j.specificity>n.specificity?-1:1;else return 0}}function rn(){return!!(process.versions&&process.versions.nw)}function qn(){if(process.versions&&process.versions.electron)return!0;if(process.env.ELECTRON_RUN_AS_NODE)return!0;return typeof window!=="undefined"&&window.process&&window.process.type==="renderer"}function En(A){return A==="linux"&&Jj.existsSync("/etc/alpine-release")}u.parseTags=Mj;u.matchTags=mj;u.compareTags=gj;u.parseTuple=Qj;u.matchTuple=Zj;u.compareTuples=hj});var lj=V((mn,pA)=>{var aA=typeof __webpack_require__==="function"?__non_webpack_require__:P;if(typeof aA.addon==="function")pA.exports=aA.addon.bind(aA);else pA.exports=bj()});var dj=V((Pn,z)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2",en=P("node:assert"),{randomBytes:kn,timingSafeEqual:fn}=P("node:crypto"),{promisify:vn}=P("node:util"),{deserialize:sj,serialize:_n}=Dj(),In=lj(),{hash:aj}=In(__dirname),cn=vn(kn);Pn.argon2d=0;Pn.argon2i=1;Pn.argon2id=2;var fA=Object.freeze({argon2d:0,argon2i:1,argon2id:2}),$n=Object.freeze({[fA.argon2d]:"argon2d",[fA.argon2i]:"argon2i",[fA.argon2id]:"argon2id"}),pj={hashLength:32,timeCost:3,memoryCost:65536,parallelism:4,type:2,version:19};async function Fn(A,j){let{raw:n,salt:t,...r}={...pj,...j};if(r.hashLength>4294967295)throw new RangeError("Hash length is too large");if(r.memoryCost>4294967295)throw new RangeError("Memory cost is too large");if(r.timeCost>4294967295)throw new RangeError("Time cost is too large");if(r.parallelism>16777215)throw new RangeError("Parallelism is too large");t=t??await cn(16);let{hashLength:E,secret:k=Buffer.alloc(0),type:i,version:v,memoryCost:c,timeCost:B,parallelism:L,associatedData:$=Buffer.alloc(0)}=r,D=await aj({password:Buffer.from(A),salt:t,secret:k,data:$,hashLength:E,m:c,t:B,p:L,version:v,type:i});if(n)return D;return _n({id:$n[i],version:v,params:{m:c,t:B,p:L,...$.byteLength>0?{data:$}:{}},salt:t,hash:D})}Pn.hash=Fn;function Bn(A,j={}){let{memoryCost:n,timeCost:t,parallelism:r,version:E}={...pj,...j},{version:k,params:{m:i,t:v,p:c}}=sj(A);return+k!==+E||+i!==+n||+v!==+t||+c!==+r}Pn.needsRehash=Bn;async function Ln(A,j,n={}){let{id:t,...r}=sj(A);if(!(t in fA))return!1;let{version:E=16,params:{m:k,t:i,p:v,data:c=""},salt:B,hash:L}=r,{secret:$=Buffer.alloc(0)}=n;return fn(await aj({password:Buffer.from(j),salt:B,secret:$,data:Buffer.from(c,"base64"),hashLength:L.byteLength,m:+k,t:+i,p:+v,version:+E,type:fA[t]}),L)}Pn.verify=Ln});class W extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class x extends W{}class PA extends W{}class g extends W{}class T extends W{}class UA extends W{}class R extends W{}class U{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new PA(`Version ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new PA(`Unknown version: ${A}`);return j}static get current(){return this.get(0)}}class WA{p;key;constructor(A){this.p=A}setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(12)),n=new Uint8Array(await this.p.subtle.encrypt({name:"AES-GCM",iv:j},this.key,A)),t=new Uint8Array(j.length+n.length);return t.set(j),t.set(n,j.length),t}async decryptChunk(A){let j=A.slice(0,12),n=A.slice(12),t=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);try{let r=await this.p.subtle.decrypt({name:"AES-GCM",iv:j},this.key,n);return new Uint8Array(r)}catch{throw new R("Decryption failed: wrong passphrase or corrupted ciphertext")}}}var xA=VA(xj(),1);async function A6(A,j,n,t){if(t==="node"){let r=await Promise.resolve().then(() => VA(dj(),1)),E=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),k=Buffer.from(j),i=await r.hash(E,{salt:k,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,hashLength:32,raw:!0,type:r.argon2id});return{hash:new Uint8Array(i)}}if(t==="browser"){if(!("loadArgon2WasmBinary"in globalThis))globalThis.loadArgon2WasmBinary=()=>{let r=new URL("argon2.wasm",import.meta.url).href;return fetch(r).then((E)=>{if(!E.ok)throw new Error("Failed to load argon2.wasm");return E.arrayBuffer()}).then((E)=>new Uint8Array(E))};return xA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:xA.ArgonType.Argon2id}).then((r)=>{if(!r||!r.hash)throw new Error("Failed to produce key derivation");return{hash:r.hash}}).catch((r)=>{let E=r instanceof Error?r.message:typeof r==="string"?r:"Unknown error";throw new T(`argon2-browser failure: ${E}`)})}throw new Error(`Unsupported environment: ${t}`)}class dA{presets;name="argon2id";constructor(A){this.presets=A}async derive(A,j,n,t){let{hash:r}=await A6(A,j,this.presets[n],t.isNode?"node":"browser");return t.subtle.importKey("raw",r,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var j6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},un={id:0,cipher:WA,kdf:new dA(j6),saltLengths:{low:12,high:16},difficulties:j6,defaultChunkSize:524288};U.register(un);var TA=1;function n6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!0}function iA(...A){let j=A.reduce((r,E)=>r+E.byteLength,0),n=new Uint8Array(j),t=0;for(let r of A)n.set(r,t),t+=r.byteLength;return n}function vA(...A){let j=iA(...A);if(n6())return Buffer.from(j).toString("base64");let n="";for(let t=0;t<j.length;t++)n+=String.fromCharCode(j[t]);return btoa(n)}function Aj(A){if(n6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let t=0;t<j.length;t++)n[t]=j.charCodeAt(t);return n}function NA(A,j,n,t){let r={low:0,middle:1,high:2}[j]??0,E=A<<5|(n==="high"?1:0)<<2|r;return iA(new Uint8Array([TA,E]),t)}function C(A){if(A[0]!==TA)throw new x("Invalid input format. The input is unknown.");try{let j=A[1],n=j>>5,t=j>>2&1?"high":"low",r=j&3,E=["low","middle","high"][r],k=U.get(n).saltLengths[t],i=A.slice(2,2+k);return{version:n,difficulty:E,saltStrength:t,salt:i,headerLen:2+k}}catch(j){throw new g(j instanceof Error?j.message:String(j))}}class _A{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(n.length-t>=this.chunkSize){let r=n.slice(t,t+this.chunkSize);t+=this.chunkSize;let E=await this.engine.encryptChunk(r),k=new Uint8Array(4);new DataView(k.buffer).setUint32(0,E.length,!1);let i=new Uint8Array(4+E.length);i.set(k),i.set(E,k.length),j.enqueue(i)}this.buffer=n.slice(t)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,j.length,!1);let t=new Uint8Array(4+j.length);t.set(n),t.set(j,4),A.enqueue(t),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class e{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await this.asUint8Array(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let t=0;while(!0){if(n.length-t<4)break;let r=new DataView(n.buffer,n.byteOffset+t,4).getUint32(0,!1);if(n.length-t-4<r)break;t+=4;let E=n.slice(t,t+r);t+=r;try{let k=await this.engine.decryptChunk(E);j.enqueue(k)}catch(k){throw k instanceof R?k:new R("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(t)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0)}async asUint8Array(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}}class b{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new _A(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(r,E){if(j===0){E.enqueue(r);return}if(r.byteLength<=j){j-=r.byteLength;return}E.enqueue(r.slice(j)),j=0}}),t=new e(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(t)}}async collect(A,j,n=null){let t=A.pipeThrough(j).getReader(),r=[];if(n?.length)r.push(n);while(!0){let{value:v,done:c}=await t.read();if(c)break;r.push(v)}let E=r.reduce((v,c)=>v+c.byteLength,0),k=new Uint8Array(E),i=0;for(let v of r)k.set(v,i),i+=v.byteLength;return k}}function t6(A=0,j=console.info){return{level:A,log(n,t){if(n<=A)j(`${n}| ${t}`)}}}var r6=new Map;class S{static getEngine(A,j){let n=r6.get(j);if(n)return n;let t=U.get(j),r=new t.cipher(A),E=t.kdf,k=t.defaultChunkSize;return n={desc:t,cipher:r,kdf:E,chunkSize:k,provider:A},r6.set(j,n),n}static async deriveKey(A,j,n,t){try{let r=await A.kdf.derive(j,n,t,A.provider);A.cipher.key=r}catch(r){let E=r instanceof Error?r.message:String(r);throw new T(E)}}}class Q{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=U.get(j.version??U.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=j.chunkSize??this.v.defaultChunkSize,this.stream=new b(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=t6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await Q.peekHeader(A),!0}catch{return!1}}static async headerDecode(A){let j=await Q.peekHeader(A),n=C(j);return{version:n.version,difficulty:n.difficulty,salt:vA(n.salt),saltLength:n.salt.byteLength}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setVersion(A){this.v=U.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new b(this.cipher,this.chunkSize)}getVersion(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){this.chunkSize=A,this.stream=new b(this.cipher,this.chunkSize)}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){try{this.log.log(1,"Start text encryption"),this.log.log(2,"Deriving key for text encryption");let n=this.genSalt();await this.deriveKey(j,n),this.log.log(3,`Salt generated: ${vA(n)}, KDF difficulty: ${this.difficulty}`),this.log.log(2,"Encrypting text data");let t=await this.cipher.encryptChunk(typeof A==="string"?new TextEncoder().encode(A):A);this.log.log(3,"Encoding header");let r=NA(this.v.id,this.difficulty,this.saltStrength,n);return this.log.log(3,"Encoding text"),vA(r,t)}catch(n){throw new UA(n instanceof Error?n.message:String(n))}}async decryptText(A,j){try{this.log.log(1,"Start text decryption");let n=Aj(A);this.log.log(3,"Start header decoding"),await Q.peekHeader(A);let t=C(n);this.log.log(3,"Trying to get engine");let r=S.getEngine(this.provider,t.version);this.log.log(2,"Deriving key via engine for text decryption"),this.log.log(3,`Salt use: ${vA(t.salt)}, KDF difficulty: ${t.difficulty}`),await S.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting text data");let E=await r.cipher.decryptChunk(n.slice(t.headerLen));return this.log.log(3,"Decoding text"),new TextDecoder().decode(E)}catch(n){if(n instanceof R||n instanceof x||n instanceof g||n instanceof T)throw n;throw new R("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){try{this.log.log(2,"Deriving key for file encryption");let n=this.genSalt();await this.deriveKey(j,n);let t=NA(this.v.id,this.difficulty,this.saltStrength,n),r=await this.stream.collect(A.stream(),new _A(this.cipher,this.chunkSize).toTransformStream(),t);return new Blob([r],{type:"application/octet-stream"})}catch(n){throw new UA(n instanceof Error?n.message:String(n))}}async decryptFile(A,j){try{let n=await Q.peekHeader(A),t=C(n),r=S.getEngine(this.provider,t.version);await S.deriveKey(r,j,t.salt,t.difficulty),this.log.log(2,"Decrypting file data");let k=await new b(r.cipher,r.chunkSize).collect(A.slice(t.headerLen).stream(),new e(r.cipher,r.chunkSize).toTransformStream());return new Blob([k],{type:"application/octet-stream"})}catch(n){if(n instanceof R)throw n;throw new R(n instanceof Error?n.message:String(n))}}async createEncryptionStream(A){this.log.log(2,"Deriving key for stream encryption");let j=this.genSalt();await this.deriveKey(A,j);let n=NA(this.v.id,this.difficulty,this.saltStrength,j),t=this.stream.encryptionStream();return{header:n,writable:t.writable,readable:t.readable}}async createDecryptionStream(A){let j=this,n=new Uint8Array(0),t=null;async function r(E,k){let i=E.getReader();while(!0){let{value:v,done:c}=await i.read();if(c)break;k.enqueue(v)}}return new TransformStream({async transform(E,k){if(!t){if(n=iA(n,E),n.length<2)return;let v=n.slice(0,30),{salt:c,difficulty:B}=C(v),L=n[1]>>5,$=n[1]>>2&1?"high":"low",f=2+U.get(L).saltLengths[$];if(n.length<f)return;let I=S.getEngine(j.provider,L);await S.deriveKey(I,A,c,B),t=new e(I.cipher,I.chunkSize).toTransformStream(),r(t.readable,k);let _=n.slice(f);if(_.length){let F=t.writable.getWriter();await F.write(_),F.releaseLock()}return}let i=t.writable.getWriter();await i.write(E),i.releaseLock()},async flush(){if(t){let E=t.writable.getWriter();await E.close(),E.releaseLock()}}})}async deriveKey(A,j,n=this.difficulty){let t=performance.now();try{let r=await this.kdf.derive(A,j,n,this.provider);this.cipher.key=r,this.log.log(3,`Key derivation completed in ${(performance.now()-t).toFixed(1)} ms`)}catch(r){throw new T(r instanceof Error?r.message:String(r))}}genSalt(){let A=this.v.saltLengths[this.saltStrength];return this.provider.getRandomValues(new Uint8Array(A))}static async peekHeader(A){if(typeof A==="string")A=Aj(A);if(A instanceof Uint8Array){if(A.length<2)throw new x("Input too short");let{headerLen:j}=C(A.length>=16?A:Uint8Array.from(A));if(A.length<j)throw new x("Incomplete header");return A.slice(0,j)}if(A instanceof Blob){let j=new Uint8Array(await A.slice(0,2).arrayBuffer());if(j[0]!==1)throw new x("Invalid input format. The input is unknown.");let n=j[1],t=n>>5,r=n>>2&1?"high":"low",E=U.get(t).saltLengths[r],k=new Uint8Array(await A.slice(0,2+E).arrayBuffer());return C(k),k}throw new g("Unsupported input type")}}import{webcrypto as wn,randomFillSync as Hn}from"node:crypto";var q6={subtle:wn.subtle,getRandomValues(A){return Hn(A),A},isNode:!0};function ot(A){return new Q(q6,A)}export{ot as createCryptit};

//# debugId=709CDB927FF3131364756E2164756E21
