var r6=Object.create;var{getPrototypeOf:C6,defineProperty:VA,getOwnPropertyNames:Hj,getOwnPropertyDescriptor:b6}=Object,Qj=Object.prototype.hasOwnProperty;var HA=(A,j,n)=>{n=A!=null?r6(C6(A)):{};let q=j||!A||!A.__esModule?VA(n,"default",{value:A,enumerable:!0}):n;for(let f of Hj(A))if(!Qj.call(q,f))VA(q,f,{get:()=>A[f],enumerable:!0});return q},Vj=new WeakMap,Zj=(A)=>{var j=Vj.get(A),n;if(j)return j;if(j=VA({},"__esModule",{value:!0}),A&&typeof A==="object"||typeof A==="function")Hj(A).map((q)=>!Qj.call(j,q)&&VA(j,q,{get:()=>A[q],enumerable:!(n=b6(A,q))||n.enumerable}));return Vj.set(A,j),j},qj=(A,j)=>()=>(j||A((j={exports:{}}).exports,j),j.exports);var l6=(A,j)=>{for(var n in j)VA(A,n,{get:j[n],enumerable:!0,configurable:!0,set:(q)=>j[n]=()=>q})};var u6=(A,j)=>()=>(A&&(j=A(A=0)),j);var QA=((A)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(A,{get:(j,n)=>(typeof require!=="undefined"?require:j)[n]}):A)(function(A){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+A+'" is not supported')});var Fj={};l6(Fj,{sep:()=>A6,resolve:()=>eA,relative:()=>ej,posix:()=>n6,parse:()=>aj,normalize:()=>ij,join:()=>sj,isAbsolute:()=>tj,format:()=>xj,extname:()=>pj,dirname:()=>hj,delimiter:()=>j6,default:()=>En,basename:()=>oj,_makeLong:()=>dj});function x(A){if(typeof A!=="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(A))}function cj(A,j){var n="",q=0,f=-1,v=0,E;for(var k=0;k<=A.length;++k){if(k<A.length)E=A.charCodeAt(k);else if(E===47)break;else E=47;if(E===47){if(f===k-1||v===1);else if(f!==k-1&&v===2){if(n.length<2||q!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var $=n.lastIndexOf("/");if($!==n.length-1){if($===-1)n="",q=0;else n=n.slice(0,$),q=n.length-1-n.lastIndexOf("/");f=k,v=0;continue}}else if(n.length===2||n.length===1){n="",q=0,f=k,v=0;continue}}if(j){if(n.length>0)n+="/..";else n="..";q=2}}else{if(n.length>0)n+="/"+A.slice(f+1,k);else n=A.slice(f+1,k);q=k-f-1}f=k,v=0}else if(E===46&&v!==-1)++v;else v=-1}return n}function vn(A,j){var n=j.dir||j.root,q=j.base||(j.name||"")+(j.ext||"");if(!n)return q;if(n===j.root)return n+q;return n+A+q}function eA(){var A="",j=!1,n;for(var q=arguments.length-1;q>=-1&&!j;q--){var f;if(q>=0)f=arguments[q];else{if(n===void 0)n=process.cwd();f=n}if(x(f),f.length===0)continue;A=f+"/"+A,j=f.charCodeAt(0)===47}if(A=cj(A,!j),j)if(A.length>0)return"/"+A;else return"/";else if(A.length>0)return A;else return"."}function ij(A){if(x(A),A.length===0)return".";var j=A.charCodeAt(0)===47,n=A.charCodeAt(A.length-1)===47;if(A=cj(A,!j),A.length===0&&!j)A=".";if(A.length>0&&n)A+="/";if(j)return"/"+A;return A}function tj(A){return x(A),A.length>0&&A.charCodeAt(0)===47}function sj(){if(arguments.length===0)return".";var A;for(var j=0;j<arguments.length;++j){var n=arguments[j];if(x(n),n.length>0)if(A===void 0)A=n;else A+="/"+n}if(A===void 0)return".";return ij(A)}function ej(A,j){if(x(A),x(j),A===j)return"";if(A=eA(A),j=eA(j),A===j)return"";var n=1;for(;n<A.length;++n)if(A.charCodeAt(n)!==47)break;var q=A.length,f=q-n,v=1;for(;v<j.length;++v)if(j.charCodeAt(v)!==47)break;var E=j.length,k=E-v,$=f<k?f:k,U=-1,F=0;for(;F<=$;++F){if(F===$){if(k>$){if(j.charCodeAt(v+F)===47)return j.slice(v+F+1);else if(F===0)return j.slice(v+F)}else if(f>$){if(A.charCodeAt(n+F)===47)U=F;else if(F===0)U=0}break}var P=A.charCodeAt(n+F),N=j.charCodeAt(v+F);if(P!==N)break;else if(P===47)U=F}var O="";for(F=n+U+1;F<=q;++F)if(F===q||A.charCodeAt(F)===47)if(O.length===0)O+="..";else O+="/..";if(O.length>0)return O+j.slice(v+U);else{if(v+=U,j.charCodeAt(v)===47)++v;return j.slice(v)}}function dj(A){return A}function hj(A){if(x(A),A.length===0)return".";var j=A.charCodeAt(0),n=j===47,q=-1,f=!0;for(var v=A.length-1;v>=1;--v)if(j=A.charCodeAt(v),j===47){if(!f){q=v;break}}else f=!1;if(q===-1)return n?"/":".";if(n&&q===1)return"//";return A.slice(0,q)}function oj(A,j){if(j!==void 0&&typeof j!=="string")throw new TypeError('"ext" argument must be a string');x(A);var n=0,q=-1,f=!0,v;if(j!==void 0&&j.length>0&&j.length<=A.length){if(j.length===A.length&&j===A)return"";var E=j.length-1,k=-1;for(v=A.length-1;v>=0;--v){var $=A.charCodeAt(v);if($===47){if(!f){n=v+1;break}}else{if(k===-1)f=!1,k=v+1;if(E>=0)if($===j.charCodeAt(E)){if(--E===-1)q=v}else E=-1,q=k}}if(n===q)q=k;else if(q===-1)q=A.length;return A.slice(n,q)}else{for(v=A.length-1;v>=0;--v)if(A.charCodeAt(v)===47){if(!f){n=v+1;break}}else if(q===-1)f=!1,q=v+1;if(q===-1)return"";return A.slice(n,q)}}function pj(A){x(A);var j=-1,n=0,q=-1,f=!0,v=0;for(var E=A.length-1;E>=0;--E){var k=A.charCodeAt(E);if(k===47){if(!f){n=E+1;break}continue}if(q===-1)f=!1,q=E+1;if(k===46){if(j===-1)j=E;else if(v!==1)v=1}else if(j!==-1)v=-1}if(j===-1||q===-1||v===0||v===1&&j===q-1&&j===n+1)return"";return A.slice(j,q)}function xj(A){if(A===null||typeof A!=="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof A);return vn("/",A)}function aj(A){x(A);var j={root:"",dir:"",base:"",ext:"",name:""};if(A.length===0)return j;var n=A.charCodeAt(0),q=n===47,f;if(q)j.root="/",f=1;else f=0;var v=-1,E=0,k=-1,$=!0,U=A.length-1,F=0;for(;U>=f;--U){if(n=A.charCodeAt(U),n===47){if(!$){E=U+1;break}continue}if(k===-1)$=!1,k=U+1;if(n===46){if(v===-1)v=U;else if(F!==1)F=1}else if(v!==-1)F=-1}if(v===-1||k===-1||F===0||F===1&&v===k-1&&v===E+1){if(k!==-1)if(E===0&&q)j.base=j.name=A.slice(1,k);else j.base=j.name=A.slice(E,k)}else{if(E===0&&q)j.name=A.slice(1,v),j.base=A.slice(1,k);else j.name=A.slice(E,v),j.base=A.slice(E,k);j.ext=A.slice(v,k)}if(E>0)j.dir=A.slice(0,E-1);else if(q)j.dir="/";return j}var A6="/",j6=":",n6,En;var Uj=u6(()=>{n6=((A)=>(A.posix=A,A))({resolve:eA,normalize:ij,isAbsolute:tj,join:sj,relative:ej,_makeLong:dj,dirname:hj,basename:oj,extname:pj,format:xj,parse:aj,sep:A6,delimiter:j6,win32:null,posix:null}),En=n6});var _j=qj((Bq,wA)=>{var __dirname="/Users/maxim/Projects/Private/Sites/cryptit/node_modules/argon2-browser/dist",I=typeof self!=="undefined"&&typeof self.Module!=="undefined"?self.Module:{},kn=I,YA={},UA;for(UA in I)if(I.hasOwnProperty(UA))YA[UA]=I[UA];var SA=[],E6="./this.program",Pj=function(A,j){throw j},pA=!1,GA=!1,Bj=!1,k6=!1;pA=typeof window==="object";GA=typeof importScripts==="function";Bj=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";k6=!pA&&!Bj&&!GA;var h="";function $n(A){if(I.locateFile)return I.locateFile(A,h);return h+A}var dA,wj,gA,In,Kj,Gj;if(Bj){if(GA)h=(Uj(),Zj(Fj)).dirname(h)+"/";else h=__dirname+"/";if(dA=function A(j,n){if(!Kj)Kj=(()=>({}));if(!Gj)Gj=(Uj(),Zj(Fj));return j=Gj.normalize(j),Kj.readFileSync(j,n?null:"utf8")},gA=function A(j){var n=dA(j,!0);if(!n.buffer)n=new Uint8Array(n);return q6(n.buffer),n},process.argv.length>1)E6=process.argv[1].replace(/\\/g,"/");if(SA=process.argv.slice(2),typeof wA!=="undefined")wA.exports=I;process.on("uncaughtException",function(A){if(!(A instanceof yn))throw A}),process.on("unhandledRejection",DA),Pj=function(A){process.exit(A)},I.inspect=function(){return"[Emscripten Module object]"}}else if(k6){if(typeof read!="undefined")dA=function A(j){return read(j)};if(gA=function A(j){var n;if(typeof readbuffer==="function")return new Uint8Array(readbuffer(j));return n=read(j,"binary"),q6(typeof n==="object"),n},typeof scriptArgs!="undefined")SA=scriptArgs;else if(typeof arguments!="undefined")SA=arguments;if(typeof quit==="function")Pj=function(A){quit(A)};if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print,console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(pA||GA){if(GA)h=self.location.href;else if(typeof document!=="undefined"&&document.currentScript)h=document.currentScript.src;if(h.indexOf("blob:")!==0)h=h.substr(0,h.lastIndexOf("/")+1);else h="";{if(dA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.send(null),j.responseText},GA)gA=function(A){var j=new XMLHttpRequest;return j.open("GET",A,!1),j.responseType="arraybuffer",j.send(null),new Uint8Array(j.response)};wj=function(A,j,n){var q=new XMLHttpRequest;q.open("GET",A,!0),q.responseType="arraybuffer",q.onload=function(){if(q.status==200||q.status==0&&q.response){j(q.response);return}n()},q.onerror=n,q.send(null)}}In=function(A){document.title=A}}var Rq=I.print||console.log.bind(console),mA=I.printErr||console.warn.bind(console);for(UA in YA)if(YA.hasOwnProperty(UA))I[UA]=YA[UA];YA=null;if(I.arguments)SA=I.arguments;if(I.thisProgram)E6=I.thisProgram;if(I.quit)Pj=I.quit;var zA;if(I.wasmBinary)zA=I.wasmBinary;var Pq=I.noExitRuntime||!0;if(typeof WebAssembly!=="object")DA("no native wasm support detected");var LA,$6=!1,Fn;function q6(A,j){if(!A)DA("Assertion failed: "+j)}var Un=0,Kn=1;function Gn(A,j){var n;if(j==Kn)n=W6(A.length);else n=_6(A.length);if(A.subarray||A.slice)PA.set(A,n);else PA.set(new Uint8Array(A),n);return n}var f6=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function Rn(A,j,n){var q=j+n,f=j;while(A[f]&&!(f>=q))++f;if(f-j>16&&A.subarray&&f6)return f6.decode(A.subarray(j,f));else{var v="";while(j<f){var E=A[j++];if(!(E&128)){v+=String.fromCharCode(E);continue}var k=A[j++]&63;if((E&224)==192){v+=String.fromCharCode((E&31)<<6|k);continue}var $=A[j++]&63;if((E&240)==224)E=(E&15)<<12|k<<6|$;else E=(E&7)<<18|k<<12|$<<6|A[j++]&63;if(E<65536)v+=String.fromCharCode(E);else{var U=E-65536;v+=String.fromCharCode(55296|U>>10,56320|U&1023)}}}return v}function Pn(A,j){return A?Rn(PA,A,j):""}function wn(A,j){if(A%j>0)A+=j-A%j;return A}var Oj,I6,PA,i6,F6,U6,K6,G6,R6;function P6(A){Oj=A,I.HEAP8=I6=new Int8Array(A),I.HEAP16=i6=new Int16Array(A),I.HEAP32=U6=new Int32Array(A),I.HEAPU8=PA=new Uint8Array(A),I.HEAPU16=F6=new Uint16Array(A),I.HEAPU32=K6=new Uint32Array(A),I.HEAPF32=G6=new Float32Array(A),I.HEAPF64=R6=new Float64Array(A)}var wq=I.INITIAL_MEMORY||16777216,hA,w6=[],B6=[],O6=[],Bn=!1;function On(){if(I.preRun){if(typeof I.preRun=="function")I.preRun=[I.preRun];while(I.preRun.length)_n(I.preRun.shift())}Nj(w6)}function Nn(){Bn=!0,Nj(B6)}function Tn(){if(I.postRun){if(typeof I.postRun=="function")I.postRun=[I.postRun];while(I.postRun.length)Jn(I.postRun.shift())}Nj(O6)}function _n(A){w6.unshift(A)}function Wn(A){B6.unshift(A)}function Jn(A){O6.unshift(A)}var RA=0,Rj=null,XA=null;function Vn(A){if(RA++,I.monitorRunDependencies)I.monitorRunDependencies(RA)}function Hn(A){if(RA--,I.monitorRunDependencies)I.monitorRunDependencies(RA);if(RA==0){if(Rj!==null)clearInterval(Rj),Rj=null;if(XA){var j=XA;XA=null,j()}}}I.preloadedImages={};I.preloadedAudios={};function DA(A){if(I.onAbort)I.onAbort(A);A+="",mA(A),$6=!0,Fn=1,A="abort("+A+"). Build with -s ASSERTIONS=1 for more info.";var j=new WebAssembly.RuntimeError(A);throw j}var Qn="data:application/octet-stream;base64,";function N6(A){return A.startsWith(Qn)}function T6(A){return A.startsWith("file://")}var s="argon2.wasm";if(!N6(s))s=$n(s);function v6(A){try{if(A==s&&zA)return new Uint8Array(zA);if(gA)return gA(A);else throw"both async and sync fetching of the wasm failed"}catch(j){DA(j)}}function Zn(){if(!zA&&(pA||GA)){if(typeof fetch==="function"&&!T6(s))return fetch(s,{credentials:"same-origin"}).then(function(A){if(!A.ok)throw"failed to load wasm binary file at '"+s+"'";return A.arrayBuffer()}).catch(function(){return v6(s)});else if(wj)return new Promise(function(A,j){wj(s,function(n){A(new Uint8Array(n))},j)})}return Promise.resolve().then(function(){return v6(s)})}function mn(){var A={a:Xn};function j(E,k){var $=E.exports;I.asm=$,LA=I.asm.c,P6(LA.buffer),hA=I.asm.k,Wn(I.asm.d),Hn("wasm-instantiate")}Vn("wasm-instantiate");function n(E){j(E.instance)}function q(E){return Zn().then(function(k){var $=WebAssembly.instantiate(k,A);return $}).then(E,function(k){mA("failed to asynchronously prepare wasm: "+k),DA(k)})}function f(){if(!zA&&typeof WebAssembly.instantiateStreaming==="function"&&!N6(s)&&!T6(s)&&typeof fetch==="function")return fetch(s,{credentials:"same-origin"}).then(function(E){var k=WebAssembly.instantiateStreaming(E,A);return k.then(n,function($){return mA("wasm streaming compile failed: "+$),mA("falling back to ArrayBuffer instantiation"),q(n)})});else return q(n)}if(I.instantiateWasm)try{var v=I.instantiateWasm(A,j);return v}catch(E){return mA("Module.instantiateWasm callback failed with error: "+E),!1}return f(),{}}function Nj(A){while(A.length>0){var j=A.shift();if(typeof j=="function"){j(I);continue}var n=j.func;if(typeof n==="number")if(j.arg===void 0)hA.get(n)();else hA.get(n)(j.arg);else n(j.arg===void 0?null:j.arg)}}function Yn(A,j,n){PA.copyWithin(A,j,j+n)}function Sn(A){try{return LA.grow(A-Oj.byteLength+65535>>>16),P6(LA.buffer),1}catch(j){}}function gn(A){var j=PA.length;A=A>>>0;var n=2147418112;if(A>n)return!1;for(var q=1;q<=4;q*=2){var f=j*(1+0.2/q);f=Math.min(f,A+100663296);var v=Math.min(n,wn(Math.max(A,f),65536)),E=Sn(v);if(E)return!0}return!1}var Xn={a:Yn,b:gn},zn=mn(),Ln=I.___wasm_call_ctors=function(){return(Ln=I.___wasm_call_ctors=I.asm.d).apply(null,arguments)},Dn=I._argon2_hash=function(){return(Dn=I._argon2_hash=I.asm.e).apply(null,arguments)},_6=I._malloc=function(){return(_6=I._malloc=I.asm.f).apply(null,arguments)},Mn=I._free=function(){return(Mn=I._free=I.asm.g).apply(null,arguments)},rn=I._argon2_verify=function(){return(rn=I._argon2_verify=I.asm.h).apply(null,arguments)},Cn=I._argon2_error_message=function(){return(Cn=I._argon2_error_message=I.asm.i).apply(null,arguments)},bn=I._argon2_encodedlen=function(){return(bn=I._argon2_encodedlen=I.asm.j).apply(null,arguments)},ln=I._argon2_hash_ext=function(){return(ln=I._argon2_hash_ext=I.asm.l).apply(null,arguments)},un=I._argon2_verify_ext=function(){return(un=I._argon2_verify_ext=I.asm.m).apply(null,arguments)},W6=I.stackAlloc=function(){return(W6=I.stackAlloc=I.asm.n).apply(null,arguments)};I.allocate=Gn;I.UTF8ToString=Pn;I.ALLOC_NORMAL=Un;var oA;function yn(A){this.name="ExitStatus",this.message="Program terminated with exit("+A+")",this.status=A}XA=function A(){if(!oA)Tj();if(!oA)XA=A};function Tj(A){if(A=A||SA,RA>0)return;if(On(),RA>0)return;function j(){if(oA)return;if(oA=!0,I.calledRun=!0,$6)return;if(Nn(),I.onRuntimeInitialized)I.onRuntimeInitialized();Tn()}if(I.setStatus)I.setStatus("Running..."),setTimeout(function(){setTimeout(function(){I.setStatus("")},1),j()},1);else j()}I.run=Tj;if(I.preInit){if(typeof I.preInit=="function")I.preInit=[I.preInit];while(I.preInit.length>0)I.preInit.pop()()}Tj();if(typeof wA!=="undefined")wA.exports=I;I.unloadRuntime=function(){if(typeof self!=="undefined")delete self.Module;if(I=kn=LA=hA=zn=Oj=I6=PA=i6=F6=U6=K6=G6=R6=void 0,typeof wA!=="undefined")delete wA.exports}});var J6=qj((Oq,cn)=>{cn.exports="./argon2.wasm"});var H6=qj((V6,xA)=>{(function(A,j){if(typeof define==="function"&&define.amd)define([],j);else if(typeof xA==="object"&&xA.exports)xA.exports=j();else A.argon2=j()})(typeof self!=="undefined"?self:V6,function(){let A=typeof self!=="undefined"?self:this,j={Argon2d:0,Argon2i:1,Argon2id:2};function n(i){if(n._promise)return n._promise;if(n._module)return Promise.resolve(n._module);let K;if(A.process&&A.process.versions&&A.process.versions.node)K=f().then((G)=>new Promise((w)=>{G.postRun=()=>w(G)}));else K=v().then((G)=>{let w=i?k(i):void 0;return q(G,w)});return n._promise=K,K.then((G)=>{return n._module=G,delete n._promise,G})}function q(i,K){return new Promise((G)=>{return A.Module={wasmBinary:i,wasmMemory:K,postRun(){G(Module)}},f()})}function f(){if(A.loadArgon2WasmModule)return A.loadArgon2WasmModule();return Promise.resolve(_j())}function v(){if(A.loadArgon2WasmBinary)return A.loadArgon2WasmBinary();return Promise.resolve(J6()).then((K)=>{return E(K)})}function E(i){let K=atob(i),G=new Uint8Array(new ArrayBuffer(K.length));for(let w=0;w<K.length;w++)G[w]=K.charCodeAt(w);return G}function k(i){let z=Math.min(Math.max(Math.ceil(i*1024/65536),256)+256,32767);return new WebAssembly.Memory({initial:z,maximum:32767})}function $(i,K){return i.allocate(K,"i8",i.ALLOC_NORMAL)}function U(i,K){let G=new Uint8Array([...K,0]);return $(i,G)}function F(i){if(typeof i!=="string")return i;if(typeof TextEncoder==="function")return new TextEncoder().encode(i);else if(typeof Buffer==="function")return Buffer.from(i);else throw new Error("Don't know how to encode UTF8")}function P(i){let K=i.mem||1024;return n(K).then((G)=>{let w=i.time||1,_=i.parallelism||1,T=F(i.pass),z=U(G,T),e=T.length,r=F(i.salt),C=U(G,r),Q=r.length,H=i.type||j.Argon2d,J=G.allocate(new Array(i.hashLen||24),"i8",G.ALLOC_NORMAL),V=i.secret?$(G,i.secret):0,Z=i.secret?i.secret.byteLength:0,W=i.ad?$(G,i.ad):0,L=i.ad?i.ad.byteLength:0,Y=i.hashLen||24,X=G._argon2_encodedlen(w,K,_,Q,Y,H),g=G.allocate(new Array(X+1),"i8",G.ALLOC_NORMAL),B=19,S,D;try{D=G._argon2_hash_ext(w,K,_,z,e,C,Q,J,Y,g,X,H,V,Z,W,L,19)}catch(m){S=m}let M;if(D===0&&!S){let m="",d=new Uint8Array(Y);for(let o=0;o<Y;o++){let AA=G.HEAP8[J+o];d[o]=AA,m+=("0"+(255&AA).toString(16)).slice(-2)}let IA=G.UTF8ToString(g);M={hash:d,hashHex:m,encoded:IA}}else{try{if(!S)S=G.UTF8ToString(G._argon2_error_message(D))}catch(m){}M={message:S,code:D}}try{if(G._free(z),G._free(C),G._free(J),G._free(g),W)G._free(W);if(V)G._free(V)}catch(m){}if(S)throw M;else return M})}function N(i){return n().then((K)=>{let G=F(i.pass),w=U(K,G),_=G.length,T=i.secret?$(K,i.secret):0,z=i.secret?i.secret.byteLength:0,e=i.ad?$(K,i.ad):0,r=i.ad?i.ad.byteLength:0,C=F(i.encoded),Q=U(K,C),H=i.type;if(H===void 0){let W=i.encoded.split("$")[1];if(W)W=W.replace("a","A"),H=j[W]||j.Argon2d}let J,V;try{V=K._argon2_verify_ext(Q,w,_,T,z,e,r,H)}catch(W){J=W}let Z;if(V||J){try{if(!J)J=K.UTF8ToString(K._argon2_error_message(V))}catch(W){}Z={message:J,code:V}}try{K._free(w),K._free(Q)}catch(W){}if(J)throw Z;else return Z})}function O(){if(n._module)n._module.unloadRuntime(),delete n._promise,delete n._module}return{ArgonType:j,hash:P,verify:N,unloadRuntime:O}})});class jA extends Error{constructor(A){super(A);Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name,this.stack=void 0}}class t extends jA{}class NA extends jA{}class fj extends jA{}class lA extends jA{}class iA extends jA{}class nA extends jA{}class p extends jA{}class y extends jA{}class l{static byId=new Map;static register(A){if(this.byId.has(A.id))throw new lA(`Scheme ${A.id} already registered`);this.byId.set(A.id,A)}static get(A){let j=this.byId.get(A);if(!j)throw new lA(`Unknown scheme: ${A}`);return j}static get current(){return this.get(0)}}class FA{p;static IV_LENGTH=12;static TAG_LENGTH=16;IV_LENGTH=FA.IV_LENGTH;TAG_LENGTH=FA.TAG_LENGTH;key;aad=new Uint8Array(0);constructor(A){this.p=A}async setKey(A){this.key=A}async encryptChunk(A){let j=this.p.getRandomValues(new Uint8Array(FA.IV_LENGTH)),n=this.aad.length?{name:"AES-GCM",iv:j,additionalData:this.aad}:{name:"AES-GCM",iv:j},q=await this.p.subtle.encrypt(n,this.requireKey(),A),f=new Uint8Array(q);A.fill(0);let v=new Uint8Array(j.length+f.length);return v.set(j,0),v.set(f,j.length),v}async decryptChunk(A){let j=A.slice(0,FA.IV_LENGTH),n=A.slice(FA.IV_LENGTH),q=this.aad.length?{name:"AES-GCM",iv:j,additionalData:this.aad}:{name:"AES-GCM",iv:j};try{let f=await this.p.subtle.decrypt(q,this.requireKey(),n);return new Uint8Array(f)}catch{throw new y("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){this.key=null}setAAD(A){this.aad=A&&A.byteLength?new Uint8Array(A):new Uint8Array(0)}requireKey(){if(!this.key)throw new Error("Encryption key not set");return this.key}}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Yj(A){return A instanceof Uint8Array||ArrayBuffer.isView(A)&&A.constructor.name==="Uint8Array"}function uA(A){if(typeof A!=="boolean")throw new Error(`boolean expected, not ${A}`)}function yA(A){if(!Number.isSafeInteger(A)||A<0)throw new Error("positive integer expected, got "+A)}function u(A,...j){if(!Yj(A))throw new Error("Uint8Array expected");if(j.length>0&&!j.includes(A.length))throw new Error("Uint8Array expected of length "+j+", got length="+A.length)}function vj(A,j=!0){if(A.destroyed)throw new Error("Hash instance has been destroyed");if(j&&A.finished)throw new Error("Hash#digest() has already been called")}function Sj(A,j){u(A);let n=j.outputLen;if(A.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function qA(A){return new Uint32Array(A.buffer,A.byteOffset,Math.floor(A.byteLength/4))}function fA(...A){for(let j=0;j<A.length;j++)A[j].fill(0)}function y6(A){return new DataView(A.buffer,A.byteOffset,A.byteLength)}var c6=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function t6(A){if(typeof A!=="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(A))}function cA(A){if(typeof A==="string")A=t6(A);else if(Yj(A))A=tA(A);else throw new Error("Uint8Array expected, got "+typeof A);return A}function gj(A,j){if(j==null||typeof j!=="object")throw new Error("options must be defined");return Object.assign(A,j)}function Xj(A,j){if(A.length!==j.length)return!1;let n=0;for(let q=0;q<A.length;q++)n|=A[q]^j[q];return n===0}var Ej=(A,j)=>{function n(q,...f){if(u(q),!c6)throw new Error("Non little-endian hardware is not yet supported");if(A.nonceLength!==void 0){let F=f[0];if(!F)throw new Error("nonce / iv required");if(A.varSizeNonce)u(F);else u(F,A.nonceLength)}let v=A.tagLength;if(v&&f[1]!==void 0)u(f[1]);let E=j(q,...f),k=(F,P)=>{if(P!==void 0){if(F!==2)throw new Error("cipher output not supported");u(P)}},$=!1;return{encrypt(F,P){if($)throw new Error("cannot encrypt() twice with same key + nonce");return $=!0,u(F),k(E.encrypt.length,P),E.encrypt(F,P)},decrypt(F,P){if(u(F),v&&F.length<v)throw new Error("invalid ciphertext length: smaller than tagLength="+v);return k(E.decrypt.length,P),E.decrypt(F,P)}}}return Object.assign(n,A),n};function kj(A,j,n=!0){if(j===void 0)return new Uint8Array(A);if(j.length!==A)throw new Error("invalid output length, expected "+A+", got: "+j.length);if(n&&!s6(j))throw new Error("invalid output, must be aligned");return j}function mj(A,j,n,q){if(typeof A.setBigUint64==="function")return A.setBigUint64(j,n,q);let f=BigInt(32),v=BigInt(4294967295),E=Number(n>>f&v),k=Number(n&v),$=q?4:0,U=q?0:4;A.setUint32(j+$,E,q),A.setUint32(j+U,k,q)}function zj(A,j,n){uA(n);let q=new Uint8Array(16),f=y6(q);return mj(f,0,BigInt(j),n),mj(f,8,BigInt(A),n),q}function s6(A){return A.byteOffset%4===0}function tA(A){return Uint8Array.from(A)}var Dj=(A)=>Uint8Array.from(A.split("").map((j)=>j.charCodeAt(0))),e6=Dj("expand 16-byte k"),d6=Dj("expand 32-byte k"),h6=qA(e6),o6=qA(d6);function R(A,j){return A<<j|A>>>32-j}function $j(A){return A.byteOffset%4===0}var sA=64,p6=16,Mj=4294967295,Lj=new Uint32Array;function x6(A,j,n,q,f,v,E,k){let $=f.length,U=new Uint8Array(sA),F=qA(U),P=$j(f)&&$j(v),N=P?qA(f):Lj,O=P?qA(v):Lj;for(let i=0;i<$;E++){if(A(j,n,q,F,E,k),E>=Mj)throw new Error("arx: counter overflow");let K=Math.min(sA,$-i);if(P&&K===sA){let G=i/4;if(i%4!==0)throw new Error("arx: invalid block position");for(let w=0,_;w<p6;w++)_=G+w,O[_]=N[_]^F[w];i+=sA;continue}for(let G=0,w;G<K;G++)w=i+G,v[w]=f[w]^U[G];i+=K}}function Ij(A,j){let{allowShortKeys:n,extendNonceFn:q,counterLength:f,counterRight:v,rounds:E}=gj({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},j);if(typeof A!=="function")throw new Error("core must be a function");return yA(f),yA(E),uA(v),uA(n),(k,$,U,F,P=0)=>{u(k),u($),u(U);let N=U.length;if(F===void 0)F=new Uint8Array(N);if(u(F),yA(P),P<0||P>=Mj)throw new Error("arx: counter overflow");if(F.length<N)throw new Error(`arx: output (${F.length}) is shorter than data (${N})`);let O=[],i=k.length,K,G;if(i===32)O.push(K=tA(k)),G=o6;else if(i===16&&n)K=new Uint8Array(32),K.set(k),K.set(k,16),G=h6,O.push(K);else throw new Error(`arx: invalid 32-byte key, got length=${i}`);if(!$j($))O.push($=tA($));let w=qA(K);if(q){if($.length!==24)throw new Error("arx: extended nonce must be 24 bytes");q(G,w,qA($.subarray(0,16)),w),$=$.subarray(16)}let _=16-f;if(_!==$.length)throw new Error(`arx: nonce must be ${_} or 16 bytes`);if(_!==12){let z=new Uint8Array(12);z.set($,v?0:12-$.length),$=z,O.push($)}let T=qA($);return x6(A,G,w,T,U,F,P,E),fA(...O),F}}var b=(A,j)=>A[j++]&255|(A[j++]&255)<<8;class rj{constructor(A){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,A=cA(A),u(A,32);let j=b(A,0),n=b(A,2),q=b(A,4),f=b(A,6),v=b(A,8),E=b(A,10),k=b(A,12),$=b(A,14);this.r[0]=j&8191,this.r[1]=(j>>>13|n<<3)&8191,this.r[2]=(n>>>10|q<<6)&7939,this.r[3]=(q>>>7|f<<9)&8191,this.r[4]=(f>>>4|v<<12)&255,this.r[5]=v>>>1&8190,this.r[6]=(v>>>14|E<<2)&8191,this.r[7]=(E>>>11|k<<5)&8065,this.r[8]=(k>>>8|$<<8)&8191,this.r[9]=$>>>5&127;for(let U=0;U<8;U++)this.pad[U]=b(A,16+2*U)}process(A,j,n=!1){let q=n?0:2048,{h:f,r:v}=this,E=v[0],k=v[1],$=v[2],U=v[3],F=v[4],P=v[5],N=v[6],O=v[7],i=v[8],K=v[9],G=b(A,j+0),w=b(A,j+2),_=b(A,j+4),T=b(A,j+6),z=b(A,j+8),e=b(A,j+10),r=b(A,j+12),C=b(A,j+14),Q=f[0]+(G&8191),H=f[1]+((G>>>13|w<<3)&8191),J=f[2]+((w>>>10|_<<6)&8191),V=f[3]+((_>>>7|T<<9)&8191),Z=f[4]+((T>>>4|z<<12)&8191),W=f[5]+(z>>>1&8191),L=f[6]+((z>>>14|e<<2)&8191),Y=f[7]+((e>>>11|r<<5)&8191),X=f[8]+((r>>>8|C<<8)&8191),g=f[9]+(C>>>5|q),B=0,S=B+Q*E+H*(5*K)+J*(5*i)+V*(5*O)+Z*(5*N);B=S>>>13,S&=8191,S+=W*(5*P)+L*(5*F)+Y*(5*U)+X*(5*$)+g*(5*k),B+=S>>>13,S&=8191;let D=B+Q*k+H*E+J*(5*K)+V*(5*i)+Z*(5*O);B=D>>>13,D&=8191,D+=W*(5*N)+L*(5*P)+Y*(5*F)+X*(5*U)+g*(5*$),B+=D>>>13,D&=8191;let M=B+Q*$+H*k+J*E+V*(5*K)+Z*(5*i);B=M>>>13,M&=8191,M+=W*(5*O)+L*(5*N)+Y*(5*P)+X*(5*F)+g*(5*U),B+=M>>>13,M&=8191;let m=B+Q*U+H*$+J*k+V*E+Z*(5*K);B=m>>>13,m&=8191,m+=W*(5*i)+L*(5*O)+Y*(5*N)+X*(5*P)+g*(5*F),B+=m>>>13,m&=8191;let d=B+Q*F+H*U+J*$+V*k+Z*E;B=d>>>13,d&=8191,d+=W*(5*K)+L*(5*i)+Y*(5*O)+X*(5*N)+g*(5*P),B+=d>>>13,d&=8191;let IA=B+Q*P+H*F+J*U+V*$+Z*k;B=IA>>>13,IA&=8191,IA+=W*E+L*(5*K)+Y*(5*i)+X*(5*O)+g*(5*N),B+=IA>>>13,IA&=8191;let o=B+Q*N+H*P+J*F+V*U+Z*$;B=o>>>13,o&=8191,o+=W*k+L*E+Y*(5*K)+X*(5*i)+g*(5*O),B+=o>>>13,o&=8191;let AA=B+Q*O+H*N+J*P+V*F+Z*U;B=AA>>>13,AA&=8191,AA+=W*$+L*k+Y*E+X*(5*K)+g*(5*i),B+=AA>>>13,AA&=8191;let BA=B+Q*i+H*O+J*N+V*P+Z*F;B=BA>>>13,BA&=8191,BA+=W*U+L*$+Y*k+X*E+g*(5*K),B+=BA>>>13,BA&=8191;let OA=B+Q*K+H*i+J*O+V*N+Z*P;B=OA>>>13,OA&=8191,OA+=W*F+L*U+Y*$+X*k+g*E,B+=OA>>>13,OA&=8191,B=(B<<2)+B|0,B=B+S|0,S=B&8191,B=B>>>13,D+=B,f[0]=S,f[1]=D,f[2]=M,f[3]=m,f[4]=d,f[5]=IA,f[6]=o,f[7]=AA,f[8]=BA,f[9]=OA}finalize(){let{h:A,pad:j}=this,n=new Uint16Array(10),q=A[1]>>>13;A[1]&=8191;for(let E=2;E<10;E++)A[E]+=q,q=A[E]>>>13,A[E]&=8191;A[0]+=q*5,q=A[0]>>>13,A[0]&=8191,A[1]+=q,q=A[1]>>>13,A[1]&=8191,A[2]+=q,n[0]=A[0]+5,q=n[0]>>>13,n[0]&=8191;for(let E=1;E<10;E++)n[E]=A[E]+q,q=n[E]>>>13,n[E]&=8191;n[9]-=8192;let f=(q^1)-1;for(let E=0;E<10;E++)n[E]&=f;f=~f;for(let E=0;E<10;E++)A[E]=A[E]&f|n[E];A[0]=(A[0]|A[1]<<13)&65535,A[1]=(A[1]>>>3|A[2]<<10)&65535,A[2]=(A[2]>>>6|A[3]<<7)&65535,A[3]=(A[3]>>>9|A[4]<<4)&65535,A[4]=(A[4]>>>12|A[5]<<1|A[6]<<14)&65535,A[5]=(A[6]>>>2|A[7]<<11)&65535,A[6]=(A[7]>>>5|A[8]<<8)&65535,A[7]=(A[8]>>>8|A[9]<<5)&65535;let v=A[0]+j[0];A[0]=v&65535;for(let E=1;E<8;E++)v=(A[E]+j[E]|0)+(v>>>16)|0,A[E]=v&65535;fA(n)}update(A){vj(this),A=cA(A),u(A);let{buffer:j,blockLen:n}=this,q=A.length;for(let f=0;f<q;){let v=Math.min(n-this.pos,q-f);if(v===n){for(;n<=q-f;f+=n)this.process(A,f);continue}if(j.set(A.subarray(f,f+v),this.pos),this.pos+=v,f+=v,this.pos===n)this.process(j,0,!1),this.pos=0}return this}destroy(){fA(this.h,this.r,this.buffer,this.pad)}digestInto(A){vj(this),Sj(A,this),this.finished=!0;let{buffer:j,h:n}=this,{pos:q}=this;if(q){j[q++]=1;for(;q<16;q++)j[q]=0;this.process(j,0,!0)}this.finalize();let f=0;for(let v=0;v<8;v++)A[f++]=n[v]>>>0,A[f++]=n[v]>>>8;return A}digest(){let{buffer:A,outputLen:j}=this;this.digestInto(A);let n=A.slice(0,j);return this.destroy(),n}}function a6(A){let j=(q,f)=>A(f).update(cA(q)).digest(),n=A(new Uint8Array(32));return j.outputLen=n.outputLen,j.blockLen=n.blockLen,j.create=(q)=>A(q),j}var Cj=a6((A)=>new rj(A));function uj(A,j,n,q,f,v=20){let E=A[0],k=A[1],$=A[2],U=A[3],F=j[0],P=j[1],N=j[2],O=j[3],i=j[4],K=j[5],G=j[6],w=j[7],_=f,T=n[0],z=n[1],e=n[2],r=E,C=k,Q=$,H=U,J=F,V=P,Z=N,W=O,L=i,Y=K,X=G,g=w,B=_,S=T,D=z,M=e;for(let d=0;d<v;d+=2)r=r+J|0,B=R(B^r,16),L=L+B|0,J=R(J^L,12),r=r+J|0,B=R(B^r,8),L=L+B|0,J=R(J^L,7),C=C+V|0,S=R(S^C,16),Y=Y+S|0,V=R(V^Y,12),C=C+V|0,S=R(S^C,8),Y=Y+S|0,V=R(V^Y,7),Q=Q+Z|0,D=R(D^Q,16),X=X+D|0,Z=R(Z^X,12),Q=Q+Z|0,D=R(D^Q,8),X=X+D|0,Z=R(Z^X,7),H=H+W|0,M=R(M^H,16),g=g+M|0,W=R(W^g,12),H=H+W|0,M=R(M^H,8),g=g+M|0,W=R(W^g,7),r=r+V|0,M=R(M^r,16),X=X+M|0,V=R(V^X,12),r=r+V|0,M=R(M^r,8),X=X+M|0,V=R(V^X,7),C=C+Z|0,B=R(B^C,16),g=g+B|0,Z=R(Z^g,12),C=C+Z|0,B=R(B^C,8),g=g+B|0,Z=R(Z^g,7),Q=Q+W|0,S=R(S^Q,16),L=L+S|0,W=R(W^L,12),Q=Q+W|0,S=R(S^Q,8),L=L+S|0,W=R(W^L,7),H=H+J|0,D=R(D^H,16),Y=Y+D|0,J=R(J^Y,12),H=H+J|0,D=R(D^H,8),Y=Y+D|0,J=R(J^Y,7);let m=0;q[m++]=E+r|0,q[m++]=k+C|0,q[m++]=$+Q|0,q[m++]=U+H|0,q[m++]=F+J|0,q[m++]=P+V|0,q[m++]=N+Z|0,q[m++]=O+W|0,q[m++]=i+L|0,q[m++]=K+Y|0,q[m++]=G+X|0,q[m++]=w+g|0,q[m++]=_+B|0,q[m++]=T+S|0,q[m++]=z+D|0,q[m++]=e+M|0}function An(A,j,n,q){let f=A[0],v=A[1],E=A[2],k=A[3],$=j[0],U=j[1],F=j[2],P=j[3],N=j[4],O=j[5],i=j[6],K=j[7],G=n[0],w=n[1],_=n[2],T=n[3];for(let e=0;e<20;e+=2)f=f+$|0,G=R(G^f,16),N=N+G|0,$=R($^N,12),f=f+$|0,G=R(G^f,8),N=N+G|0,$=R($^N,7),v=v+U|0,w=R(w^v,16),O=O+w|0,U=R(U^O,12),v=v+U|0,w=R(w^v,8),O=O+w|0,U=R(U^O,7),E=E+F|0,_=R(_^E,16),i=i+_|0,F=R(F^i,12),E=E+F|0,_=R(_^E,8),i=i+_|0,F=R(F^i,7),k=k+P|0,T=R(T^k,16),K=K+T|0,P=R(P^K,12),k=k+P|0,T=R(T^k,8),K=K+T|0,P=R(P^K,7),f=f+U|0,T=R(T^f,16),i=i+T|0,U=R(U^i,12),f=f+U|0,T=R(T^f,8),i=i+T|0,U=R(U^i,7),v=v+F|0,G=R(G^v,16),K=K+G|0,F=R(F^K,12),v=v+F|0,G=R(G^v,8),K=K+G|0,F=R(F^K,7),E=E+P|0,w=R(w^E,16),N=N+w|0,P=R(P^N,12),E=E+P|0,w=R(w^E,8),N=N+w|0,P=R(P^N,7),k=k+$|0,_=R(_^k,16),O=O+_|0,$=R($^O,12),k=k+$|0,_=R(_^k,8),O=O+_|0,$=R($^O,7);let z=0;q[z++]=f,q[z++]=v,q[z++]=E,q[z++]=k,q[z++]=G,q[z++]=w,q[z++]=_,q[z++]=T}var jn=Ij(uj,{counterRight:!1,counterLength:4,allowShortKeys:!1}),nn=Ij(uj,{counterRight:!1,counterLength:8,extendNonceFn:An,allowShortKeys:!1});var qn=new Uint8Array(16),bj=(A,j)=>{A.update(j);let n=j.length%16;if(n)A.update(qn.subarray(n))},fn=new Uint8Array(32);function lj(A,j,n,q,f){let v=A(j,n,fn),E=Cj.create(v);if(f)bj(E,f);bj(E,q);let k=zj(q.length,f?f.length:0,!0);E.update(k);let $=E.digest();return fA(v,k),$}var yj=(A)=>(j,n,q)=>{return{encrypt(v,E){let k=v.length;E=kj(k+16,E,!1),E.set(v);let $=E.subarray(0,-16);A(j,n,$,$,1);let U=lj(A,j,n,$,q);return E.set(U,k),fA(U),E},decrypt(v,E){E=kj(v.length-16,E,!1);let k=v.subarray(0,-16),$=v.subarray(-16),U=lj(A,j,n,k,q);if(!Xj($,U))throw new Error("invalid tag");return E.set(v.subarray(0,-16)),A(j,n,E,E,1),fA(U),E}}},iq=Ej({blockSize:64,nonceLength:12,tagLength:16},yj(jn)),ZA=Ej({blockSize:64,nonceLength:24,tagLength:16},yj(nn));class vA{p;static IV_LENGTH=24;static TAG_LENGTH=16;IV_LENGTH=vA.IV_LENGTH;TAG_LENGTH=vA.TAG_LENGTH;key;aad=new Uint8Array(0);constructor(A){this.p=A}async setKey(A){this.key=new Uint8Array(await this.p.subtle.exportKey("raw",A))}async encryptChunk(A){if(!this.key)throw new Error("Key not set");let j=this.p.getRandomValues(new Uint8Array(vA.IV_LENGTH)),q=(this.aad.length?ZA(this.key,j,this.aad):ZA(this.key,j)).encrypt(A);A.fill(0);let f=new Uint8Array(j.length+q.length);return f.set(j,0),f.set(q,j.length),f}async decryptChunk(A){if(!this.key)throw new Error("Key not set");if(A.byteLength<vA.IV_LENGTH+16)throw new y("Invalid ciphertext: too short.");let j=A.slice(0,vA.IV_LENGTH),n=A.slice(vA.IV_LENGTH),q=this.aad.length?ZA(this.key,j,this.aad):ZA(this.key,j);try{return q.decrypt(n)}catch{throw new y("Decryption failed: wrong passphrase or corrupted ciphertext")}}zeroKey(){if(this.key)this.key.fill(0)}setAAD(A){this.aad=A&&A.byteLength?new Uint8Array(A):new Uint8Array(0)}}var aA=HA(H6(),1);async function tn(){if(typeof window!=="undefined")return;if(globalThis.loadArgon2WasmModule)return;try{let{createRequire:A}=await import("node:module"),{readFile:j}=await import("node:fs/promises"),n=A(import.meta.url),q=n.resolve("argon2-browser/dist/argon2.js"),f=n.resolve("argon2-browser/dist/argon2.wasm");globalThis.loadArgon2WasmModule=async()=>{let v=new Uint8Array(await j(f));return globalThis.Module={wasmBinary:v,locateFile:(E)=>E==="argon2.wasm"?f:E},n(q)}}catch{}}async function Q6(A,j,n,q){if(q==="node"){let v=await import("@node-rs/argon2"),E=typeof A==="string"?Buffer.from(A,"utf8"):Buffer.from(A),$=(await v.hash(E,{salt:j,timeCost:n.time,memoryCost:n.mem,parallelism:n.parallelism,outputLen:32,algorithm:v.Algorithm.Argon2id})).split("$").pop();if(!$)throw new Error("Unexpected argon2 hash format");let U=Buffer.from($,"base64");return j.fill(0),E.fill(0),{hash:new Uint8Array(U)}}if(q==="browser")return await tn(),aA.hash({pass:A,salt:j,time:n.time,mem:n.mem,parallelism:n.parallelism,hashLen:32,type:aA.ArgonType.Argon2id}).then((f)=>{if(!f||!f.hash)throw new nA("Failed to produce key derivation");return{hash:f.hash}}).catch((f)=>{let v=f instanceof Error?f.message:typeof f==="string"?f:"Unknown error";throw new nA(`argon2-browser failure: ${v}`)});throw new Error(`Unsupported environment: ${q}`)}class Aj{presets;exportExtractable;name="argon2id";constructor(A,j=!1){this.presets=A;this.exportExtractable=j}async derive(A,j,n,q){let{hash:f}=await Q6(A,j,this.presets[n],q.isNode?"node":"browser");if(this.exportExtractable)return q.subtle.importKey("raw",f,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);else return q.subtle.importKey("raw",f,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}var Z6={low:{time:5,mem:65536,parallelism:1},middle:{time:20,mem:65536,parallelism:1},high:{time:40,mem:65536,parallelism:1}},sn={id:0,cipher:FA,kdf:new Aj(Z6),saltLengths:{low:12,high:16},difficulties:Z6,defaultChunkSize:524288};l.register(sn);var m6={low:{time:5,mem:65536,parallelism:2},middle:{time:10,mem:98304,parallelism:4},high:{time:20,mem:98304,parallelism:4}},en={id:1,cipher:vA,kdf:new Aj(m6,!0),saltLengths:{low:12,high:16},difficulties:m6,defaultChunkSize:524288};l.register(en);var jj=1;function Y6(){return typeof process!=="undefined"&&typeof process.versions==="object"&&!1}function TA(...A){let j=A.reduce((f,v)=>f+v.byteLength,0),n=new Uint8Array(j),q=0;for(let f of A)n.set(f,q),q+=f.byteLength;return n}function _A(...A){try{let j=TA(...A);if(Y6())return Buffer.from(j).toString("base64");let n="";for(let q=0;q<j.length;q++)n+=String.fromCharCode(j[q]);return btoa(n)}catch{throw new fj("Base64 Encoding Error")}}function MA(A){try{if(!/^[A-Za-z0-9+/]+={0,2}$/.test(A)||A.length%4!==0)throw new Error("Invalid Base64");if(Y6())return new Uint8Array(Buffer.from(A,"base64"));let j=atob(A),n=new Uint8Array(j.length);for(let q=0;q<j.length;q++)n[q]=j.charCodeAt(q);return n}catch{throw new NA(`Invalid Base64: length=${A.length}, content='${A.slice(0,12)}…'`)}}function c(A){let j=A.value.length,n=new Array(j).fill("\x00").join("");A.value=n}function rA(A,j,n,q,f){let v={low:0,middle:1,high:2};if(!(j in v))throw new TypeError(`Unsupported difficulty: ${j}`);let E=v[j],k=A<<5|(n==="high"?1:0)<<2|E,$=TA(new Uint8Array([jj,k]),q);if(f)f.setAAD($);return $}function a(A,j){if(A[0]!==jj)throw new t("Invalid input format. The input is unknown.");if(A.length<14)throw new t("Invalid input format. Header too short.");try{let n=A[1],q=n>>5,f=n>>2&1?"high":"low",v=n&3,E=["low","middle","high"][v],k=l.get(q).saltLengths[f],$=2+k;if(A.length<$)throw new t("Invalid input format. Header truncated.");if(j)j.setAAD(A.subarray(0,$));let U=A.slice(2,2+k);return{scheme:q,difficulty:E,saltStrength:f,salt:U,headerLen:$}}catch(n){throw new iA(n instanceof Error?n.message:String(n))}}async function nj(A){if(A instanceof Uint8Array)return A;if(A instanceof ArrayBuffer)return new Uint8Array(A);return new Uint8Array(await A.arrayBuffer())}function Wj(A){let j=new Uint8Array(4);return new DataView(j.buffer).setUint32(0,A,!1),j}function S6(A,j=0){if(A.length-j<4)throw new RangeError("Not enough bytes for frame header");return new DataView(A.buffer,A.byteOffset+j,4).getUint32(0,!1)}var EA=4;class CA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await nj(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){if(A.length>Math.min(this.chunkSize*4,67108864))throw new RangeError(`Input block (${A.length} B) exceeds maximum allowed ${Math.min(this.chunkSize*4,67108864)} B`);let q=new Uint8Array(this.buffer.length+A.length);q.set(this.buffer),q.set(A,this.buffer.length);let f=0;while(q.length-f>=this.chunkSize){let v=q.slice(f,f+this.chunkSize);f+=this.chunkSize;let E=await this.engine.encryptChunk(v),k=new Uint8Array(EA+E.length);k.set(Wj(E.length)),k.set(E,EA),j.enqueue(k)}this.buffer=q.slice(f)}async flush(A){if(!this.buffer.length)return;let j=await this.engine.encryptChunk(this.buffer),n=new Uint8Array(EA+j.length);n.set(Wj(j.length)),n.set(j,EA),A.enqueue(n),this.buffer=new Uint8Array(0),this.engine.zeroKey()}}class WA{engine;chunkSize;buffer=new Uint8Array(0);constructor(A,j=524288){this.engine=A;this.chunkSize=j}toTransformStream(){return new TransformStream({transform:async(A,j)=>{await this.transform(await nj(A),j)},flush:async(A)=>this.flush(A)})}async transform(A,j){let n=new Uint8Array(this.buffer.length+A.length);n.set(this.buffer),n.set(A,this.buffer.length);let q=0;while(!0){if(n.length-q<EA)break;let f=S6(n,q);if(f>this.chunkSize*2)throw new y(`Frame length ${f} exceeds …`);if(n.length-q-EA<f)break;q+=EA;let v=n.slice(q,q+f);q+=f;try{let E=await this.engine.decryptChunk(v);j.enqueue(E)}catch(E){throw E instanceof y?E:new y("Decryption failed: Wrong passphrase or corrupted ciphertext")}}this.buffer=n.slice(q)}async flush(A){await this.transform(new Uint8Array(0),A),this.buffer=new Uint8Array(0),this.engine.zeroKey()}}async function g6(A,j){let n=A.getReader(),q=j&&j.length?[j]:[];try{while(!0){let{value:k,done:$}=await n.read();if($)break;q.push(k)}}finally{n.releaseLock()}let f=q.reduce((k,$)=>k+$.byteLength,0),v=new Uint8Array(f),E=0;for(let k of q)v.set(k,E),E+=k.byteLength;return v}class JA{engine;chunkSize;constructor(A,j=524288){this.engine=A;this.chunkSize=j}encryptionStream(){let A=new CA(this.engine,this.chunkSize).toTransformStream();return{writable:A.writable,readable:A.readable}}decryptionStream(A){let j=A,n=new TransformStream({transform(f,v){if(j===0){v.enqueue(f);return}if(f.byteLength<=j){j-=f.byteLength;return}v.enqueue(f.slice(j)),j=0}}),q=new WA(this.engine,this.chunkSize).toTransformStream();return{writable:n.writable,readable:n.readable.pipeThrough(q)}}async collect(A,j,n=null){return g6(A.pipeThrough(j),n??void 0)}getEngine(){return this.engine}}function X6(A){try{if(A)A.fill(0)}catch{}}function dn(A){let j="";for(let n=0;n<A.length;n++){let q=A[n].toString(16).padStart(2,"0");j+=q}return j}class kA{bytes;destroyed=!1;static from(A){if(A instanceof kA)return A;if(typeof A==="string")return new kA(new TextEncoder().encode(A));if(A instanceof Uint8Array)return new kA(A);throw new TypeError("ConvertibleInput: unsupported input type")}constructor(A){this.bytes=A}toUint8Array(){if(this.destroyed)throw new Error("ConvertibleInput: already cleared");return this.bytes}clear(){if(!this.destroyed)X6(this.bytes),this.bytes=new Uint8Array(0),this.destroyed=!0}}class bA{bytes;destroyed=!1;constructor(A){this.bytes=A}get uint8array(){if(this.destroyed)throw new Error("ConvertibleOutput: already cleared");return this.bytes}get base64(){if(this.destroyed)throw new Error("ConvertibleOutput: already cleared");return _A(this.bytes)}get hex(){if(this.destroyed)throw new Error("ConvertibleOutput: already cleared");return dn(this.bytes)}get text(){if(this.destroyed)throw new Error("ConvertibleOutput: already cleared");return new TextDecoder().decode(this.bytes)}clear(){if(!this.destroyed)X6(this.bytes),this.bytes=new Uint8Array(0),this.destroyed=!0}toString(){return this.base64}}function z6(A=0,j=console.info){return{level:A,log(n,q){if(n<=A)j(`${n}| ${q}`)}}}function L6(A,j,n){if(j<0||n<0||j+n>A)throw new RangeError("read() slice exceeds data bounds")}var{promises:kf}=(()=>({}));class Jj{src;#A=null;constructor(A){this.src=A}get length(){if(this.src instanceof Uint8Array)return this.src.byteLength;if(this.src instanceof Blob)return this.src.size;return this.ensureUint8().byteLength}async read(A,j){if(L6(this.length,A,j),this.src instanceof Uint8Array)return this.src.slice(A,A+j);if(this.src instanceof Blob){let n=await this.src.slice(A,A+j).arrayBuffer();return new Uint8Array(n)}return this.ensureUint8().slice(A,A+j)}ensureUint8(){if(!this.#A)this.#A=MA(this.src);return this.#A}}var D6=new WeakMap;class KA{static getEngine(A,j){let n=D6.get(A);if(!n)n=new Map,D6.set(A,n);let q=n.get(j);if(q)return q;let f=l.get(j);return q={desc:f,cipher:new f.cipher(A),kdf:f.kdf,chunkSize:f.defaultChunkSize,provider:A},n.set(j,q),q}static async deriveKey(A,j,n,q){try{let f=await A.kdf.derive(j.value,n,q,A.provider);await A.cipher.setKey(f)}catch(f){let v=f instanceof Error?f.message:String(f);throw new nA(v)}finally{c(j)}}}class $A{provider;v;cipher;kdf;chunkSize;stream;difficulty;saltStrength;engines=new Map;log;constructor(A,j={}){this.provider=A;this.v=l.get(j.scheme??l.current.id),this.cipher=new this.v.cipher(A),this.kdf=this.v.kdf,this.chunkSize=this.setChunkSize(j.chunkSize??this.v.defaultChunkSize),this.stream=new JA(this.cipher,this.chunkSize),this.difficulty=j.difficulty??"middle",this.saltStrength=j.saltStrength??"high",this.log=z6(j.verbose??0,j.logger)}static async isEncrypted(A){try{return await $A.peekHeader(A),!0}catch{return!1}}static async decodeHeader(A){let j=await $A.peekHeader(A),n=a(j);return{scheme:n.scheme,difficulty:n.difficulty,salt:_A(n.salt),saltBytes:n.salt,saltLength:n.salt.byteLength}}static async headerDecode(A){return this.decodeHeader(A)}static isRandomAccessSource(A){return typeof A==="object"&&A!==null&&typeof A.read==="function"}static async decodeData(A){let j=$A.isRandomAccessSource(A)?A:new Jj(A),n=await j.read(0,Math.min(256,j.length)),q=await $A.peekHeader(n),{scheme:f,headerLen:v}=a(q),E=j.length,k=E-v;if(k<=0)throw new t("Payload is empty");let $=await j.read(v,4),U=new DataView($.buffer,$.byteOffset,4).getUint32(0,!1);if(U+4<=k&&U>=28){let i=U,K=v,G=0,w=0;while(K+4<=E){let _=await j.read(K,4),T=new DataView(_.buffer,_.byteOffset,4).getUint32(0,!1);if(T===0||K+4+T>E)break;G++,w+=T,K+=4+T}return{isChunked:!0,chunks:{chunkSize:i,count:G,totalPayload:w}}}let P=await j.read(v,k),N=l.get(f).cipher.IV_LENGTH,O=l.get(f).cipher.TAG_LENGTH;if(P.length<N+O)throw new t("Ciphertext too short for IV & tag");return{isChunked:!1,payloadLength:k-N-O,params:{iv:P.slice(0,N),ivLength:N,tag:P.slice(P.length-O),tagLength:O}}}setDifficulty(A){this.difficulty=A}getDifficulty(){return this.difficulty}setScheme(A){this.v=l.get(A),this.cipher=new this.v.cipher(this.provider),this.kdf=this.v.kdf,this.stream=new JA(this.cipher,this.chunkSize)}getScheme(){return this.v.id}setSaltDifficulty(A){this.saltStrength=A}getSaltDifficulty(){return this.saltStrength}setChunkSize(A){let n=A,q;if(n==null)q=this.v.defaultChunkSize;else{if(q=Number(n),!Number.isInteger(q)||q<1)throw new Error(`Invalid chunkSize: ${n}. Must be a positive integer.`);if(q>134217728)throw new RangeError("chunkSize cannot exceed 134217728 bytes.")}if(this.chunkSize=q,this.stream)this.stream=new JA(this.cipher,this.chunkSize);return q}getChunkSize(){return this.chunkSize}setVerbose(A){this.log.level=A}getVerbose(){return this.log.level}async encryptText(A,j){if(j===null)throw new p("Password can't be null");let n={value:j};try{if(j==="")this.log.log(0,"Empty passphrase provided to encryptText");this.log.log(1,`Start text encryption, scheme: ${this.getScheme()}`);let q=kA.from(A),f=q.toUint8Array();this.log.log(2,"Deriving key for text encryption");let v=this.genSalt();await this.deriveKey(n,v),c(n),j=null,this.log.log(3,`Salt generated: ${_A(v)}, KDF difficulty: ${this.difficulty}`),this.log.log(3,"Encoding header");let E=rA(this.v.id,this.difficulty,this.saltStrength,v,this.cipher);this.log.log(2,"Encrypting text data");let k=await this.cipher.encryptChunk(f);this.cipher.zeroKey();try{q.clear()}catch{}let $=TA(E,k);return this.log.log(1,"Encryption finished"),new bA($)}catch(q){throw new p(q instanceof Error?q.message:String(q))}}async decryptText(A,j){if(j===null)throw new p("Password can't be null");let n={value:j};try{if(j==="")this.log.log(0,"Empty passphrase provided to decryptText");this.log.log(1,`Start text decryption, Version ${this.getScheme()}`);let q;if(typeof A==="string")this.log.log(3,"Decoding Base64 ciphertext"),q=MA(A);else if(A instanceof Uint8Array)q=A;else if(A instanceof kA)q=A.toUint8Array();else throw new NA("Unsupported ciphertext input type");this.log.log(3,"Start header decoding");let f=a(q);this.log.log(3,"Selecting decryption engine");let v=KA.getEngine(this.provider,f.scheme);this.log.log(2,`Deriving key via engine for scheme: ${f.scheme}`),this.log.log(3,`Salt use: ${_A(f.salt)}, KDF difficulty: ${f.difficulty}`);try{await KA.deriveKey(v,n,f.salt,f.difficulty)}finally{c(n),j=null}this.log.log(2,"Decrypting text data"),a(q,v.cipher);let E=await v.cipher.decryptChunk(q.slice(f.headerLen));if(v.cipher.zeroKey(),A instanceof kA)try{A.clear()}catch{}return this.log.log(1,"Decryption finished"),new bA(E)}catch(q){if(q instanceof y||q instanceof t||q instanceof iA||q instanceof NA||q instanceof nA)throw q;throw new y("Decryption failed: wrong passphrase or corrupted ciphertext")}}async encryptFile(A,j){if(j===null)throw new p("Password can't be null");let n={value:j};try{if(A.size===0){let E=this.genSalt();await this.deriveKey(n,E),c(n),j=null;let k=rA(this.v.id,this.difficulty,this.saltStrength,E);return new Blob([k],{type:"application/octet-stream"})}this.log.log(2,"Deriving key for file encryption");let q=this.genSalt();await this.deriveKey(n,q),c(n),j=null;let f=rA(this.v.id,this.difficulty,this.saltStrength,q,this.stream.getEngine()),v=await this.stream.collect(A.stream(),new CA(this.cipher,this.chunkSize).toTransformStream(),f);return new Blob([v],{type:"application/octet-stream"})}catch(q){throw new p(q instanceof Error?q.message:String(q))}}async decryptFile(A,j){if(j===null)throw new p("Password can't be null");let n={value:j};try{let q=await $A.peekHeader(A),f=a(q),v=KA.getEngine(this.provider,f.scheme);try{await KA.deriveKey(v,n,f.salt,f.difficulty)}finally{c(n),j=null}if(A.size===f.headerLen)return new Blob([],{type:"application/octet-stream"});this.log.log(2,"Decrypting file data");let E=new JA(v.cipher,v.chunkSize);a(q,E.getEngine());let k=await E.collect(A.slice(f.headerLen).stream(),new WA(v.cipher,v.chunkSize).toTransformStream());return new Blob([k],{type:"application/octet-stream"})}catch(q){if(q instanceof y)throw q;throw new y(q instanceof Error?q.message:String(q))}}async createEncryptionStream(A){if(A===null)throw new p("Password can't be null");let j={value:A};this.log.log(2,"Deriving key for stream encryption");let n=this.genSalt();await this.deriveKey(j,n),c(j),A=null;let q=rA(this.v.id,this.difficulty,this.saltStrength,n,this.stream.getEngine()),f=this.stream.encryptionStream();return{header:q,writable:f.writable,readable:f.readable}}async createDecryptionStream(A){if(A===null)throw new p("Password can't be null");let j=this.provider,n={value:A},q=new Uint8Array(0),f=null,v=65536,E=14,k=async($,U)=>{let F=$.getReader();while(!0){let{value:P,done:N}=await F.read();if(N)break;U.enqueue(P)}};return new TransformStream({transform:async($,U)=>{if(!f){if($&&$.byteLength){if(q.byteLength+$.byteLength>v){c(n),U.error(new t(`Header not found within ${v} bytes`));return}q=TA(q,$)}if(q.byteLength<E)return;let P=q[1],N=P>>5,O=P>>2&1?"high":"low",i=0;try{i=2+l.get(N).saltLengths[O]}catch(T){c(n),U.error(new iA(T instanceof Error?T.message:String(T)));return}if(q.byteLength<i)return;let K=q.subarray(0,i),G;try{G=a(K)}catch(T){c(n),U.error(T instanceof Error?T:new iA("Invalid header"));return}let w=KA.getEngine(j,G.scheme);try{await KA.deriveKey(w,n,G.salt,G.difficulty)}finally{c(n),A=null}a(K,w.cipher),f=new WA(w.cipher,w.chunkSize).toTransformStream(),k(f.readable,U).catch((T)=>U.error(T));let _=q.subarray(i);if(q=new Uint8Array(0),_.byteLength){let T=f.writable.getWriter();await T.write(_),T.releaseLock()}return}let F=f.writable.getWriter();await F.write($),F.releaseLock()},flush:async()=>{if(!f)throw c(n),new t("Header not found before end of stream");let $=f.writable.getWriter();await $.close(),$.releaseLock()}})}async deriveKey(A,j,n=this.difficulty){let q=performance.now();try{let f=await this.kdf.derive(A.value,j,n,this.provider);c(A),await this.cipher.setKey(f),this.log.log(3,`Key derivation completed in ${(performance.now()-q).toFixed(1)} ms`)}catch(f){throw new nA(f instanceof Error?f.message:String(f))}}genSalt(A=this.saltStrength){let j=this.v.saltLengths[A];return this.provider.getRandomValues(new Uint8Array(j))}static async peekHeader(A){let j=await this.readAsUint8(A);if(j instanceof Uint8Array){if(j.length<2)throw new t("Input too short");let{headerLen:n}=a(j.length>=16?j:Uint8Array.from(j));if(j.length<n)throw new t("Incomplete header");return j.slice(0,n)}throw new iA("Unsupported input type")}static async readAsUint8(A){if(typeof A==="string")return MA(A);if(A instanceof Blob){let j=A.slice(0,64);return new Uint8Array(await j.arrayBuffer())}return A}}var M6={subtle:globalThis.crypto.subtle,getRandomValues(A){return globalThis.crypto.getRandomValues(A)},isNode:!1};function gf(A){return new $A(M6,A)}export{gf as createCryptit,$A as Cryptit,bA as ConvertibleOutput,kA as ConvertibleInput};

//# debugId=980AF7B97B784B5364756E2164756E21
